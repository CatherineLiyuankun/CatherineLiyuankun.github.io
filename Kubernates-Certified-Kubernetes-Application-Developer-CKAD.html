<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="4aJ9pFEKjOcI9zlltw5NYLKMsnk_Ygy49okv3PcTknw">
    <meta name="baidu-site-verification" content="JFD0vIDsbS">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/cat-icon-512.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          2022 CKAD K8s v1.25 考试真题整理 - Yuankun | Zilan
        
    </title>

    <link rel="canonical" href="http://liyuankun.top/Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <!-- <link rel="stylesheet" href="/css/zilan.min.css"> -->
    <link rel="stylesheet" href="/css/zilan.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <link rel="stylesheet" href="/css/share.css">

    <link rel="stylesheet" href="/css/gitment.css">

    <link rel="stylesheet" href="/css/copyright.css">

    <link rel="stylesheet" href="/css/search/localsearch.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('');
            /*post*/
        
    }
    
        #signature{
            background-image: url('/img/signature/signature-white.png');
        }
    

    
        #header-cover {
            background-color: rgba(0,0,0,.2);
        }
    
</style>

<header class="intro-header" >
    <div id="header-cover">
        <!-- Signature -->
        <div id="signature">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    
                        <div class="post-heading">
                            <div class="tags">
                                
                                <a class="tag" href="/tags/#Cloud" title="Cloud">Cloud</a>
                                
                                <a class="tag" href="/tags/#container" title="container">container</a>
                                
                            </div>
                            <!-- category post header -->
                            
                                <div class="page-header-category">
                                    <a class="category-list-link" href="/categories/TECH/">TECH</a>►<a class="category-list-link" href="/categories/TECH/container/">container</a>
                                </div>
                            
                            
                                <span class="post-comments-count">
                                    <span class="post-meta-divider">|</span>
                                    <a href="/Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html#git_comment" rel="external nofollow" itemprop="discussionUrl">
                                        <span class="post-meta-item-icon">
                                            <i class="fa fa-comment-o"></i>
                                        </span>
                                        <span class="post-comments-count gitment-comments-count" data-xid="/Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html" itemprop="commentsCount"></span>
                                    </a>
                                </span>
                            
                            <h1>
                                2022 CKAD K8s v1.25 考试真题整理
                                <!-- Share -->
                                
                                    <span id="needsharebutton-postbottom" class="header-share">
                                        <span class="btn">
                                            <i class="fa fa-share-alt" aria-hidden="true"></i>
                                        </span>
                                    </span>
                                
                            </h1>
                            <h2 class="subheading">Kubernates-Certified Kubernetes Application Developer</h2>
                            <span class="meta">
                                Posted by Yuankun Li on
                                2022-08-02
                            </span>
                        </div>
                    
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">岚</a>
            <!-- Search -->
            
            
                <li class="menu-item menu-item-search">
                
                    <a href="javascript:;" class="popup-trigger">
                
                    
                        <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
                    
                </a>
                </li>
            
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/categories/">Categories</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Post Content -->
<div id="container">
    <article>
        <div class="container post-content-container">
            <div class="row">

                <!-- One Post Content Container -->
                <div class="
                    col-lg-8 col-lg-offset-2
                    col-md-10 col-md-offset-1
                    post-container">

                    <p>上一篇：<a href="./Kubernates-Certified-Kubernetes-Administrator-CKA.html">CKA考试真题</a></p>
<h2 id="考试内容">考试内容</h2>
<p><a href="https://docs.linuxfoundation.org/tc-docs/certification/tips-cka-and-ckad" target="_blank" rel="noopener">Important Instructions: CKA and CKAD</a></p>
<ul>
<li>考试包括 15-20 项performance-based tasks。
<ul>
<li>2022.12 实测是16道题</li>
</ul>
</li>
<li>考生有 2 小时的时间完成 CKA 和 CKAD 考试。
<ul>
<li>因为从06/2022开始环境升级（贬义），考试环境更难用了，变的很卡，所以时间变得比较紧张。容易做不完题，建议先把有把握的，花费时间不多的题先做掉
<ul>
<li><a href="https://itnext.io/cks-cka-ckad-changed-terminal-to-remote-desktop-157a26c1d5e" target="_blank" rel="noopener">CKS CKA CKAD changed Terminal to Remote Desktop </a></li>
</ul>
</li>
</ul>
</li>
<li>CKAD考试66分以上即可通过，考试不通过有一次补考机会。</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKA/CKA_exam_syllabus.png" alt="CKA"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKA/CKAD_exam_syllabus.png" alt="CKAD"></p>
<p>You’re only allowed to have one other browser tab open with:</p>
<ul>
<li><a href="https://kubernetes.io/docs" target="_blank" rel="noopener">https://kubernetes.io/docs</a></li>
<li><a href="https://kubernetes.io/blog" target="_blank" rel="noopener">https://kubernetes.io/blog</a></li>
<li><a href="https://helm.sh/docs" target="_blank" rel="noopener">https://helm.sh/docs</a></li>
</ul>
<h3 id="more-items-for-ckad-than-cka">More items for CKAD than CKA</h3>
<ul>
<li>Define, build and modify container images, <code>Dockerfile</code></li>
<li>Understand multi-container Pod design patterns (init containers)</li>
<li>Understand <code>Jobs</code> and <code>CronJobs</code></li>
<li>Implement <code>probes</code> and health checks</li>
<li>Understand <a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/" target="_blank" rel="noopener"><code>SecurityContexts</code></a></li>
<li><a href="https://kubernetes.io/docs/concepts/cluster-administration/manage-deployment/#canary-deployments" target="_blank" rel="noopener"><code>canary deployment</code></a>
<ul>
<li><a href="./Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html#%E8%80%83%E9%A2%9810-2022-rollout-canary">考题10 - 2022 Rollout Canary</a></li>
</ul>
</li>
<li><code>ResourceQuota</code></li>
</ul>
<h2 id="如何备考">如何备考</h2>
<h3 id="k8s练习环境-同cka"><a href="./Kubernates-Certified-Kubernetes-Administrator-CKA.html#k8s%E7%BB%83%E4%B9%A0%E7%8E%AF%E5%A2%83">k8s练习环境</a>(同CKA)</h3>
<h3 id="ckad练习题">CKAD练习题</h3>
<p>有几个练习库，建议将每个题目都自己亲自操作一遍，一定要操作。</p>
<ul>
<li>CKAD在线练习环境：<a href="https://killercoda.com/killer-shell-ckad" target="_blank" rel="noopener">https://killercoda.com/killer-shell-ckad</a></li>
<li><a href="https://github.com/StenlyTU/K8s-training-official" target="_blank" rel="noopener">Git - StenlyTU - K8s Practice Training for CKA, CKAD and CKS</a></li>
<li><a href="https://github.com/bbachi/CKAD-Practice-Questions" target="_blank" rel="noopener">bbachi/CKAD-Practice-Questions</a>
<ul>
<li>对应博客<a href="https://medium.com/bb-tutorials-and-thoughts/practice-enough-with-these-questions-for-the-ckad-exam-2f42d1228552" target="_blank" rel="noopener">2019.11 Practice Enough With These 150 Questions for the CKAD Exam</a><!-- - [CKAD考试真题-练习题150道](https://www.cnblogs.com/peteremperor/p/12785335.html) 同第一个链接一样 -->
<ul>
<li>同第一个链接一样，中文版 <a href="https://blog.csdn.net/tanjunchen/article/details/104865939?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166039499316782248541148%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166039499316782248541148&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-104865939-null-null.142%5Ev40%5Epc_search_integral,185%5Ev2%5Econtrol&amp;utm_term=CKAD%E8%80%83%E8%AF%95%E9%A2%98&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener">2020 CKAD 考试习题练习104道</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://github.com/dgkanatsios/CKAD-exercises" target="_blank" rel="noopener">dgkanatsios/CKAD-exercises</a></li>
<li>Oreilly视频课程-附带练习环境（链接已失效Katacoda has ended public service）： <a href="https://www.katacoda.com/liptanbiswas/courses/ckad-practice-challenges" target="_blank" rel="noopener">https://www.katacoda.com/liptanbiswas/courses/ckad-practice-challenges</a></li>
</ul>
<p>题库里面题目是更简单一些，真的考题会是这些练习题的组合，把里面的题目都能熟练操作，就差不多了。</p>
<h3 id="ckad课程">CKAD课程</h3>
<ul>
<li>【需付费】CKAD考试-对应官方课程<a href="https://training.linuxfoundation.org/training/kubernetes-for-developers/" target="_blank" rel="noopener">Kubernetes for Developers (LFD259)</a></li>
<li>【需付费】Udemy CKAD 课程
<ul>
<li><a href="https://www.techbeatly.com/kk-ckad" target="_blank" rel="noopener">Certified Kubernetes Application Developer (CKAD)</a> – by Mumshad Mannambeth</li>
<li><a href="https://www.techbeatly.com/kk-ckad-ud" target="_blank" rel="noopener">Kubernetes Certified Application Developer (CKAD) with Tests</a> – by Mumshad Mannambeth – Udemy</li>
</ul>
</li>
<li>【需付费】Oreilly视频课程: (For beginner or Advanced) <a href="https://learning.oreilly.com/videos/certified-kubernetes-application/9780137841509/" target="_blank" rel="noopener">Certified Kubernetes Application Developer (CKAD) Sander van Vugt</a>.
<ul>
<li><a href="https://learning.oreilly.com/live-events/certified-kubernetes-application-developer-ckad-crash-course/0636920315803/" target="_blank" rel="noopener">Certified Kubernetes Application Developer (CKAD) Crash Course</a>
<ul>
<li>附带练习环境Practice: <a href="https://learning.oreilly.com/playlists/ea6ea0fc-d8e2-422c-94dd-a0a8f608d224/" target="_blank" rel="noopener">Certified Kubernetes - CKAD Labs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="常用命令">常用命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不熟</span></span><br><span class="line"><span class="comment">## 输出pod status</span></span><br><span class="line">kubectl -n default describe pod pod1 | grep -i status:</span><br><span class="line">kubectl -n default get pod pod1 -o jsonpath=<span class="string">"&#123;.status.phase&#125;"</span></span><br><span class="line"><span class="comment">## Check the pod for error</span></span><br><span class="line">kubectl describe pod podname | grep -i error</span><br><span class="line">... Error: ImagePullBackOff</span><br><span class="line"><span class="comment">## a fast way to get an overview of the ReplicaSets of a Deployment and their images could be done with:</span></span><br><span class="line">kubectl -n neptune get rs -o wide | grep deployname</span><br><span class="line">NAME         DESIRED   CURRENT   READY   AGE    CONTAINERS   IMAGES         SELECTOR</span><br><span class="line">deployname   3         3         3       9m6s   httpd        httpd:alpine   app=wonderful</span><br><span class="line"></span><br><span class="line"><span class="comment">## 创建job</span></span><br><span class="line">kubectl -n neptune create job neb-new-job --image=busybox:1.31.0 <span class="variable">$do</span> &gt; /opt/course/3/job.yaml -- sh -c <span class="string">"sleep 2 &amp;&amp; echo done"</span></span><br><span class="line"><span class="comment">## If a Secret bolongs to a serviceaccount, it'll have the annotation kubernetes.io/service-account.name</span></span><br><span class="line">kubectl get secrets -oyaml | grep annotations -A 1 <span class="comment"># shows secrets with first annotation</span></span><br><span class="line"><span class="comment">## log</span></span><br><span class="line">kubectl logs podname &gt; /opt/test.log</span><br><span class="line">➜ k -n mercury logs cleaner-576967576c-cqtgx --container logger-con</span><br><span class="line"></span><br><span class="line"><span class="comment">## decode base64</span></span><br><span class="line">base64 -d filename</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"YWRtaW4="</span> | base64 -d</span><br><span class="line">admins$</span><br><span class="line"></span><br><span class="line"><span class="comment">## check service connection using a temporary Pod</span></span><br><span class="line"><span class="comment">## k run tmp --restart=Never --rm --image=nginx:alpine -i -- curl http://svcname.namespace:svcport</span></span><br><span class="line">kubectl run tmp --restart=Never --rm --image=nginx:alpine -i -- curl http://svcname.namespace:80</span><br><span class="line"><span class="comment">## check that both PV and PVC have the status Bound:</span></span><br><span class="line">k -n earth get pv,pvc</span><br><span class="line">NAME                                            CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                 STORAGECLASS   REASON   AGE</span><br><span class="line">persistentvolume/earth-project-earthflower-pv   2Gi        RWO            Retain           Bound    earth/earth-project-earthflower-pvc                           8m4s</span><br><span class="line"></span><br><span class="line">NAME                                                  STATUS   VOLUME                         CAPACITY   ACCESS MODES   STORAGECLASS   AGE</span><br><span class="line">persistentvolumeclaim/earth-project-earthflower-pvc   Bound    earth-project-earthflower-pv   2Gi        RWO                           7m38s</span><br><span class="line"></span><br><span class="line"><span class="comment">## We can confirm the pod of deployment with PVC mounting correctly:</span></span><br><span class="line">k describe pod project-earthflower-586758cc49-hb87f -n earth | grep -A2 Mount:</span><br><span class="line">    Mounts:</span><br><span class="line">      /tmp/project-data from task-pv-storage (rw)</span><br><span class="line">      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-jj2t2 (ro)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Verify everything using kubectl auth can-i</span></span><br><span class="line">kubectl auth can-i create deployments --as system:serviceaccount:app-team1:cicd-token -n app-team1 <span class="comment"># YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 查看某个namespace的resource quota</span></span><br><span class="line">$ kubectl describe quota --namespace=rq-demo</span><br><span class="line"><span class="comment">## 或者</span></span><br><span class="line">$ kubectl describe resourcequotas -n rq-demo</span><br><span class="line"></span><br><span class="line"><span class="comment">## rollout</span></span><br><span class="line">k -n mercury rollout <span class="built_in">history</span> deploy cleaner --revision 1</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 常用</span></span><br><span class="line"><span class="comment">## 创建pod</span></span><br><span class="line">kubectl run pod1 --image=httpd:2.4.41-alpine <span class="variable">$do</span> --port=80 &gt; 2.yaml</span><br><span class="line">kubectl get pod sat-003 -o yaml &gt; 7-sat-003.yaml <span class="comment"># export</span></span><br><span class="line">kubectl delete pod pod1 --force --grace-period=0</span><br><span class="line"><span class="comment">## 创建service</span></span><br><span class="line">kubectl expose deployment d1 --name=服务名 --port=服务端口 --target-port=pod运行端口 --<span class="built_in">type</span>=类型 --protocol=TCP</span><br><span class="line">kubectl expose pod pod名 --name=服务名 --port=服务端口 --target-port=pod运行端口 --<span class="built_in">type</span>=类型</span><br><span class="line"><span class="comment">## 创建secret</span></span><br><span class="line">kubectl create secret generic db-credentials --from-literal db-password=passwd</span><br><span class="line"><span class="comment">## modify a pod yaml to deployment yaml</span></span><br><span class="line"><span class="comment">### put the Pod's metadata: and spec: into the Deployment's template: section:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Ingress</span></span><br><span class="line"><span class="comment"># 1 注意namespace</span></span><br><span class="line"><span class="comment"># spec:</span></span><br><span class="line">  <span class="comment"># ingressClassName: nginx   # 2 ingressClassName</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># metadata:</span></span><br><span class="line">  <span class="comment"># name: minimal-ingress</span></span><br><span class="line">  <span class="comment"># annotations:</span></span><br><span class="line">  <span class="comment">#   nginx.ingress.kubernetes.io/rewrite-target: /   #3 annotation</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## NetworkPolicy</span></span><br><span class="line">注意 </span><br><span class="line">  egress:</span><br><span class="line">    - to:</span><br><span class="line">        - ipBlock:</span><br><span class="line">            cidr: 10.0.0.0/24</span><br><span class="line">      ports:                   <span class="comment"># &amp;</span></span><br><span class="line">        - protocol: TCP</span><br><span class="line">          port: 5978</span><br><span class="line"></span><br><span class="line">  egress:</span><br><span class="line">    - to:</span><br><span class="line">        - ipBlock:</span><br><span class="line">            cidr: 10.0.0.0/24</span><br><span class="line">    - ports:                  <span class="comment"># ||</span></span><br><span class="line">        - protocol: TCP</span><br><span class="line">          port: 5978</span><br></pre></td></tr></table></figure>
<h2 id="经验总结-同cka"><a href="http://liyuankun.top/Kubernates-Certified-Kubernetes-Administrator-CKA.html#%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93">经验总结</a>(同CKA)</h2>
<h2 id="pre-setup-同cka"><a href="http://liyuankun.top/Kubernates-Certified-Kubernetes-Administrator-CKA.html#pre-setup">Pre Setup</a>(同CKA)</h2>
<h2 id="ckad-真题">CKAD 真题</h2>
<p>2021 年的考题，基于k8s 1.20<br>
2022.12 的考题，基于k8s 1.25</p>
<h3 id="2021考题1-creating-a-pod-and-inspecting-it">2021考题1 - Creating a Pod and Inspecting it</h3>
<ol>
<li>Create the namespace ckad-prep.</li>
<li>In the namespace ckad-prep create a new Pod named mypod with the image nginx:2.3.5. Expose the port 80.</li>
<li>Identify the issue with creating the container. Write down the root cause of issue in a file named pod-error.txt.</li>
<li>Change the image of the Pod to nginx:1.15.12.</li>
<li>List the Pod and ensure that the container is running.</li>
<li>Log into the container and run the ls command. Write down the output. Log out of the container.</li>
<li>Retrieve the IP address of the Pod mypod.</li>
<li>Run a temporary Pod using the image busybox, shell into it and run a wget command against the nginx Pod using port 80.</li>
<li>Render the logs of Pod mypod.</li>
<li>Delete the Pod and the namespace.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. create the namespace.</span></span><br><span class="line">$ kubectl create ns ckad-prep</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. create a new Pod</span></span><br><span class="line">$ kubectl run mypod -n ckad-prep --image=nginx:2.3.5 --port=80 </span><br><span class="line"><span class="comment"># 或者：</span></span><br><span class="line"><span class="comment"># $ kubectl run mypod --namespace=ckad-prep --image=nginx:2.3.5 --port=80 </span></span><br><span class="line">pod/mypod created</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3. Write down root cause in pod-error.txt</span></span><br><span class="line">$ kubectl get pod -n ckad-prep</span><br><span class="line">NAME    READY   STATUS             RESTARTS   AGE</span><br><span class="line">mypod   0/1     ImagePullBackOff   0          1m</span><br><span class="line"></span><br><span class="line">$ kubectl describe pod mypod -n ckad-prep</span><br><span class="line">...</span><br><span class="line">Events:</span><br><span class="line">  Type     Reason     Age                  From               Message</span><br><span class="line">  ----     ------     ----                 ----               -------</span><br><span class="line">  Normal   Scheduled  12m                  default-scheduler  Successfully assigned ckad-prep/mypod to controlplane</span><br><span class="line">  Normal   Pulling    10m (x4 over 12m)    kubelet            Pulling image <span class="string">"nginx:2.3.5"</span></span><br><span class="line">  Warning  Failed     10m (x4 over 12m)    kubelet            Failed to pull image <span class="string">"nginx:2.3.5"</span>: rpc error: code = NotFound desc = failed to pull and unpack image <span class="string">"docker.io/library/nginx:2.3.5"</span>: failed to resolve reference <span class="string">"docker.io/library/nginx:2.3.5"</span>: docker.io/library/nginx:2.3.5: not found</span><br><span class="line">  Warning  Failed     10m (x4 over 12m)    kubelet            Error: ErrImagePull</span><br><span class="line">  Warning  Failed     10m (x6 over 12m)    kubelet            Error: ImagePullBackOff</span><br><span class="line">  Normal   BackOff    2m9s (x41 over 12m)  kubelet            Back-off pulling image <span class="string">"nginx:2.3.5"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ kubectl describe pod mypod -n ckad-prep | grep err -i</span><br><span class="line">      Reason:       ErrImagePull</span><br><span class="line">  Warning  Failed     17s (x3 over 57s)  kubelet            Failed to pull image <span class="string">"nginx:2.3.5"</span>: rpc error: code = NotFound desc = failed to pull and unpack image <span class="string">"docker.io/library/nginx:2.3.5"</span>: failed to resolve reference <span class="string">"docker.io/library/nginx:2.3.5"</span>: docker.io/library/nginx:2.3.5: not found</span><br><span class="line">  Warning  Failed     17s (x3 over 57s)  kubelet            Error: ErrImagePull</span><br><span class="line">  Warning  Failed     3s (x3 over 56s)   kubelet            Error: ImagePullBackOff</span><br><span class="line"></span><br><span class="line">$ kubectl describe pod mypod -n ckad-prep | grep err -i &gt; pod-error.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4. Change the image of the Pod to nginx:1.15.12</span></span><br><span class="line">$ kubectl edit pod mypod -n ckad-prep</span><br><span class="line"></span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - image: nginx:1.15.12 <span class="comment"># 从nginx:2.3.5改为nginx:1.15.12</span></span><br><span class="line"></span><br><span class="line">pod/mypod edited</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. List the Pod and ensure that the container is running.</span></span><br><span class="line">$ kubectl get pod -n ckad-prep</span><br><span class="line">NAME    READY   STATUS    RESTARTS   AGE</span><br><span class="line">mypod   1/1     Running   0          19m</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. Log into the container and run the ls command. Write down the output. Log out of the container.</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> mypod -n ckad-prep -- ls</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> mypod -it -n ckad-prep  -- /bin/sh</span><br><span class="line">/ <span class="comment"># ls</span></span><br><span class="line">bin  boot  dev	etc  home  lib	lib64  media  mnt  opt	proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">/ <span class="comment"># exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. Retrieve the IP address of the Pod mypod.</span></span><br><span class="line">$ kubectl get pod -n ckad-prep -o wide</span><br><span class="line">NAME    READY   STATUS    RESTARTS   AGE   IP            NODE           NOMINATED NODE   READINESS GATES</span><br><span class="line">mypod   1/1     Running   0          29m   192.168.0.6   controlplane   &lt;none&gt;           &lt;none&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 8. Run a temporary Pod using the image busybox, shell into it and run a wget command against the nginx Pod using port 80.</span></span><br><span class="line"><span class="comment"># 用#7 里面得到的IP</span></span><br><span class="line">$ kubectl run busybox --image=busybox --rm -it --restart=Never -n ckad-prep -- /bin/sh</span><br><span class="line">/ <span class="comment"># wget -O- 192.168.0.6:80</span></span><br><span class="line">Connecting to 192.168.0.6:80 (192.168.0.6:80)</span><br><span class="line">writing to stdout</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">        width: 35em;</span><br><span class="line">        margin: 0 auto;</span><br><span class="line">        font-family: Tahoma, Verdana, Arial, sans-serif;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;If you see this page, the nginx web server is successfully installed and</span><br><span class="line">working. Further configuration is required.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;For online documentation and support please refer to</span><br><span class="line">&lt;a href=<span class="string">"http://nginx.org/"</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span><br><span class="line">Commercial support is available at</span><br><span class="line">&lt;a href=<span class="string">"http://nginx.com/"</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;&lt;em&gt;Thank you <span class="keyword">for</span> using nginx.&lt;/em&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">-                    100% |***************************************************************************************************|   612  0:00:00 ETA</span><br><span class="line">written to stdout</span><br><span class="line">/ <span class="comment"># exit</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 9. Render the logs of Pod mypod.</span></span><br><span class="line">$ kubectl logs pods/mypod -n ckad-prep</span><br><span class="line">192.168.0.7 - - [25/Dec/2022:10:47:23 +0000] <span class="string">"GET / HTTP/1.1"</span> 200 612 <span class="string">"-"</span> <span class="string">"Wget"</span> <span class="string">"-"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 10. Delete the Pod and the namespace.</span></span><br><span class="line">$ kubectl delete pods/mypod -n ckad-prep</span><br><span class="line">pod <span class="string">"mypod"</span> deleted</span><br><span class="line"></span><br><span class="line">$ kubectl delete ns ckad-prep</span><br><span class="line">namespace <span class="string">"ckad-prep"</span> deleted</span><br></pre></td></tr></table></figure>
<h3 id="2021考题2-configuring-a-pod-to-use-a-configmap">2021考题2 - Configuring a Pod to Use a ConfigMap</h3>
<ol>
<li>Create a new file named <code>config.txt</code> with the following environment variables as key/value pairs on each line.
<ul>
<li><code>DB_URL</code> equates to <code>localhost:3306</code></li>
<li><code>DB_USERNAME</code> equates to <code>postgres</code></li>
</ul>
</li>
<li>Create a new ConfigMap named <code>db-config</code> from that file.</li>
<li>Create a Pod named <code>backend</code> that uses the environment variables from the ConfigMap and runs the container with the image <code>nginx</code>.</li>
<li>Shell into the Pod and print out the created environment variables. You should find <code>DB_URL</code> and <code>DB_USERNAME</code> with their appropriate values.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Create a new file named `config.txt`</span></span><br><span class="line">$ <span class="built_in">echo</span> -e <span class="string">"DB_URL=localhost:3306\nDB_USERNAME=postgres"</span> &gt; config.txt</span><br><span class="line">或者</span><br><span class="line">$ vim config.txt</span><br><span class="line">DB_URL=localhost:3306</span><br><span class="line">DB_USERNAME=postgres</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. Create a new ConfigMap `db-config`</span></span><br><span class="line">$ kubectl create configmap db-config --from-file config.txt</span><br><span class="line">configmap/db-config created</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. Create a Pod `backend`</span></span><br><span class="line">$ kubectl run backend --image nginx --dry-run=client -o yaml &gt; 1.yaml</span><br><span class="line">$ vim 1.yaml</span><br></pre></td></tr></table></figure>
<p>参考官网<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/#configure-all-key-value-pairs-in-a-configmap-as-container-environment-variables" target="_blank" rel="noopener">config</a></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">backend</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">    <span class="attr">envFrom:</span>         <span class="comment"># Add</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">configMapRef:</span>  <span class="comment"># Add</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">db-config</span>  <span class="comment"># Modify to configmap name: db-config</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl apply -f 1.yaml </span><br><span class="line">pod/backend created</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4. Shell into the Pod and print out the created environment variables. You should find `DB_URL` and `DB_USERNAME` with their appropriate values.</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> backend -it -- /bin/sh</span><br><span class="line">/ <span class="comment"># env</span></span><br><span class="line">config.txt=DB_URL=localhost:3306</span><br><span class="line">DB_USERNAME=postgres</span><br><span class="line">...</span><br><span class="line">/ <span class="comment"># exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> backend -- env | grep DB</span><br><span class="line">config.txt=DB_URL=localhost:3306</span><br><span class="line">DB_USERNAME=postgres</span><br></pre></td></tr></table></figure>
<h3 id="2021考题3-configuring-a-pod-to-use-a-secret">2021考题3 - Configuring a Pod to Use a Secret</h3>
<ol>
<li>Create a new Secret named <code>db-credentials</code> with the key/value pair <code>db-password=passwd</code>.</li>
<li>Create a Pod named <code>backend</code> that defines uses the Secret as environment variable named <code>DB_PASSWORD</code> and runs the container with the image <code>nginx</code>.</li>
<li>Shell into the Pod and print out the created environment variables. You should find <code>DB_PASSWORD</code> variable.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.</span></span><br><span class="line">$ kubectl create secret generic db-credentials --from-literal=db-password=passwd</span><br><span class="line">secret/db-credentials created</span><br><span class="line">$ kubectl get secrets</span><br><span class="line">NAME              TYPE      DATA   AGE</span><br><span class="line">db-credentials    Opaque    1      26s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. </span></span><br><span class="line">$ kubectl run backend --image=nginx --restart=Never -o yaml --dry-run &gt; pod.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">backend</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">env:</span>                          <span class="comment"># Add</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_PASSWORD</span>         <span class="comment"># modify to DB_PASSWORD</span></span><br><span class="line">        <span class="attr">valueFrom:</span>                <span class="comment"># Add</span></span><br><span class="line">          <span class="attr">secretKeyRef:</span>           <span class="comment"># Add</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">db-credentials</span>  <span class="comment"># secret name</span></span><br><span class="line">            <span class="attr">key:</span> <span class="string">db-password</span>      <span class="comment"># secret key</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2.2</span></span><br><span class="line">$ kubectl create -f pod.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> -it backend -- /bin/sh</span><br><span class="line">/ <span class="comment"># env</span></span><br><span class="line">DB_PASSWORD=passwd</span><br><span class="line">/ <span class="comment"># exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> backend -- env</span><br></pre></td></tr></table></figure>
<h3 id="考题4-creating-a-security-context-for-a-pod">考题4 - Creating a Security Context for a Pod</h3>
<h4 id="2021考题4">2021考题4</h4>
<ol>
<li>Create a Pod named <code>secured</code> that uses the image <code>nginx</code> for a single container. Mount an <code>emptyDir</code> volume to the directory <code>/data/app</code>.</li>
<li>Files created on the volume should use the filesystem group ID <code>3000</code>.</li>
<li>Get a shell to the running container and create a new file named <code>logs.txt</code> in the directory <code>/data/app</code>. List the contents of the directory and write them down.</li>
</ol>
<p>参考官网：<a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod" target="_blank" rel="noopener">Configure a Security Context for a Pod or Container</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.1 Create a Pod named `secured`</span></span><br><span class="line">$ kubectl run secured --image=nginx -o yaml --dry-run &gt; secured.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># secured.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">secured</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">secured</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">securityContext:</span>        <span class="comment"># Add</span></span><br><span class="line">    <span class="attr">fsGroup:</span> <span class="number">3000</span>         <span class="comment"># Add 2 filesystem group ID `3000`</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">secured</span></span><br><span class="line">    <span class="attr">volumeMounts:</span>                   <span class="comment"># Add 1.3 mount emptyDir</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">data-vol</span>                <span class="comment"># Add 1.3 mount emptyDir</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">/data/app</span>          <span class="comment"># Add 1.3 mount emptyDir</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">volumes:</span>                  <span class="comment"># Add 1.2 emptyDir</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">data-vol</span>          <span class="comment"># Add 1.2 emptyDir</span></span><br><span class="line">    <span class="attr">emptyDir:</span> <span class="string">&#123;&#125;</span>            <span class="comment"># Add 1.2 emptyDir</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. Create a Pod named `secured`</span></span><br><span class="line">$ kubectl create -f secured.yaml</span><br><span class="line">pod/secured created</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 </span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> -it secured -- sh</span><br><span class="line">/ <span class="comment"># cd /data/app</span></span><br><span class="line">/ <span class="comment"># touch logs.txt</span></span><br><span class="line">/ <span class="comment"># ls -l</span></span><br><span class="line">-rw-r--r-- 1 root 3000 0 Mar 11 15:56 logs.txt</span><br><span class="line">/ <span class="comment"># exit</span></span><br></pre></td></tr></table></figure>
<h4 id="2022-考题4-security-context">2022 考题4 Security Context</h4>
<blockquote>
<p>只记住了大概</p>
</blockquote>
<p>deployment 或者pod</p>
<ul>
<li>user ID <code>10000</code></li>
<li>Privilege escalation forbidden</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">security-context-demo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">securityContext:</span></span><br><span class="line">    <span class="attr">runAsUser:</span> <span class="number">10000</span>          <span class="comment">#  user ID `10000`</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sec-ctx-vol</span></span><br><span class="line">    <span class="attr">emptyDir:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sec-ctx-demo</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox:1.28</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">[</span> <span class="string">"sh"</span><span class="string">,</span> <span class="string">"-c"</span><span class="string">,</span> <span class="string">"sleep 1h"</span> <span class="string">]</span></span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sec-ctx-vol</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">/data/demo</span></span><br><span class="line">    <span class="attr">securityContext:</span></span><br><span class="line">      <span class="attr">allowPrivilegeEscalation:</span> <span class="literal">false</span>  <span class="comment"># Privilege escalation forbidden</span></span><br></pre></td></tr></table></figure>
<h3 id="考题5-defining-a-pod-s-resource-requirements">考题5 - Defining a Pod’s Resource Requirements</h3>
<h4 id="2021-考题5-resourcequota">2021 考题5 ResourceQuota</h4>
<ol>
<li>Create a resource quota named <code>apps</code> under the namespace <code>rq-demo</code> using the following YAML definition in the file <code>rq.yaml</code>.</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ResourceQuota</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">app</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">hard:</span></span><br><span class="line">    <span class="attr">pods:</span> <span class="string">"2"</span></span><br><span class="line">    <span class="attr">requests.cpu:</span> <span class="string">"2"</span></span><br><span class="line">    <span class="attr">requests.memory:</span> <span class="string">500m</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Create a new Pod that exceeds the limits of the resource quota requirements. Write down the error message.</li>
<li>Change the request limits to fulfill the requirements to ensure that the Pod could be created successfully. Write down the output of the command that renders the used amount of resources for the namespace.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.</span></span><br><span class="line">$ kubectl create namespace rq-demo</span><br><span class="line">$ vim rq.yaml</span><br><span class="line"></span><br><span class="line">metadata:</span><br><span class="line">  name: apps</span><br><span class="line"></span><br><span class="line">$ kubectl create -f rq.yaml --namespace=rq-demo</span><br><span class="line">resourcequota/app created</span><br><span class="line"></span><br><span class="line">$ kubectl get resourcequota/apps -n rq-demo</span><br><span class="line">NAME   AGE     REQUEST                                                 LIMIT</span><br><span class="line">apps   4m43s   pods: 0/2, requests.cpu: 0/2, requests.memory: 0/500m</span><br><span class="line"></span><br><span class="line">$ kubectl describe quota --namespace=rq-demo</span><br><span class="line">Name:            app</span><br><span class="line">Namespace:       rq-demo</span><br><span class="line">Resource         Used  Hard</span><br><span class="line">--------         ----  ----</span><br><span class="line">pods             0     2</span><br><span class="line">requests.cpu     0     2</span><br><span class="line">requests.memory  0     500m</span><br></pre></td></tr></table></figure>
<p>参考官网：<a href="https://kubernetes.io/docs/concepts/policy/resource-quotas/" target="_blank" rel="noopener">resource-quotas</a></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">mypod</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mypod</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mypod</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">requests:</span></span><br><span class="line">        <span class="attr">memory:</span> <span class="string">"1G"</span></span><br><span class="line">        <span class="attr">cpu:</span> <span class="string">"400m"</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. 注意即使yaml文件里面加了metadata.namespace, 创建的命令仍然要加`-n`或者`--namespace`，否则新建的pod不在这个namespace上</span></span><br><span class="line">$ kubectl create -f pod.yaml -n rq-demo</span><br><span class="line">Error from server (Forbidden): error when creating <span class="string">"pod.yaml"</span>: pods <span class="string">"mypod"</span> is forbidden: exceeded quota: app, requested: requests.memory=1G, used: requests.memory=0, limited: requests.memory=500m</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Lower the memory settings to less than 500m (e.g. 200m) and create the Pod.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl create -f pod.yaml --namespace=rq-demo</span><br><span class="line">pod/mypod created</span><br><span class="line">$ kubectl describe quota --namespace=rq-demo</span><br><span class="line">Name:            app</span><br><span class="line">Namespace:       rq-demo</span><br><span class="line">Resource         Used  Hard</span><br><span class="line">--------         ----  ----</span><br><span class="line">pods             1     2</span><br><span class="line">requests.cpu     400m  2</span><br><span class="line">requests.memory  200m  500m</span><br></pre></td></tr></table></figure>
<h4 id="2022-考题5-limitrange">2022 考题5 LimitRange</h4>
<blockquote>
<p>只记住了大概</p>
</blockquote>
<p>有一个deployment，路径 <code>~/path/5.yaml</code>, namespace <code>namespace1</code> 因为resource不足，无法成功启动。<br>
修改deployment：</p>
<ul>
<li>memory request “300Mi”</li>
<li>memory limit 是所在namespace的一半</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 尝试get resourcequota, 但没得到东西</span></span><br><span class="line"><span class="comment"># k get resourcequota -n namespace1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试get resourcequota, 但没得到东西</span></span><br><span class="line">k get limitranges -n namespace1</span><br><span class="line">NAMESPACE   NAME              CREATED AT</span><br><span class="line">default     mem-limit-range </span><br><span class="line"></span><br><span class="line">k k describe limitrange -n namespace1</span><br><span class="line">Type        Resource  Min  Max  Default Request  Default Limit  Max Limit/Request Ratio</span><br><span class="line">----        --------  ---  ---  ---------------  -------------  -----------------------</span><br><span class="line">Container   memory    -    898Mi 256Mi            512Mi          -</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pod 或者deployment</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">example-no-conflict-with-limitrange-cpu</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">demo</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.k8s.io/pause:2.0</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">requests:</span></span><br><span class="line">        <span class="attr">memory:</span> <span class="string">"300Mi"</span>              <span class="comment"># Add</span></span><br><span class="line">      <span class="attr">limits:</span></span><br><span class="line">        <span class="attr">memory:</span> <span class="string">"449Mi"</span>              <span class="comment"># Add 898Mi 的一半</span></span><br></pre></td></tr></table></figure>
<h3 id="考题6-using-a-service-account">考题6 - Using a Service Account</h3>
<ol>
<li>Create a new service account named <code>backend-team</code>.</li>
<li>Print out the token for the service account in YAML format.</li>
<li>Create a Pod named <code>backend</code> that uses the image <code>nginx</code> and the identity <code>backend-team</code> for running processes.</li>
<li>Get a shell to the running container and print out the token of the service account.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Create a new service account</span></span><br><span class="line">$ kubectl create serviceaccount backend-team</span><br><span class="line">serviceaccount/backend-team created</span><br><span class="line"></span><br><span class="line"><span class="comment">## 参考https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-a-long-lived-api-token-for-a-serviceaccount</span></span><br><span class="line"><span class="comment"># 加annotation</span></span><br><span class="line">  annotations:</span><br><span class="line">    kubernetes.io/service-account.name: backend-team</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.</span></span><br><span class="line">$ kubectl get serviceaccount backend-team -o yaml --<span class="built_in">export</span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  creationTimestamp: 2019-05-09T22:43:54Z</span><br><span class="line">  name: backend-team</span><br><span class="line">  namespace: default</span><br><span class="line">  resourceVersion: <span class="string">"1888067"</span></span><br><span class="line">  selfLink: /api/v1/namespaces/default/serviceaccounts/backend-team</span><br><span class="line">  uid: ecd3b7ea-72ab-11e9-96c5-025000000001</span><br><span class="line">secrets:</span><br><span class="line">- name: backend-team-token-hskch</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2.2 拿到对应的secret的encoded token</span></span><br><span class="line">$ kubectl get secret backend-team-token-hskch -o yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">data:</span><br><span class="line">...</span><br><span class="line">  token:</span><br><span class="line">ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNkltNWFaRmRxWkRKMmFHTnZRM0JxV0haT1IxZzFiM3BJY201SlowaEhOV3hUWmt3elFuRmFhVEZhZDJNaWZ</span><br><span class="line">RLmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOX</span><br><span class="line">VZVzFsYzNCaFkyVWlPaUp1WlhCMGRXNWxJaXdpYTNWaVpYSnVaWFJsY3k1cGJ5OXpaWEoyYVdObFlXTmpiM1Z1ZEM5elpXTnlaWFF1Ym1GdFpTSTZJbTVsY</span><br><span class="line">0hSMWJtVXRjMkV0ZGpJdGRHOXJaVzR0Wm5FNU1tb2lMQ0pyZFdKbGNtNWxkR1Z6TG1sdkwzTmxjblpwWTJWaFkyTnZkVzUwTDNObGNuWnBZMlV0WVdOamIz</span><br><span class="line">VnVkQzV1WVcxbElqb2libVZ3ZEhWdVpTMXpZUzEyTWlJc0ltdDFZbVZ5Ym1WMFpYTXVhVzh2YzJWeWRtbGpaV0ZqWTI5MWJuUXZjMlZ5ZG1salpTMWhZMk5</span><br><span class="line">2ZFc1MExuVnBaQ0k2SWpZMlltUmpOak0yTFRKbFl6TXROREpoWkMwNE9HRTFMV0ZoWXpGbFpqWmxPVFpsTlNJc0luTjFZaUk2SW5ONWMzUmxiVHB6WlhKMm</span><br><span class="line">FXTmxZV05qYjNWdWREcHVaWEIwZFc1bE9tNWxjSFIxYm1VdGMyRXRkaklpZlEuVllnYm9NNENUZDBwZENKNzh3alV3bXRhbGgtMnZzS2pBTnlQc2gtNmd1R</span><br><span class="line">XdPdFdFcTVGYnc1WkhQdHZBZHJMbFB6cE9IRWJBZTRlVU05NUJSR1diWUlkd2p1Tjk1SjBENFJORmtWVXQ0OHR3b2FrUlY3aC1hUHV3c1FYSGhaWnp5NHlp</span><br><span class="line">bUZIRzlVZm1zazVZcjRSVmNHNm4xMzd5LUZIMDhLOHpaaklQQXNLRHFOQlF0eGctbFp2d1ZNaTZ2aUlocnJ6QVFzME1CT1Y4Mk9KWUd5Mm8tV1FWYzBVVWF</span><br><span class="line">uQ2Y5NFkzZ1QwWVRpcVF2Y3pZTXM2bno5dXQtWGd3aXRyQlk2VGo5QmdQcHJBOWtfajVxRXhfTFVVWlVwUEFpRU43T3pka0pzSThjdHRoMTBseXBJMUFlRn</span><br><span class="line">I0M3Q2QUx5clFvQk0zOWFiRGZxM0Zrc1Itb2NfV013</span><br><span class="line">kind: Secret</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.3 拿到对应的secret的decoded token</span></span><br><span class="line">$ kubectl describe secret backend-team-token-hskch -o yaml</span><br><span class="line">...</span><br><span class="line">Data</span><br><span class="line">====</span><br><span class="line">token:</span><br><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6Im5aZFdqZDJ2aGNvQ3BqWHZOR1g1b3pIcm5JZ0hHNWxTZkwzQnFaaTFad2MifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3Nl</span><br><span class="line">cnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJuZXB0dW5lIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWN</span><br><span class="line">jb3VudC9zZWNyZXQubmFtZSI6Im5lcHR1bmUtc2EtdjItdG9rZW4tZnE5MmoiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3</span><br><span class="line">VudC5uYW1lIjoibmVwdHVuZS1zYS12MiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjY2YmRjNjM2LTJlY</span><br><span class="line">zMtNDJhZC04OGE1LWFhYzFlZjZlOTZlNSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpuZXB0dW5lOm5lcHR1bmUtc2EtdjIifQ.VYgboM4CTd0pd</span><br><span class="line">CJ78wjUwmtalh-2vsKjANyPsh-6guEwOtWEq5Fbw5ZHPtvAdrLlPzpOHEbAe4eUM95BRGWbYIdwjuN95J0D4RNFkVUt48twoakRV7h-</span><br><span class="line">aPuwsQXHhZZzy4yimFHG9Ufmsk5Yr4RVcG6n137y-FH08K8zZjIPAsKDqNBQtxg-lZvwVMi6viIhrrzAQs0MBOV82OJYGy2o-</span><br><span class="line">WQVc0UUanCf94Y3gT0YTiqQvczYMs6nz9ut-</span><br><span class="line">XgwitrBY6Tj9BgPprA9k_j5qEx_LUUZUpPAiEN7OzdkJsI8ctth10lypI1AeFr43t6ALyrQoBM39abDfq3FksR-oc_WMw</span><br><span class="line">ca.crt:     1066 bytes</span><br><span class="line">namespace:  7 bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.1 Create a Pod named `backend`</span></span><br><span class="line">$ kubectl run backend --image=nginx --dry-run=client -o yaml &gt; 6.yaml</span><br><span class="line">$ vim 6.yaml</span><br></pre></td></tr></table></figure>
<p>参考官方文档<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#launch-a-pod-using-service-account-token-projection" target="_blank" rel="noopener">Configure Service Accounts for Pods</a></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 6.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">backend</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">serviceAccountName:</span> <span class="string">backend-team</span>  <span class="comment"># Add</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3.2</span></span><br><span class="line">$ k apply -f 6.yaml </span><br><span class="line">pod/backend created</span><br><span class="line">$ k get pod/backend -o wide</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. print out the token from the volume source at /var/run/secrets/kubernetes.io/serviceaccount</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> -it backend -- /bin/sh</span><br><span class="line">/ <span class="comment"># cat /var/run/secrets/kubernetes.io/serviceaccount/token</span></span><br><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImJhY2tlbmQtdGVhbS10b2tlbi1kbTJmZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJiYWNrZW5kLXRlYW0iLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIxNzM0MzVjMS00NDJmLTExZTktOGRjMy0wMjUwMDAwMDAwMDEiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDpiYWNrZW5kLXRlYW0ifQ.DjWUxEMNUmQVoXd4b-eIjxboj3w3k7hS5hfV8mm8eoEPz3HJJMgjIpAaurcvo1pp2Ggpd1kIhQvfRqI6-u57f80N5UqXt_qATJfonat2NNXX8pXmFNoPig9LB-pbo8TN_pYGWNworXsxmK9w6V9eaRosIinRp0u-cvijQbsBw3lxWgGo9S4G-7f19mMKN1Pg2xS2J6fKX9IKvhHrUkM91nwcwmsO0use5B4TGbuRa9METiGsfEpegvzMPBbPl0B_T1ANH_pck0LFNtvKe0g1v5zpKx2lRF9WdFAqPsG7BJ1dEH88JtBHzD59OhxIPqtyT4sXKjACBN_ka5ZADMzPJg</span><br></pre></td></tr></table></figure>
<h3 id="考题7-implementing-the-adapter-pattern">考题7 - Implementing the Adapter Pattern</h3>
<p>The adapter pattern helps with providing a simplified, homogenized view of an application running within a container. For example, we could stand up another container that unifies the log output of the application container. As a result, other monitoring tools can rely on a standardized view of the log output without having to transform it into an expected format.</p>
<ol>
<li>Create a new Pod in a YAML file named <code>adapter.yaml</code>. The Pod declares two containers.
<ul>
<li>The container <code>app</code> uses the image <code>busybox</code> and runs the command <code>while true; do echo &quot;$(date) | $(du -sh ~)&quot; &gt;&gt; /var/logs/diskspace.txt; sleep 5; done;</code>.</li>
<li>The adapter container <code>transformer</code> uses the image <code>busybox</code> and runs the command <code>sleep 20; while true; do while read LINE; do echo &quot;$LINE&quot; | cut -f2 -d&quot;|&quot; &gt;&gt; $(date +%Y-%m-%d-%H-%M-%S)-transformed.txt; done &lt; /var/logs/diskspace.txt; sleep 20; done;</code> to strip the log output off the date for later consumption my a monitoring tool. Be aware that the logic does not handle corner cases (e.g. automatically deleting old entries) and would look different in production systems</li>
</ul>
</li>
<li>Before creating the Pod, define an <code>emptyDir</code> volume. Mount the volume in both containers with the path <code>/var/logs</code>.</li>
<li>Create the Pod, log into the container <code>transformer</code>. The current directory should continuously write a new file every 20 seconds.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.1</span></span><br><span class="line">kubectl run adapter --image=busybox --restart=Never -o yaml --dry-run -- /bin/sh -c <span class="string">'while true; do echo "$(date) | $(du -sh ~)" &gt;&gt; /var/logs/diskspace.txt; sleep 5; done;'</span> &gt; adapter.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.2 adapter.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">adapter</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">volumes:</span>                <span class="comment"># 2.1 `emptyDir` volume</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-volume</span> <span class="comment"># 2.1 `emptyDir` volume</span></span><br><span class="line">      <span class="attr">emptyDir:</span> <span class="string">&#123;&#125;</span>        <span class="comment"># 2.1 `emptyDir` volume</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">args:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/bin/sh</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">'while true; do echo "$(date) | $(du -sh ~)" &gt;&gt; /var/logs/diskspace.txt; sleep 5; done;'</span> <span class="comment"># 注意用单引号，因为命令里面有双引号</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">app</span>           <span class="comment"># 1.1 modify name to app</span></span><br><span class="line">    <span class="attr">volumeMounts:</span>            <span class="comment"># 2.2 Add</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-volume</span>  <span class="comment"># 2.2 Add</span></span><br><span class="line">        <span class="attr">mountPath:</span> <span class="string">/var/logs</span> <span class="comment"># 2.2 Add</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">busybox</span>       <span class="comment"># 1.2 Add</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">transformer</span>    <span class="comment"># 1.2 Add</span></span><br><span class="line">    <span class="attr">args:</span>                <span class="comment"># 1.2 Add</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/bin/sh</span>            <span class="comment"># 1.2 Add</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">-c</span>                 <span class="comment"># 1.2 Add</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">'sleep 20; while true; do while read LINE; do echo "$LINE" | cut -f2 -d"|" &gt;&gt; $(date +%Y-%m-%d-%H-%M-%S)-transformed.txt; done &lt; /var/logs/diskspace.txt; sleep 20; done;'</span>             <span class="comment"># 1.2 Add 注意用单引号，因为命令里面有双引号</span></span><br><span class="line">    <span class="attr">volumeMounts:</span>             <span class="comment"># 2.2 Add</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-volume</span>   <span class="comment"># 2.2 Add</span></span><br><span class="line">        <span class="attr">mountPath:</span> <span class="string">/var/logs</span>  <span class="comment"># 2.2 Add</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> adapter --container=transformer -it -- /bin/sh</span><br><span class="line">/ <span class="comment"># ls -l</span></span><br><span class="line">-rw-r--r--    1 root     root           205 May 12 20:43 2019-05-12-20-43-32-transformed.txt</span><br><span class="line">-rw-r--r--    1 root     root           369 May 12 20:43 2019-05-12-20-43-52-transformed.txt</span><br><span class="line">...</span><br><span class="line">/ <span class="comment"># cat 2019-05-12-20-43-52-transformed.txt</span></span><br><span class="line"> 4.0K	/root</span><br><span class="line"> 4.0K	/root</span><br><span class="line"> 4.0K	/root</span><br><span class="line"> 4.0K	/root</span><br><span class="line">/ <span class="comment"># exit</span></span><br></pre></td></tr></table></figure>
<h3 id="考题8-defining-a-pod-s-readiness-and-liveness-probe">考题8 - Defining a Pod’s Readiness and Liveness Probe</h3>
<ol>
<li>Create a new Pod named <code>hello</code> with the image <code>bonomat/nodejs-hello-world</code> that exposes the port <code>3000</code>. Provide the name <code>nodejs-port</code> for the container port.</li>
<li>Add a Readiness Probe that checks the URL path <code>/</code> on the port referenced with the name <code>nodejs-port</code> after a <code>2</code> seconds delay. You do not have to define the period interval.</li>
<li>Add a Liveness Probe that verifies that the app is up and running every <code>8</code> seconds by checking the URL path <code>/</code> on the port referenced with the name <code>nodejs-port</code>. The probe should start with a <code>5</code> seconds delay.</li>
<li>Shell into container and <code>curl localhost:3000</code>. Write down the output. Exit the container. Retrieve the logs from the container. Write down the output.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Create a new Pod named `hello`</span></span><br><span class="line">$ kubectl run hello --image=bonomat/nodejs-hello-world --port=3000 -o yaml --dry-run &gt; pod.yaml</span><br><span class="line">$ vim pod.yaml</span><br></pre></td></tr></table></figure>
<p>参考官网： <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#use-a-named-port" target="_blank" rel="noopener">livenessProbe</a></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.2 pod.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">hello</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">hello</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">bonomat/nodejs-hello-world</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">hello</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nodejs-port</span>           <span class="comment"># Add 1.2 Provide the name `nodejs-port` for the container port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">3000</span></span><br><span class="line">    <span class="attr">readinessProbe:</span>               <span class="comment"># Add 2 Readiness</span></span><br><span class="line">      <span class="attr">httpGet:</span>                    <span class="comment"># Add 2 Readiness</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/</span>                   <span class="comment"># Add 2 Readiness</span></span><br><span class="line">        <span class="attr">port:</span> <span class="string">nodejs-port</span>         <span class="comment"># Add 2 Readiness</span></span><br><span class="line">      <span class="attr">initialDelaySeconds:</span> <span class="number">2</span>       <span class="comment"># Add 2 Readiness</span></span><br><span class="line">    <span class="attr">livenessProbe:</span>            <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">      <span class="attr">httpGet:</span>                <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/</span>               <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">        <span class="attr">port:</span> <span class="string">nodejs-port</span>     <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">      <span class="attr">initialDelaySeconds:</span> <span class="number">5</span>  <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">      <span class="attr">periodSeconds:</span> <span class="number">8</span>        <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl create -f pod.yaml</span><br><span class="line">pod/hello created</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. </span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> hello -it -- /bin/sh</span><br><span class="line">/ <span class="comment"># curl localhost:3000</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;NodeJS Docker Hello World&lt;/title&gt;</span><br><span class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">	&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span><br><span class="line">	&lt;link href=<span class="string">"http://cdn.bootcss.com/bootstrap/3.3.2/css/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">	&lt;link href=<span class="string">"/stylesheets/styles.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;div class=<span class="string">"container"</span>&gt;</span><br><span class="line">		&lt;div class=<span class="string">"well well-sm"</span>&gt;</span><br><span class="line">			&lt;h2&gt;This is just a hello world message&lt;/h2&gt;</span><br><span class="line">			&lt;img a href=<span class="string">"./cage.jpg"</span>/&gt;</span><br><span class="line">			&lt;img src=<span class="string">"src/cage.jpg"</span> alt=<span class="string">"Smiley face"</span> width=<span class="string">"640"</span>&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">/ <span class="comment"># exit</span></span><br><span class="line"> </span><br><span class="line">$ kubectl logs pod/hello</span><br><span class="line">Magic happens on port 3000</span><br></pre></td></tr></table></figure>
<h4 id="2022-readiness-probe">2022 readiness probe</h4>
<h3 id="考题9-fixing-a-misconfigured-pod">考题9 - Fixing a Misconfigured Pod</h3>
<ol>
<li>Create a new Pod with the following YAML.</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">failing-pod</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">failing-pod</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">args:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/bin/sh</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">while</span> <span class="literal">true</span><span class="string">;</span> <span class="string">do</span> <span class="string">echo</span> <span class="string">$(date)</span> <span class="string">&gt;&gt;</span> <span class="string">~/tmp/curr-date.txt;</span> <span class="string">sleep</span> <span class="number">5</span><span class="string">;</span> <span class="string">done;</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">failing-pod</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Check the Pod’s status. Do you see any issue?</li>
<li>Follow the logs of the running container and identify an issue.</li>
<li>Fix the issue by shelling into the container. After resolving the issue the current date should be written to a file. Render the output.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 Create a new Pod</span></span><br><span class="line">$ vim pod.yaml</span><br><span class="line">$ kubectl create -f pod.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. Check the Pod’s status</span></span><br><span class="line"><span class="comment"># seems to be running without problems.</span></span><br><span class="line">$ kubectl get pods</span><br><span class="line">NAME          READY   STATUS    RESTARTS   AGE</span><br><span class="line">failing-pod   1/1     Running   0          5s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line">$ kubectl logs failing-pod</span><br><span class="line">/bin/sh: can<span class="string">'t create /root/tmp/curr-date.txt: nonexistent directory</span></span><br><span class="line"><span class="string">/bin/sh: can'</span>t create /root/tmp/curr-date.txt: nonexistent directory</span><br><span class="line">/bin/sh: can<span class="string">'t create /root/tmp/curr-date.txt: nonexistent directory</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4.</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> failing-pod -it -- /bin/sh</span><br><span class="line">/ <span class="comment"># mkdir -p /root/tmp</span></span><br><span class="line">/ <span class="comment"># cd /root</span></span><br><span class="line">~ <span class="comment"># ls -l</span></span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x    2 root     root          4096 Dec 26 04:47 tmp</span><br><span class="line">~ <span class="comment"># chmod 777 /root/tmp</span></span><br><span class="line">~ <span class="comment"># cd /root/tmp</span></span><br><span class="line">~/tmp <span class="comment"># ls -l</span></span><br><span class="line">total 4</span><br><span class="line">-rw-r--r-- 1 root root 112 May  9 23:52 curr-date.txt</span><br><span class="line">/ <span class="comment"># cat ~/tmp/curr-date.txt</span></span><br><span class="line">Thu May 9 23:59:01 UTC 2019</span><br><span class="line">Thu May 9 23:59:06 UTC 2019</span><br><span class="line">Thu May 9 23:59:11 UTC 2019</span><br><span class="line">/ <span class="comment"># exit</span></span><br></pre></td></tr></table></figure>
<h3 id="考题10-2022-rollout-canary">考题10 - 2022 Rollout Canary</h3>
<p>Application “wonderful” is running in <code>default</code> Namespace.<br>
You can call the app using <code>curl wonderful:30080</code> .<br>
The application YAML is available at <code>/wonderful/init.yaml</code> .<br>
The app has a Deployment with image <code>httpd:alpine</code> , but should be switched over to <code>nginx:alpine</code> .</p>
<ol>
<li>The switch should not happen fast or automatically, but using the Canary approach:</li>
</ol>
<ul>
<li>20% of requests should hit the new image</li>
<li>80% of requests should hit the old image</li>
</ul>
<ol start="2">
<li>
<p>For this create a new Deployment <code>wonderful-v2</code> which uses image <code>nginx:alpine</code> .</p>
</li>
<li>
<p>The total amount of Pods of both Deployments combined should be <code>10</code>.</p>
</li>
</ol>
<p>参考官方文档<a href="https://kubernetes.io/docs/concepts/cluster-administration/manage-deployment/#canary-deployments" target="_blank" rel="noopener">canary-deployments</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ k get deployments.apps</span><br><span class="line">NAME           READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">wonderful-v1   10/10   10           10          27s</span><br><span class="line"></span><br><span class="line">$ k get deployments.apps wonderful-v1 -o yaml &gt; v2.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># v2.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wonderful-v2</span> <span class="comment"># name</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">2</span>        <span class="comment"># Modify to 2</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx:alpine</span>  <span class="comment"># Image</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ k apply -f v2.yaml </span><br><span class="line">$ k get deployments.apps </span><br><span class="line">NAME           READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">wonderful-v1   10/10   10           10          4m37s</span><br><span class="line">wonderful-v2   2/2     2            2           4s</span><br><span class="line"></span><br><span class="line">$ k edit deployments.apps wonderful-v1</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wonderful-v1</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">8</span>     <span class="comment"># Modify to 8</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">httpd:alpine</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">httpd</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ k get deployments.apps </span><br><span class="line">NAME           READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">wonderful-v1   8/8     8            8           5m38s</span><br><span class="line">wonderful-v2   2/2     2            2           65s</span><br></pre></td></tr></table></figure>
<h3 id="考题11-2022-helm-nanagement">考题11 - 2022 Helm Nanagement</h3>
<h3 id="考题12-2022-networkpolicy">考题12 - 2022 NetworkPolicy</h3>
<p>记不太清了。。。<br>
修改pod <code>pod1</code>，使得only to and from pod <code>frondend</code> and <code>db</code><br>
networkpolicy已经建好，不要增加，新建或者修改</p>
<p>这样的话，应该只需要根据已有networkpolicy，修改<code>pod1</code>的labels就可以了。</p>
<p>有个类似的题：</p>
<h4 id="restricting-access-to-and-from-a-pod">Restricting Access to and from a Pod</h4>
<p>Let’s assume we are working on an application stack that defines three different layers: a <code>frontend</code>, a <code>backend</code> and a <code>database</code>. Each of the layers runs in a Pod. You can find the definition in the YAML file <code>app-stack.yaml</code>. The application needs to run in the namespace <code>app-stack</code>.</p>
<p>Task:</p>
<ol>
<li>Create the required namespace.</li>
<li>Copy the Pod definition to the file <code>app-stack.yaml</code> and create all three Pods. Notice that the namespace has already been defined in the YAML definition.</li>
<li>Create a network policy in the YAML file <code>app-stack-network-policy.yaml</code>.</li>
<li>The network policy should allow incoming traffic from the <code>backend</code> to the <code>database</code> but disallow incoming traffic from the <code>frontend</code>.</li>
<li>Incoming traffic to the <code>database</code> should only be allowed on <code>TCP</code> port <code>3306</code> and no other port.</li>
</ol>
<details>
  <summary>3个 pod yaml文件</summary>
  <p>
<pre><code><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">frontend</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">app-stack</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">frontend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">frontend</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">app-stack</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">backend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">database</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">app-stack</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">database</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">database</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">mysql</span></span><br><span class="line">      <span class="attr">env:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_ROOT_PASSWORD</span></span><br><span class="line">        <span class="attr">value:</span> <span class="string">example</span></span><br></pre></td></tr></table></figure>
</code></pre>
  </p>
</details>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 Create the namespace</span></span><br><span class="line">$ kubectl create namespace app-stack</span><br><span class="line">namespace/app-stack created</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. create all three Pods</span></span><br><span class="line">$ vim app-stack.yaml</span><br><span class="line">$ kubectl create -f app-stack.yaml</span><br><span class="line">pod/frontend created</span><br><span class="line">pod/backend created</span><br><span class="line">pod/database created</span><br><span class="line"></span><br><span class="line">$ kubectl get pods --namespace app-stack</span><br><span class="line">NAME       READY   STATUS    RESTARTS   AGE</span><br><span class="line">backend    1/1     Running   0          22s</span><br><span class="line">database   1/1     Running   0          22s</span><br><span class="line">frontend   1/1     Running   0          22s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. Create the network policy.</span></span><br><span class="line">$ vim app-stack-network-policy.yaml</span><br><span class="line">$ kubectl create -f app-stack-network-policy.yaml</span><br><span class="line">$ kubectl get networkpolicy --namespace app-stack</span><br><span class="line">NAME                       POD-SELECTOR             AGE</span><br><span class="line">app-stack-network-policy   app=todo,tier=database   5s</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">NetworkPolicy</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">app-stack-network-policy</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">app-stack</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">podSelector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">  <span class="attr">policyTypes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Ingress</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Egress</span></span><br><span class="line">  <span class="attr">ingress:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">from:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">podSelector:</span></span><br><span class="line">        <span class="attr">matchLabels:</span></span><br><span class="line">          <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">          <span class="attr">tier:</span> <span class="string">backend</span></span><br><span class="line">  <span class="attr">egress:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">to:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">podSelector:</span></span><br><span class="line">        <span class="attr">matchLabels:</span></span><br><span class="line">          <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">          <span class="attr">tier:</span> <span class="string">database</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">3306</span></span><br></pre></td></tr></table></figure>
<h3 id="考题13-2022-docker">考题13 - 2022 Docker</h3>
<ol>
<li>通过Dckerfile 创建image with name <code>name1</code>, tag <code>tag1</code> (不要publish)</li>
<li>export container to ~/somepath/name.tar</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 创建image</span></span><br><span class="line"><span class="built_in">cd</span> ~/path2Dockerfile/Dckerfile</span><br><span class="line">podman build -t name1:tag1 .</span><br><span class="line">podman image less</span><br><span class="line"></span><br><span class="line"><span class="comment"># run container</span></span><br><span class="line">podman run -d name1:tag1</span><br><span class="line">podman ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># export container</span></span><br><span class="line">podman <span class="built_in">export</span> containerID &gt; ~/somepath/name.tar</span><br></pre></td></tr></table></figure>
<h3 id="考题14-2022-cronjobs">考题14 - 2022 <code>CronJobs</code></h3>
<ol>
<li>新建一个CronJobs ppi, 要求</li>
</ol>
<ul>
<li>每10分钟执行一次</li>
<li>completion 2</li>
<li>fail 4</li>
<li>delete after 9s</li>
<li>restartPolicy 为nerver</li>
</ul>
<p>Cronjob 里面的container信息已给出：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">pi</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">perl:5.34.0</span></span><br><span class="line"><span class="attr">command:</span> <span class="string">["perl",</span>  <span class="string">"-Mbignum=bpi"</span><span class="string">,</span> <span class="string">"-wle"</span><span class="string">,</span> <span class="string">"print bpi(2000)"</span><span class="string">]</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>新建一个Job xxx, 来执行CronJobs。。。</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">batch/v1</span> </span><br><span class="line"><span class="attr">kind:</span> <span class="string">CronJob</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">hello</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">schedule:</span> <span class="string">"*/10 * * * *"</span>          <span class="comment">#每10分钟执行一次， 记着前面加*/</span></span><br><span class="line">  <span class="attr">jobTemplate:</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">backoffLimit:</span> <span class="number">4</span>             <span class="comment"># fail 4， 注意不要加在spec下面，而是spec.jobTemplate.spec下</span></span><br><span class="line">      <span class="attr">completions:</span> <span class="number">2</span>              <span class="comment"># completion 2</span></span><br><span class="line">      <span class="attr">ttlSecondsAfterFinished:</span> <span class="number">9</span>  <span class="comment"># delete after 9s</span></span><br><span class="line">      <span class="attr">template:</span></span><br><span class="line">        <span class="attr">spec:</span></span><br><span class="line">          <span class="attr">containers:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pi</span>              <span class="comment"># 粘贴题目给出信息</span></span><br><span class="line">            <span class="attr">image:</span> <span class="string">perl:5.34.0</span>    <span class="comment"># 粘贴题目给出信息</span></span><br><span class="line">            <span class="attr">command:</span> <span class="string">["perl",</span>  <span class="string">"-Mbignum=bpi"</span><span class="string">,</span> <span class="string">"-wle"</span><span class="string">,</span> <span class="string">"print bpi(2000)"</span><span class="string">]</span> <span class="comment"># 粘贴题目给出信息</span></span><br><span class="line">          <span class="attr">restartPolicy:</span> <span class="string">Never</span>                                  <span class="comment"># restartPolicy 为nerver</span></span><br></pre></td></tr></table></figure>
<h3 id="考题15-2022-service-ingress">考题15 - 2022 service, ingress</h3>
<p>namespace <code>namespace1</code><br>
一个路径<code>~/path</code>下，有<code>service.yaml</code>, <code>ingress.yaml</code>和 <code>deployment.yaml</code>。<br>
现在无法访问 <code>curl http://xxxx/content-moment</code>，检查并修复问题。<br>
不要修改<code>deployment.yaml</code>，deployment没有问题</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/path</span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line">k get service -n namespace1</span><br><span class="line">content-moment-service</span><br><span class="line"></span><br><span class="line">vim ingress.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ingress.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">minimal-ingress</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">nginx.ingress.kubernetes.io/rewrite-target:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ingressClassName:</span> <span class="string">nginx</span>             <span class="comment"># 通过k get ingressclass -A 检查，发现没错，不需要改</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">      <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/app</span>                    <span class="comment"># 路径不对，改为/content-moment</span></span><br><span class="line">        <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">        <span class="attr">backend:</span></span><br><span class="line">          <span class="attr">service:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">content-moment-service-service</span> <span class="comment"># 改为content-moment-service</span></span><br><span class="line">            <span class="attr">port:</span></span><br><span class="line">              <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># service.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">my-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app.kubernetes.io/name:</span> <span class="string">MyApp</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">9376</span>        <span class="comment"># 通过查看 deployment.yaml 里面的 containerPort, 发现这里错误，改为containerPort对应的port</span></span><br></pre></td></tr></table></figure>
<h2 id="ckad-练习题">CKAD 练习题</h2>
<h3 id="练习题1-rollout-rolling">练习题1 - Rollout Rolling</h3>
<ol>
<li>Application “wonderful” is running in <code>default</code> Namespace.</li>
<li>You can call the app using <code>curl wonderful:30080</code> .</li>
<li>The app has a Deployment with image <code>httpd:alpine</code> , but should be switched over to <code>nginx:alpine</code> .</li>
<li>Set the <code>maxSurge</code> to <code>50%</code> and the <code>maxUnavailable</code> to <code>0%</code> . Then perform a rolling update.</li>
<li>Wait till the rolling update has succeeded.</li>
</ol>
<details>
  <summary>Explanation</summary>
  <p>
<pre><code>Why can you call `curl wonderful:30080` and it works?

There is a NodePort Service `wonderful` which listens on port `30080` . It has the Pods of Deployment of app &quot;wonderful&quot; as selector.

We can reach the NodePort Service via the K8s Node IP:

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 172.30.1.2:30080</span><br></pre></td></tr></table></figure>

And because of an entry in `/etc/hosts `we can call:

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 172.30.1.2:30080</span><br></pre></td></tr></table></figure>
</code></pre>
  </p>
</details>
<details><summary>Solution</summary>
<p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k edit deploy wonderful-v1</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">deployment.kubernetes.io/revision:</span> <span class="string">"2"</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="string">"2022-12-26T07:00:45Z"</span></span><br><span class="line">  <span class="attr">generation:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wonderful-v1</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">resourceVersion:</span> <span class="string">"2063"</span></span><br><span class="line">  <span class="attr">uid:</span> <span class="string">5cf0fc94-8bc5-47b2-bc71-2147880bf1ed</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">progressDeadlineSeconds:</span> <span class="number">600</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">revisionHistoryLimit:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">strategy:</span></span><br><span class="line">    <span class="attr">rollingUpdate:</span></span><br><span class="line">      <span class="attr">maxSurge:</span> <span class="number">50</span><span class="string">%</span>              <span class="comment"># Edit 4</span></span><br><span class="line">      <span class="attr">maxUnavailable:</span> <span class="number">0</span><span class="string">%</span>         <span class="comment"># Edit 4</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">RollingUpdate</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx:alpine</span>     <span class="comment"># Edit 3</span></span><br><span class="line">        <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">httpd</span></span><br><span class="line">        <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">        <span class="attr">terminationMessagePath:</span> <span class="string">/dev/termination-log</span></span><br><span class="line">        <span class="attr">terminationMessagePolicy:</span> <span class="string">File</span></span><br><span class="line">      <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">      <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br><span class="line">      <span class="attr">schedulerName:</span> <span class="string">default-scheduler</span></span><br><span class="line">      <span class="attr">securityContext:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">30</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 172.30.1.2:30080</span><br></pre></td></tr></table></figure>
</p>
</details>
<h3 id="练习题2-rollout-green-blue">练习题2 - Rollout Green-Blue</h3>
<p>Application “wonderful” is running in <code>default</code> Namespace.</p>
<p>You can call the app using <code>curl wonderful:30080</code> .</p>
<p>The application YAML is available at <code>/wonderful/init.yaml</code> .</p>
<p>The app has a Deployment with image <code>httpd:alpine</code> , but should be switched over to <code>nginx:alpine</code> .</p>
<ol>
<li>
<p>The switch should happen instantly. Meaning that from the moment of rollout, all new requests should hit the new image.</p>
<ul>
<li>1.1 Create a new Deployment <code>wonderful-v2</code> which uses image <code>nginx:alpine</code> with <code>4</code> replicas. It’s Pods should have labels <code>app: wonderful</code> and <code>version: v2</code></li>
<li>1.2 Once all new Pods are running, change the selector label of Service wonderful to <code>version: v2</code></li>
<li>1.3 Finally scale down Deployment <code>wonderful-v1</code> to <code>0</code> replicas</li>
</ul>
</li>
</ol>
<details>
  <summary>Solution</summary>
  <p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2.1 Create a new Deployment and watch these places:</span></span><br><span class="line">cp /wonderful/init.yaml v2.yaml</span><br><span class="line">vim v2.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wonderful-v2</span>    <span class="comment"># Modify</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">4</span>           <span class="comment"># Modify</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">      <span class="attr">version:</span> <span class="string">v2</span>       <span class="comment"># Modify 1.1</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">        <span class="attr">version:</span> <span class="string">v2</span>     <span class="comment"># Modify 1.1</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx:alpine</span>    <span class="comment"># Modify 1.1</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="comment"># delete service part</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ k apply -f v2.yaml </span><br><span class="line"><span class="comment"># Wait till all Pods are running, then switch the Service selector:</span></span><br><span class="line">$ k get deployments.apps </span><br><span class="line">NAME           READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">wonderful-v1   4/4     4            4           13m</span><br><span class="line">wonderful-v2   4/4     4            4           4s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.2</span></span><br><span class="line">$ k get service</span><br><span class="line">NAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE</span><br><span class="line">wonderful    NodePort    10.98.188.152   &lt;none&gt;        80:30080/TCP   9m21s</span><br><span class="line"></span><br><span class="line">$ k edit service wonderful</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wonderful</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">    <span class="attr">targetPort:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">nodePort:</span> <span class="number">30080</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">    <span class="attr">version:</span> <span class="string">v2</span>     <span class="comment"># Modify 1.2</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span></span><br></pre></td></tr></table></figure>
</p><p>Confirm with curl wonderful:30080 , all requests should hit the new image.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.3 Finally scale down the original Deployment:</span></span><br><span class="line">kubectl scale deploy wonderful-v1 --replicas 0</span><br></pre></td></tr></table></figure>
  <p></p>
</details>
<h2 id="参考文章">参考文章</h2>
<ul>
<li>CKAD 真题
<ul>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/104332178?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166047629616782350895616%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=166047629616782350895616&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-23-104332178-null-null.142%5Ev40%5Epc_search_integral,185%5Ev2%5Econtrol&amp;utm_term=CKAD%E8%80%83%E8%AF%95%E9%A2%98&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener">CKAD考试预备动员</a>
<ul>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108342028" target="_blank" rel="noopener">CKAD 1. Core Concepts(13%)考题答案</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108342510" target="_blank" rel="noopener">CKAD 2. Configuration (18%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108350785" target="_blank" rel="noopener">CKAD 3. Multi-Container Pods (10%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108358664" target="_blank" rel="noopener">CKAD 4. Observability(18%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108365404" target="_blank" rel="noopener">CKAD 5. Pod Design (20%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108420840" target="_blank" rel="noopener">CKAD 6. Services &amp; Networking (13%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108423635" target="_blank" rel="noopener">CKAD 7. State Persistence (8%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108424082" target="_blank" rel="noopener">CKAD 8. Bonus Exercises考试必背</a></li>
</ul>
</li>
<li><a href="https://blog.csdn.net/marlon212/article/details/120245331?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166047524116782246432126%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=166047524116782246432126&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-4-120245331-null-null.nonecase&amp;utm_term=CKAD&amp;spm=1018.2226.3001.4450" target="_blank" rel="noopener">2021年全年CKAD真题 5道题</a></li>
<li><a href="https://blog.csdn.net/itsaka/category_11115176.html" target="_blank" rel="noopener">2021 Kubernetes CKAD 1.20 - 真题 4道题</a>
<ul>
<li><a href="https://blog.csdn.net/itsaka/article/details/117590286" target="_blank" rel="noopener">Kubernetes CKAD 1.20 - 真题 （第1题）Creating a Pod and Inspecting it</a></li>
<li><a href="https://blog.csdn.net/itsaka/article/details/117590437" target="_blank" rel="noopener">Kubernetes CKAD 1.20 - 真题 （第2题）Configuring a Pod to Use a ConfigMap</a></li>
<li><a href="https://blog.csdn.net/itsaka/article/details/117590502" target="_blank" rel="noopener">Kubernetes CKAD 1.20 - 真题 （第3题）Implementing the Adapter Pattern</a></li>
<li><a href="https://blog.csdn.net/itsaka/article/details/117590558" target="_blank" rel="noopener">Kubernetes CKAD 1.20 - 真题 （第4题）Defining a Pod’s Readiness and Liveness Probe</a></li>
</ul>
</li>
<li><a href="https://blog.csdn.net/vic_qxz/article/details/123361130?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166039499316782248581366%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=166039499316782248581366&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-16-123361130-null-null.142%5Ev40%5Epc_search_integral,185%5Ev2%5Econtrol&amp;utm_term=CKAD%E8%80%83%E8%AF%95%E9%A2%98&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener">2022 K8S CKAD 1.23 考试 实验 模拟环境（一键导入）【需购买】</a></li>
</ul>
</li>
<li><a href="https://itnext.io/practical-tips-for-passing-ckad-exam-6cbdf2d35cb1" target="_blank" rel="noopener">Practical tips for passing CKAD certification exam</a></li>
</ul>


                    <!-- Donate -->

<div>
    <div class="donate-container" style="padding: 10px 0; margin: auto auto; width: 90%; text-align: center;">
        <div></div>
        <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
        <span>Donate</span>
        </button>
        <div id="QR" style="display: none;">
            <div id="wechat" style="display: inline-block">
                <img id="wechat_qr" src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/wechat/wechatpay.png" alt="WeChat Pay" style="width: 200px; height: 200px; text-align: center;">
            <!-- <p>Wechat</p> -->
            </div>
            <div id="alipay" style="display: inline-block">
                <img id="alipay_qr" src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/alipay.png" alt="Alipay" style="width: 200px; height: 200px; text-align: center;">
            <!-- <p>Alipay</p> -->
            </div>
        </div>
    </div>
</div>


                    <! -- 添加版权信息 -->
<div class="article-footer-copyright">
  <div><b>本文标题: </b><a href="/Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html" target="_blank" title="2022 CKAD K8s v1.25 考试真题整理">2022 CKAD K8s v1.25 考试真题整理</a></div>
  <div><b>本文链接: </b><a href="/Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html" target="_blank" title="2022 CKAD K8s v1.25 考试真题整理">http://liyuankun.top/Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html</a>.</div>
  <div>本文由<a href="/index.html" target="_blank" title="Yuankun Li">Yuankun Li</a>创作和发表,采用<b>BY</b>-<b>NC</b>-<b>SA</b>国际许可协议进行许可,转载请注明作者及出处。</div>
</div>

                    
                    <hr>
                    <!-- Pager -->
                    <ul class="pager">
                        
                            <li class="previous">
                                <a href="/计算机英语-安全Security.html" rel="external nofollow" data-toggle="tooltip" data-placement="top" title="计算机英语-安全Security">&larr; Previous Post</a>
                            </li>
                        
                        
                            <li class="next">
                                <a href="/Kubernates-Certified-Kubernetes-Administrator-CKA.html" rel="external nofollow" data-toggle="tooltip" data-placement="top" title="2022年8月 CKA K8s v1.24 考试真题整理">Next Post &rarr;</a>
                            </li>
                        
                    </ul>

                    <!-- Duoshuo Comment Share -->
                    

                    <!-- Duoshuo Comment -->
                    

                    <!-- Disqus Comment -->
                    <!-- disqus comment -->

    <div class="disqus_comment">
        <div id="disqus_thread" class="disqus-thread"></div>
    </div>


                    <!-- Git Comment -->
                    <!-- gitment -->

    <hr>
    <div class="git_comment" id="git_comment">
        
            <div onclick="document.getElementById('gitment-display-button').style.display = 'none';document.getElementById('gitment-container').style.display = 'block';renderGitment();" id="gitment-display-button">show git comment</div>
            <div id="gitment-container" style="display:none"></div>
        
    </div>
    <hr>

                </div>
                
                <!-- Tabe of Content -->
                <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#考试内容"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">考试内容</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#more-items-for-ckad-than-cka"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">More items for CKAD than CKA</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#如何备考"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">如何备考</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#k8s练习环境-同cka"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">k8s练习环境(同CKA)</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ckad练习题"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">CKAD练习题</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ckad课程"><span class="toc-nav-number">2.3.</span> <span class="toc-nav-text">CKAD课程</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#常用命令"><span class="toc-nav-number">2.4.</span> <span class="toc-nav-text">常用命令</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#经验总结-同cka"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">经验总结(同CKA)</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#pre-setup-同cka"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">Pre Setup(同CKA)</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ckad-真题"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">CKAD 真题</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2021考题1-creating-a-pod-and-inspecting-it"><span class="toc-nav-number">5.1.</span> <span class="toc-nav-text">2021考题1 - Creating a Pod and Inspecting it</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2021考题2-configuring-a-pod-to-use-a-configmap"><span class="toc-nav-number">5.2.</span> <span class="toc-nav-text">2021考题2 - Configuring a Pod to Use a ConfigMap</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2021考题3-configuring-a-pod-to-use-a-secret"><span class="toc-nav-number">5.3.</span> <span class="toc-nav-text">2021考题3 - Configuring a Pod to Use a Secret</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题4-creating-a-security-context-for-a-pod"><span class="toc-nav-number">5.4.</span> <span class="toc-nav-text">考题4 - Creating a Security Context for a Pod</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2021考题4"><span class="toc-nav-number">5.4.1.</span> <span class="toc-nav-text">2021考题4</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2022-考题4-security-context"><span class="toc-nav-number">5.4.2.</span> <span class="toc-nav-text">2022 考题4 Security Context</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题5-defining-a-pod-s-resource-requirements"><span class="toc-nav-number">5.5.</span> <span class="toc-nav-text">考题5 - Defining a Pod’s Resource Requirements</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2021-考题5-resourcequota"><span class="toc-nav-number">5.5.1.</span> <span class="toc-nav-text">2021 考题5 ResourceQuota</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2022-考题5-limitrange"><span class="toc-nav-number">5.5.2.</span> <span class="toc-nav-text">2022 考题5 LimitRange</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题6-using-a-service-account"><span class="toc-nav-number">5.6.</span> <span class="toc-nav-text">考题6 - Using a Service Account</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题7-implementing-the-adapter-pattern"><span class="toc-nav-number">5.7.</span> <span class="toc-nav-text">考题7 - Implementing the Adapter Pattern</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题8-defining-a-pod-s-readiness-and-liveness-probe"><span class="toc-nav-number">5.8.</span> <span class="toc-nav-text">考题8 - Defining a Pod’s Readiness and Liveness Probe</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2022-readiness-probe"><span class="toc-nav-number">5.8.1.</span> <span class="toc-nav-text">2022 readiness probe</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题9-fixing-a-misconfigured-pod"><span class="toc-nav-number">5.9.</span> <span class="toc-nav-text">考题9 - Fixing a Misconfigured Pod</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题10-2022-rollout-canary"><span class="toc-nav-number">5.10.</span> <span class="toc-nav-text">考题10 - 2022 Rollout Canary</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题11-2022-helm-nanagement"><span class="toc-nav-number">5.11.</span> <span class="toc-nav-text">考题11 - 2022 Helm Nanagement</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题12-2022-networkpolicy"><span class="toc-nav-number">5.12.</span> <span class="toc-nav-text">考题12 - 2022 NetworkPolicy</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#restricting-access-to-and-from-a-pod"><span class="toc-nav-number">5.12.1.</span> <span class="toc-nav-text">Restricting Access to and from a Pod</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题13-2022-docker"><span class="toc-nav-number">5.13.</span> <span class="toc-nav-text">考题13 - 2022 Docker</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题14-2022-cronjobs"><span class="toc-nav-number">5.14.</span> <span class="toc-nav-text">考题14 - 2022 CronJobs</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#考题15-2022-service-ingress"><span class="toc-nav-number">5.15.</span> <span class="toc-nav-text">考题15 - 2022 service, ingress</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ckad-练习题"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">CKAD 练习题</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#练习题1-rollout-rolling"><span class="toc-nav-number">6.1.</span> <span class="toc-nav-text">练习题1 - Rollout Rolling</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#练习题2-rollout-green-blue"><span class="toc-nav-number">6.2.</span> <span class="toc-nav-text">练习题2 - Rollout Green-Blue</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#参考文章"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">参考文章</span></a></li></ol>
        
        </div>
      </aside>
    

                    
                <!-- Sidebar Container Below-->
                <div class="
    col-lg-8 col-lg-offset-2
    col-md-10 col-md-offset-1
    sidebar-container">
    
        
    
        
    
        
    
        
            
  <h5>RECENT POSTS</h5>
  <div class="widget">
    <ul>
      
        <li>
          <a href="/awesome-tools.html">程序猿的那些好用工具</a>
        </li>
      
        <li>
          <a href="/计算机英语-virus-worm-Spyware-Ransomware-Trojan-horse.html">计算机英语-virus,worm,Spyware,Ransomware,Trojan horse</a>
        </li>
      
        <li>
          <a href="/浏览器报错“localhost-sent-an-invalid-response-ERR-SSL-PROTOCOL-ERROR”.html">浏览器报错“localhost sent an invalid response.ERR_SSL_PROTOCOL_ERROR”</a>
        </li>
      
        <li>
          <a href="/JSON-Web-Token-JWT-入门教程.html">JSON Web Token (JWT) 入门教程</a>
        </li>
      
        <li>
          <a href="/Develop-LLM-powered-applications-with-LangChain-Udemy-Course.html">Develop LLM powered applications with LangChain - Udemy Course</a>
        </li>
      
    </ul>
  </div>

            <hr>
        
    
        
            <!-- Friends Blog -->

<h5>FRIENDS</h5>
<ul class="list-inline">

    
        <li><a href="https://blog.csdn.net/muzilanlan" target="_blank">CSDN</a></li>
    
        <li><a href="https://www.jianshu.com/u/6b421fa23669" target="_blank">简书</a></li>
    
</ul>

            <hr>
        
    
        
    
</div>
            </div>
        </div>
    </article>
</div>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℒ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<!-- Read more, 微信解锁博客 https://openwrite.cn/openwrite/openwrite-readmore/-->
<script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script>
<script>
    const btw = new BTWPlugin();
    btw.init({
        id: 'container',
        blogId: '19965-1582033785898-401',
        name: '岚坤爷',
        qrcode: 'https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/wechat/wechat-public.png',
        keyword: 'vip',
    });
    // 加英文版翻译
    const readMoreBtn = document.querySelector('#read-more-btn');
    const addEnglish = () => {
        const element = document.querySelector('#btw-modal-header');
        element.innerHTML = element.innerHTML + `<p id="btw-modal-header-en" style="margin-top: 10px; line-height: 1.8; font-size: 13px; color: #0085a1;">
            Scan the QR code to follow the WeChat public account: <strong>岚坤爷</strong><br>
            Send message:<strong> vip</strong><br>
            Get a verification code that permanently unlocks all articles on this site`;
        const input = document.querySelector('#btw-modal-input');
        input.setAttribute('placeholder', '请输入验证码 Input verification code');
        const submit = document.querySelector('#btw-submit-btn');
        submit.innerHTML = '提交 Submit';
    };

    readMoreBtn.addEventListener('click', () => {
        setTimeout(addEnglish, 10);
    });
</script>

<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-1 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                    <li>
                        <a href="/atom.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank"  href="https://github.com/catherineliyuankun">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank"  href="https://www.linkedin.com/in/liyuankun">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/muzilan">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="https://www.jianshu.com/u/6b421fa23669">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">简</i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank" href="mailto:muzilan1@qq.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="https://twitter.com/CatherineLiYK">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="https://www.facebook.com/liyuankun">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Yuankun Li 2025 
                    <br>
                    Theme by <a href="https://github.com/CatherineLiyuankun">Li, Yuankun</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=catherineliyuankun&repo=hexo-theme-zilan&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://liyuankun.top/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->





    <!-- Fork me on GitHub -->
    
       
    <!-- Search -->
    <!-- {% include 'tinysou.swig' %}
 {% include 'localsearch.swig' %}
 {% include 'algolia-search/assets.swig' %} -->


  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = 'search.xml';
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = '/' + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        // dataType: isXml ? "xml" : "json",
        // dataType: "binary",
        // contentType: "text/xml",
        dataType: "text", // Fix Bug: xml parser error
        async: true,
        data: "{}",
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-cover');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if (!input || !resultContent) {
            // Fix Bug: add /zilan/layout/_partial/search/localsearch.ejs inside "site-search"
              $(".site-search")
              .append(
                  '<div class="popup search-popup local-search-popup">' +
                  '<div class="local-search-header clearfix">' +
                    '<span class="search-icon">' +
                      '<i class="fa fa-search"></i>' +
                  '</span>' +
                    '<span class="popup-btn-close">' +
                      '<i class="fa fa-times-circle"></i>' +
                    '</span>' +
                    '<div class="local-search-input-wrapper">' +
                      '<input autocomplete="off"' +
                            'placeholder="search" spellcheck="false"' +
                            'type="text" id="local-search-input">' +
                    '</div>' +
                  '</div>' +
                  '<div id="local-search-result"></div>' +
                '</div>');
            input = document.getElementById("local-search-input");
            resultContent = document.getElementById("local-search-result");
            // Fix Bug: close not work
            var searchClose = document.querySelector(".popup-btn-close");
            searchClose.addEventListener('click', onPopupClose);
          }
          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        },
        error: function (jqXHR, textStatus, errorThrown) {
            /*弹出jqXHR对象的信息*/
            alert(jqXHR.responseText);
            alert(jqXHR.status);
            alert(jqXHR.readyState);
            alert(jqXHR.statusText);
            /*弹出其他两个参数的信息*/
            alert(textStatus);
            alert(errorThrown);
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    var registerESCKeyEvent =  function () {
      $(document).on('keyup', function (event) {
        var shouldDismissSearchPopup = event.which === 27 &&
          $('.search-popup').is(':visible');
        if (shouldDismissSearchPopup) {
          $('.search-popup').hide();
          $('.search-popup-overlay').remove();
          $('body').css('overflow', '');
        }
      });
    };
    registerESCKeyEvent();
  </script>





    <!-- Share -->
      
    <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">
    <script src="/lib/needsharebutton/needsharebutton.js"></script>

    
      <script>
          var pbOptions = {};
          var iconStyle = "light";
          var boxForm = "horizontal";
          var position = "bottom";
          var networks = "Wechat,Weibo,Douban,Twitter,Facebook,Reddit,Linkedin,Evernote";
          pbOptions["iconStyle"] = iconStyle;
          pbOptions["boxForm"] = boxForm;
          pbOptions["position"] = position;
          pbOptions["networks"] = networks;
          
          new needShareButton('#needsharebutton-postbottom', pbOptions);
      </script>
    

    
      <script>
          var pbOptions = {};
          var iconStyle = "light";
          var boxForm = "horizontal";
          var position = "middleRight";
          var networks = "Wechat,Weibo,Douban,Twitter,Facebook,Reddit,Linkedin,Evernote";
          pbOptions["iconStyle"] = iconStyle;
          pbOptions["boxForm"] = boxForm;
          pbOptions["position"] = position;
          pbOptions["networks"] = networks;
          
          new needShareButton('#needsharebutton-postbottom', pbOptions);
      </script>
    

    
      <script>
          var flOptions = {};
          var iconStyle = "box";
          var boxForm = "horizontal";
          var position = "middleRight";
          var networks = "Wechat,Weibo,Douban,Twitter,Facebook,Reddit,Linkedin,Evernote";
          flOptions["iconStyle"] = iconStyle;
          flOptions["boxForm"] = boxForm;
          flOptions["position"] = position;
          flOptions["networks"] = networks;

          new needShareButton('#needsharebutton-float', flOptions);
      </script>
    


    <!-- Share float -->
    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt fa-inverse" aria-hidden="true"></i>
        </span>
      </div>
      

    <!-- Git Comment -->
    
    
    <!-- LOCAL: You can save these files to your site and update links -->
        
            <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
            <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
        
    <!-- END LOCAL -->
        
        <style>
            a.gitment-editor-footer-tip { display: none; }
            .gitment-container.gitment-footer-container { display: none; }
        </style>
        

        
        <script type="text/javascript">
            var option = {
                id: window.location.pathname,
                owner: 'CatherineLiyuankun',
                repo: 'gitment-comments',
                oauth: {
                    client_id: 'f3a0c1c7153576e1ab6c'
                }
            };
            if(true) {
                option.lang = "" || navigator.language || navigator.systemLanguage || navigator.userLanguage;
            }
            if (true && ( || false)) {
                option.oauth.redirect_protocol = '';
            }
            if (true && ( || false)) {
                option.oauth.proxy_gateway = '';
            } else {
                option.oauth.client_secret = 'bedf5010df925fa0e02e8be9399a64caac3d2b4e';
            }

            function renderGitment(){
                var gitment;
                if (true) {
                    gitment = new Gitmint(option);
                } else {
                    gitment = new Gitment(option);
                }
                gitment.render('gitment-container');
            }

            if(!true) {
                renderGitment();
            } else {
                function showGitment(){
                    document.getElementById("gitment-display-button").style.display = "none";
                    document.getElementById("gitment-container").style.display = "block";
                    renderGitment();
                }
            }
        </script>
        
    



    <!-- Disqus Comment -->
    
    <!-- disqus embedded js code start (one page only need to embed once) -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES * * */
        var disqus_shortname = "lyk-1";
        var disqus_identifier = "http://liyuankun.top/Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html";
        var disqus_url = "http://liyuankun.top/Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html";

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

    </script>
    <!-- disqus embedded js code start end -->

    
    <!-- Duoshuo Comment -->
    

    <!-- Search popup-->
    
    
      <div class="site-search">
      <!-- {% if theme.algolia_search.enable %}
  {% include '../_third-party/search/algolia-search/dom.swig' %}
{% elseif theme.swiftype_key %}
  {% include 'search/swiftype.swig' %}
{% elseif theme.tinysou_Key %}
  {% include 'search/tinysou.swig' %}
{% elseif theme.local_search.enable %}
  {% include 'search/localsearch.swig' %}
{% endif %} -->

<div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="search" spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



      </div>
    
    
	<a id="rocket" href="#top" class="" rel="external nofollow"></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>

  <!-- Markdown math -->
   
   
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  



  <!-- Fancybox -->
  
      <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox.css">
      <script src="/lib/fancybox/jquery.fancybox.pack.js"></script>
      <script src="/js/wrapImage.js"></script>
  
  <!-- Migrate from head to bottom, no longer block render and still work --><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

</body>

</html>
