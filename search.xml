<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>10秦小明-新金融思维训练笔记第10讲-公司金融与资本运作</title>
    <url>/10%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC10%E8%AE%B2-%E5%85%AC%E5%8F%B8%E9%87%91%E8%9E%8D%E4%B8%8E%E8%B5%84%E6%9C%AC%E8%BF%90%E4%BD%9C.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC10%E8%AE%B2-%E5%85%AC%E5%8F%B8%E9%87%91%E8%9E%8D%E4%B8%8E%E8%B5%84%E6%9C%AC%E8%BF%90%E4%BD%9C.png" alt="思维导图"></p>
<h1 id="第10讲-公司金融与资本运作">第10讲-公司金融与资本运作</h1>
<h2 id="资本化-vs-费用">资本化 Vs 费用</h2>
<h3 id="资本化-资产负债表">资本化【资产负债表】</h3>
<ul>
<li>【长期】</li>
<li>可以再生产</li>
<li>买一台可以用10年的设备、不动产房子、知识产权</li>
</ul>
<h3 id="费用-利润表里">费用【利润表里】</h3>
<ul>
<li>【当/短期】产生作用</li>
<li>不能再生产，消耗性</li>
<li>吃饭、旅游</li>
</ul>
<h3 id="资本化支出-费用支出">⤴资本化支出⤵费用支出</h3>
<ul>
<li>⤴睡后收入[边际成本=0]</li>
<li>⤴资本化支出 -&gt; ⤴资本化收入</li>
<li>工资劳动性收入[边际成本高] &lt; 资本化收入[边际成本低]</li>
</ul>
<h2 id="公司金融">公司金融</h2>
<p>推荐书：Coperate Finance 罗斯的公司理财</p>
<h3 id="公司财务">公司财务</h3>
<ul>
<li>财务分析帮助公司决策</li>
<li>多套公司财务报表
<ul>
<li>公开财务报表</li>
<li>内部财务报表</li>
<li>监管财务报表</li>
</ul>
</li>
</ul>
<h3 id="公司投资决策">公司投资决策</h3>
<ul>
<li>公司股票回购
<ul>
<li>新东方在美国上市，被别人做空，股票⤵, 用公司的钱回购自己公司的股票，注销，⤵股份数 ⤴股价</li>
</ul>
</li>
<li>公司投资
<ul>
<li>1<a href="https://wiki.mbalib.com/wiki/%E5%87%80%E7%8E%B0%E5%80%BC%E6%B3%95" target="_blank" rel="noopener">Net Present Value</a> (NPV) &gt; 0 值得投资
<ul>
<li>折现  未来的5w 相当于现在多少钱？ 对机会成本的补偿</li>
<li>包子铺每年产生5w现金，第10年的5w折现 = 5w/(1+收益率5%)10次方</li>
</ul>
</li>
<li>2投资回报期</li>
<li>3<a href="https://wiki.mbalib.com/wiki/%E5%86%85%E9%83%A8%E6%94%B6%E7%9B%8A%E7%8E%87%E6%B3%95" target="_blank" rel="noopener">内部收益率法(Internal Rate of Return，IRR)</a>
<ul>
<li>一个项目实际可以达到的最高收益率</li>
</ul>
</li>
</ul>
</li>
<li>公司融资
<ul>
<li>【间接融资】跟银行借款</li>
<li>【直接融资】股票上市IPO、增发（二次募集）、发行债券</li>
<li>中国的【间接融资】比例高
<ul>
<li>外国投行多</li>
<li>问题1 中小公司 贷不到银行款 民间借贷，利息高</li>
<li>问题2 风险汇集到银行
<ul>
<li>坏账</li>
<li>房市</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>公司资本结构
<ul>
<li>1 股权/权益性资本 权益属于股东</li>
<li>2 债务性资本</li>
<li>MM定理：公司资本结构对公司价值的影响</li>
</ul>
</li>
<li>银行资产新规
<ul>
<li>保证负债安全
<ul>
<li>信用评级、抵押物、贷款资质</li>
<li>银行资本充足率
<ul>
<li>银行每往外贷款100w, 银行自有资本要有8w，8%</li>
<li>表外业务 不写在资产负债表内
<ul>
<li>去银行买理财产品</li>
<li>隐形风险，逃脱监管</li>
<li>回归表内</li>
</ul>
</li>
<li>表内业务 写在资产负债表内
<ul>
<li>银行发行股票、债券（永续债）-&gt; 增加银行自有资本</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>银行的资产= 负债 + 所有者权益
<ul>
<li>负债 = 储户的钱</li>
<li>银行的所有者权益很低，负债率很高，高杠杆</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="资本运作方式">资本运作方式</h2>
<h3 id="m-a并购-兼并-merger-收购-acquisition"><a href="https://wiki.mbalib.com/wiki/M%26A" target="_blank" rel="noopener">M&amp;A并购=兼并（Merger）&amp; 收购（Acquisition）</a></h3>
<p>收购资产、收购子公司 M&amp;A</p>
<ul>
<li>自己拿钱买</li>
<li>【借钱去买】杠杆收购 <a href="https://wiki.mbalib.com/wiki/%E6%9D%A0%E6%9D%86%E6%94%B6%E8%B4%AD" target="_blank" rel="noopener">LBO Leveraged Buyout</a></li>
</ul>
<!-- - Good well 商域 -->
<h3 id="重组">重组</h3>
<ul>
<li>资产重组
<ul>
<li>剥离不良资产</li>
</ul>
</li>
<li>股权重组</li>
<li>债务重组
<ul>
<li>本金⤵</li>
<li>利率⤵</li>
<li>债务延期</li>
</ul>
</li>
</ul>
<h3 id="四个层面进行交易">四个层面进行交易</h3>
<ul>
<li>公司-&gt;资产-&gt;股东-&gt;债务</li>
</ul>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>12秦小明-新金融思维训练笔记第12讲-金融市场-股、债、商、汇</title>
    <url>/12%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC12%E8%AE%B2-%E9%87%91%E8%9E%8D%E5%B8%82%E5%9C%BA-%E8%82%A1%E3%80%81%E5%80%BA%E3%80%81%E5%95%86%E3%80%81%E6%B1%87.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC12%E8%AE%B2-%20%E9%87%91%E8%9E%8D%E5%B8%82%E5%9C%BA-%E8%82%A1%E3%80%81%E5%80%BA%E3%80%81%E5%95%86%E3%80%81%E6%B1%87.png" alt="思维导图"></p>
<h1 id="12-金融市场-股-债-商-汇">12 金融市场-股、债、商、汇</h1>
<h2 id="三个问题">三个问题</h2>
<h3 id="step1-买-什么时候开仓">step1 【买】什么时候开仓</h3>
<h3 id="step2-处理波动">step2 处理波动</h3>
<h3 id="step3-卖-退出">step3 【卖】退出</h3>
<h2 id="锚">锚</h2>
<h3 id="1跟自己得出的锚相比-决定step1">@1跟自己得出的锚相比,决定step1</h3>
<h3 id="2市场价格给你提供的安全边际-决定step2">@2市场价格给你提供的安全边际，决定step2</h3>
<h3 id="3基于-1-2来决定step3">@3基于@1@2来决定step3</h3>
<ul>
<li>不要追高杀跌</li>
<li>严格执行原来的卖出计划</li>
</ul>
<h2 id="股票市场">股票市场</h2>
<h3 id="贴现现金流dcf"><a href="https://wiki.mbalib.com/wiki/DCF" target="_blank" rel="noopener">贴现现金流DCF</a></h3>
<ul>
<li>不同公司贴现率不同</li>
<li>无风险收益率 （受国家央行影响，⤵利率-&gt; 流动性⤵-&gt;无风险收益率⤵）</li>
</ul>
<h3 id="1-长期-基本面-分子">1 【长期】基本面【分子】</h3>
<ul>
<li>国家经济情况： GDP增速、出口、投资消费</li>
<li>美国PMI、非农就业指数</li>
</ul>
<h3 id="2-中期-流动性-分母">2 【中期】流动性【分母】</h3>
<ul>
<li>金融数据：央行货币政策 利率【降/升息】、存款准备金率【降/升准】</li>
<li>供给面 m2、信贷</li>
<li>需求面 社会融资总量</li>
</ul>
<h3 id="3-短期-交易情绪-偏好">3 【短期】交易情绪/偏好</h3>
<ul>
<li>受前两个因素影响</li>
<li>成交量</li>
</ul>
<h3 id="3个因素与预期相比">3个因素与预期相比</h3>
<h2 id="债市">债市</h2>
<h3 id="国债-企业债-公司债-固定收益产品：cdo">国债、企业债、公司债、固定收益产品：CDO</h3>
<h3 id="上节课-债券定价">上节课“债券定价”</h3>
<h3 id="影响因素">影响因素</h3>
<ul>
<li>通胀⤴（经济过热，大宗商品、股市牛市）-&gt; 没人买债券 -&gt; 债券交易价格⤵收益率⤴</li>
<li>基本面</li>
<li>货币政策</li>
</ul>
<h3 id="关系">关系</h3>
<ul>
<li>通常股市牛市⤴债市牛市⤵</li>
<li>偶尔股市牛市⤴债市牛市⤴
<ul>
<li>发生在：基本面一般快要好，利率⤵货币流动性很好⤴买债券的人多，票面价格⤴收益率⤵</li>
<li>利率⤵新发行的债券承诺利率⤵ -&gt; 过去发行债券价格⤴  过去发行债券收益率⤵</li>
</ul>
</li>
</ul>
<h2 id="汇率">汇率</h2>
<h3 id="外汇">外汇</h3>
<ul>
<li>【短期】市场预期与交易情绪</li>
<li>【中期】货币政策
<ul>
<li>利率</li>
<li>窗口干预</li>
</ul>
</li>
<li>【长期】基本面</li>
</ul>
<h3 id="大宗商品">大宗商品</h3>
<ul>
<li>大宗商品 T+0 期货形式
<ul>
<li>股市 T+1</li>
</ul>
</li>
<li>杠杆交易
<ul>
<li>100w商品，保证金只用交10%，就是十倍杠杆</li>
</ul>
</li>
<li>【影响因素1】宏观经济
<ul>
<li>【中期】货币政策</li>
<li>【长期】基本面</li>
<li>石油、铜、<a href="https://about.fengjr.com/bank/detail-qa-134061" target="_blank" rel="noopener">黑色产品</a>（主要有铁矿石，焦煤，焦炭，动力煤，螺纹钢，线材，板材，硅铁，锰硅这几类。）</li>
</ul>
</li>
<li>【影响因素2】产业供需情况
<ul>
<li>产业链了解清楚</li>
<li>供给⤴需求⤵-&gt;价格⤵</li>
<li>供给⤴需求⤵-&gt;库存⤴ 矿石铁⤵钢铁产量⤴需求⤴-&gt;供给矿石价格⤴</li>
</ul>
</li>
<li><a href="https://wiki.mbalib.com/zh-tw/%E5%9F%BA%E5%B7%AE" target="_blank" rel="noopener">期差/基差</a>
<ul>
<li>基差=现货价格-期货价格
<ul>
<li>1、正向市场。基差为负，各月份合约的价格差距以持有成本为基础。理论上，负的基差有一上限，若基差绝对值超过持有成本，将引发套利行为，从而纠正其不合理的价差。</li>
<li>2、反向市场。基差为正值，市场短缺，持有成本为负，近期价格高于远期价格。价差没有一定的上限，看短缺程度。</li>
</ul>
</li>
<li>期货价格⤴升水-&gt;做多，期货价格⤵贴水-&gt;做空</li>
<li>越接近交割期，基差⤵</li>
</ul>
</li>
<li>控制风险
<ul>
<li>控制仓位</li>
<li>控制总投入</li>
</ul>
</li>
</ul>
<blockquote>
<p>期权交易<br>
国内能买50、300、500ETF这几种期权（国内都是欧式期权，不能提前行权）</p>
<p>开户要求：50万资金，交易所开户，考试后可开通（小明说他40-50万资金，实际能操作的也就7-8万）</p>
<p>期权优势：自带杠杆…</p>
<p>看涨期权，看跌期权（建议买入）</p>
<p>1份是10000，选择“到期时间”。每个月第三周的周四交割，建议用“限价下单”</p>
<p>如：50ETF，购3月，3000</p>
<p>期权定价是下面2者相加</p>
<p>1、内在价值：市价与约定价格之差</p>
<p>2、保险费（时间价值）：时间越长，买入价格越高；随着时间靠近，持有价格会下降</p>
</blockquote>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>13秦小明-新金融思维训练笔记第13讲-金融行业</title>
    <url>/13%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC13%E8%AE%B2-%E9%87%91%E8%9E%8D%E8%A1%8C%E4%B8%9A.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC13%E8%AE%B2-%E9%87%91%E8%9E%8D%E8%A1%8C%E4%B8%9A.png" alt="思维导图"></p>
<h1 id="金融行业">金融行业</h1>
<h2 id="资产类别">资产类别</h2>
<h3 id="传统资产类别">传统资产类别</h3>
<ul>
<li>股票市场
<ul>
<li>美国散户少，散户委托投资人进行理财</li>
<li>中国散户比例高</li>
</ul>
</li>
<li>债券</li>
<li>大宗商品</li>
<li>汇率</li>
<li><a href="https://wiki.mbalib.com/wiki/%E7%BE%8E%E6%9E%97%E6%8A%95%E8%B5%84%E6%97%B6%E9%92%9F" target="_blank" rel="noopener">美林时钟</a>
<ul>
<li>1．不同类别资产的收益率
<ul>
<li>(1)所有资产中股票的表现最好，年均实际回报率达到6．1％，相比债券收益率，存在约2．5％的股权风险溢价。</li>
<li>(2)债券的收益率高出现金2％，反映了债券的久期风险和违约风险。</li>
<li>(3)大宗商品的收益率高出预期。</li>
<li>(4)1．5％的现金实际回报率是平均实际利率。</li>
</ul>
</li>
<li>2．不同阶段的资产收益率
<ul>
<li>(1)衰退：债券&gt;现金&gt;大宗商品；股票&gt;大宗商品</li>
<li>(2)复苏：股票&gt;债券&gt;现金&gt;大宗商品</li>
<li>(3)过热：大宗商品&gt;股票&gt;现金／债券</li>
<li>(4)滞胀：大宗商品</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="另类投资-alternative-investment"><a href="https://wiki.mbalib.com/wiki/%E5%8F%A6%E7%B1%BB%E6%8A%95%E8%B5%84" target="_blank" rel="noopener">另类投资（Alternative Investment）</a></h3>
<ul>
<li>
<p><a href="https://wiki.mbalib.com/wiki/%E7%A7%81%E5%8B%9F%E8%82%A1%E6%9D%83" target="_blank" rel="noopener">私募股权(PE, Private Equity)</a></p>
<ul>
<li>广义
<ul>
<li>非公开形式募集资金，并对企业进行各种类型的股权投资。涵盖企业首次公开发行前各阶段的权益投资，即对处于种子期、初创期、发展期、扩展期、成熟期和Pre-IPO各个时期企业所进行的投资，以及上市后的私募投资(如Private Investment In Public Equity，PIPE)等。</li>
</ul>
</li>
<li>狭义
<ul>
<li>对已经形成一定规模的，并产生稳定现金流的成熟企业的私募股权投资部分，主要是指创业投资后期的私募股权投资部分。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href="https://wiki.mbalib.com/wiki/%E9%A3%8E%E9%99%A9%E6%8A%95%E8%B5%84" target="_blank" rel="noopener">风险投资</a>(VC, Venture Capital)</p>
<ul>
<li>创业投资
<ul>
<li>天使投资人：适合有行业经验的人</li>
</ul>
</li>
<li>相对法估值</li>
<li>运作程序
<ul>
<li>一、初审</li>
<li>二、风险投资家之间的磋商</li>
<li>三、面谈【创始人很重要】</li>
<li>四、责任审查</li>
<li>五、条款清单</li>
<li>六、签订合同
<ul>
<li>对赌协议</li>
</ul>
</li>
<li>七、投资生效后的监管</li>
<li>八、其他投资事宜</li>
</ul>
</li>
</ul>
</li>
<li>
<p>地产、房产、矿业、杠杆并购(Leveraged Buyout)、基金的基金(Fund of Funds)等诸多品种</p>
</li>
<li>
<p>根本理念</p>
<ul>
<li>市场未必一定有效率，许多企业、项目的价格没有体现其内在价值，因而离公共交易平台越远，价格与价值之间的偏差可能越高。</li>
</ul>
</li>
<li>
<p>重点</p>
<ul>
<li>放在没有上市、但具有包装潜力的企业和项目上，通过购买、重组、包装、套现，将收购的企业或项目的价值体现出来。</li>
</ul>
</li>
<li>
<p>重大特点</p>
<ul>
<li>缺少流动性
<ul>
<li>一个项目从购入到套现通常需要几年的时间，于是另类投资基金一般设有5、10年的锁定期，中途赎回很困难。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="职业">职业</h2>
<ul>
<li>收入差异大</li>
<li>投行 工资更高
<ul>
<li>banker 50w年薪起</li>
</ul>
</li>
<li>商业银行
<ul>
<li>柜员-&gt;客户经理</li>
</ul>
</li>
</ul>
<h3 id="商业银行-commercial-bank"><a href="https://wiki.mbalib.com/wiki/%E5%95%86%E4%B8%9A%E9%93%B6%E8%A1%8C" target="_blank" rel="noopener">商业银行（Commercial Bank）</a></h3>
<ul>
<li>资产端业务：贷款</li>
<li>负债端业务：储户存款
<ul>
<li>同业业务：小银行借大银行</li>
</ul>
</li>
<li>风险控制
<ul>
<li><a href="https://wiki.mbalib.com/wiki/%E5%AE%8F%E8%A7%82%E5%AE%A1%E6%85%8E%E8%AF%84%E4%BC%B0%E4%BD%93%E7%B3%BB" target="_blank" rel="noopener">宏观审慎评估体系（Macro Prudential Assessment，MPA）</a></li>
</ul>
</li>
<li>盈利：存贷款利差</li>
</ul>
<h3 id="投资银行-investment-banking"><a href="https://wiki.mbalib.com/wiki/%E6%8A%95%E8%A1%8C" target="_blank" rel="noopener">投资银行(Investment Banking)</a></h3>
<ul>
<li>中间商/卖方
<ul>
<li>名校毕业</li>
<li>自带资源</li>
</ul>
</li>
<li>买方(基金公司、资产管理公司)：看投资业绩
<ul>
<li>投资研究体系</li>
<li>研究员-6-8年-&gt;基金经理</li>
</ul>
</li>
<li>国内的证券公司业务 是投资银行业务的子集</li>
<li>一、获利性业务
<ul>
<li>初级市场造市：证券承销业务，比如为企业做IPO。</li>
<li>次级市场买卖撮合：包括自营和经纪业务。</li>
<li>自有资金操作交易：包括投机，套利等。</li>
<li>公司重组：包括扩大/缩小规模，所有权与控制等。</li>
<li>财务工程</li>
<li>其他获利性业务：包括咨询，投资管理，商人银行，风险基金，顾问业务等。</li>
</ul>
</li>
<li>二、支援性业务
<ul>
<li>包括市场研究，清算服务，信息资讯服务等。国际投资银行的三大系统:
<ul>
<li>美国投行–比如号称华尔街证券三巨头的美林，高盛，摩根士丹利。</li>
<li>英国商人银行及欧洲综合银行。</li>
<li>日本综合券商–比如野村证券，大和证券，日天证券等。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="投资银行与商业银行的区别"><a href="https://wiki.mbalib.com/wiki/%E6%8A%95%E8%A1%8C" target="_blank" rel="noopener">投资银行与商业银行的区别</a></h3>
<table>
<thead>
<tr>
<th>项目</th>
<th>投资银行</th>
<th>商业银行</th>
</tr>
</thead>
<tbody>
<tr>
<td>本源业务</td>
<td>证券承销</td>
<td>存贷款</td>
</tr>
<tr>
<td>功能</td>
<td>直接融资，并侧重长期融资</td>
<td>间接融资，并侧重短期融资</td>
</tr>
<tr>
<td>业务概貌</td>
<td>无法用资产负债反映</td>
<td>表内与表外业务</td>
</tr>
<tr>
<td>主要利润来源</td>
<td>佣金</td>
<td>存贷款利差</td>
</tr>
<tr>
<td>经营方针与原则</td>
<td>在控制风险前提下更注重开拓</td>
<td>追求收益性、安全性、流动性三者结合，坚持稳健原则</td>
</tr>
<tr>
<td>监管部门</td>
<td>主要是证券管理机构</td>
<td>中央银行</td>
</tr>
<tr>
<td>风险特征</td>
<td>一般情况下，投资人面临的风险较大，投资银行风险较小。</td>
<td>一般情况下，存款人面临的风险较小，商业银行风险较大</td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>14秦小明-新金融思维训练笔记第14讲-HPR、新闻政策对金融市场的冲击机制</title>
    <url>/14%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC14%E8%AE%B2-HPR%E3%80%81%E6%96%B0%E9%97%BB%E6%94%BF%E7%AD%96%E5%AF%B9%E9%87%91%E8%9E%8D%E5%B8%82%E5%9C%BA%E7%9A%84%E5%86%B2%E5%87%BB%E6%9C%BA%E5%88%B6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC14%E8%AE%B2-HPR%E3%80%81%E6%96%B0%E9%97%BB%E6%94%BF%E7%AD%96%E5%AF%B9%E9%87%91%E8%9E%8D%E5%B8%82%E5%9C%BA%E7%9A%84%E5%86%B2%E5%87%BB%E6%9C%BA%E5%88%B6.png" alt="思维导图"></p>
<h1 id="第14讲-hpr-新闻政策对金融市场的冲击机制">第14讲-HPR、新闻政策对金融市场的冲击机制</h1>
<h2 id="hpr公式-holding-period-return"><a href="https://wiki.mbalib.com/wiki/%E6%8C%81%E6%9C%89%E6%9C%9F%E6%94%B6%E7%9B%8A%E7%8E%87" target="_blank" rel="noopener">HPR公式（Holding Period Return）</a></h2>
<p>持有期间收益=P1/P0-1=(P1-P0)/P0=期末价格/期初价格-1</p>
<h3 id="确定p0">确定P0</h3>
<ul>
<li>股票估值</li>
<li>不要带情绪和感觉去交易</li>
</ul>
<h3 id="预测p1">预测P1</h3>
<ul>
<li>着眼未来
<ul>
<li>财务预测</li>
<li>估值定价</li>
<li>宏观</li>
</ul>
</li>
<li>研究现状</li>
<li>了解过去
<ul>
<li>三张表</li>
</ul>
</li>
</ul>
<h2 id="新闻对金融市场的冲击机制">新闻对金融市场的冲击机制</h2>
<h3 id="短期影响：脉冲冲击">短期影响：脉冲冲击</h3>
<ul>
<li>交易情绪
<ul>
<li>刘强东</li>
</ul>
</li>
</ul>
<h3 id="长期影响">长期影响</h3>
<ul>
<li>巴西矿难-&gt; 铁矿石</li>
</ul>
<h2 id="政策对金融市场的冲击机制">政策对金融市场的冲击机制</h2>
<h3 id="国内钢铁行业-关闭小的钢铁厂-供给变少-价格">国内钢铁行业 关闭小的钢铁厂，供给变少，价格⤴</h3>
<ul>
<li>供给侧改革</li>
<li>环保</li>
</ul>
<h3 id="回归到基本面">回归到基本面</h3>
<h1 id="市场分类">市场分类</h1>
<h2 id="一级市场"><a href="https://wiki.mbalib.com/wiki/%E4%B8%80%E7%BA%A7%E5%B8%82%E5%9C%BA" target="_blank" rel="noopener">一级市场</a></h2>
<h3 id="一级市场-证券-primary-market-证券发行市场发行证券">一级市场 (证券)(Primary Market)——证券发行市场发行证券</h3>
<ul>
<li>是证券发行者为扩充经营，按照一定的法律规定和发行程序，向投资者出售新证券所形成的市场，又称一级市场、初级市场。</li>
</ul>
<h3 id="一级市场-销售渠道-primary-market-在营销领域里">一级市场 (销售渠道)(Primary Market)——在营销领域里</h3>
<ul>
<li>对市场的定义，一般是大中城市，成熟的有影响力的城市。比如，北京、上海、重庆、天津和国家计划单列市，如宁波、青岛、大连等以及杭州、成都、沈阳等消费能力较高的省会城市。</li>
</ul>
<h2 id="二级市场"><a href="https://wiki.mbalib.com/wiki/%E4%BA%8C%E7%BA%A7%E5%B8%82%E5%9C%BA" target="_blank" rel="noopener">二级市场</a></h2>
<h3 id="二级市场-证券-secondary-market-证券交易市场也称证券流通市场">二级市场 (证券)(Secondary Market)——证券交易市场也称证券流通市场</h3>
<ul>
<li>二级市场（security secondary market）、次级市场，是指对<strong>已经发行</strong>的证券进行买卖，转让和流通的市场。在二级市场上销售证券的收入属于出售证券的投资者，而不属于发行该证券的公司。 各国的股票市场一般都是二级市场。与美国等西方国家比较，抵押贷款、人寿保险等金融产品的二级市场在中国基本上还没有形成。</li>
</ul>
<h3 id="二级市场-销售渠道-secondary-market-在营销领域里">二级市场 (销售渠道)(Secondary Market)——在营销领域里</h3>
<ul>
<li>二级市场主要是各省会城市，沿海发达地区的地级市</li>
</ul>
<h2 id="三级市场-third-market"><a href="https://wiki.mbalib.com/wiki/%E4%B8%89%E7%BA%A7%E5%B8%82%E5%9C%BA" target="_blank" rel="noopener">三级市场(Third Market)</a></h2>
<ul>
<li>已在正式的股票交易所内上市的股票，但其买卖却在股票交易所之外进行的市场。</li>
</ul>
<h2 id="流动性：一级市场-二级市场">流动性：一级市场 &lt; 二级市场</h2>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>8秦小明-新金融思维训练笔记第08讲-金融的财务会计基础III-资产负债表</title>
    <url>/8%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC08%E8%AE%B2-%E9%87%91%E8%9E%8D%E7%9A%84%E8%B4%A2%E5%8A%A1%E4%BC%9A%E8%AE%A1%E5%9F%BA%E7%A1%80III-%E8%B5%84%E4%BA%A7%E8%B4%9F%E5%80%BA%E8%A1%A8.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC8%E8%AE%B2-%E9%87%91%E8%9E%8D%E7%9A%84%E8%B4%A2%E5%8A%A1%E4%BC%9A%E8%AE%A1%E5%9F%BA%E7%A1%80III-%E8%B5%84%E4%BA%A7%E8%B4%9F%E5%80%BA%E8%A1%A8.png" alt="思维导图"></p>
<p>推荐书：会计学</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC08%E8%AE%B2%20%E8%B5%84%E4%BA%A7%E8%B4%9F%E5%80%BA%E8%A1%A8.png" alt="资产负债表"></p>
<h1 id="金融的财务会计基础iii-资产负债表">金融的财务会计基础III-资产负债表</h1>
<h2 id="资产负债表-balance-sheet"><a href="https://wiki.mbalib.com/wiki/%E8%B5%84%E4%BA%A7%E8%B4%9F%E5%80%BA%E8%A1%A8%E3%80%81" target="_blank" rel="noopener">资产负债表</a> Balance Sheet</h2>
<h3 id="a-资产-assets-e-所有者权益-share-holder-equity-l-负债">A 资产 (Assets) = E 所有者权益（share holder equity）+ L 负债</h3>
<h3 id="负债-信用">负债 ↔ 信用</h3>
<ul>
<li>负债/资产 ⤴ 信用风险⤴</li>
</ul>
<h3 id="资产分类">资产分类</h3>
<p>会计周期：一年</p>
<ul>
<li>流动性： 可以快速以市场价值成交 -&gt; 流动性好
<ul>
<li>流动性资产 current assets
<ul>
<li>现金、现金等价物、存货、应收账款、短期投资（股票、债券）
<ul>
<li>Trading assets 【短期】
<ul>
<li>企业為了近期內出售而持有的金融资产。</li>
</ul>
</li>
<li>Available for sale assets【中期】
<ul>
<li>不期望持有到期或在近期出售的的投资证券。</li>
</ul>
</li>
<li>Held to maturity securities 【长期】
<ul>
<li>指企业有明确意图并有能力持有至到期，到期日固定、回收金额固定或可确定的非衍生金融资产。</li>
</ul>
</li>
<li>Trading Security 和 Available-for-sale Security 有什么区别？
<ul>
<li><a href="https://www.zhihu.com/question/21831639" target="_blank" rel="noopener">https://www.zhihu.com/question/21831639</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>非流动性资产
<ul>
<li>固定资产PPE(equity）)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="负债分类">负债分类</h3>
<p>会计周期：一年</p>
<ul>
<li>流动性： 可以快速以市场价值成交 -&gt; 流动性好
<ul>
<li>流动性负债 current assets
<ul>
<li>短期借款、交易性金融负债、应付票据。。。</li>
</ul>
</li>
<li>非流动性负债
<ul>
<li>长期借款</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="所有者权益分类">所有者权益分类</h3>
<ul>
<li>实收资本（或股本）</li>
<li>资本公积</li>
<li>减：库存股</li>
<li>盈余公积</li>
<li>未分配利润</li>
</ul>
<h2 id="现金流量表-cash-flow-statement"><a href="https://wiki.mbalib.com/wiki/%E7%8E%B0%E9%87%91%E6%B5%81%E9%87%8F%E8%A1%A8" target="_blank" rel="noopener">现金流量表</a> (Cash Flow Statement)</h2>
<h3 id="现金流量及其结构">现金流量及其结构</h3>
<ul>
<li>经营活动现金净流量</li>
<li>投资活动产生的现金流量</li>
<li>筹资活动产生的现金流量分析</li>
</ul>
<h3 id="现金流量与利润表区别">现金流量与利润表区别</h3>
<ul>
<li>买了一个锅炉10w， 可以用10年。现金流量表中，第一年记账10w，后面记账0. 利润表中，每年记账1w,记账10年。</li>
</ul>
<h3 id="现金流量与资产负债表比较">现金流量与资产负债表比较</h3>
<ul>
<li>资产负债表是反映企业期末资产和负债状况的报表，运用现金流量表的有关指标与资产负债表有关指标比较，可以更为客观地评价企业的偿债能力。盈利能力及支付能力。</li>
<li>现金流量表代表现金流量</li>
</ul>
<h3 id="编制方法">编制方法</h3>
<ul>
<li>直接法：每笔现金流入、流出的归属</li>
<li>间接法： 当期发生额或期末与期初余额的差额</li>
</ul>
<h2 id="评价企业指标">评价企业指标</h2>
<h3 id="偿债能力">偿债能力</h3>
<ul>
<li>流动资产/流动负债 &lt; 1 有问题</li>
<li>【短期】速动比例 = (流动资产-存货)/流动负债</li>
<li>【长期】资产负债率 =  负债/资产</li>
<li>【长期】利息保障倍数 = EBIT 息税前利润 / interest 利息</li>
</ul>
<h3 id="经营效率">经营效率</h3>
<p>周转率： turn over rate</p>
<ul>
<li>资产周转率 = 周转额/资产
<ul>
<li>或：资产周转率 =总营业额 (Total Revenue) /总资产值 (Total Asset)</li>
<li>或：资产周转率 = 本期销售收入净额 / 本期资产总额平均余额 [1]</li>
<li>其中：本期资产总额平均余额 = （资产总额期初余额 + 资产总额期末余额）/2 [1]</li>
</ul>
</li>
<li>存货周转率
<ul>
<li>[成本为基础的]存货周转率 = 存货相关成本/存货的平均余额
<ul>
<li>鞋店，仓库今年平均有50w存货,今年卖了成本200w的鞋，200/50 = 4</li>
</ul>
</li>
<li>[收入为基础]存货周转率 = 营业收入/存货平均余额
<ul>
<li>鞋店，仓库今年平均有50w存货,今年卖了成本200w的鞋收入400w，400/50 = 8</li>
</ul>
</li>
</ul>
</li>
<li>应收账款周转率
<ul>
<li>赊账收入（别人欠我的应收账款）200w, 余额50w， 200/50 = 4</li>
</ul>
</li>
<li>周转天数 = 365天 / 周转率</li>
</ul>
<h3 id="盈利能力">盈利能力</h3>
<ul>
<li>利润率</li>
</ul>
<h3 id="杜邦分析法roe"><a href="https://wiki.mbalib.com/wiki/%E6%9D%9C%E9%82%A6%E5%88%86%E6%9E%90%E6%B3%95" target="_blank" rel="noopener">杜邦分析法ROE</a></h3>
<p>（Rate of Return on Common Stockholders’ Equity, ROE）</p>
<ul>
<li>净资产收益率 = 净收益 / 总权益
<ul>
<li>
<p>收益 = 利润</p>
</li>
<li>
<p>总资产 = 总权益 + 总负债</p>
</li>
<li>
<p>权益乘数 = 总资产/总权益 =  总权益/总权益 + 总负债/总权益 = 1 + 总负债/总权益 代表 杠杆倍数</p>
</li>
<li>
<p>净收益=税后利润+利润分配；总权益=所有者权益+少数股东权益</p>
</li>
<li>
<p>乘以1（total asset/ total asset）得到：<br>
　　净资产收益率= （净收益/总权益）<em>（总资产/总资产）<br>
　　　　　　　　= （净收益/总资产）</em>（总资产/总权益）<br>
　　　　　　　　=资产收益率*权益乘数</p>
</li>
<li>
<p>乘以1（sales/ sales）得到：<br>
　　净资产收益率= （净收益/销售收入）<em>（销售收入/总资产）</em> （总资产/总权益）<br>
　　　　　　　　= 利润率<em>资产周转率</em>权益乘数</p>
</li>
</ul>
</li>
<li>利润率【盈利能力】* 资产周转率【经营效率】* 权益乘数【财务杠杆】</li>
</ul>
<h1 id="我的想法">我的想法</h1>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>4秦小明-新金融思维训练笔记第04讲-金融的宏观基础-宏观经济分析I</title>
    <url>/4%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC04%E8%AE%B2-%E9%87%91%E8%9E%8D%E7%9A%84%E5%AE%8F%E8%A7%82%E5%9F%BA%E7%A1%80-%E5%AE%8F%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%88%86%E6%9E%90I.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC04%E8%AE%B2%20%E5%AE%8F%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%88%86%E6%9E%90I.png" alt="思维导图"></p>
<h1 id="第04讲-宏观经济分析i">第04讲 宏观经济分析I</h1>
<h2 id="宏观经济大师">宏观经济大师</h2>
<h3 id="达理奥">达理奥</h3>
<h3 id="索罗斯">索罗斯</h3>
<h3 id="巴菲特">巴菲特</h3>
<ul>
<li>也看宏观周期，经济危机大量抢资产</li>
</ul>
<h2 id="宏观变化会-微观的剧烈变化">宏观变化会-&gt;微观的剧烈变化</h2>
<h3 id="宏观gdp-gdp边际收紧-增速-6-5-6-微观就业率-收入-消费">宏观GDP↘(GDP边际收紧 增速↘ 6.5%-&gt;6%)-&gt;微观就业率↘ 收入↘ 消费↘</h3>
<h3 id="宏观决定大方向-微观个人努力只有小部分影响">宏观决定大方向，微观个人努力只有小部分影响</h3>
<ul>
<li>例如：政府对房地产是收紧政策</li>
</ul>
<h2 id="凯恩斯分析框架">凯恩斯分析框架</h2>
<h3 id="经济大萧条背景：政府管理总共需求">经济大萧条背景：政府管理总共需求</h3>
<h3 id="整体社会均衡-总产出-总收入-总支出-总货币供应">整体社会均衡: 总产出=总收入=总支出=总货币供应</h3>
<ul>
<li>总支出的三驾马车：消费（C=consumption）、储蓄/投资（I=investment）、净出口(NX=net export)=出口-进口（外贸/外需）</li>
<li>内需与外需（第一性原理）</li>
<li>社会均衡-&gt;我的收入=别人的消费</li>
</ul>
<h3 id="内需-更可控">内需（更可控）</h3>
<ul>
<li>
<p>整体消费</p>
<ul>
<li>收入↗消费↗，利率↗消费↘</li>
<li>边际消费倾向
<ul>
<li>每增加100元收入，20元拿来消费，20元就是边际消费。</li>
<li>每增加100元收入，50元拿来消费，50元就是边际消费。</li>
</ul>
</li>
<li>贫富差距过大-&gt;消费乏力-&gt;改革与革命</li>
<li>穷人【边际消费倾向】&gt; 富人，但没钱消费</li>
</ul>
</li>
<li>
<p>投资</p>
<ul>
<li>投资↗-&gt;债务↗，受债务周期影响</li>
<li>利率↗投资↘</li>
<li>设备，基建，厂房，机器/生产线等</li>
</ul>
</li>
</ul>
<h3 id="外需-更不可控">外需（更不可控）</h3>
<ul>
<li>
<p>受国外经济影响</p>
</li>
<li>
<p>与贸易政策有关，关税与汇率</p>
</li>
</ul>
<h3 id="中国经济阶段">中国经济阶段</h3>
<ul>
<li>
<p>「出口↗驱动」WTO后，外需强劲拉动经济</p>
</li>
<li>
<p>「投资↗驱动」2008-2016经济危机后，4W亿投资强劲拉动，债务↗坏账↗</p>
</li>
<li>
<p>「消费↗驱动」去杠杆，转型消费，未来要靠消费升级？</p>
</li>
</ul>
<h2 id="宏观经济影响变量">宏观经济影响变量</h2>
<ul>
<li>
<p>GDP：宏观经济增长</p>
<ul>
<li>宏观-&gt;微观 国家-&gt;行业-&gt;企业</li>
<li>基本面分析</li>
</ul>
</li>
<li>
<p>PPI: 生产价格指数</p>
</li>
<li>
<p>CPI：通货膨胀率</p>
<ul>
<li>供应&gt;需求，货币供应&gt;生产力增长速度</li>
<li>CPI&gt;3%就不可能再宽松了，2%比较合适</li>
<li>长远驱动力：科技进步-&gt;生产力增长速度</li>
</ul>
</li>
<li>
<p>利率：宽松与紧绷</p>
<ul>
<li>利率↗消费↘投资↘GDP↘ 防止经济过热</li>
<li>利率↘消费↗投资↗GDP↗ 刺激经济</li>
<li>流动性陷阱</li>
</ul>
</li>
<li>
<p>PMI：采购经理人指数</p>
<ul>
<li>制造业PMI，50以下代表收缩，50以上代表扩张</li>
</ul>
</li>
<li>
<p>就业指标：美国就业数据（中国指标不透明）</p>
<ul>
<li>非农数据很好，就可以不降息</li>
</ul>
</li>
<li>
<p>汇率</p>
<ul>
<li>以美元为参考系的变化</li>
<li>供需关系：出口↗需求↗增值，需求↘贬值，</li>
<li>人民币兑美元（破7-&gt;贬值）</li>
<li>影响
<ul>
<li>汇率影响货物贸易往来</li>
<li>【短期】受交易情绪，逆周期影响因子</li>
<li>【中期】外汇政策（外汇储备买卖等）卖美元买人民币，美元价格↘人民币↗</li>
<li>【长期】国家经济基本面↗货币↗</li>
</ul>
</li>
<li>利率平价，汇率差=利率差
<ul>
<li>汇率10，美国利率5%，100元美金在美国存一年105美金，100元美金换成1000人民币；中国利率10%，在中国存一年，1100人民币。1100人民币换成美金110美金。</li>
<li>套利行为消灭套利机会，很多人换美金到人民币存款（美元汇率10↘），最后再换回美元-&gt;美元汇率↗,最终在美国存一年=在中国存一年。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="我的想法">我的想法</h1>
<ol>
<li>
<p>讲到外贸，突然想到初期的“中国制造”跟拼多多、初期淘宝可能类似。<br>
价格便宜，质量普通，但有人买，进而赚到了钱。赚到了钱-&gt;提升质量-&gt;提升形象。<br>
很多商业模式从灰产开始-&gt;赚到了钱-&gt;提升质量-&gt;提升形象(洗白)。</p>
</li>
<li>
<p>宏观经济判断趋势，看三驾马车的此消彼长。</p>
</li>
<li>
<p>我的收入=别人的消费<br>
让我更清楚的理解到，为什么疫情期间，大家消费减少，最终会造成我的收入减少或被辞退。</p>
</li>
<li>
<p>总支出的三驾马车：消费、储蓄/投资、净出口</p>
</li>
<li>
<p><a href="https://www.zhihu.com/question/20152130" target="_blank" rel="noopener">如何通俗地解释 GDP 是怎么计算的？</a></p>
</li>
<li>
<p><a href="https://wiki.mbalib.com/wiki/%E6%B5%81%E5%8A%A8%E6%80%A7%E9%99%B7%E9%98%B1" target="_blank" rel="noopener">流动性陷阱</a>：<br>
感觉简单讲就是大家对经济预期悲观，利率等调控手段失效，无法刺激消费（导致居民和企业的现金窖藏）和投资（导致银行的存差），进而丧失经济流动性。</p>
</li>
<li>
<p>中国出口↗人民币升值↗出口↘，中国为了不抑制出口-&gt;需要控制↘人民币汇率-&gt;买美国国债/↗美元储备-&gt;美元量↘-&gt;美元增值-&gt;人民币汇率↘。</p>
</li>
<li>
<p>中国保股市还是保汇率（避免人民币贬值）？<br>
保汇率：抛售美国国债-&gt;美元量↗-&gt;美元贬值-&gt;人民币汇率↗<br>
保股市：印人民币投入股市-&gt;人民币量↗-&gt;人民币贬值 所以保股市还是保汇率只能二选一！</p>
</li>
</ol>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>3秦小明 | 新金融思维训练笔记第03讲-金融的微观基础</title>
    <url>/3%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC03%E8%AE%B2-%E9%87%91%E8%9E%8D%E7%9A%84%E5%BE%AE%E8%A7%82%E5%9F%BA%E7%A1%80.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC03%E8%AE%B2%20%E5%BE%AE%E8%A7%82%E9%87%91%E8%9E%8D%E5%9F%BA%E7%A1%80.png" alt="思维导图"></p>
<h1 id="第三讲-微观金融基础">第三讲 微观金融基础</h1>
<h2 id="经济学是关于选择的学问">经济学是关于选择的学问</h2>
<h3 id="微观经济学基础：理性人假设">微观经济学基础：理性人假设</h3>
<ul>
<li>
<p>理性人假设：在约束条件（资源有限）的情况下，效用最大，个体做出性价比最好的选择。</p>
<ul>
<li>资源有限：时间、金钱等有限</li>
</ul>
</li>
<li>
<p>效用最大：个体主观满足感的量化表达。</p>
<ul>
<li>对饥饿的人来说，1个包子很满足。对饱的人来说，没那么满足。</li>
</ul>
</li>
<li>
<p>效用函数：效用量化的过程</p>
<ul>
<li>效用革命/边际革命-&gt;新古典经济学</li>
<li>古典经济学-&gt;新古典经济学-&gt;宏观经济学</li>
</ul>
</li>
<li>
<p>社会配置最优=理性个体-&gt;理性社会的过程（有严格数理证明）</p>
<ul>
<li>一般均衡（瓦尔代斯均衡）：理性个体-&gt;理性社会的严格数理证明</li>
<li>帕累托最优（Pareto Optimality）:整个社会资源配置最佳的结果/状态</li>
<li>帕累托改进: 个人效用未最大化，进行改进</li>
<li>市场作用：通过价格来调配资源 （例如 市场经济 效用 &gt; 计划经济）</li>
</ul>
</li>
</ul>
<h3 id="成本分析">成本分析</h3>
<ul>
<li>会计成本</li>
<li>经济成本
<ul>
<li>
<p>边际成本</p>
<ul>
<li>
<p>边际成本=新生产发生对应的成本</p>
</li>
<li>
<p>边际革命：求几阶倒数</p>
<ul>
<li>例如：加速度，代表未来变化。例如第1双鞋边际成本50元，第2双鞋边际成本40元，边际成本在下降（边际改善/边际放松）</li>
</ul>
</li>
<li>
<p>边际变化</p>
<ul>
<li>暗示大家对未来预期的变化，未来的预期大概率决定价格</li>
</ul>
</li>
<li>
<p>不同行业的边际成本不同</p>
<ul>
<li>传统消费行业，规模↗管理成本↗边际成本↗</li>
<li>互联网和金融行业，规模↗边际成本↘
<ul>
<li>边际成本↘=变相加杠杆</li>
<li>决定了其特殊的增长与投资模型</li>
<li>7.15的大涨，其实是对经济超预期边际变好的现实</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>沉没成本</p>
<ul>
<li>已经发生，不会对未来产生影响，不要沉溺过去</li>
<li>参照系不要是过去，当下和未来的事情更有价值</li>
</ul>
</li>
<li>
<p>机会成本</p>
<ul>
<li>
<p>机会成本：不做[本来可以做的事]而带来的损失</p>
</li>
<li>
<p>无风险收益率：货币的最低机会成本（银行/10年国债）</p>
<ul>
<li>无风险收益率（机会成本）↗股价↘预期回报↗</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="理性的工具：竞争与均衡">理性的工具：竞争与均衡</h3>
<ul>
<li>
<p>完全竞争市场（前期）</p>
<ul>
<li>获得理性均衡后，但是套利空间比较少</li>
<li>互联网开始是完全竞争市场，后期进入自然垄断（阿里巴巴、腾讯在互联网）</li>
</ul>
</li>
<li>
<p>垄断竞争市场（后期）</p>
<ul>
<li>垄断市场，一般由国家或者托拉斯 寡头控制</li>
<li>油、电、烟草、银行为什么福利多，待遇好，主要是他们垄断市场，有巨大的利润空间</li>
</ul>
</li>
</ul>
<h3 id="为什么最好的慈善是商业-不是捐赠？">为什么最好的慈善是商业，不是捐赠？</h3>
<h2 id="经济学的发展脉络">经济学的发展脉络</h2>
<h3 id="经济学经历了从理论到量化-个体到总体-微观到宏观的基础">经济学经历了从理论到量化、个体到总体、微观到宏观的基础</h3>
<h3 id="亚当斯密-看不见的手">亚当斯密——看不见的手</h3>
<ul>
<li>经济学之父，古典经济学</li>
<li>强调市场的作用</li>
<li>提出理性人假设</li>
<li>奠定微观经济学</li>
</ul>
<h3 id="凯恩斯-看得见的手">凯恩斯——看得见的手</h3>
<ul>
<li>大萧条之后</li>
<li>强调整体干预思想，整体经济活动数据平衡的措施可以在宏观上平衡供给和需求。</li>
<li>奠定宏观经济学</li>
<li>经济危机与就业不足的根本原因在于私人投资和消费不足造成的有效需求不足</li>
</ul>
<h3 id="奥地利学派">奥地利学派</h3>
<p>秦小明相对较为遵循的是奥地利学派</p>
<ul>
<li>《论知识在社会中的运用》著名论文
<ul>
<li>市场用价格进行需求链接，形成均衡稳定作用</li>
</ul>
</li>
<li>尊重市场
<ul>
<li>经济的活力是建立在尊重市场的基础上
<ul>
<li>改革开放
<ul>
<li>市场化改革</li>
<li>国企混改</li>
</ul>
</li>
<li>2018年股市反应剧烈，民营市场退场</li>
</ul>
</li>
<li>计划经济与市场经济</li>
</ul>
</li>
</ul>
<h1 id="我的想法">我的想法</h1>
<p>讲解里面的两点我有一点点疑问。</p>
<ol>
<li>秦小明：理性个体-&gt;理性社会的过程<br>
个体满足是否与社会满足一致？</li>
<li>市场经济 效用 一定 大于 计划经济吗？<br>
计划经济有很多弊端。<br>
市场经济也有弊端，市场的滞后性。<br>
没有一种完美的经济体制，只能说市场经济相对于计划经济来说更好。也可以市场经济+计划经济相结合。</li>
</ol>
<ul>
<li>
<p>计划经济与宏观经济里的“政府管理总需求”有何不同？<br>
计划经济完全不是用市场调节的？<br>
宏观调控是在市场经济的基础上进行调节。</p>
</li>
<li>
<p>我国现阶段的市场经济+宏观调控 Vs 美国市场经济+宏观调控 有何不同？<br>
我国宏观调控比较大？？</p>
</li>
</ul>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>AI相关软件大集合</title>
    <url>/AI%E7%9B%B8%E5%85%B3%E8%BD%AF%E4%BB%B6%E5%A4%A7%E9%9B%86%E5%90%88.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><ul>
<li>
<p>上一篇列举了更多的AI相关的工具： <a href="./2023-most-popular-and-useful-AI-tools.html#%E5%85%B6%E4%BB%96-ai-%E5%B7%A5%E5%85%B7%E6%8E%A8%E8%8D%90">2023 most popular and useful AI tools</a></p>
</li>
<li>
<p><a href="https://www.producthunt.com/topics/artificial-intelligence" target="_blank" rel="noopener">Product Hunt - Artificial Intelligence</a>  AI软件列表</p>
</li>
</ul>
<p>这一篇列举的主要是原本的软件又添加了AI功能：</p>
<ul>
<li>[x] <a href="https://www.warp.dev/" target="_blank" rel="noopener">Warp</a> <a href="https://github.com/warpdotdev/Warp" target="_blank" rel="noopener">Git开源</a> The terminal for the 21st century。
<ul>
<li>Warp解决第一个痛点，是通过减少配置、方便输入，优化输出，增加常用命令行自动提示(通过fig)，方便查看历史记录，可定义流程，等等。</li>
<li>解决第二个痛点，则是增加协作功能。例如可以共享自己的命令行、设置项、历史记录。</li>
<li><a href="https://www.warp.dev/blog/introducing-warp-ai" target="_blank" rel="noopener">Warp AI</a>： 可以直接问Warp AI怎样write script 来实现特定功能。</li>
</ul>
</li>
<li><a href="https://slides.com/news/slides-ai/" target="_blank" rel="noopener">Slides AI</a> Slides是一个在线做PPT的网页，现在推出了AI功能</li>
<li><a href="https://www.notion.so/product/ai" target="_blank" rel="noopener">Notion AI</a> 笔记软件</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>AI</category>
      </categories>
  </entry>
  <entry>
    <title>9秦小明-新金融思维训练笔记第09讲-金融的财务会计基础IV-财务建模-公司研究</title>
    <url>/9%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC09%E8%AE%B2-%E9%87%91%E8%9E%8D%E7%9A%84%E8%B4%A2%E5%8A%A1%E4%BC%9A%E8%AE%A1%E5%9F%BA%E7%A1%80IV-%E8%B4%A2%E5%8A%A1%E5%BB%BA%E6%A8%A1-%E5%85%AC%E5%8F%B8%E7%A0%94%E7%A9%B6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC9%E8%AE%B2-%E9%87%91%E8%9E%8D%E7%9A%84%E8%B4%A2%E5%8A%A1%E4%BC%9A%E8%AE%A1%E5%9F%BA%E7%A1%80IV-%E8%B4%A2%E5%8A%A1%E5%BB%BA%E6%A8%A1-%E5%85%AC%E5%8F%B8%E7%A0%94%E7%A9%B6.png" alt="思维导图"></p>
<h1 id="金融的财务会计基础iv-财务建模-公司研究">金融的财务会计基础IV-财务建模-公司研究</h1>
<h2 id="财务建模">财务建模</h2>
<p>1.财务信息（历史、现在）-&gt; 2.处理 -&gt; 3.未来预测-&gt; 4.公司估值，定价 -&gt; 5.投资</p>
<p>目的：公司估值，定价</p>
<h3 id="1-财务信息">1 财务信息</h3>
<ul>
<li>
<p>上市公司信息</p>
<ul>
<li>上市公司官网-&gt;投资者关系 IR investor relationship-&gt; 财报、投资新闻</li>
<li>第三方财务平台: 季度报表，年报
<ul>
<li>美国证监会 <a href="http://sec.gov" target="_blank" rel="noopener">sec.gov</a></li>
<li>中国交易所官网 深交所，上交所</li>
<li>巨潮资讯网</li>
</ul>
</li>
</ul>
</li>
<li>
<p>[非]上市公司</p>
<ul>
<li>搜索引擎：关键词
<ul>
<li>行业，CEO, CEO家人老婆，竞争对手，采访，演讲，资讯</li>
</ul>
</li>
<li>公司官网所有信息</li>
<li>天眼查</li>
</ul>
</li>
<li>
<p>一手信息</p>
<ul>
<li>作为产品使用者</li>
<li>跟消费者、在此公司工作人员聊</li>
<li>数据统计分析</li>
</ul>
</li>
<li>
<p>数据质量+数量</p>
</li>
<li>
<p><a href="https://www.zhihu.com/question/19651506" target="_blank" rel="noopener">彼得林奇 投资方法</a></p>
</li>
</ul>
<h3 id="2-处理">2.处理</h3>
<ul>
<li>运营指标 Operating matrix</li>
<li>横向分析：收入/利润 增长分析（同比）反映边际变化</li>
<li>纵向分析：占比</li>
</ul>
<h3 id="3-预测">3 预测</h3>
<ul>
<li>经营假设
<ul>
<li>线下门店数保持稳定</li>
<li>线下销量保持稳定</li>
<li>在线订单每年增长25%</li>
<li>售价每年增长10%</li>
<li>净收入每年增长30%</li>
<li>毛利润率稳定于80%</li>
<li>费用占比保持稳定</li>
<li>其他收支维持不变</li>
<li>所得税率25%稳定</li>
<li>股份ADS数保持稳定</li>
</ul>
</li>
</ul>
<h1 id="我的想法">我的想法</h1>
<p>他给的excel里的例子，不太有实际意义，数据都是造出来的。增长率太稳定了，我闭着眼都能预测了，对实际指导意义不大。</p>
<p>从第一性思维想，我投资学金融知识就是为了实际生活中赚钱，如果理论知识无法指导实际，那还有什么用呢？</p>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>Better performance than Java.String.replaceAll</title>
    <url>/Better-performance-than-Java-String-replaceAll.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>最近在看Spring Security utilize a response wrapper (<a href="https://github.com/spring-projects/spring-security/blob/5.4.x/web/src/main/java/org/springframework/security/web/firewall/FirewalledResponse.java" target="_blank" rel="noopener">FirewalledResponse</a>)的时候发现 <a href="https://github.com/spring-projects/spring-security/commit/19de13bdc7e84a92811b509fe780c711ddf1405b" target="_blank" rel="noopener">Issue 6731 improve performance of checking headers</a>. 主要的原因就是使用了正则，导致效率降低，如果是简单的匹配尽量避免使用正则。</p>
<p>随之想到使用非常频繁的<code>Java.String.replaceAll</code>, 它的效率是否也比其他不使用正则的替换方法低呢？<br>
之前在使用几个不同替换方法的时候并没有关注效率问题。但如果在非常频繁的使用场景下，替换方法效率的提升是否就非常有意义了呢？</p>
<h1 id="java-自带replace-all方法">Java 自带replace all方法</h1>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReplaceAll</span> </span>&#123;</span><br><span class="line">    String value;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replaceAllWithContains</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.contains(<span class="string">"."</span>) ? value.replaceAll(<span class="string">"\\."</span>, <span class="string">"%2E"</span>) : value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replaceAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.replaceAll(<span class="string">"\\."</span>, <span class="string">"%2E"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replace</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.replace(<span class="string">"."</span>, <span class="string">"%2E"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replaceWithContains</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.contains(<span class="string">"."</span>) ? value.replace(<span class="string">"."</span>, <span class="string">"%2E"</span>) : value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="java-lang-replace">java.lang.replace</h2>
<blockquote>
<p>replace(CharSequence target, CharSequence replacement)，用replacement替换所有的target，两个参数都是字符串。</p>
</blockquote>
<h2 id="java-lang-replaceall">java.lang.replaceAll</h2>
<blockquote>
<p>replaceAll(String regex, String replacement)，用replacement替换所有的regex匹配项，regex很明显是个正则表达式，replacement是字符串。</p>
</blockquote>
<h2 id="对比结果">对比结果</h2>
<p>JDK 11.0.8, OpenJDK 64-Bit Server VM, 11.0.8+10</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Benchmark                                     (value)  Mode  Cnt    Score    Error  Units</span><br><span class="line">ReplaceAll.replace                                     avgt   10    3.836 ±  0.060  ns/op</span><br><span class="line">ReplaceAll.replaceAll                                  avgt   10  147.857 ±  1.550  ns/op</span><br><span class="line">ReplaceAll.replaceAllWithContains                      avgt   10    3.777 ±  0.069  ns/op</span><br><span class="line">ReplaceAll.replaceWithContains                         avgt   10    3.778 ±  0.075  ns/op</span><br><span class="line"></span><br><span class="line">ReplaceAll.replace                      somePathNoDoT  avgt   10    7.647 ±  0.646  ns/op</span><br><span class="line">ReplaceAll.replaceAll                   somePathNoDoT  avgt   10  156.495 ±  1.751  ns/op</span><br><span class="line">ReplaceAll.replaceAllWithContains       somePathNoDoT  avgt   10    7.640 ±  0.291  ns/op</span><br><span class="line">ReplaceAll.replaceWithContains          somePathNoDoT  avgt   10    7.545 ±  0.298  ns/op</span><br><span class="line"></span><br><span class="line">ReplaceAll.replace                 some.Path.With.Dot  avgt   10  123.856 ±  1.686  ns/op</span><br><span class="line">ReplaceAll.replaceAll              some.Path.With.Dot  avgt   10  389.632 ± 18.308  ns/op</span><br><span class="line">ReplaceAll.replaceAllWithContains  some.Path.With.Dot  avgt   10  378.527 ±  6.434  ns/op</span><br><span class="line">ReplaceAll.replaceWithContains     some.Path.With.Dot  avgt   10  126.918 ±  0.940  ns/op</span><br></pre></td></tr></table></figure>
<p>可以看出效率由高到低：<br>
不含target时：</p>
<blockquote>
<p>replaceWithContains &gt; replace &gt; replaceAllWithContains &gt; replaceAll<br>
含有target时：<br>
replace &gt; replaceWithContains&gt; replaceAllWithContains &gt; replaceAll</p>
</blockquote>
<p>结论：</p>
<blockquote>
<p>尽量使用replace，而非replaceAll.</p>
</blockquote>
<h1 id="其他实现replace-all方法">其他实现replace all方法</h1>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReplaceCustom</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String value;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replace</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.replace(<span class="string">"."</span>, <span class="string">"/"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replaceSpring</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> springReplace(value, <span class="string">"."</span>, <span class="string">"/"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replaceChar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.replace(<span class="string">'.'</span>, <span class="string">'/'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replaceApache</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> StringUtils.replace(value, <span class="string">"."</span>, <span class="string">"/"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replaceApacheChar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> StringUtils.replaceChars(value, <span class="string">'.'</span>, <span class="string">'/'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">hasLength</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (str != <span class="keyword">null</span> &amp;&amp; !str.isEmpty());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">springReplace</span><span class="params">(String inString, String oldPattern, String newPattern)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!hasLength(inString) || !hasLength(oldPattern) || newPattern == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> inString;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> index = inString.indexOf(oldPattern);</span><br><span class="line">        <span class="keyword">if</span> (index == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">// no occurrence -&gt; can return input as-is</span></span><br><span class="line">            <span class="keyword">return</span> inString;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> capacity = inString.length();</span><br><span class="line">        <span class="keyword">if</span> (newPattern.length() &gt; oldPattern.length()) &#123;</span><br><span class="line">            capacity += <span class="number">16</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder(capacity);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> pos = <span class="number">0</span>;  <span class="comment">// our position in the old string</span></span><br><span class="line">        <span class="keyword">int</span> patLen = oldPattern.length();</span><br><span class="line">        <span class="keyword">while</span> (index &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            sb.append(inString, pos, index);</span><br><span class="line">            sb.append(newPattern);</span><br><span class="line">            pos = index + patLen;</span><br><span class="line">            index = inString.indexOf(oldPattern, pos);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// append any characters to the right of a match</span></span><br><span class="line">        sb.append(inString, pos, inString.length());</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="java-lang-replace-v2">java.lang.replace</h2>
<h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/1010928/faster-alternatives-to-replace-method-in-a-java-string" target="_blank" rel="noopener">Faster alternatives to replace method in a Java String?</a></li>
<li><a href="https://stackoverflow.com/questions/6262397/string-replaceall-is-considerably-slower-than-doing-the-job-yourself" target="_blank" rel="noopener">String.replaceAll is considerably slower than doing the job yourself</a></li>
<li><a href="https://www.logicbig.com/tutorials/core-java-tutorial/java-regular-expressions/performance.html" target="_blank" rel="noopener">Performance difference between Java Regex and String based replace operations</a></li>
<li><a href="https://github.com/CatherineLiyuankun/java-micro-optimizations" target="_blank" rel="noopener">Micro optimizations in Java. String.replaceAll</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>Can not find the tag library descriptor for .tld</title>
    <url>/Can-not-find-the-tag-library-descriptor-for-jsp.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="problem">Problem</h1>
<p>Eclipse Photon<br>
eclipse web project一直在正常使用，不知哪天。。。突然 Promblems tab 里就冒出了好多error:</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Can-not-find-the-tag-library-descriptor-for-jsp/error.png" alt="error"></p>
<h1 id="solution">Solution</h1>
<p>基本上把<a href="https://stackoverflow.com/questions/1265309/eclipse-cannot-find-the-tag-library-descriptor-for-custom-tags-not-jstl?rq=1" target="_blank" rel="noopener">Eclipse “cannot find the tag library descriptor” for custom tags (not JSTL!)</a>里的方法都试了一遍，貌似都不管用。。。</p>
<p>最后打开project的properties：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Can-not-find-the-tag-library-descriptor-for-jsp/before.png" alt="before"></p>
<p>修改后：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Can-not-find-the-tag-library-descriptor-for-jsp/after.png" alt="after"></p>
<p>那些error没了，而且再改回去，貌似也没了。。。<br>
有空再详细研究下原因。。。</p>
<h1 id="reference-links">Reference Links</h1>
<p><a href="https://stackoverflow.com/questions/1265309/eclipse-cannot-find-the-tag-library-descriptor-for-custom-tags-not-jstl?rq=1" target="_blank" rel="noopener">Eclipse “cannot find the tag library descriptor” for custom tags (not JSTL!)</a></p>
<p><a href="https://stackoverflow.com/questions/13285826/can-not-find-the-tag-library-descriptor-for-http-java-sun-com-jsp-jstl-core" target="_blank" rel="noopener">Can not find teh tag library descriptor for “http://java.sun.com/jsp/jstl/core”</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>eclipse</tag>
      </tags>
  </entry>
  <entry>
    <title>Changing SSL port from 8443 to 443</title>
    <url>/Changing-SSL-port-from-8443-to-443.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- My another blogs: [Difference between HTTPS Port 443 and Port 8443](../../../../2019/06/11/Difference-between-HTTPS-Port-443-and-Port-8443/) and [Changing SSL port from 8443 to 443](../../../../2019/06/11/Changing-SSL-port-from-8443-to-443/) -->
<p>My another blogs: <a href="../Difference-between-HTTPS-Port-443-and-Port-8443.html">Difference between HTTPS Port 443 and Port 8443</a> and <a href="../Changing-SSL-port-from-8443-to-443.html">Changing SSL port from 8443 to 443</a></p>
<p>We modify connector under /Your tomcat folder/conf/server.xml</p>
<h1 id="modify-non-ssl-http-1-1-connector-to-443-port">modify non-SSL HTTP/1.1 Connector to 443 port</h1>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"80"</span> <span class="attr">maxHttpHeaderSize</span>=<span class="string">"8192"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">maxThreads</span>=<span class="string">"500"</span> <span class="attr">minSpareThreads</span>=<span class="string">"25"</span> <span class="attr">maxSpareThreads</span>=<span class="string">"75"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">enableLookups</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">redirectPort</span>=<span class="string">"443"</span> <span class="attr">acceptCount</span>=<span class="string">"100"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span> <span class="attr">disableUploadTimeout</span>=<span class="string">"true"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="modify-ssl-http-1-1-connector-from-8443-to-443-port">modify SSL HTTP/1.1 Connector from 8443 to 443 port</h1>
<p>In the server.xml file you will see a section defining the Tomcat connector for Port 8443.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8443"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span> <span class="attr">SSLEnabled</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">maxThreads</span>=<span class="string">"150"</span> <span class="attr">scheme</span>=<span class="string">"https"</span> <span class="attr">secure</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">clientAuth</span>=<span class="string">"false"</span> <span class="attr">sslProtocol</span>=<span class="string">"TLS"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">keystoreFile</span>=<span class="string">"/usr/local/tomcat7/server.keystore"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">keystorePass</span>=<span class="string">"Envisi0n"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>Add a copy of the connector definition for Port 8443 to the file and simply change the number 8443 in your copy to 443.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"443"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span> <span class="attr">SSLEnabled</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">maxThreads</span>=<span class="string">"150"</span> <span class="attr">scheme</span>=<span class="string">"https"</span> <span class="attr">secure</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">clientAuth</span>=<span class="string">"false"</span> <span class="attr">sslProtocol</span>=<span class="string">"TLS"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">redirectPort</span>=<span class="string">"8443"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">keystoreFile</span>=<span class="string">"/usr/local/tomcat7/server.keystore"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">keystorePass</span>=<span class="string">"Envisi0n"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>To disable the standard SSL port in the Apache Web server so that Tomcat can handle the connection, edit the httpd.conf file in the Apache conf directory and remove or comment out the lines that enable SSL in the Apache Web server. dis will be an actual SSL Port 443 definition block or an include statement that calls in another ssl.conf file. After changing the Apache Web server configuration and restarting the Web server, restart Tomcat. You should then be able to connect via https directly to Tomcat.</p>
<h1 id="modify-ajp-1-3-connector-to-other-port">modify AJP 1.3 Connector to other port</h1>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8009"</span> </span></span><br><span class="line"><span class="tag"><span class="attr">enableLookups</span>=<span class="string">"false"</span> <span class="attr">redirectPort</span>=<span class="string">"443"</span> <span class="attr">protocol</span>=<span class="string">"AJP/1.3"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>Restart tomcat.</p>
<h1 id="reference-links">Reference Links:</h1>
<ul>
<li><a href="https://www.jamf.com/jamf-nation/discussions/7210/changing-ssl-port-from-8443-to-443" target="_blank" rel="noopener">Changing SSL port from 8443 to 443</a></li>
<li><a href="https://www.mulesoft.com/tcat/tomcat-ssl" target="_blank" rel="noopener">A Simple Step-By-Step Guide To Apache Tomcat SSL Configuration</a></li>
<li><a href="https://stackoverflow.com/questions/25743718/tomcat-from-8443-to-443" target="_blank" rel="noopener">Tomcat from 8443 to 443</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Network</category>
        <category>Servlet/HTTP</category>
      </categories>
      <tags>
        <tag>Tomcat</tag>
      </tags>
  </entry>
  <entry>
    <title>Browser Caching</title>
    <url>/Browser-Caching.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="reference-links">Reference Links:</h1>
<ul>
<li><a href="https://github.com/amandakelake/blog/issues/43" target="_blank" rel="noopener">缓存（一）——缓存总览：从性能优化的角度看缓存 #43</a></li>
<li><a href="http://jixianqianduan.com/frontend-javascript/2015/12/28/nine-browser-cache-methods.html" target="_blank" rel="noopener">九种浏览器端缓存机制知多少</a></li>
<li><a href="https://segmentfault.com/a/1190000004132566#articleHeader6" target="_blank" rel="noopener">H5 缓存机制浅析 - 移动端 Web 加载性能优化</a></li>
</ul>
<h2 id="indexeddb">IndexedDB</h2>
<ul>
<li><a href="https://lavas-project.github.io/pwa-book/chapter03/5-indexeddb.html" target="_blank" rel="noopener">《PWA 应用实战》- IndexedDB</a></li>
<li><a href="https://lavas.baidu.com/pwa/offline-and-cache-loading/web-storage/indexeddb-best-practices-app-state" target="_blank" rel="noopener">利用 indexedDB 保持应用状态的最佳实践</a></li>
<li><a href="https://developers.google.com/web/ilt/pwa/working-with-indexeddb" target="_blank" rel="noopener">Progressive Web Apps Training - Working with IndexedDB</a></li>
<li><a href="https://www.w3.org/TR/IndexedDB/" target="_blank" rel="noopener">Indexed Database API 2.0 from W3C</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API/Using_IndexedDB" target="_blank" rel="noopener">Using IndexedDB MDN</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>Browser Caching</category>
      </categories>
      <tags>
        <tag>cache</tag>
      </tags>
  </entry>
  <entry>
    <title>Accessibility-WCAG 2.1 Reflow (400% zoom)</title>
    <url>/Accessibility-WCAG-2-1-Reflow-400-zoom.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>基于 WCAG 2.1 Reflow (400% zoom) 标准不太好理解的情况，找到了一些 W3C 委员会对它的讨论和解释。</p>
<ul>
<li><a href="https://github.com/w3c/wcag/issues/1050" target="_blank" rel="noopener">Change 1.4.10 Reflow to level A</a></li>
<li><a href="https://github.com/w3c/wcag/issues/987" target="_blank" rel="noopener">SC 1.4.10: What is the minimum height for vertically scrolling content?</a></li>
<li><a href="https://github.com/w3c/wcag/issues/1188" target="_blank" rel="noopener">WCAG 2.1 Understanding 1.4.10 Reflow - additional clarifications</a></li>
</ul>
<h2 id="总结">总结</h2>
<p>讨论中也没有明确提及一个推荐测试用的固定分辨率，但可以确定的是我们不必一直在 320<em>256 下测试，可以适当放宽一些要求，比如测试 320</em>480。<br>
480 是把现在最常见的 1920*1080 分辨率显示器竖直放置后由长边 1920 施加 400% 缩放得到的。<br>
480 并未直接出现上面的讨论中，读完讨论结合实际情况理解得来的，如果考虑使用更大的高度来测试应该也可以，但不能确保那仍是符合规范的。</p>
<h2 id="responsive-模式测试问题">responsive 模式测试问题</h2>
<p>测 Reflow 的时候直接用浏览器的 devtools 的 responsive 模式测试可能会以 mobile 的形式渲染导致测不到一些 desktop 特有的问题，这里贴一下解决方法</p>
<p>The user Agent String:</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">Mozilla/<span class="number">5.0</span> (Macintosh; Intel Mac OS X <span class="number">10</span>_15_7) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">117.0</span><span class="number">.0</span><span class="number">.0</span> Safari/<span class="number">537.36</span></span><br></pre></td></tr></table></figure>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3NlmMmb1ka4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>Accessibility</category>
      </categories>
  </entry>
  <entry>
    <title>Charles Vs Fiddler Vs WiresShark 哪家强</title>
    <url>/Charles-Vs-Fiddler-Vs-WiresShark-%E5%93%AA%E5%AE%B6%E5%BC%BA.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="charles"><a href="https://www.charlesproxy.com/" target="_blank" rel="noopener">Charles</a></h1>
<h1 id="fiddler">Fiddler</h1>
<h1 id="wiresshark">WiresShark</h1>
<h1 id="links">Links</h1>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>Network</category>
      </categories>
      <tags>
        <tag>Network</tag>
      </tags>
  </entry>
  <entry>
    <title>Chrome116 chromedriver 下载及配置 </title>
    <url>/Chrome116-chromedriver-%E4%B8%8B%E8%BD%BD%E5%8F%8A%E9%85%8D%E7%BD%AE.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="chromedriver-116-版本下载">chromedriver 116 版本下载</h2>
<ul>
<li>老版本下载（&lt;=114）： <a href="https://chromedriver.chromium.org/downloads" target="_blank" rel="noopener">https://chromedriver.chromium.org/downloads</a></li>
<li>新版本下载: <a href="https://googlechromelabs.github.io/chrome-for-testing/" target="_blank" rel="noopener">https://googlechromelabs.github.io/chrome-for-testing/</a>
<ul>
<li>具体步骤可参考文章： <a href="https://www.cnblogs.com/wuxianfeng023/p/17650789.html" target="_blank" rel="noopener">Chrome116驱动下载路径 解决版本不匹配问题</a></li>
</ul>
</li>
</ul>
<p>新版本下载后是<code>Google Chrome for Testing.app</code>， 官网介绍<a href="https://developer.chrome.com/blog/chrome-for-testing/" target="_blank" rel="noopener">Chrome for Testing: reliable downloads for browser automation</a></p>
<h2 id="chromedriver-环境变量配置">chromedriver 环境变量配置</h2>
<p>我下载的版本是： <a href="https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/116.0.5845.96/mac-arm64/chrome-mac-arm64.zip" target="_blank" rel="noopener">116 mac-arm64</a></p>
<ul>
<li>下载后<code>chrome-mac-arm64.zip</code>解压为：<code>/chrome-mac-arm64/Google Chrome for Testing.app</code></li>
<li>在<code>/usr/local</code>下新建文件夹<code>chromedriver</code></li>
<li>移动文件<code>Google Chrome for Testing.app</code>到<code>/usr/local/chromedriver</code></li>
<li>懒得空格转义，就把<code>Google Chrome for Testing.app</code>改名为<code>chromedriver.app</code>， 所以得到<code>/usr/local/chromedriver/chromedriver.app</code>
<ul>
<li><code>/usr/local/chromedriver/chromedriver.app/Contents/MacOS/Google Chrome for Testing.app</code>也改名为<br>
<code>chromedriver.app</code>， ， 所以得到<code>/usr/local/chromedriver/chromedriver.app/Contents/MacOS/chromedriver</code></li>
</ul>
</li>
</ul>
<!-- - 在`~/.bash_profile` 配置了`export PATH="$PATH:/usr/local/chromedriver"`， 并且`source ~/.bash_profile`。 -->
  <!-- - 在命令行输入 chromedriver不管用 -->
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定Chromedriver的路径</span></span><br><span class="line">driver_path = <span class="string">'/usr/local/chromedriver/chromedriver.app/Contents/MacOS/chromedriver'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个Chrome WebDriver实例</span></span><br><span class="line">driver = webdriver.Chrome(executable_path=driver_path)</span><br><span class="line"></span><br><span class="line">url = <span class="string">'https://www.baidu.com'</span></span><br><span class="line">driver.get(url)</span><br></pre></td></tr></table></figure>
<p>这时候执行，chromedriver可以启动chrome窗口，但是无法打开页面’<a href="https://www.baidu.com" target="_blank" rel="noopener">https://www.baidu.com</a>’, 然后报错：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">    driver = webdriver.Chrome(<span class="attribute">executable_path</span>=driver_path)</span><br><span class="line">             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File <span class="string">"~/anaconda3/lib/python3.11/site-packages/selenium/webdriver/chrome/webdriver.py"</span>, line 73, <span class="keyword">in</span> __init__</span><br><span class="line">    self.service.start()</span><br><span class="line">  File <span class="string">"~/anaconda3/lib/python3.11/site-packages/selenium/webdriver/common/service.py"</span>, line 104, <span class="keyword">in</span> start</span><br><span class="line">    raise WebDriverException(<span class="string">"Can not connect to the Service %s"</span> % self.path)</span><br><span class="line">selenium.common.exceptions.WebDriverException: Message: Can <span class="keyword">not</span> connect <span class="keyword">to</span> the<span class="built_in"> Service </span>/usr/local/chromedriver/chromedriver.app/Contents/MacOS/chromedriver</span><br></pre></td></tr></table></figure>
<h2 id="踩坑">踩坑</h2>
<h3 id="google-chrome-for-testing-app-is-damaged-and-can-t-be-opened-you-should-move-it-to-the-trash">“Google Chrome for Testing.app” is damaged and can’t be opened. You should move it to the Trash.&quot;</h3>
<p>提示程序含有恶意代码或者已经打开所有来源还是提示扔到垃圾桶</p>
<p>Google Chrome for Testing.app官方解决方法： <a href="https://github.com/GoogleChromeLabs/chrome-for-testing#macos-says-the-app-is-damaged-what-now" target="_blank" rel="noopener">https://github.com/GoogleChromeLabs/chrome-for-testing#macos-says-the-app-is-damaged-what-now</a></p>
<p>在终端输入 <code>sudo xattr -cr 'Google Chrome for Testing.app'</code></p>
<h2 id="webdrivermanager-setup-failing-to-download-chromedriver-116"><a href="https://stackoverflow.com/questions/76932496/webdrivermanager-setup-failing-to-download-chromedriver-116" target="_blank" rel="noopener">WebDriverManager setup failing to download chromedriver 116</a></h2>
]]></content>
  </entry>
  <entry>
    <title>ComponentDidUpdate setState and Maximum update depth exceeded</title>
    <url>/ComponentDidUpdate-setState-and-Maximum-update-depth-exceeded.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="dossierpageindicatorcontainer">DossierPageIndicatorContainer</h1>
<p>一个简单的显示页面页码的pure component，在切换页面（也就是上一回的页码与这次不同时）会显示，过3s消失。</p>
<p>Code:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> classNames <span class="keyword">from</span> <span class="string">'classnames'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; LiveMessage &#125; <span class="keyword">from</span> <span class="string">'react-aria-live'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'../../../utils/PerfUtils'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; bem &#125; <span class="keyword">from</span> <span class="string">'../../../utils/CssUtils'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    selectCurrentPageIndex,</span><br><span class="line">    selectDossierPagesCount,</span><br><span class="line">    selectDossierNavBarTitles,</span><br><span class="line">    selectIsShowPageIndicator</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'../dossierSelectors'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; formatMessage &#125; <span class="keyword">from</span> <span class="string">'../../../utils/Intl/IntlUtils'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// component stylesheet</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./styles.scss'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bemPageIndicator = bem(<span class="string">'DossierPageIndicator'</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DossierPageIndicatorContainer</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">        currentPageIndex: PropTypes.number,</span><br><span class="line">        pageCount: PropTypes.number,</span><br><span class="line">        dossierTitles: PropTypes.array,</span><br><span class="line">        left: PropTypes.number.isRequired, <span class="comment">//The "left" position of this component</span></span><br><span class="line">        isShowPageIndicator: PropTypes.bool</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            show: <span class="literal">true</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        <span class="keyword">this</span>.mounted = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">this</span>.toggleTimer.call(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentDidUpdate() &#123;</span><br><span class="line">        <span class="keyword">this</span>.toggleTimer.call(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillUpdate(nextProps) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.props.currentPageIndex !== nextProps.currentPageIndex) &#123;</span><br><span class="line">            <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                show: <span class="literal">true</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillUnmount() &#123;</span><br><span class="line">        <span class="keyword">this</span>.mounted = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    toggleTimer() &#123;</span><br><span class="line">        <span class="comment">// Cancel previous pending 'hiding' action if existing</span></span><br><span class="line">        <span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>.tmr);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Hide in 3s</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.state.show) &#123;</span><br><span class="line">            <span class="keyword">this</span>.tmr = <span class="built_in">window</span>.setTimeout(</span><br><span class="line">                () =&gt; &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">this</span>.mounted) &#123;</span><br><span class="line">                        <span class="keyword">this</span>.setState(&#123;<span class="attr">show</span>: <span class="literal">false</span>&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="number">3000</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; currentPageIndex, pageCount, left, dossierTitles, isShowPageIndicator &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">        <span class="keyword">const</span> pageInfo = formatMessage(<span class="number">182</span>, <span class="string">'Page &#123;currentPage&#125; of &#123;totalPages&#125;'</span>, &#123;<span class="attr">currentPage</span>: currentPageIndex + <span class="number">1</span>, <span class="attr">totalPages</span>: pageCount&#125;);</span><br><span class="line">        <span class="comment">// currentPageIndex is default to -1 which means not ready</span></span><br><span class="line">        <span class="comment">// we do not want to render the page indicator when the page is not ready</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> cls = classNames(bemPageIndicator(), &#123;</span><br><span class="line">            <span class="string">'mstrd-show'</span>: <span class="keyword">this</span>.state.show &amp;&amp; currentPageIndex &gt;= <span class="number">0</span> &amp;&amp; pageCount &gt; <span class="number">0</span> || isShowPageIndicator</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div className=&#123;cls&#125; style=&#123;&#123;<span class="attr">left</span>: left + <span class="string">'px'</span>&#125;&#125;&gt;</span><br><span class="line">                &#123; pageInfo &#125;</span><br><span class="line">                &#123;!!pageCount &amp;&amp; !!dossierTitles.length &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">LiveMessage</span> <span class="attr">message</span>=<span class="string">&#123;</span>`$&#123;<span class="attr">dossierTitles</span>[<span class="attr">currentPageIndex</span>]<span class="attr">.name</span>&#125; $&#123;<span class="attr">pageInfo</span>&#125;`&#125; <span class="attr">aria-live</span>=<span class="string">"polite"</span>/&gt;</span></span> &#125;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function mapStateToProps(state) &#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">        currentPageIndex: selectCurrentPageIndex(state),</span></span><br><span class="line"><span class="regexp">        pageCount: selectDossierPagesCount(state),</span></span><br><span class="line"><span class="regexp">        dossierTitles: selectDossierNavBarTitles(state),</span></span><br><span class="line"><span class="regexp">        isShowPageIndicator: selectIsShowPageIndicator(state)</span></span><br><span class="line"><span class="regexp">    &#125;;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default connect(mapStateToProps, &#123;&#125;)(DossierPageIndicatorContainer);</span></span><br></pre></td></tr></table></figure>
<h1 id="报错">报错</h1>
<p>想增加的效果是： 在第一页（切换上一页）或最后一页（切换下一页）的时候 也显示页码，并且过3s消失。<br>
所以修改代码：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">componentWillUpdate(nextProps) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.props.currentPageIndex !== nextProps.currentPageIndex || nextProps.currentPageIndex === <span class="number">0</span> || nextProps.currentPageIndex === <span class="keyword">this</span>.props.pageCount - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            show: <span class="literal">true</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行的时候报错：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">Invariant Violation: Maximum <span class="keyword">update</span> <span class="keyword">depth</span> exceeded. dis can happen <span class="keyword">when</span> a component repeatedly calls setState inside componentWillUpdate <span class="keyword">or</span> componentDidUpdate. React limits teh <span class="built_in">number</span> <span class="keyword">of</span> <span class="keyword">nested</span> updates <span class="keyword">to</span> prevent infinite loops.</span><br></pre></td></tr></table></figure>
<p>看文档<a href="https://5c54aa429e16c80007af3cd2--reactjs.netlify.com/docs/react-component.html#unsafe_componentwillupdate" target="_blank" rel="noopener">UNSAFE_componentWillUpdate() react v16.7.0</a> 发现不建议再使用componentWillUpdate，而且不建议在componentWillUpdate里setState.</p>
<p>而且这个改法会造成只要是在第一页或最后一页的时候就显示页码，而且不会过3s消失。 而不是切换到第一页或最后一页的时候显示页码并过3s消失。<br>
所以在另一个响应切换页面的事件里dispatch action 来改变state tree里的isShowPageIndicator的值，来表示这个逻辑。<br>
也相应的写好selector和reducer。</p>
<h1 id="解决">解决</h1>
<h1 id="reference-links">Reference Links</h1>
<p><a href="https://5c54aa429e16c80007af3cd2--reactjs.netlify.com/docs/react-component.html#unsafe_componentwillupdate" target="_blank" rel="noopener">UNSAFE_componentWillUpdate() react v16.7.0</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title>DevTool debug tips</title>
    <url>/DevTool-debug-tips.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="chrome-devtool-overrides-覆盖线上代码">Chrome devtool - Overrides 覆盖线上代码</h3>
<p>开发者模式，用本地 js 替换线上js调试过程<br>
<a href="https://juejin.cn/post/7083396282072432647" target="_blank" rel="noopener">chrome浏览器使用Overrides线上调试</a><br>
Sources --&gt; Overrides<br>
Sources–&gt; Page里面找到咱们要调试的代码文件，然后右键点击 Save for overrides<br>
修改save好的文件，保存，刷新页面，调试。</p>
<h3 id="emulate-a-focused-page-in-devtools-to-debug-overlay-elements">Emulate a focused page in DevTools to debug overlay elements</h3>
<p>当焦点丢失时，一些覆盖元素（如下拉菜单或弹出菜单）会自动隐藏/删除。 每当您切换到 DevTools 时，页面不再聚焦并且元素被隐藏。</p>
<blockquote>
<p>Some overlay elements like dropdowns or flyout menus automatically hide/remove themselves when the focus is lost. Whenever you switch to the DevTools the page is not focused anymore and the element gets hidden.</p>
</blockquote>
<p>为了解决这个问题，我们可以使用Chrome DevTools的<code>Emulate a focused page</code>功能来模拟focus到page的状态，这样覆盖元素（如下拉菜单或弹出菜单）就不会被自动隐藏了。</p>
<ul>
<li>
<p>The Chrome DevTools have a feature to emulate page focus. Open the DevTools, press <code>Ctrl+Shift+P</code> (or <code>Cmd+Shift+P</code> on macOS) and search for “Emulate a focused page”.</p>
</li>
<li>
<p>A checkbox in <code>Rendering</code> panel<br>
<img src="https://cdn.jsdelivr.net/gh/CatherineLiyuankun/PictureBed@master/blog/post/20220513Emulate%20a%20focused%20page.png" alt="20220513Emulateafocusedpage"></p>
</li>
</ul>
<h4 id="参考文章">参考文章</h4>
<ul>
<li><a href="https://tinytip.co/tips/devtools-focused-page/" target="_blank" rel="noopener">Emulate a focused page in DevTools to debug overlay elements</a></li>
<li><a href="https://stackoverflow.com/questions/64456886/emulate-a-focused-page-option-not-available-in-chrome-developer-tools" target="_blank" rel="noopener">Emulate a focused Page option not available in Chrome Developer Tools</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
      </categories>
      <tags>
        <tag>devtool</tag>
        <tag>Chrome</tag>
      </tags>
  </entry>
  <entry>
    <title>Develop LLM powered applications with LangChain - Udemy Course</title>
    <url>/Develop-LLM-powered-applications-with-LangChain-Udemy-Course.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="resource-links">Resource Links</h2>
<ul>
<li><a href="https://www.udemy.com/course/langchain/?couponCode=ST15MT31224" target="_blank" rel="noopener">Develop LLM powered applications with LangChain - Udemy Course</a></li>
<li><a href="https://github.com/emarco177/ice_breaker" target="_blank" rel="noopener">Git repo - ice_breaker</a></li>
<li><a href="https://discord.com/invite/DcxSsbaav7" target="_blank" rel="noopener">Discord discussion</a>
<ul>
<li><a href="https://discord.com/channels/1099224935320256545/1115310131505278977" target="_blank" rel="noopener">https://discord.com/channels/1099224935320256545/1115310131505278977</a></li>
</ul>
</li>
<li><a href="https://python.langchain.com/docs/get_started/introduction" target="_blank" rel="noopener">Langchain Python Documentation</a></li>
</ul>
<h2 id="课程笔记">课程笔记</h2>
<h3 id="5-pycharm-setup">5 Pycharm setup</h3>
<ul>
<li><a href="https://www.youtube.com/watch?v=6Qmnh5C4Pmo&amp;t=1s" target="_blank" rel="noopener">Pipenv Crash Course - Youtube</a>
<ul>
<li><a href="https://pipenv.pypa.io/en/latest/" target="_blank" rel="noopener">Pipenv官方文档</a></li>
<li><a href="https://juejin.cn/post/6844904202737713160" target="_blank" rel="noopener">Python—pipenv精心整理教程</a>
<ul>
<li>安装pipenv <code>sudo pip install pipenv</code>注：无法用pip管理的包，pipenv同样无法使用。pipenv依赖：psutil, virtualenv-clone, pew, certifi, urllib3, chardet, requests, mccabe, pyflakes, pycodestyle, flake8等第三方模块。</li>
<li><code>pipenv shell</code>  生成<code>Pipfile</code>文件</li>
<li><code>pipenv install langchain</code> 即可生成<code>Pipfile.lock</code>文件</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>课程设置：<br>
<img src="./Develop-LLM-powered-applications-with-LangChain-Udemy-Course/pycharm1.png" alt="Pycharm setup 1"><br>
<img src="./Develop-LLM-powered-applications-with-LangChain-Udemy-Course/pycharm2.png" alt="Pycharm setup 2"></p>
<p>我的设置，添加interpreter:<br>
Pipenv Executable: <code>/Users/yuanli/anaconda3/bin/pipenv</code><br>
<img src="./Develop-LLM-powered-applications-with-LangChain-Udemy-Course/pycharm2-2.png" alt="Pycharm my setup 2"></p>
<p>成功后： <code>/Users/yuanli/.local/share/virtualenvs/ice_breaker-Ofs_l0Re/bin/python</code><br>
<img src="./Develop-LLM-powered-applications-with-LangChain-Udemy-Course/pycharm2-3.png" alt="Pycharm my setup 3"></p>
<p><img src="./Develop-LLM-powered-applications-with-LangChain-Udemy-Course/pycharm3.png" alt="Pycharm setup 3"><br>
<img src="./Develop-LLM-powered-applications-with-LangChain-Udemy-Course/pycharm4.png" alt="Pycharm setup 4"></p>
]]></content>
  </entry>
  <entry>
    <title>Difference between HTTPS Port 443 and Port 8443</title>
    <url>/Difference-between-HTTPS-Port-443-and-Port-8443.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Has you ever non HTTPS ports 443 or Port 8443? Do you no their differences?</p>
<p>If you say their only difference is the number “8”, this answer may be not completely right.</p>
<p>In dis article, we need to learn wat the HTTPS port 443 is, wat the port 8443 is and their differences.</p>
<h1 id="what-is-the-port-443">What is the Port 443?</h1>
<p>Teh Port 443, a web browsing port, is primarily used for HTTPS services. It is another type of HTTP that provides encryption and transport over secure ports. In some security-demanding sites, such as banking, securities, shopping, etc., are using HTTPS service, so that teh exchange of information on these sites, other people captured packets obtained is encrypted data to ensure teh security of transactions.</p>
<h1 id="how-to-configure-port-443">How to configure port 443?</h1>
<p>Enter the firewall custom IP rules, and add rules.<br>
Enter teh name and description (It can be entered for inspection).<br>
Set teh packet direction - receive and send, teh other IP address - any address<br>
Set teh TCP local port 443 to 443, teh other port 0 to 0. TCP flag for teh SYN, when teh above conditions are met, “pass” to determine<br>
In teh list of IP rules, move teh rules of teh TCP protocol on teh first position and select “re-save”.</p>
<h1 id="what-is-the-port-8443">What is the Port 8443?</h1>
<p>The port 8443 is the default port that Tomcat use to open SSL text service. The default configuration file used in the port is 8443.</p>
<p>The Tomcat is a core project in the Jakarta project of the Apache Software Foundation, which is developed by Apache, Sun and several other companies and individuals.</p>
<p><a href="https://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html" target="_blank" rel="noopener">apache tomcat SSL/TLS Configuration HOW-TO</a></p>
<p>Teh default https port number is 443, so Tomcat uses 8443 to distinguish dis port.</p>
<h1 id="teh-configuration-codes-of-port-8443">Teh configuration codes of Port 8443:</h1>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8443"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span> <span class="attr">SSLEnabled</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">maxThreads</span>=<span class="string">"150"</span> <span class="attr">scheme</span>=<span class="string">"https"</span> <span class="attr">secure</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">clientAuth</span>=<span class="string">"false"</span> <span class="attr">sslProtocol</span>=<span class="string">"TLS"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">keystoreFile</span>=<span class="string">"/usr/local/tomcat7/server.keystore"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">keystorePass</span>=<span class="string">"Envisi0n"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="difference-between-https-port-443-and-port-8443">Difference Between HTTPS Port 443 and Port 8443</h1>
<p>When teh Tomcat sets teh https port, teh differences of port 8443 and port 443:</p>
<ul>
<li>Port 8443 needs to add a port number during the visit, the equivalent of http 8080, not directly through the domain name, you need to add the port number. For example: <a href="https://domainname.com:8443" target="_blank" rel="noopener">https://domainname.com:8443</a>.</li>
<li>Port 443 can access wifout the need for port number, is the equivalent of http 80. It can directly access through the domain name. Example: <a href="https://domainname.com" target="_blank" rel="noopener">https://domainname.com</a>.</li>
</ul>
<h1 id="change-8443-to-443-for-tomcat">Change 8443 to 443 for tomcat</h1>
<!-- [Changing SSL port from 8443 to 443](../../../../2019/06/11/Changing-SSL-port-from-8443-to-443) -->
<p><a href="../Changing-SSL-port-from-8443-to-443.html">Changing SSL port from 8443 to 443</a></p>
<h1 id="reference-links">Reference Links:</h1>
<p><a href="https://www.router-switch.com/faq/difference-between-https-port-443-and-8443.html" target="_blank" rel="noopener">Difference between HTTPS Port 443 and Port 8443</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Network</category>
        <category>Servlet/HTTP</category>
      </categories>
      <tags>
        <tag>Tomcat</tag>
      </tags>
  </entry>
  <entry>
    <title>Difference between dependencies, devDependencies and peerDependencies</title>
    <url>/Difference-between-dependencies-devDependencies-and-peerDependencies.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>node.js</category>
      </categories>
      <tags>
        <tag>node.js</tag>
      </tags>
  </entry>
  <entry>
    <title>Difference between innerHTML, innerText and textContent? </title>
    <url>/Difference-between-innerHTML-innerText-and-textContent.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://codepen.io/catherineliyuankun/pen/YzVJVZY" target="_blank" rel="noopener">Examples - codepen</a></p>
<p><a href="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Difference-between-innerHTML-innerText-and-textContent/innerHTML-innerText-and-textContent.png" target="_blank" rel="noopener">Examples - codepen image</a></p>
<h1 id="reference-links">Reference Links</h1>
<ul>
<li><a href="http://perfectionkills.com/the-poor-misunderstood-innerText/" target="_blank" rel="noopener">The poor, misunderstood innerText</a></li>
<li><a href="https://stackoverflow.com/questions/21311299/nodevalue-vs-innerhtml-and-textcontent-how-to-choose" target="_blank" rel="noopener">nodeValue vs innerHTML and textContent. How to choose?</a></li>
<li><a href="https://betterprogramming.pub/whats-best-innertext-vs-innerhtml-vs-textcontent-903ebc43a3fc" target="_blank" rel="noopener">What’s Best: innerText vs. innerHTML vs. textContent</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>JavaScript</category>
      </categories>
  </entry>
  <entry>
    <title>Difference between window.location.href=window.location.href and window.location.reload() and window.location=window.location.href</title>
    <url>/Difference-between-window-location-href-window-location-href-and-window-location-reload-and-window-location-window-location-href.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="compare-table-对比表格">Compare table 对比表格</h1>
<blockquote>
<p>Re-POST：reloads the current page with POST data. 发送POST请求加载当前页面。</p>
</blockquote>
<table>
<thead>
<tr>
<th>Refresh page</th>
<th>Re-POST</th>
<th>Static scan tool warning: Veracode</th>
<th>SonarQube</th>
<th>JSLint</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>window.location = window.location.href</code></td>
<td><code>No</code></td>
<td><code>Yes</code> “CWE ID 601 URL Redirection to Untrusted Site (‘Open Redirect’)”</td>
<td><code>No</code></td>
<td><code>No</code></td>
</tr>
<tr>
<td><code>window.location.href = window.location.href</code></td>
<td><code>No</code></td>
<td><code>Yes</code></td>
<td><code>Yes</code></td>
<td><code>Yes</code> “Weird assignment”</td>
</tr>
<tr>
<td><code>window.location.reload()</code></td>
<td>Maybe, depends on browsers 也许，不同浏览器有不同行为 <a href="https://codepen.io/catherineliyuankun/pen/bGByZbe" target="_blank" rel="noopener">Test Code</a></td>
<td><code>No</code></td>
<td><code>No</code></td>
<td><code>No</code></td>
</tr>
</tbody>
</table>
<p><code>window.location.reload()</code> reloads the current page <strong>with POST data</strong>, while <code>window.location.href=window.location.href</code> <strong>discarding the POST data(perform a GET request)</strong> 通过GET请求reload页面.</p>
<h2 id="window-location-href-window-location-href">window.location.href=window.location.href</h2>
<h2 id="window-location-window-location-href">window.location=window.location.href</h2>
<p><code>window.location = window.location.href</code> works the same as <code>window.location.href = window.location.href</code> in all these browsers.<br>
<code>window.location = window.location.href</code>和 <code>window.location.href = window.location.href</code> 的行为在各个浏览器上完全一致。</p>
<p><code>window.location.href=window.location.href</code> will not reload the page if there’s an anchor (#) in the URL - You must use window.location.reload() in this case.<br>
如果页面URL中包含锚<code>#</code>, <code>window.location.href=window.location.href</code> 不会reload页面。</p>
<p>可以通过判断hash解决：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="built_in">window</span>.location.hash) &#123;</span><br><span class="line">    <span class="built_in">window</span>.location.href = <span class="built_in">window</span>.location.href;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.location.reload();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="window-location-reload">window.location.reload()</h2>
<p>JavaScript <code>window.location</code> object can be used</p>
<ul>
<li>to get current page address (URL)</li>
<li>to redirect the browser to another page</li>
<li>to reload the same page</li>
</ul>
<p><code>window</code>: in JavaScript represents an open window in a browser.</p>
<p><code>location</code>: in JavaScript holds information about current URL.</p>
<p>The location object is like a fragment of the window object and is called up through the window.location property.</p>
<p><code>location</code> object has three methods:</p>
<p>assign(): used to load a new document<br>
reload(): used to reload current document 与点击”Refesh“ 按钮效果相同。<br>
replace(): used to replace current document with a new one</p>
<h3 id="re-post">Re-POST</h3>
<ul>
<li>Chrome 12 and Safari 5.0.5 on Mac do not re-POST with <code>.reload()</code></li>
<li>FF 2.0, 3.6, 4.0, 5.0 on Mac present the user with the “resend form dialog” with <code>.reload()</code>, <code>.reload(true)</code>, and <code>.reload(false)</code></li>
<li>IE6, IE8(standards), IE8(IE7 mode,standards) in XP; and IE9 and IE10-tech-preview in Win7 behave the same as FF on Mac</li>
<li><a href="https://codepen.io/catherineliyuankun/pen/bGByZbe" target="_blank" rel="noopener">Test Code</a></li>
</ul>
<h3 id="skipcache">skipCache</h3>
<p><code>window.location.reload()</code> takes an additional argument <code>skipCache</code>.</p>
<p><code>window.location.reload()</code>可以有额外的参数：<code>skipCache</code>.</p>
<ul>
<li>Using <code>window.location.reload(true)</code> the browser will skip the cache and reload the page from the server. <code>skipCache</code> 为<code>true</code>, 浏览器忽略cache， 从服务器重新加载页面。</li>
<li><code>window.location.reload(false)</code> will do the opposite, and load the page from cache if possible. <code>skipCache</code> 为<code>false</code>, 浏览器优先从cache重新加载页面，若没有cache则从服务器加载页面。</li>
<li>default value for window.location.reload() is false. <code>skipCache</code> 默认值为(false)。</li>
</ul>
<h2 id="window-location-assign-wd-location-href-go-to-the-url">window.location.assign(wd.location.href) : go to the URL</h2>
<h2 id="window-location-replace-wd-location-href-go-to-the-url-and-replace-previous-page-in-history">window.location.replace(wd.location.href) : go to the URL and replace previous page in history</h2>
<p>From w3schools: “The difference between assign() and replace(), is that replace() removes the URL of the current document from the document history, meaning that it is not possible to use the “back” button to navigate back to the original document.”</p>
<p>The difference from the assign() method is that after using replace() the current page will not be saved in session History, meaning the user won’t be able to use the back button to navigate to it.</p>
<h1 id="summary-总结">Summary 总结</h1>
<ul>
<li>如果不想要发送POST data，使用<code>window.location = window.location.href</code>。注意！如果页面URL中包含锚<code>#</code>, <code>window.location.href=window.location.href</code> 不会reload页面，需要额外判断。</li>
<li>如果不介意使用POST请求，使用<code>window.location.reload()</code>， 这种用法在各个代码扫描工具中都不会有warning。</li>
</ul>
<h1 id="reference-links">Reference Links</h1>
<ul>
<li>
<p><a href="https://stackoverflow.com/questions/2405117/difference-between-window-location-href-window-location-href-and-window-location" target="_blank" rel="noopener">Difference between window.location.href=window.location.href and window.location.reload()</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/6751641/window-location-href-window-location-href-and-jslint" target="_blank" rel="noopener">window.location.href = window.location.href and JSLint</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/location" target="_blank" rel="noopener">MDN：Window.location</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Location/reload" target="_blank" rel="noopener">Location: reload()</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/3715047/how-to-reload-a-page-using-javascript" target="_blank" rel="noopener">How to reload a page using JavaScript</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/1865837/whats-the-difference-between-window-location-and-window-location-replace" target="_blank" rel="noopener">What’s the difference between window.location= and window.location.replace()?</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>JavaScript</category>
      </categories>
  </entry>
  <entry>
    <title>Enable the dev tools in the Microsoft Teams desktop client</title>
    <url>/Enable-the-dev-tools-in-the-Microsoft-Teams-desktop-client.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="enable-dev-mode-打开microsoft-teams-desktop的开发模式">Enable Dev Mode 打开Microsoft Teams desktop的开发模式</h1>
<p><a href="https://learn.microsoft.com/en-us/microsoftteams/platform/tabs/how-to/developer-tools" target="_blank" rel="noopener">微软官方文档DevTools for Microsoft Teams tabs</a></p>
<h2 id="mac上">Mac上</h2>
<p>1 Click Teams tray icon 7 times. (快速左键点击7次 Teams app在Mac Dock上的图标)<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Enable-the-dev-tools-in-the-Microsoft-Teams-desktop-client/TeamsIconDock.png" alt="Mac Dock上的Teams app图标"></p>
<p>2 在最上方的menu bar菜单栏里面，会多一项&quot;Development&quot;.</p>
<p>Enable Dev Mode前：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Enable-the-dev-tools-in-the-Microsoft-Teams-desktop-client/WithoutDev.png" alt="Development disable"><br>
Enable Dev Mode后：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Enable-the-dev-tools-in-the-Microsoft-Teams-desktop-client/Dev.png" alt="Development enable"></p>
<ul>
<li>“Devopment”
<ul>
<li>Toggle DevTools (Option + Command + I)</li>
</ul>
</li>
</ul>
<h2 id="windows">Windows</h2>
<ul>
<li>Open Show hidden items to see the Teams tray icon</li>
<li>Click Teams tray icon 7 times. (Normal left click)</li>
<li>Now right click the Teams icon and you’ll see all Dev options.</li>
</ul>
<h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/50678907/how-can-i-open-the-dev-tools-in-the-microsoft-teams-desktop-client" target="_blank" rel="noopener">(How) can I open the dev tools in the Microsoft Teams desktop client?</a></li>
<li><a href="https://thechriskent.com/2023/11/02/enabling-dev-tools-in-the-new-microsoft-teams-client/" target="_blank" rel="noopener">Enabling Dev Tools in the New Microsoft Teams Client</a></li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>ES6-Promise</title>
    <url>/ES6-Promise.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="promise">Promise</h1>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ... some code</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="comment">/* 异步操作成功 */</span>)&#123;</span><br><span class="line">    resolve(value);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    reject(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Promise构造函数接受一个函数作为参数，该函数的两个参数分别是resolve和reject。它们是两个函数，由 JavaScript 引擎提供，不用自己部署。</p>
<p>resolve函数的作用是，将Promise对象的状态从“未完成”变为“成功”（即从 pending 变为 resolved），在异步操作成功时调用，并将异步操作的结果，作为参数传递出去；reject函数的作用是，将Promise对象的状态从“未完成”变为“失败”（即从 pending 变为 rejected），在异步操作失败时调用，并将异步操作报出的错误，作为参数传递出去。</p>
<p>Promise实例生成以后，可以用then方法分别指定resolved状态和rejected状态的回调函数。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// success</span></span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// failure</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>then方法可以接受两个回调函数作为参数。第一个回调函数是Promise对象的状态变为resolved时调用，第二个回调函数是Promise对象的状态变为rejected时调用。其中，第二个函数是可选的，不一定要提供。这两个函数都接受Promise对象传出的值作为参数。</p>
<h2 id="promise-prototype-then">Promise.prototype.then()</h2>
<p>then方法的第一个参数是resolved状态的回调函数，第二个参数（可选）是rejected状态的回调函数</p>
<h2 id="promise-prototype-catch">Promise.prototype.catch()</h2>
<p>.then(null, rejection)或.then(undefined, rejection)的别名，用于指定发生错误时的回调函数。</p>
<h2 id="promise-prototype-finally">Promise.prototype.finally()</h2>
<p>finally方法用于指定不管 Promise 对象最后状态如何，都会执行的操作。该方法是 ES2018 引入标准的。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line">promise</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// success</span></span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// error</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line">promise</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123; <span class="comment">//cb</span></span><br><span class="line">    <span class="comment">// success</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// error</span></span><br><span class="line">    <span class="comment">//.then(null, rejection)或.then(undefined, rejection)的别名，用于指定发生错误时的回调函数。</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .finally(</span><br><span class="line">      <span class="comment">//不管 Promise 对象最后状态如何，都会执行的操作</span></span><br><span class="line">      <span class="comment">//与状态无关的，不依赖于 Promise 的执行结果</span></span><br><span class="line">  );</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params">ms</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'setTimeout start'</span>);</span><br><span class="line">    setTimeout(resolve, ms, <span class="string">'done'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'setTimeout end'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">timeout(<span class="number">100</span>).then(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// setTimeout start</span></span><br><span class="line"><span class="comment">// setTimeout end</span></span><br><span class="line"><span class="comment">// done</span></span><br></pre></td></tr></table></figure>
<h1 id="处理多个promise">处理多个promise</h1>
<h2 id="promise-all">Promise.all()</h2>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="built_in">Promise</span>.all([p1, p2, p3]);</span><br></pre></td></tr></table></figure>
<p>return all resolved</p>
<p>p的状态由p1、p2、p3决定，分成两种情况。<br>
（1）只有p1、p2、p3的状态都变成fulfilled，p的状态才会变成fulfilled，此时p1、p2、p3的返回值组成一个数组，传递给p的回调函数。</p>
<p>（2）只要p1、p2、p3之中有一个被rejected，p的状态就变成rejected，此时第一个被reject的实例的返回值，会传递给p的回调函数。</p>
<h2 id="promise-race">Promise.race()</h2>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="built_in">Promise</span>.race([p1, p2, p3]);</span><br></pre></td></tr></table></figure>
<p>return first result</p>
<p>只要p1、p2、p3之中有一个实例率先改变状态，p的状态就跟着改变。那个率先改变的 Promise 实例的返回值，就传递给p的回调函数。</p>
<h2 id="promise-allsettled">Promise.allSettled()</h2>
<p>return all end</p>
<p>只有等到所有这些参数实例都返回结果，不管是fulfilled还是rejected，包装实例才会结束。该方法由 ES2020 引入。<br>
我们不关心异步操作的结果，只关心这些操作有没有结束。这时，Promise.allSettled()方法就很有用。如果没有这个方法，想要确保所有操作都结束，就很麻烦。Promise.all()方法无法做到这一点。</p>
<h2 id="promise-any">Promise.any()</h2>
<p>return any resolved</p>
<p>只要参数实例有一个变成fulfilled状态，包装实例就会变成fulfilled状态；如果所有参数实例都变成rejected状态，包装实例就会变成rejected状态。该方法目前是一个第三阶段的提案 。</p>
<h1 id="返回一个新的-promise-实例">返回一个新的 Promise 实例</h1>
<h2 id="promise-resolve">Promise.resolve()</h2>
<p>需要将现有对象转为 Promise 对象。Promise.resolve()在本轮“事件循环”结束时执行</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve(<span class="string">'foo'</span>)</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> resolve(<span class="string">'foo'</span>))</span><br></pre></td></tr></table></figure>
<h2 id="promise-reject">Promise.reject()</h2>
<p>Promise.reject(reason)方法也会返回一个新的 Promise 实例，该实例的状态为rejected。<br>
注意，Promise.reject()方法的参数，会原封不动地作为reject的理由，变成后续方法的参数。这一点与Promise.resolve方法不一致。</p>
<h2 id="promise-try">Promise.try()</h2>
<p>实际开发中，经常遇到一种情况：不知道或者不想区分，函数f是同步函数还是异步操作，但是想用 Promise 来处理它。因为这样就可以不管f是否包含异步操作，都用then方法指定下一步流程，用catch方法处理f抛出的错误。一般就会采用下面的写法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve().then(f)</span><br></pre></td></tr></table></figure>
<p>上面的写法有一个缺点，就是如果f是同步函数，那么它会在本轮事件循环的末尾执行。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(f);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</span><br><span class="line"><span class="comment">// next</span></span><br><span class="line"><span class="comment">// now</span></span><br></pre></td></tr></table></figure>
<p>上面代码中，函数f是同步的，但是用 Promise 包装了以后，就变成异步执行了。</p>
<p>那么有没有一种方法，让同步函数同步执行，异步函数异步执行，并且让它们具有统一的 API 呢？回答是可以的，并且还有两种写法。</p>
<h3 id="第一种写法是用async函数来写">第一种写法是用async函数来写。</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</span><br><span class="line">(<span class="keyword">async</span> () =&gt; f())();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</span><br><span class="line"><span class="comment">// now</span></span><br><span class="line"><span class="comment">// next</span></span><br></pre></td></tr></table></figure>
<p>上面代码中，第二行是一个立即执行的匿名函数，会立即执行里面的async函数，因此如果f是同步的，就会得到同步的结果；如果f是异步的，就可以用then指定下一步，就像下面的写法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; f())()</span><br><span class="line">.then(...)</span><br></pre></td></tr></table></figure>
<p>需要注意的是，async () =&gt; f()会吃掉f()抛出的错误。所以，如果想捕获错误，要使用promise.catch方法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; f())()</span><br><span class="line">.then(...)</span><br><span class="line">.catch(...)</span><br></pre></td></tr></table></figure>
<h3 id="第二种写法是使用new-promise">第二种写法是使用new Promise()。</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</span><br><span class="line">(</span><br><span class="line">  () =&gt; <span class="keyword">new</span> <span class="built_in">Promise</span>(</span><br><span class="line">    resolve =&gt; resolve(f())</span><br><span class="line">  )</span><br><span class="line">)();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</span><br><span class="line"><span class="comment">// now</span></span><br><span class="line"><span class="comment">// next</span></span><br></pre></td></tr></table></figure>
<p>上面代码也是使用立即执行的匿名函数，执行new Promise()。这种情况下，同步函数也是同步执行的。</p>
<p>鉴于这是一个很常见的需求，所以现在有一个提案，提供Promise.try方法替代上面的写法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</span><br><span class="line"><span class="built_in">Promise</span>.try(f);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</span><br><span class="line"><span class="comment">// now</span></span><br><span class="line"><span class="comment">// next</span></span><br></pre></td></tr></table></figure>
<p>事实上，Promise.try存在已久，Promise 库Bluebird、Q和when，早就提供了这个方法。</p>
<p>由于Promise.try为所有操作提供了统一的处理机制，所以如果想用then方法管理流程，最好都用Promise.try包装一下。这样有许多好处，其中一点就是可以更好地管理异常。</p>
<p>function getUsername(userId) {<br>
return database.users.get({id: userId})<br>
.then(function(user) {<br>
return <a href="http://user.name" target="_blank" rel="noopener">user.name</a>;<br>
});<br>
}<br>
上面代码中，database.users.get()返回一个 Promise 对象，如果抛出异步错误，可以用catch方法捕获，就像下面这样写。</p>
<p>database.users.get({id: userId})<br>
.then(…)<br>
.catch(…)<br>
但是database.users.get()可能还会抛出同步错误（比如数据库连接错误，具体要看实现方法），这时你就不得不用try…catch去捕获。</p>
<p>try {<br>
database.users.get({id: userId})<br>
.then(…)<br>
.catch(…)<br>
} catch (e) {<br>
// …<br>
}<br>
上面这样的写法就很笨拙了，这时就可以统一用promise.catch()捕获所有同步和异步的错误。</p>
<p>Promise.try(() =&gt; database.users.get({id: userId}))<br>
.then(…)<br>
.catch(…)<br>
事实上，Promise.try就是模拟try代码块，就像promise.catch模拟的是catch代码块。</p>
<h1 id="reference-links">Reference Links:</h1>
<ul>
<li><a href="http://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="noopener">ES6 Book </a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>ES6</category>
      </categories>
      <tags>
        <tag>Promise</tag>
      </tags>
  </entry>
  <entry>
    <title>Force IE rerender</title>
    <url>/Force-IE-rerender.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="the-height-of-same-row-is-different-of-grid">The height of same row is different of grid</h1>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Force-IE-rerender/compare.png" alt="compare"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Force-IE-rerender/mark.png" alt="mark"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Force-IE-rerender/html.png" alt="html"></p>
<h1 id="fix-by-javascript-code">Fix by javascript code</h1>
<p>迫使IE重新render</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (ISIE) &#123; <span class="comment">//judge whether it is IE</span></span><br><span class="line">    <span class="built_in">window</span>.setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        el.style.zoom = el.style.zoom == <span class="string">'1'</span> ? <span class="string">'100%'</span> : <span class="string">'1'</span>;</span><br><span class="line">    &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>IE issues</category>
      </categories>
      <tags>
        <tag>IE</tag>
      </tags>
  </entry>
  <entry>
    <title>Fiddler Everywhere for MAC OS without Mono</title>
    <url>/Fiddler-Everywhere-for-MAC-OS-without-Mono.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="fiddler-版本历史">Fiddler 版本历史</h1>
<p>Fiddler著名的抓包工具，就不多说了。</p>
<p>在Mac上使用Fiddler也是血泪史，2016年出过Fiddler for OS X Beta 1, 必须通过Mono才可以在Mac上使用。但是在mac上使用是非常不稳定, 有非常多的问题.</p>
<p>现在终于有”Fiddler Everywhere“ 版本，可以直接在Mac上安装了！</p>
<p>因为之前他的mac版本非常不好用，后来就使用了其他的软件，像Charles，wireshark。下回可以写一篇这几个软件的对比文章。<br>
2018年底就出来了Beta版本，我竟然一直不知道!  在网上随便一搜，知乎上、大家的博客写的也都是原来的2016年出的Fiddler for OS X的安装教程。所以索性就写一篇关于Fiddler的回顾，mark下。</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>版本</th>
<th>系统</th>
<th>特性</th>
</tr>
</thead>
<tbody>
<tr>
<td>2007.1.5</td>
<td>Fiddler v1.x</td>
<td>Windows</td>
<td><a href="https://www.telerik.com/support/whats-new/fiddler/release-history" target="_blank" rel="noopener">Release History</a></td>
</tr>
<tr>
<td>2016年底</td>
<td>Fiddler for OS X Beta 1 (Mono)</td>
<td>Mac OS</td>
<td></td>
</tr>
<tr>
<td>2018.11.8</td>
<td>Fiddler Everywhere v0.1.0</td>
<td>Windows, Mac and Linux</td>
<td><a href="https://www.telerik.com/support/whats-new/fiddler-everywhere/release-history" target="_blank" rel="noopener">Release History</a></td>
</tr>
</tbody>
</table>
<p>各个版本后来更新的小版本就不列出来了，可以点击Release History查看详细版本。</p>
<h1 id="新版本：fiddler-everywhere-介绍及下载">新版本：Fiddler Everywhere 介绍及下载</h1>
<h2 id="fiddler-everywhere-下载">Fiddler Everywhere 下载</h2>
<p>现在终于有”Fiddler Everywhere“ 版本，可以直接在Mac上安装了！废话不多说，直接上<a href="https://www.telerik.com/download/fiddler-everywhere" target="_blank" rel="noopener">官方下载链接</a>。<br>
然后跟安装其他mac软件一样直接安装就行了，简直喜大普奔。<br>
<a href="https://www.telerik.com/support/whats-new/fiddler-everywhere/release-history" target="_blank" rel="noopener">Release History 版本历史</a>。</p>
<p>Fiddler使用方法网上一搜有很多，下回有空了再写。</p>
<h2 id="fiddler-everywhere-介绍">Fiddler Everywhere 介绍</h2>
<p>官方介绍Fiddler Everywhere的blog: “<a href="https://www.telerik.com/blogs/one-fiddler-to-rule-them-all" target="_blank" rel="noopener">One Fiddler to Rule Them All</a>”</p>
<p>官方介绍Fiddler Everywhere的blog挑重点翻译过来：</p>
<blockquote>
<p>您是否曾一再尝试将Fiddler设置为在Mac或Linux上运行，却又遇到另一个错误？<br>
您是否对没有其他选择感到沮丧？</p>
<p>多年来，将Fiddler移植到Mac和Linux一直是最受欢迎的功能请求之一。在2016年底，我们推出了使用 Mono的Beta版本，但是这种方法的问题和局限性似乎超过了获益。我们已经尝试过，我们已经了解到。</p>
<p>我们很高兴介绍下一个Fiddler – <a href="https://www.telerik.com/fiddler-everywhere" target="_blank" rel="noopener">Fiddler Everywhere</a>。 Fiddler Everywhere是从零开始构建的，可以在所有主要平台（Windows，Mac和Linux）上运行。这是您所询问的所有内容，以及更多：</p>
<ol>
<li><strong>跨平台支持</strong>：<a href="http://xn--Angular-lr4ks95bvki.NET" target="_blank" rel="noopener">基于Angular和.NET</a> Core，它为Mac和Linux用户提供了与Windows用户相同的体验和生产力。</li>
<li><strong>流畅的用户界面</strong>：自上次修改Fiddler的界面以来，UI的最佳做法已经有了长足发展。我们希望将最新的UI和UX改进引入Fiddler社区。 Kendo UI for Angular团队的同事们支持我们，这不是很好吗？</li>
<li><strong>完美的用户体验</strong>：无论您是在构建API服务还是管理组织的流量，使用Fiddler都是小菜一碟。</li>
<li>最重要的是，它是<strong>免费</strong>的。</li>
</ol>
<p>我们发布的第一个版本功能有限，但是我们将根据使用情况和您提供的反馈反复添加更多功能。</p>
<p>但是旧的Fiddler – Windows版Fiddler呢？<br>
我们将继续开发该版本，至少直到新的Fiddler具有与之相等的功能为止，并且可能在此之后很长时间。有两个主要原因：1有用 2每个人都喜欢它。</p>
</blockquote>
<h1 id="老版本：-fiddler-for-os-x-beta-1-mono">老版本： Fiddler for OS X Beta 1（Mono）</h1>
<p>官方介绍Fiddler for OS X Beta 1 <a href="https://www.telerik.com/blogs/introducing-fiddler-for-os-x-beta-1" target="_blank" rel="noopener">Introducing Fiddler for OS X Beta 1</a></p>
<h2 id="安装方法">安装方法</h2>
<ol>
<li>如果您的Mac上未安装Mono框架，请<a href="https://www.mono-project.com/download/stable/" target="_blank" rel="noopener">下载并安装</a>。如果已经安装，请更新至最新版本。</li>
<li>如果您刚刚安装了Mono，请打开Terminal并输入：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/Library/Frameworks/Mono.framework/Versions/&lt;Mono版本&gt; / bin / mozroots --import --sync</span><br></pre></td></tr></table></figure>
<p>比如Mono版本5.10.1</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/Library/Frameworks/Mono.framework/Versions/5.10.1/bin/mozroots --import —sync</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Mono框架具有自己的受信任的根证书存储。当前（在Mono版本4.2.4中），在OS X上安装Mono后，此存储仍然为空。Fiddler使用此存储中的证书来验证所访问网站的证书。因此，您需要使用一组普遍信任的根权限填充该存储，以避免Fiddler不断收到证书警告。 mozroots工具从Mozilla LXR导入受信任的权威。</p>
</blockquote>
<ol start="3">
<li>下载<a href="https://www.telerik.com/download/fiddler" target="_blank" rel="noopener">fiddler-mac.zip</a>解压缩到具有写权限的文件夹。建议Fiddler安装文件夹的完整路径不包含任何Windows路径非法字符。 （目前，某些Fiddler功能（例如各种文件导出或Fiddler脚本）可能无法处理此类路径。）</li>
<li>打开终端并导航到第3步文件夹。</li>
<li>在终端中输入<code>mono Fiddler.exe</code></li>
</ol>
<h2 id="局限性-已知问题和解决方法">局限性，已知问题和解决方法</h2>
<ul>
<li><strong>不稳定的用户界面</strong></li>
</ul>
<blockquote>
<p>用于OS X的Fiddler与Windows的Fiddler具有相同的外观，但是它建立在开源WinForms Mono实现的基础上。该实现的质量明显低于Microsoft WinForms的质量，这会导致不理想的用户体验。当我们意识到在开始使用macOS版本的Fiddler时，我们选择了这种方式，以便我们可以更快地实现对OS X的支持，而不必牺牲Windows的Fiddler路线图，而将我们的未来工作作为基础实际使用情况。</p>
</blockquote>
<blockquote>
<p>对于Beta 1版本，UI中最有问题的区域是调整窗口大小和调整窗口内部元素的大小。通常，这会导致所有受影响元素的重画效果差或拖延。不过，将鼠标悬停或单击受影响的区域通常会解决问题。</p>
</blockquote>
<ul>
<li>当Fiddler正在运行且“解密HTTPS流量”处于打开状态时，Safari无法访问某些受欢迎的网站（Facebook / Twitter / GitHub等）</li>
</ul>
<blockquote>
<p>当前，此效果仅限于Safari，并且只有在您打开Fiddler之前访问该网站时才会发生。清除受影响站点的浏览历史记录（只是历史记录不缓存或cookie）可以解决此问题。</p>
</blockquote>
<blockquote>
<p>我们的初步研究表明，使用TLS版本大于1.0的网站会出现此问题。缺少TLS 1.1和1.2的Mono实现，将Fiddler for macOS限制为仅使用TLS 1.0。不幸的是，Fiddler TLS 1.0连接是在对同一域建立TLS 1.2连接之后出现的，Safari无法接受该域。</p>
</blockquote>
<ul>
<li>
<p><strong>不支持TLS 1.1和1.2</strong><br>
这是Mono框架中TLS实现的当前状态引入的硬限制。因此，OS X的Fiddler目前无法使用这些协议。</p>
</li>
<li>
<p><strong>SSL / TLS握手属性不可用</strong><br>
Fiddler for OS X Beta目前无法显示这些内容。这项工作正在进行中。</p>
</li>
<li>
<p><strong>自动更新</strong><br>
Fiddler for OS X的初始版本只能手动更新。</p>
</li>
<li>
<p><strong>使用寿命有限</strong><br>
此版本的Fiddler for OS X可以使用60天，然后需要进行更新。</p>
</li>
</ul>
<p>所以说知道老版本的缺点，你就知道为什么原来要弃用了。就知道为什么现在要喜大普奔又可以用回来了。</p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>Network</category>
      </categories>
      <tags>
        <tag>Network</tag>
      </tags>
  </entry>
  <entry>
    <title>Git Push 避免重复输入用户名和密码方法 - 多账户配置</title>
    <url>/Git-Push-%E9%81%BF%E5%85%8D%E9%87%8D%E5%A4%8D%E8%BE%93%E5%85%A5%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81%E6%96%B9%E6%B3%95-%E5%A4%9A%E8%B4%A6%E6%88%B7%E9%85%8D%E7%BD%AE.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="git-push-避免用户名和密码方法">Git Push 避免用户名和密码方法</h1>
<p>在大家使用github的过程中，一定会碰到这样一种情况，就是每次要push 和pull时总是要输入github的账号和密码，这样不仅浪费了大量的时间且降低了工作效率。在此背景下，本文在网上找了两种方法来避免这种状况，这些成果也是先人提出来的，在此只是做个总结。</p>
<h2 id="方法一-git-credential-manager-推荐">方法一 Git Credential Manager 【推荐】</h2>
<ul>
<li><a href="https://docs.github.com/en/get-started/getting-started-with-git/caching-your-github-credentials-in-git#git-credential-manager" target="_blank" rel="noopener">Caching your GitHub credentials in Git</a>
<ul>
<li><a href="https://github.com/git-ecosystem/git-credential-manager/blob/release/docs/usage.md" target="_blank" rel="noopener">How to use <code>git credential-manager</code></a></li>
</ul>
</li>
<li><a href="https://github.com/git-ecosystem/git-credential-manager/blob/main/docs/multiple-users.md#setting-it-up" target="_blank" rel="noopener">Support Multiple users</a></li>
</ul>
<h2 id="方法二-git-credentials">方法二 .git-credentials</h2>
<h3 id="1-1-创建文件存储git用户名和密码">1.1 创建文件存储GIT用户名和密码</h3>
<p>在%HOME%目录中创建文件名为.git-credentials的文件。</p>
<!-- 文件保存在 OneDrive/LYKMACSetting/_Users_liyuankun/.git-credentials -->
<p>%HOME%目录:</p>
<ul>
<li>Windows：一般为<code>C:\users\Administrator</code>，也可以是你自己创建的系统用户名目录，反正都在C:\users\中。</li>
<li>Mac：/Users/YourUserName</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">touch .git-credentials</span><br><span class="line">vim .git-credentials</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 输入 https://&#123;username&#125;:&#123;password&#125;@github.com</span></span><br><span class="line">https://&#123;CatherineLiyuankun&#125;:&#123;xxxxxxxxx&#125;@github.com</span><br><span class="line">https://&#123;yuanli&#125;:&#123;xxxxxxx&#125;@github.yourcompanydomain.com</span><br></pre></td></tr></table></figure>
<h3 id="1-2-添加git-config-内容">1.2 添加Git Config 内容</h3>
<p>进入终端， 输入如下命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global credential.helper store</span><br></pre></td></tr></table></figure>
<p>执行完后查看%HOME%目录下的.gitconfig文件，会多了一项：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[credential]</span><br><span class="line">helper = store</span><br></pre></td></tr></table></figure>
<p>重启终端会发现git push时不用再输入用户名和密码。</p>
<h2 id="方法三">方法三</h2>
<p><a href="https://dhruvbarochiya.com/How-to-handle-multiple-git-configurations-in-one-machine/" target="_blank" rel="noopener">How to handle multiple git configurations in one machine</a><br>
<a href="https://www.micah.soy/posts/setting-up-git-identities/" target="_blank" rel="noopener">Setting Up Git Identities</a></p>
<h2 id="方法三-环境变量">方法三 环境变量</h2>
<h3 id="2-1-添加环境变量">2.1 添加环境变量</h3>
<p>添加一个HOME环境变量，变量名:HOME,变量值：%USERPROFILE%</p>
<h3 id="2-2-创建git用户名和密码存储文件">2.2 创建git用户名和密码存储文件</h3>
<p>进入%HOME%目录，新建一个名为&quot;_netrc&quot;的文件，文件中内容格式如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">machine &#123;git account name&#125;.github.comlogin your-usernmaepassword your-password</span><br></pre></td></tr></table></figure>
<p>重新打开终端，无需再输入用户名和密码</p>
<!-- [user]
        name = Li,Yuankun
        email = yuanli@microstrategy.com -->
<h2 id="3-开启两步验证-two-factor-authentication-的github账号">3 开启两步验证&quot;Two-factor authentication&quot;的github账号</h2>
<p>前面用方法一之后， 重启终端， 重新<code>git push</code>, 跟据提示输入用户名和密码，结果报错：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Username <span class="keyword">for</span> <span class="string">'https://github.com'</span>: CatherineLiyuankun</span><br><span class="line">Password <span class="keyword">for</span> <span class="string">'https://CatherineLiyuankun@github.com'</span>:</span><br><span class="line">remote: Invalid username or password.</span><br><span class="line">fatal: Authentication failed <span class="keyword">for</span> <span class="string">'https://github.com/CatherineLiyuankun/Todo-List-mojo.git/'</span></span><br></pre></td></tr></table></figure>
<p>查了下原因，是因为我github账号 开启过两步验证，所以简单说就是不要输入<code>password</code> 而是要输入<code>personal access token</code>。<br>
可以通过： <a href="https://github.com/settings/tokens" target="_blank" rel="noopener">https://github.com/settings/tokens</a> 查看你账号已有的personal access token。<br>
如果没有可以新建一个<code>personal access token</code>，并保存下来。</p>
 <!-- my own githut : token: "mac-MS"  -->
<blockquote>
<p>It turns out that I need to log in using my username, but instead of using the normal GitHub account password, I should use a personal access token that can be created here.</p>
<p>Because I am use GitHub feature named “Two-factor authentication” (It isn’t a standard Git’s feature, it’s added feature by <a href="http://GitHub.com" target="_blank" rel="noopener">GitHub.com</a>). After turn on the feature, I must create “Personal Access Tokens”</p>
</blockquote>
<blockquote>
<p><strong>Reference</strong></p>
<p>When you’ll be asked for a personal access token as a password<br>
After 2FA is enabled there are a couple of scenarios where you need to enter a personal access tokeninstead of a 2FA code and your GitHub password.</p>
</blockquote>
<blockquote>
<p><strong>Through the command line</strong></p>
<p>You must create a personal access token to use as a password when authenticating to GitHub on the command line using HTTPS URLs.<br>
For example, when you access a repository using Git on the command line using commands like git clone, git fetch, git pull or git push with HTTPS URLs, you must provide your GitHub username and your personal access token when prompted for a username and password. The command line prompt won’t specify that you should enter your personal access token when it asks for your password.</p>
</blockquote>
<blockquote>
<p><strong>2FA and Subversion (svn command line, tortoise svn, etc)</strong></p>
<p>When you access a repository via Subversion, you must provide a personal access token instead of entering your password.</p>
</blockquote>
<h2 id="附录：配置git账户命令">附录：配置git账户命令</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 配置git账户</span></span><br><span class="line">git config --list <span class="comment">#查看当前配置</span></span><br><span class="line">git config --list --<span class="built_in">local</span> <span class="comment">#查看当前仓库配置</span></span><br><span class="line">git config --list --global <span class="comment">#查看全局配置</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置全局账户（配置文件位于 ~/.gitconfig中）</span></span><br><span class="line">git config --global user.name <span class="string">"your_name"</span> <span class="comment"># 如果是提到github上，your_name最好是你的github账户的名字</span></span><br><span class="line">git config --global user.email <span class="string">"your_email@example.com"</span> <span class="comment"># 如果是提到github上，your_email@example.com最好是你的github账户的邮箱</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置本地仓库账户 (配置文件位于当前仓库目录的.git/config中）</span></span><br><span class="line">git config --<span class="built_in">local</span> user.name <span class="string">"your_name_in_company"</span> <span class="comment"># 如果是提到github上，your_name最好是你的github账户的名字</span></span><br><span class="line">git config --<span class="built_in">local</span> user.email <span class="string">"your_company_email@example.com"</span> <span class="comment"># 如果是提到github上，your_email@example.com最好是你的github账户的邮箱</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置http和https代理 set proxy to git command by executing</span></span><br><span class="line">`git config --global http.proxy http://10.xx.x.xxx:8080`</span><br><span class="line"><span class="comment"># unset the proxy, 去除http和https代理：</span></span><br><span class="line">`git config --global --<span class="built_in">unset</span> http.proxy`</span><br><span class="line">`git config --global --<span class="built_in">unset</span> https.proxy`</span><br></pre></td></tr></table></figure>
  <!-- - `git config --global http.proxy http://10.27.7.110:8080` -->
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>Environment setup</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>Github All You should know</title>
    <url>/Github-All-You-should-know.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="who-is-assignees">Who is Assignees?</h2>
<p><a href="https://stackoverflow.com/questions/43617352/" target="_blank" rel="noopener"> What do reviewer and assignee mean in pull request?</a> 里的答案：</p>
<blockquote>
<p>For a pull request, you can now &quot;request a review explicitly from collaborators, making it easier to specify who you’d like to review your pull request.&quot;<br>
但是Assignees<br>
Assignees, on the other hand, “clarify who is working on specific issues and pull requests.”</p>
</blockquote>
<blockquote>
<p>In sum, the difference is whether you’d like to ask someone to work on fixing an issue or contribute to a pull request (<strong>assignee</strong>), versus asking someone to quality check your work (<strong>reviewer</strong>).<br>
Sources:<br>
<a href="https://github.com/blog/2291-introducing-review-requests" target="_blank" rel="noopener">https://github.com/blog/2291-introducing-review-requests</a><br>
<a href="https://help.github.com/articles/assigning-issues-and-pull-requests-to-other-github-users/" target="_blank" rel="noopener">https://help.github.com/articles/assigning-issues-and-pull-requests-to-other-github-users/</a></p>
</blockquote>
<p><a href="https://stackoverflow.com/questions/41087206/on-github-whats-the-difference-between-reviewer-and-assignee" target="_blank" rel="noopener"> On GitHub, what’s the difference between reviewer and assignee?</a>里的答案：</p>
<blockquote>
<p>After discussing with several OSS maintainers, reviewers is defined as what the word supposed to be: to review (someone’s code) and “assignee” has a looser definiton explained below.</p>
</blockquote>
<blockquote>
<p>For “reviewer”: someone you want to review the code. Not necessarily the person responsible for that area or responsible for merging the commit. Can be someone who worked on that chunk of code before, as GitHub auto-suggests.</p>
</blockquote>
<blockquote>
<p>For “assignee”: up to the project’s team/maintainer what it means and there’s no strict definition. It can be the PR opener, or someone responsible for that area (who is going to accept the PR after the review is done or just close it). It’s not up to GitHub to define what it is leaving it open for project maintainers what fits best for their project.</p>
</blockquote>
<blockquote>
<p>Previous answer:<br>
Ok I’ll go ahead and answer my own question.<br>
For PR of users with write-access: the Assignee would be the same person who opened the PR, and reviewer would replace the old assignee function (reviewing code), being this one someone of assignee choice.<br>
For PR of users without write-access (outside contributors): Someone with write-access would assign herself (or other write-priviledge member), to review the PR (Reviewer). Assignee is blank.<br>
For unfinished PR from outside contributors: the write-access member would take the unfinished work and assign for her. She will be responsible for finishing the task, being the Assignee. Since the main reason of PRs is reviewing changes, she would select some other people to review the changes.</p>
</blockquote>
<p>总结下：<br>
reviewer: 一般很好理解，就是来review你代码的人。可以是原来改过这段代码的人，负责这块代码的人或是负责merge代码的人。<br>
Assignees: 其实，没有严格定义，可以具体看项目组怎么用这个选项。一般分两个场景</p>
<ol>
<li>Pull request：创建pull request的人（这种在另一个组的时候用过，如果你是创建的人，可以指定自己），或者是负责merge代码的人（我们组是这么用的），或者就是当review/colse PR完后accept PR的人.</li>
<li>Issue：当你收到一个issue（通常不是你建的issue）， 你需要指定人来fix这个issue，就可以在Assignees填。</li>
</ol>
<h2 id="tip">Tip</h2>
<h3 id="online-editor">online editor</h3>
<p>On <a href="http://github.com" target="_blank" rel="noopener">github.com</a> when you are viewing a repo or pull request you can press the . (period) key to browse the repo or PR in a VS Code-like editor running in your browser.<br>
<a href="https://github.com/github/dev" target="_blank" rel="noopener">https://github.com/github/dev</a><br>
<a href="https://www.youtube.com/watch?v=ywUZOOzLX3c" target="_blank" rel="noopener">https://www.youtube.com/watch?v=ywUZOOzLX3c</a></p>
<h3 id="tab-indenting">tab indenting</h3>
<p>Github show tab indenting as 8-letter long, this would:</p>
<ul>
<li>make code file mixes tab and spaces indenting looks ugly, you know we have some code repo with long history.</li>
<li>consume more horizontal screen space when we review code on Github.<br>
We can change this <a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-personal-account-settings/managing-your-tab-size-rendering-preference" target="_blank" rel="noopener">setting</a></li>
</ul>
<h1 id="reference-links">Reference Links:</h1>
<ul>
<li><a href="https://stackoverflow.com/questions/41087206/on-github-whats-the-difference-between-reviewer-and-assignee" target="_blank" rel="noopener"> On GitHub, what’s the difference between reviewer and assignee?</a></li>
<li><a href="https://stackoverflow.com/questions/43617352/what-do-reviewer-and-assignee-mean-in-pull-request?noredirect=1&amp;lq=1" target="_blank" rel="noopener"> What do reviewer and assignee mean in pull request? [duplicate]</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2017/08/issue.html" target="_blank" rel="noopener"> 如何使用 Issue 管理软件项目？</a></li>
<li><a href="https://tech.hahow.in/%E5%AE%8C%E5%96%84-github-flow-%E6%9C%80%E5%BE%8C%E4%B8%80%E5%93%A9%E8%B7%AF-probot-d1cda24e4455" target="_blank" rel="noopener"> 完善 GitHub Flow 最後一哩路 — Probot -Assignees 下拉選單</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>Git error 常见报错总结</title>
    <url>/Git-push-Failed-to-connect-to-github-com-port-443-after-xxx-ms-Operation-timed-out.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="error-1-failed-to-connect-to-github-com-port-443-after-xxx-ms-operation-timed-out">Error 1 Failed to connect to <a href="http://github.com" target="_blank" rel="noopener">github.com</a> port 443 after xxx ms: Operation timed out</h2>
<ul>
<li>
<p><a href="https://juejin.cn/post/6844904193170341896" target="_blank" rel="noopener">GitHub无法访问、443 Operation timed out的解决办法</a></p>
<ul>
<li>Solution 1：修改hosts文件，<a href="http://xn--github-2e4jg12p.com" target="_blank" rel="noopener">添加github.com</a> IP</li>
</ul>
</li>
<li>
<p><a href="https://juejin.cn/post/7101271526061637668" target="_blank" rel="noopener">github push ssh方式 出现 port 443 22 的报错排查及踩坑</a></p>
<ul>
<li>Solution 2：修改DNS</li>
</ul>
</li>
<li>
<p>Solution 3： 设置http和https代理 set proxy to git command by executing</p>
<ul>
<li><code>git config --global http.proxy http://10.xx.x.xxx:8080</code> 查看config： <code>git config --list</code></li>
</ul>
<!-- - `git config --global http.proxy http://10.27.7.110:8080` -->
<ul>
<li>unset the proxy, 去除http和https代理：<br>
<code>git config --global --unset http.proxy</code><br>
<code>git config --global --unset https.proxy</code></li>
</ul>
</li>
</ul>
<h2 id="error-2-http-2-stream-1-was-not-closed-cleanly-before-end-of-the-underlying-stream">Error 2 HTTP/2 stream 1 was not closed cleanly before end of the underlying stream</h2>
<p>是 git 默认使用的通信协议出现了问题，可以通过将默认通信协议修改为 http/1.1 来解决该问题。<br>
<code>$ git config --global http.version HTTP/1.1</code><br>
<code>git config --global http.postBuffer 157286400</code></p>
<h2 id="error-git-cherry-pick-xxx-fatal-bad-object-xxx">Error git cherry-pick xxx  fatal: bad object xxx</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout ABranch</span><br><span class="line"><span class="comment"># cherry-pick BBranch的一个commit</span></span><br><span class="line">git cherry-pick 121c5f6402501dc05a9c8021ec39a52ce843d76d</span><br><span class="line">fatal: bad object 121c5f6402501dc05a9c8021ec39a52ce843d76d</span><br></pre></td></tr></table></figure>
<p>出现这个错误通常意味着你试图合并一个不存在的提交。git cherry-pick是本地特性，本地要有这个commit才可以被git cherry-pick。</p>
<ul>
<li>检查提交的哈希值是否正确；</li>
<li>确保该提交存在于你的本地代码库中；</li>
<li>如果提交是在远程代码库中，请确保已将其克隆到本地并且与远程代码库保持同步；</li>
<li>如果仍然无法解决问题，可以尝试重新克隆代码库。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 本地获取BBranch的commit</span></span><br><span class="line">git checkout BBranch</span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line">git checkout ABranch</span><br><span class="line"><span class="comment"># cherry-pick BBranch的一个commit</span></span><br><span class="line">git cherry-pick 121c5f6402501dc05a9c8021ec39a52ce843d76d</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>HTTP CORS disable for browser</title>
    <url>/HTTP-CORS-disable.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>CORS的基本原理请看上一篇：</p>
<!-- [CORS的基本原理](../../../../2019/10/21/HTTP CORS disable) -->
<p><a href="../HTTP-CORS.html">CORS的基本原理</a><br>
<a href="../iframe-%E5%86%85%E5%A4%96%E9%A1%B5%E9%9D%A2%E9%80%9A%E4%BF%A1.html">iframe内外页面通信</a></p>
<p>用本地文件测试frame的时候，在执行<code>curWindow.navigator.userAgent</code>的时候会报错：<br>
<code>Uncaught DOMException: Blocked a frame with origin &quot;null&quot; from accessing a cross-origin frame.</code></p>
<p>原因是浏览器默认开启了CORS的安全保护，不允许iframe跨域获取一些值。</p>
<p>关闭同源策略 (CORS) 只会影响您的浏览器。此外，在浏览器中禁用同源安全设置会允许任何网站访问跨源资源，这是非常危险的，只能用于开发目的。现在，只有 <code>window.postMessage()</code> 才是<code>frame/iframe</code> 之间交互的最佳方式。</p>
<h2 id="解决方案1-关闭浏览器cors-limit-临时解决">解决方案1 关闭浏览器CORS limit [临时解决]</h2>
<p>Run a browser with <code>cross-domain web security/same-origin</code> policy disabled</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Mac Chrome</span></span><br><span class="line">open /Applications/Google\ Chrome.app --args --user-data-dir=<span class="string">"/const/tmp/Chrome dev session"</span> --<span class="built_in">disable</span>-web-security</span><br><span class="line"><span class="comment"># Mac Chrome Canary</span></span><br><span class="line"><span class="comment">#open /Applications/Google\ Chrome\ Canary.app --args --user-data-dir="/const/tmp/Chrome dev session" --disable-web-security</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># For Linux run:</span></span><br><span class="line">$ google-chrome --<span class="built_in">disable</span>-web-security</span><br><span class="line"></span><br><span class="line"><span class="comment"># For Windows go into the command prompt and go into the folder where Chrome.exe is and type</span></span><br><span class="line">chrome.exe --<span class="built_in">disable</span>-web-security</span><br></pre></td></tr></table></figure>
<h3 id="macos">MacOS</h3>
<p>命令行里, 加参数<code>--disable-web-security</code>打开chrome浏览器，会另外打开一个Chrome窗口：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Mac Chrome</span></span><br><span class="line">open /Applications/Google\ Chrome.app --args --user-data-dir=<span class="string">"/const/tmp/Chrome dev session"</span> --<span class="built_in">disable</span>-web-security</span><br><span class="line"></span><br><span class="line"><span class="comment"># --user-data-dir </span></span><br><span class="line">open -n -a <span class="string">"/Applications/Google Chrome.app/Contents/MacOS/Google Chrome"</span> --args --user-data-dir=<span class="string">"/tmp/chrome_dev_test"</span> --<span class="built_in">disable</span>-web-security</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mac Chrome Canary</span></span><br><span class="line"><span class="comment"># open /Applications/Google\ Chrome\ Canary.app --args --user-data-dir="/const/tmp/Chrome dev session" --disable-web-security</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>–user-data-dir 参数需要 Chrome 版本 49+ on OSX</p>
</blockquote>
<p>如果想访问本地文件（开发目的来使用 AJAX 或 JSON），可以使用flag：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-–allow-file-access-from-files</span><br></pre></td></tr></table></figure>
<h3 id="windows">Windows</h3>
<p>进入command prompt，进入到Chrome.exe文件夹，执行命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># For Windows go into the command prompt and go into the folder where Chrome.exe is and type</span></span><br><span class="line">chrome.exe --<span class="built_in">disable</span>-web-security</span><br></pre></td></tr></table></figure>
<p>这个命令会禁掉CORS，而且可以访问本地文件。</p>
<h3 id="linux">Linux</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># For Linux run:</span></span><br><span class="line">$ google-chrome --<span class="built_in">disable</span>-web-security</span><br></pre></td></tr></table></figure>
<h2 id="解决方案2-extensions-xampp-or-live-server-临时解决">解决方案2 Extensions “xampp” or “Live Server” [临时解决]</h2>
<p>You could solve it by installing xampp and moving all files to htdocs or using an extension like “Xampp”.</p>
<h2 id="解决方案3-try-catch-跨域时无法获取想要的值-只是不抛错">解决方案3 try-catch [跨域时无法获取想要的值，只是不抛错]</h2>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// iframe 内的javascript</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> parent = <span class="built_in">window</span>.parent &amp;&amp; <span class="built_in">window</span>.parent.navigator;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="built_in">console</span>.warn(<span class="string">`Error - <span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="解决方案4-window-postmessage-终极解决">解决方案4 <code>window.postMessage()</code> [终极解决]</h2>
<p>同源策略可防止脚本访问不同源的网站内容，可以使用 <code>window.postMessage()</code> 安全地在 Window 对象之间实现跨源通信。<br>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage" target="_blank" rel="noopener">MDN postMessage</a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">postMessage(message,targetOrigin)</span><br><span class="line">postMessage(message,targetOrigin, [transfer])</span><br></pre></td></tr></table></figure>
<h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/3102819/disable-same-origin-policy-in-chrome" target="_blank" rel="noopener">Disable same origin policy in Chrome</a></li>
<li><a href="https://hackernoon.com/resolving-the-blocked-a-frame-with-origin-null-from-accessing-a-cross-origin-frame-error" target="_blank" rel="noopener">Resolving the Blocked a Frame with Origin “null” From Accessing a Cross-Origin Frame Error</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Network</category>
        <category>Servlet/HTTP</category>
      </categories>
      <tags>
        <tag>CORS</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo博客中插入音乐和视频</title>
    <url>/Hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%8F%92%E5%85%A5%E9%9F%B3%E4%B9%90%E5%92%8C%E8%A7%86%E9%A2%91.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="方法一：markdown-直接插入html标签">方法一：Markdown 直接插入HTML标签</h1>
<p>Markdown作为轻量级的标记语言，兼容html语法，我们可以直接在Markdown格式的.md文件中使用 html 语法。</p>
<p>大多数的视频，点击“分享”，都可以得到嵌入视频的HTML代码（大多数都是使用）<code>&lt;iframe&gt;</code>标签或者flash<code>&lt;embed&gt;</code>标签播放，直接拷贝粘贴到 Markdown 文档中即可使用就行了。</p>
<p>虾米音乐：</p>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="750" height="110" loading="lazy" sandbox="allow-popups allow-scripts allow-same-origin" src="https://www.xiami.com/webapp/embed-player?autoPlay=1&id=1900020217"></iframe>
<h2 id="iframe-标签"><code>&lt;iframe&gt;</code>标签</h2>
<p>这个例子是拷贝我上传在YouTube视频：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">width</span>=<span class="string">"560"</span> <span class="attr">height</span>=<span class="string">"315"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">src</span>=<span class="string">"https://www.youtube.com/embed/Fco5F5EPwUo"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">allow</span>=<span class="string">"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">frameborder</span>=<span class="string">"0"</span> <span class="attr">allowfullscreen</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%8F%92%E5%85%A5%E9%9F%B3%E4%B9%90%E5%92%8C%E8%A7%86%E9%A2%91/youtube.gif" alt="YouTube视频分享"></p>
<h3 id="youtube效果">YouTube效果</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_9aM609I-m0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h3 id="bilibili">bilibili</h3>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%8F%92%E5%85%A5%E9%9F%B3%E4%B9%90%E5%92%8C%E8%A7%86%E9%A2%91/bilibili.png" alt="bilibili"></p>
<iframe width="560" height="315" src="//player.bilibili.com/player.html?aid=98312470&bvid=BV1pE411F7BX&cid=167824910&page=1" frameborder="0" framespacing="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen> </iframe>
<h2 id="flash插件-embed-标签">flash插件 <code>&lt;embed&gt;</code>标签</h2>
<p>网易云音乐：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%8F%92%E5%85%A5%E9%9F%B3%E4%B9%90%E5%92%8C%E8%A7%86%E9%A2%91/neteaseMusic.png" alt="网易云音乐"></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">embed</span> <span class="attr">src</span>=<span class="string">"//music.163.com/style/swf/widget.swf?sid=1372350500&amp;type=2&amp;auto=1&amp;width=320&amp;height=66"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">width</span>=<span class="string">"340"</span> <span class="attr">height</span>=<span class="string">"86"</span>  <span class="attr">allowNetworking</span>=<span class="string">"all"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">embed</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>网易云音乐效果：<br>
<embed src="//music.163.com/style/swf/widget.swf?sid=1372350500&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"><br>
</p>
<h2 id="script-标签"><code>&lt;script&gt;</code>标签</h2>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://www.xiami.com/widget/player-single?uid=32329501&amp;sid=1776238762&amp;mode=js"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="vedio-标签"><code>&lt;vedio&gt;</code>标签</h2>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">style</span>=<span class="string">"max-width: 100%; display: block; margin-left: auto; margin-right: auto;"</span> <span class="attr">controls</span> <span class="attr">src</span>=<span class="string">"https://www.bilibili.com/video/BV1Ta4y1t7UX/"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h1 id="方法二：hexo视频-音乐插件">方法二：Hexo视频/音乐插件</h1>
<hr>
<h2 id="音乐播放aplayer">音乐播放aplayer</h2>
<blockquote>
<p>hexo-tag-aplayer: <a href="https://github.com/grzhan/hexo-tag-aplayer" target="_blank" rel="noopener">https://github.com/grzhan/hexo-tag-aplayer</a></p>
</blockquote>
<h3 id="命令行安装">命令行安装</h3>
<p>Hexo-theme-zilan文件夹下，执行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-tag-aplayer --save</span><br></pre></td></tr></table></figure>
<h3 id="使用方法"><a href="https://github.com/MoePlayer/hexo-tag-aplayer/raw/master/docs/README-zh_cn.md" target="_blank" rel="noopener">使用方法</a></h3>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% aplayer title author url [picture_url, narrow, autoplay, width:xxx, lrc:xxx] %&#125;</span><br></pre></td></tr></table></figure>
<h4 id="标签参数">标签参数</h4>
<ul>
<li>title : 曲目标题</li>
<li>author: 曲目作者</li>
<li>url: 音乐文件 URL 地址</li>
<li>picture_url: (可选) 音乐对应的图片地址</li>
<li>narrow: （可选）播放器袖珍风格</li>
<li>autoplay: (可选) 自动播放，移动端浏览器暂时不支持此功能</li>
<li>width:xxx: (可选) 播放器宽度 (默认: 100%)</li>
<li>lrc:xxx: （可选）歌词文件 URL 地址</li>
</ul>
<p>当开启 Hexo 的 文章资源文件夹 功能时，可以将图片、音乐文件、歌词文件放入与文章对应的资源文件夹中，然后直接引用：</p>
<h3 id="例子">例子</h3>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% aplayer "岚坤爷" "岚坤爷" "https://www.xiami.com/webapp/embed-player?autoPlay=1&amp;id=1900020217" "https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/chatHead.jpg" %&#125;</span><br></pre></td></tr></table></figure>

        <div id="aplayer-MsgnlUKA" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">
            <pre class="aplayer-lrc-content"></pre>
        </div>
        <script>
          var ap = new APlayer({
            element: document.getElementById("aplayer-MsgnlUKA"),
            narrow: false,
            autoplay: false,
            showlrc: false,
            music: {
              title: "岚坤爷",
              author: "岚坤爷",
              url: "https://www.xiami.com/webapp/embed-player?autoPlay=1&id=1900020217",
              pic: "https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/chatHead.jpg",
              lrc: ""
            }
          });
          window.aplayers || (window.aplayers = []);
          window.aplayers.push(ap);
        </script>
<h2 id="视频播放dplayer">视频播放dplayer</h2>
<blockquote>
<p>hexo-tag-dplayer: <a href="https://github.com/NextMoe/hexo-tag-dplayer" target="_blank" rel="noopener">https://github.com/NextMoe/hexo-tag-dplayer</a></p>
</blockquote>
<h3 id="命令行安装-v2">命令行安装</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-tag-dplayer --save</span><br></pre></td></tr></table></figure>
<h3 id="标签参数-v2">标签参数</h3>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&#123;% dplayer <span class="attribute">key</span>=value <span class="built_in">..</span>. %&#125;</span><br></pre></td></tr></table></figure>
<p>参数：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">dplayer options:</span><br><span class="line">    <span class="string">'autoplay'</span>, <span class="string">'loop'</span>, <span class="string">'screenshot'</span>, <span class="string">'hotkey'</span>, <span class="string">'mutex'</span>, <span class="string">'dmunlimited'</span> : bool options, use <span class="string">"yes"</span> <span class="string">"y"</span> <span class="string">"true"</span> <span class="string">"1"</span> <span class="string">"on"</span> <span class="keyword">or</span> just without value <span class="keyword">to</span> enable</span><br><span class="line">    <span class="string">'preload'</span>, <span class="string">'theme'</span>, <span class="string">'lang'</span>, <span class="string">'logo'</span>, <span class="string">'url'</span>, <span class="string">'pic'</span>, <span class="string">'thumbnails'</span>, <span class="string">'vidtype'</span>, <span class="string">'suburl'</span>, <span class="string">'subtype'</span>, <span class="string">'subbottom'</span>, <span class="string">'subcolor'</span>, <span class="string">'subcolor'</span>, <span class="string">'id'</span>, <span class="string">'api'</span>, <span class="string">'token'</span>, <span class="string">'addition'</span>, <span class="string">'dmuser'</span> : string arguments</span><br><span class="line">    <span class="string">'volume'</span>, <span class="string">'maximum'</span> : number arguments</span><br><span class="line">container options:</span><br><span class="line">    <span class="string">'width'</span>, <span class="string">'height'</span> : string, used <span class="keyword">in</span> container element style</span><br><span class="line">other:</span><br><span class="line">    <span class="string">'code'</span> : value of this key will be append <span class="keyword">to</span><span class="built_in"> script </span>tag</span><br></pre></td></tr></table></figure>
<h3 id="例子-v2">例子</h3>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% dplayer "url=https://player.bilibili.com/player.html?aid=98312470&amp;bvid=BV1pE411F7BX&amp;cid=167824910&amp;page=1" "api=http://dplayer.daoapp.io" "pic=https://www.xiami.com/webapp/embed-player?autoPlay=1&amp;id=1900020217" "id=9E2E3368B56CDBB4" "loop=yes" "theme=#FADFA3" "autoplay=false" "token=tokendemo" %&#125;</span><br></pre></td></tr></table></figure>
<div id="dplayer0" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer0"),"theme":"#FADFA3","loop":true,"video":{"url":"https://player.bilibili.com/player.html?aid=98312470&bvid=BV1pE411F7BX&cid=167824910&page=1","pic":"https://www.xiami.com/webapp/embed-player?autoPlay=1&id=1900020217"},"danmaku":{"id":"9E2E3368B56CDBB4","api":"http://dplayer.daoapp.io","token":"tokendemo"}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script>
<h1 id="其他相关文章">其他相关文章</h1>
<p><a href="../Git-Pages-Jekyll-Hexo-Build-your-own-blog.html">Git Pages + Jekyll/Hexo Build your own blog 构建个人博客-你想知道的都在这里了</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Blog</tag>
      </tags>
  </entry>
  <entry>
    <title>GraphQL All you should know</title>
    <url>/GraphQL-All-you-should-know.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><ul>
<li><a href="https://betterprogramming.pub/graphql-from-excitement-to-deception-f81f7c95b7cf" target="_blank" rel="noopener">GraphQL: From Excitement to Deception</a> GraphQL是一种新趋势，但并未说服所有人。虽然移动和前端团队喜欢它的惊人工具和强类型，但后端工程师提出了一些问题，例如缺乏适当的分页、缓存、MIME类型以及管理GraphQL类型和本机类型的复杂性。随着项目的增长，需要使用昂贵的工具（如Stitching或Federation）来修复大型模式。生态系统尚不够成熟，与REST API相比，维护此解决方案的成本太高。为了做出明智的决策，需要了解业务需求和组织约束，例如有多少开发人员以及他们是否已经熟悉GraphQL。</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>How to Compress HTTP responses at the Tomcat level</title>
    <url>/How-to-Compress-HTTP-responses-at-the-Tomcat-level.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="tomcat应用程序服务器级别压缩选项">Tomcat应用程序服务器级别压缩选项</h2>
<p>有时可能会注意到 HTTP 流量很高，有可能因为服务器正试图将大量数据返回给浏览器。<br>
在这种情况下，如果正在运行 Tomcat，则可以添加在应用程序服务器级别打开压缩的选项。 这样做会压缩 HTTP 响应，并且可以在性能上产生很大的差异，尤其是对于文本密集型的流量。 压缩文本的大小可以减少 90% 以上，如果您的未压缩数据以 MB 为单位，这会产生很大的不同。</p>
<ol>
<li>
<p>关闭 Tomcat 服务器。</p>
</li>
<li>
<p>编辑在 Tomcat 的 <code>conf/server.xml</code> 文件。</p>
</li>
<li>
<p>将以下属性添加到连接器（compression、compressMinSize、noCompressionUserAgents 和 compressibleMimeType），如下例所示：</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">compressibleMimeType</span> =<span class="string">"text/html,text/xml,text/css,text/javascript,application/javascript,application/json"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">compression</span>=<span class="string">"on"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">compressionMinSize</span>=<span class="string">"128"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">noCompressionUserAgents</span>=<span class="string">"gozilla, traviata"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">port</span>=<span class="string">"8080"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">redirectPort</span>=<span class="string">"8443"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>注意MimeType 是改过名字的！！！否则启动中是有warining的</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[main] org.apache.catalina.startup.SetAllPropertiesRule.begin [SetAllPropertiesRule]&#123;Server/Service/Connector&#125; Setting property &apos;compressableMimeType&apos; to &apos;text/html,text/xml,application/javascript,text/css,text/plain&apos; did not find a matching property.</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>Tomcat version</th>
<th>MimeType</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://tomcat.apache.org/tomcat-5.5-doc/config/http.html#Standard_Implementation" target="_blank" rel="noopener">tomcat-5.5</a></td>
<td>compress<code>a</code>bleMimeType</td>
</tr>
<tr>
<td><a href="https://tomcat.apache.org/tomcat-6.0-doc/config/http.html#Standard_Implementation" target="_blank" rel="noopener">tomcat-6.0</a></td>
<td>compress<code>a</code>bleMimeType</td>
</tr>
<tr>
<td><a href="https://tomcat.apache.org/tomcat-7.0-doc/config/http.html#Standard_Implementation" target="_blank" rel="noopener">Tomcat 7.0 文档</a></td>
<td>compress<code>i</code>bleMimeType</td>
</tr>
<tr>
<td><a href="https://tomcat.apache.org/tomcat-8.5-doc/config/http.html#Standard_Implementation" target="_blank" rel="noopener">Tomcat 8.5 文档</a></td>
<td>compress<code>i</code>bleMimeType</td>
</tr>
<tr>
<td><a href="https://tomcat.apache.org/tomcat-9.0-doc/config/http.html" target="_blank" rel="noopener">Tomcat 9 文档</a></td>
<td>compress<code>i</code>bleMimeType</td>
</tr>
<tr>
<td><a href="https://tomcat.apache.org/tomcat-10.0-doc/config/http.html" target="_blank" rel="noopener">Tomcat 10 文档</a></td>
<td>compress<code>i</code>bleMimeType</td>
</tr>
</tbody>
</table>
<p>参数说明：</p>
<ul>
<li>org.apache.coyote.http11.Http11NioProtocol：调整工作模式为Nio</li>
<li>maxThreads：最大线程数，默认150。增大值避免队列请求过多，导致响应缓慢。</li>
<li>minSpareThreads：最小空闲线程数。</li>
<li>acceptCount：当处理请求超过此值时，将后来请求放到队列中等待。</li>
<li>disableUploadTimeout：禁用上传超时时间</li>
<li>connectionTimeout：连接超时，单位毫秒，0代表不限制</li>
<li>URIEncoding：URI地址编码使用UTF-8</li>
<li>enableLookups：关闭dns解析，提高响应时间</li>
<li>compression：启用压缩功能</li>
<li>compressionMinSize：最小压缩大小，单位Byte</li>
<li>compressibleMimeType ：压缩的文件类型</li>
<li>noCompressionUserAgents: 该值是一个正则表达式（使用java.util.regex），与user-agent不应使用压缩的HTTP客户端的头部相匹配，因为这些客户端虽然宣称支持该功能，但实现方式却不一致。默认值是一个空字符串（禁用正则表达式匹配）。</li>
</ul>
<ol start="4">
<li>重启Tomcat服务器</li>
</ol>
<hr>
<p>注意：压缩compression与 <code>useSendFile</code> 配置不兼容。 有关详细信息，请参阅文档</p>
<ul>
<li><a href="https://tomcat.apache.org/tomcat-9.0-doc/config/http.html" target="_blank" rel="noopener">Tomcat 9 文档</a></li>
<li><a href="https://tomcat.apache.org/tomcat-8.5-doc/config/http.html#Standard_Implementation" target="_blank" rel="noopener">Tomcat 8.5 文档</a></li>
</ul>
<h2 id="tomcat-内存与优化">Tomcat 内存与优化</h2>
<h3 id="tomcat-运行环境介绍">Tomcat 运行环境介绍</h3>
<ol>
<li>Tomcat 本身无法直接在计算机上运行，需要依赖硬件基础上的操作系统和Java虚拟机；</li>
<li>Java 程序启动时JVM都会分配一个初始内存和最大内存给这个应用；</li>
<li>当应用程序用到最大内存的时刻，就会触发JVM做垃圾回收(GC)动作，释放被占用的内存；</li>
<li>因此想要调整Java程序启动时的初始内存和最大内存，需要向JVM申请；</li>
<li>如果初始内存大小设置过小，且此时初始化的应用对象过多，虚拟机就必须重复的加载内存来满足使用；</li>
<li>基于以上原因，最好把初始内存大小(Xms)和最大内存(Xmx)设置成一样；</li>
<li>JVM上所有的对象都在&quot;&quot;“堆区(heap)”&quot;&quot;上分配内存(也有在&quot;栈&quot;上分配内存的)</li>
<li>堆区的大小是可以动态扩展的，但&quot;&quot;“堆”&quot;&quot;的大小受限于系统使用的物理内存，当应用程序需要的内存超出&quot;堆&quot;的最大值时，JVM虚拟机就会抛出内存溢出异常，并且导致应用程序奔溃；</li>
<li>基于以上原因，建议“堆”的大小设置成物理内存的80%</li>
</ol>
<h3 id="linux下的tomcat">Linux下的tomcat</h3>
<p>需要找到<code>catalina.sh</code>，在<code>cygwin=false</code>的上面一行加上：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">JAVA_OPTS=<span class="string">"-Xms256m -Xmx512m -Xss1024K -XX:PermSize=128m -XX:MaxPermSize=256m"</span></span><br></pre></td></tr></table></figure>
<h3 id="windows下解压版的tomcat">Windows下解压版的tomcat</h3>
<p>要通过startup.bat启动tomcat才能加载配置</p>
<p>要添加在tomcat 的bin 下catalina.bat 里</p>
<p>rem Guess CATALINA_HOME if not defined<br>
<code>set CURRENT_DIR=%cd%</code>后面添加,红色的为新添加的.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1 <span class="built_in">set</span> JAVA_OPTS=-Xms256m -Xmx512m -XX:PermSize=128M -XX:MaxNewSize=256m -XX:MaxPermSize=256m -Djava.awt.headless=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h4 id="情况二-安装版的tomcat-没有catalina-bat">情况二:安装版的Tomcat ,没有catalina.bat</h4>
<p>安装版的Tomcat下没有catalina.bat</p>
<p>如果tomcat 6 注册成了windows服务，或者windows2003下用tomcat的安装版，在/bin/tomcat6w.exe里修改就可以了。</p>
<p>如果tomcat 5, windows服务执行的是bin\tomcat.exe.他读取注册表中的值,而不是catalina.bat的设置.<br>
修改注册表HKEY_LOCAL_MACHINE\SOFTWARE\Apache Software Foundation\Tomcat Service Manager\Tomcat5\Parameters\JavaOptions<br>
原值为<br>
<code>-Dcatalina.home=&quot;C:\ApacheGroup\Tomcat 5.0&quot; -Djava.endorsed.dirs=&quot;C:\ApacheGroup\Tomcat 5.0\common\endorsed&quot; -Xrs</code><br>
加入 <code>-Xms300m -Xmx350m</code><br>
重起tomcat服务,设置生效</p>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://community.jaspersoft.com/wiki/how-compress-http-responses-tomcat-level" target="_blank" rel="noopener">How to Compress HTTP responses at the Tomcat level</a></li>
<li><a href="https://blog.csdn.net/bluetjs/article/details/77449535" target="_blank" rel="noopener">Apache Tomcat 8.5 安全配置与高并发优化</a></li>
<li><a href="https://www.cnblogs.com/hardxuexi/articles/8817897.html" target="_blank" rel="noopener">tomcat优化配置属性含义解释，转自官网 </a></li>
<li><a href="https://juejin.cn/post/7085588638255284260" target="_blank" rel="noopener">Tomcat参数调优</a>
<ul>
<li><a href="https://juejin.cn/post/7067745436555182087" target="_blank" rel="noopener">https://juejin.cn/post/7067745436555182087</a></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Tomcat</tag>
      </tags>
  </entry>
  <entry>
    <title>&quot;Hexo fs.SyncWriteStream is deprecated&quot;</title>
    <url>/Hexo-node-28561-DEP0061-DeprecationWarning-fs-SyncWriteStream-is-deprecated.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="problem">Problem</h1>
<p>NodeJs V8 使用hexo时报错：</p>
<p>(node:28561) [DEP0061] DeprecationWarning: fs.SyncWriteStream is deprecated.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">➜  Hexo-theme-zilan git:(master) ✗ hexo g</span><br><span class="line">(node:28561) [DEP0061] DeprecationWarning: fs.SyncWriteStream is deprecated.</span><br><span class="line">INFO  Start processing</span><br><span class="line">FATAL Something<span class="string">'s wrong. Maybe you can find the solution here: http://hexo.io/docs/troubleshooting.html</span></span><br><span class="line"><span class="string">TypeError: Cannot set property '</span>lastIndex<span class="string">' of undefined</span></span><br><span class="line"><span class="string">    at highlight (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/highlight.js/lib/highlight.js:511:35)</span></span><br><span class="line"><span class="string">    at /Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/highlight.js/lib/highlight.js:561:21</span></span><br><span class="line"><span class="string">    at Array.forEach (&lt;anonymous&gt;)</span></span><br><span class="line"><span class="string">    at Object.highlightAuto (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/highlight.js/lib/highlight.js:560:40)</span></span><br><span class="line"><span class="string">    at /Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/hexo-util/lib/highlight.js:117:25</span></span><br><span class="line"><span class="string">    at highlight (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/hexo-util/lib/highlight.js:120:7)</span></span><br><span class="line"><span class="string">    at highlightUtil (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/hexo-util/lib/highlight.js:22:14)</span></span><br><span class="line"><span class="string">    at /Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/hexo/lib/plugins/filter/before_post_render/backtick_code_block.js:62:15</span></span><br><span class="line"><span class="string">    at String.replace (&lt;anonymous&gt;)</span></span><br><span class="line"><span class="string">    at Hexo.backtickCodeBlock (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/hexo/lib/plugins/filter/before_post_render/backtick_code_block.js:14:31)</span></span><br><span class="line"><span class="string">    at Hexo.tryCatcher (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/util.js:16:23)</span></span><br><span class="line"><span class="string">    at Hexo.&lt;anonymous&gt; (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/method.js:15:34)</span></span><br><span class="line"><span class="string">    at Promise.each.filter (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/hexo/lib/extend/filter.js:63:65)</span></span><br><span class="line"><span class="string">    at tryCatcher (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/util.js:16:23)</span></span><br><span class="line"><span class="string">    at Object.gotValue (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/reduce.js:155:18)</span></span><br><span class="line"><span class="string">    at Object.gotAccum (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/reduce.js:144:25)</span></span><br><span class="line"><span class="string">    at Object.tryCatcher (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/util.js:16:23)</span></span><br><span class="line"><span class="string">    at Promise._settlePromiseFromHandler (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/promise.js:512:31)</span></span><br><span class="line"><span class="string">    at Promise._settlePromise (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/promise.js:569:18)</span></span><br><span class="line"><span class="string">    at Promise._settlePromiseCtx (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/promise.js:606:10)</span></span><br><span class="line"><span class="string">    at Async._drainQueue (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/async.js:138:12)</span></span><br><span class="line"><span class="string">    at Async._drainQueues (/Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/bluebird/js/release/async.js:143:10)</span></span><br></pre></td></tr></table></figure>
<h2 id="root-cause">Root cause</h2>
<p>hexo-fs 老版本里有一行：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">exports.SyncWriteStream</span> = fs.SyncWriteStream<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>跟nodejs v8 有冲突。所以要更新 hexo-fs &gt;= ^0.2.0</p>
<h1 id="solutions">Solutions</h1>
<h2 id="fix-1-use-old-version-of-nodejs">Fix 1 use old version of nodejs</h2>
<p>用nvm管理node版本。发现切换node后，zsh: command not found: hexo。<br>
重新npm install hexo-cli -g 就好了</p>
 <figure class="highlight css"><table><tr><td class="code"><pre><span class="line">➜  <span class="selector-tag">Hexo-theme-zilan</span> <span class="selector-tag">git</span><span class="selector-pseudo">:(master)</span> ✗ <span class="selector-tag">nvm</span> <span class="selector-tag">list</span></span><br><span class="line">        <span class="selector-tag">v7</span><span class="selector-class">.4</span><span class="selector-class">.0</span></span><br><span class="line"><span class="selector-tag">-</span>&gt;       <span class="selector-tag">v8</span><span class="selector-class">.9</span><span class="selector-class">.1</span></span><br><span class="line">        <span class="selector-tag">v9</span><span class="selector-class">.3</span><span class="selector-class">.0</span></span><br><span class="line">➜  <span class="selector-tag">Hexo-theme-zilan</span> <span class="selector-tag">git</span><span class="selector-pseudo">:(master)</span> ✗ <span class="selector-tag">nvm</span> <span class="selector-tag">use</span> <span class="selector-tag">v7</span><span class="selector-class">.4</span><span class="selector-class">.0</span></span><br><span class="line"><span class="selector-tag">Now</span> <span class="selector-tag">using</span> <span class="selector-tag">node</span> <span class="selector-tag">v7</span><span class="selector-class">.4</span><span class="selector-class">.0</span> (<span class="selector-tag">npm</span> <span class="selector-tag">v4</span><span class="selector-class">.0</span><span class="selector-class">.5</span>)</span><br><span class="line">➜  <span class="selector-tag">Hexo-theme-zilan</span> <span class="selector-tag">git</span><span class="selector-pseudo">:(master)</span> ✗ <span class="selector-tag">npm</span> <span class="selector-tag">install</span></span><br><span class="line">➜  <span class="selector-tag">Hexo-theme-zilan</span> <span class="selector-tag">git</span><span class="selector-pseudo">:(master)</span> ✗ <span class="selector-tag">hexo</span> <span class="selector-tag">g</span></span><br><span class="line"><span class="selector-tag">zsh</span>: <span class="selector-tag">command</span> <span class="selector-tag">not</span> <span class="selector-tag">found</span>: <span class="selector-tag">hexo</span></span><br><span class="line"></span><br><span class="line">➜  <span class="selector-tag">Hexo-theme-zilan</span> <span class="selector-tag">git</span><span class="selector-pseudo">:(master)</span> ✗ <span class="selector-tag">npm</span> <span class="selector-tag">install</span> <span class="selector-tag">hexo-cli</span> <span class="selector-tag">-g</span></span><br></pre></td></tr></table></figure>
<h2 id="fix-2-install-hexo-fs">Fix 2 install hexo-fs</h2>
<p>如果还想使用nodejs &gt; v8, 可以更新hexo-fs</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">➜  Hexo-theme-zilan git:(master) ✗ npm <span class="keyword">install</span> hexo-fs –<span class="keyword">save</span></span><br></pre></td></tr></table></figure>
<p>试了下还是没解决。。。 Try again, still has the error…</p>
<h2 id="fix-2-hexo-debug">Fix 2 hexo --debug</h2>
<p>会发现hexo-deployer-git 里使用了旧版本的hexo-fs，所以造成问题</p>
  <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">➜  Hexo-theme-zilan git:(master) ✗ hexo --debug</span><br><span class="line">    07:05:51.382 <span class="builtin-name">DEBUG</span> Hexo version: 3.7.1</span><br><span class="line">    07:05:51.385 <span class="builtin-name">DEBUG</span> Working directory: ~/MyOwnGit/Hexo-theme-zilan/</span><br><span class="line">    07:05:51.513 <span class="builtin-name">DEBUG</span><span class="built_in"> Config </span>loaded: ~/MyOwnGit/Hexo-theme-zilan/_config.yml</span><br><span class="line">    07:05:51.579 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-deployer-git</span><br><span class="line">    (node:29976) [DEP0061] DeprecationWarning: fs.SyncWriteStream is deprecated.</span><br><span class="line">    07:05:51.728 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-fs</span><br><span class="line">    07:05:51.731 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-generator-archive</span><br><span class="line">    07:05:51.733 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-generator-category</span><br><span class="line">    07:05:51.737 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-generator-feed</span><br><span class="line">    07:05:51.738 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-generator-index</span><br><span class="line">    07:05:51.783 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-generator-seo-friendly-sitemap</span><br><span class="line">    07:05:51.784 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-generator-tag</span><br><span class="line">    07:05:51.788 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-renderer-ejs</span><br><span class="line">    07:05:52.277 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-renderer-jade</span><br><span class="line">    07:05:52.278 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-renderer-markdown-it</span><br><span class="line">    07:05:52.280 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-renderer-stylus</span><br><span class="line">    07:05:52.360 <span class="builtin-name">DEBUG</span> Plugin loaded: hexo-server</span><br><span class="line">    07:05:52.364 <span class="builtin-name">DEBUG</span><span class="built_in"> Script </span>loaded: themes/zilan/scripts/fancybox.js</span><br></pre></td></tr></table></figure>
<h2 id="fix-2-modify-hexo-deployer-git">Fix 2 modify hexo-deployer-git</h2>
 <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">➜  Hexo-theme-zilan git:(master) ✗ npm <span class="keyword">install</span> hexo-deployer-git hexo-serve <span class="comment">--save</span></span><br></pre></td></tr></table></figure>
<p>试了下还是没解决。。。 Try again, still has the error…<br>
看了下hexo-deployer-git并没什么更新，只能自己手动改了</p>
<p>注释掉 /Users/liyuankun/MyOwnGit/Hexo-theme-zilan/node_modules/hexo-deployer-git/node_modules/hexo-fs/lib/fs.js 中的</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//exports.SyncWriteStream = fs.SyncWriteStream;</span></span><br></pre></td></tr></table></figure>
<h1 id="reference-links">Reference Links</h1>
<p><a href="https://github.com/hexojs/hexo/issues/2598" target="_blank" rel="noopener">fs.SyncWriteStream is deprecated [Nodejs v8.0]</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>node.js</tag>
        <tag>Hexo</tag>
        <tag>Blog</tag>
      </tags>
  </entry>
  <entry>
    <title>How to debug openssl command line</title>
    <url>/How-to-debug-openssl-command-line.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Openssl provides command line tool to let user operate the security functions conveniently in terminal. This <a href="https://www.openssl.org/docs/man3.1/man1/" target="_blank" rel="noopener">official site</a> describes openssl command in details. As we know, openssl is an open source project so we can dig into the concrete internal code of a command. This page describes how to configure the openssl source code project in VSCode to debug openssl command.</p>
<h2 id="code-structure">Code structure</h2>
<p>In this page, I take openssl 3.0.8 as example. Download the code from <a href="https://github.com/openssl/openssl" target="_blank" rel="noopener">https://github.com/openssl/openssl</a> . Let’s see the root folder below. Here we only focus on the crypto and apps folder.</p>
<p><img src="https://raw.githubusercontent.com/CatherineLiyuankun/PictureBed/master/blog/post/How-to-debug-openssl-command-line/openssl1.png" alt="crypto and apps folder"></p>
<p>The crypto folder is the core of openssl. It contains the implementation of encrypted algorithm and other security features. The apps folder is just the command line entry point. We should first build crypto then let apps link to crypto whose library name is libcrypto.a.</p>
<h2 id="how-to-build-libcrypto-a">How to build libcrypto.a</h2>
<p>In the openssl root folder, run:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./config -d</span><br></pre></td></tr></table></figure>
<p>This is to make a debug configuration. “-d” means the ultimate library can be stepped into to see the code for debugger.</p>
<p>Then build, run:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make clean</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p>“make clean” is to remove any intermediate generated files from previous build. If it is the first time, “make clean” can be neglected.</p>
<p>“make” is just to build the library.</p>
<p>After successful build, we can find the libcrypto.a in the root folder.</p>
<h2 id="how-to-debug-openssl-command">How to debug openssl command</h2>
<p>Now we can debug openssl command. The whole thought is to directly run code in “apps” + libcrypto.a + header files.</p>
<p><img src="https://raw.githubusercontent.com/CatherineLiyuankun/PictureBed/master/blog/post/How-to-debug-openssl-command-line/openssl2.png" alt="“apps” + libcrypto.a + header files"></p>
<p>We use VSCode IDE to set up the environment.<br>
Here I don’t mention how to add C/C++ plugin/extension in VSCode and how to create tasks.json/launch.json template initially because these can be easily found on the Internet.<br>
The file paths(/Users/weilin/…) mentioned afterwards are paths in my machine. You can easily replace them with your paths. The steps are:</p>
<ol>
<li>
<p>Copy <code>apps</code> folder out to a new place and open <code>apps</code> in VSCode.</p>
</li>
<li>
<p>Add <code>.vscode/tasks.json</code> as below. This is just the completed gcc build command. Those code files after <code>-g</code> is just the C code to be built. (I used * wildcard in order not to type too many files here.)The “<code>-I</code>” part is additional header file search path. And we also specify the <code>libcrypto.a</code>.</p>
</li>
</ol>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"tasks"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"cppbuild"</span>,</span><br><span class="line">            <span class="attr">"label"</span>: <span class="string">"C/C++: gcc build active file"</span>,</span><br><span class="line">            <span class="attr">"command"</span>: <span class="string">"/usr/bin/gcc"</span>,</span><br><span class="line">            <span class="attr">"args"</span>: [</span><br><span class="line">                <span class="string">"-fdiagnostics-color=always"</span>,</span><br><span class="line">                <span class="string">"-g"</span>,</span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/openssl/ssl/*.c"</span>, </span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/openssl/ssl/record/*.c"</span>,</span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/apps/lib/app*.c"</span>,</span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/apps/lib/fmt.c"</span>, <span class="string">"/Users/weilin/openssl/src/apps/*.c"</span>, </span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/apps/lib/c*.c"</span>, <span class="string">"/Users/weilin/openssl/src/openssl/ssl/statem/*.c"</span>,</span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/apps/lib/n*.c"</span>, <span class="string">"/Users/weilin/openssl/src/apps/lib/e*.c"</span>, </span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/apps/lib/s*.c"</span>, <span class="string">"/Users/weilin/openssl/src/apps/lib/h*.c"</span>, </span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/apps/lib/t*.c"</span>, <span class="string">"/Users/weilin/openssl/src/apps/lib/v*.c"</span>,</span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/apps/lib/o*.c"</span>,</span><br><span class="line">                <span class="string">"-o"</span>,</span><br><span class="line">                <span class="string">"$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;"</span>,</span><br><span class="line">                <span class="string">"-I"</span>,</span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/openssl/include"</span>,</span><br><span class="line">                <span class="string">"-I"</span>,</span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/apps/include"</span>,</span><br><span class="line">                <span class="string">"-I"</span>,</span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/openssl"</span>,</span><br><span class="line">                <span class="string">"/Users/weilin/openssl/src/openssl/libcrypto.a"</span>,</span><br><span class="line">                <span class="string">"-ldl"</span>,</span><br><span class="line">                <span class="string">"-lpthread"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"options"</span>: &#123;</span><br><span class="line">                <span class="attr">"cwd"</span>: <span class="string">"$&#123;fileDirname&#125;"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">"problemMatcher"</span>: [</span><br><span class="line">                <span class="string">"$gcc"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"group"</span>: &#123;</span><br><span class="line">                <span class="attr">"kind"</span>: <span class="string">"build"</span>,</span><br><span class="line">                <span class="attr">"isDefault"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">"detail"</span>: <span class="string">"Task generated by Debugger."</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"version"</span>: <span class="string">"2.0.0"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Open <code>openssl.c</code> file. This is just the entry point of openssl command. You can find the beginning main function “int main(…)” in it. Tap the running button on top right, it will build and run the code. Because we don’t specify any command line arguments, the output is the help information. To confirm it,  we can type “openssl” in terminal. The helper output are the same!</li>
</ol>
<p><img src="https://raw.githubusercontent.com/CatherineLiyuankun/PictureBed/master/blog/post/How-to-debug-openssl-command-line/openssl3.png" alt="Output in VSCode"></p>
<p><img src="https://raw.githubusercontent.com/CatherineLiyuankun/PictureBed/master/blog/post/How-to-debug-openssl-command-line/openssl4.png" alt="Output in Terminal"></p>
<ol start="4">
<li>Now we almost reach our goal. The only thing we should do is to specify the arguments. Suppose we need to debug this command:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">openssl pkcs12 -<span class="built_in">export</span> -<span class="keyword">in</span> cert_data -inkey myKey.pem -out mobileapp.p12 \</span><br><span class="line">-passout pass:123456 -provider-path providers</span><br></pre></td></tr></table></figure>
<p>We should add the <code>launch.json</code> as below. The args part are just command line arguments.</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Use IntelliSense to learn about possible attributes.</span></span><br><span class="line">    <span class="comment">// Hover to view descriptions of existing attributes.</span></span><br><span class="line">    <span class="comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">    <span class="attr">"configurations"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"(lldb) Launch"</span>,</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"cppdbg"</span>,</span><br><span class="line">            <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">            <span class="attr">"program"</span>: <span class="string">"$&#123;fileDirname&#125;/openssl"</span>,</span><br><span class="line">            <span class="attr">"args"</span>: [<span class="string">"pkcs12"</span>, <span class="string">"-export"</span>, <span class="string">"-in"</span>, </span><br><span class="line">            <span class="string">"cert_data"</span>, <span class="string">"-inkey"</span>, </span><br><span class="line">            <span class="string">"myKey.pem"</span>, <span class="string">"-out"</span>, </span><br><span class="line">            <span class="string">"mobileapp.p12"</span>, <span class="string">"-passout"</span>, <span class="string">"pass:123456"</span>, <span class="string">"-legacy"</span>,</span><br><span class="line">            <span class="string">"-provider-path"</span>, <span class="string">"providers"</span>],</span><br><span class="line">            <span class="attr">"stopAtEntry"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"cwd"</span>: <span class="string">"$&#123;fileDirname&#125;"</span>,</span><br><span class="line">            <span class="attr">"environment"</span>: [&#123;<span class="attr">"name"</span>:<span class="string">"OPENSSL_CONF"</span>, <span class="attr">"value"</span>:<span class="string">"/Users/weilin/openssl/src/apps/openssl.cnf"</span>&#125;],</span><br><span class="line">            <span class="attr">"externalConsole"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"MIMode"</span>: <span class="string">"lldb"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Set the breakpoint. We can debug the code now! Have fun~<br>
<img src="https://raw.githubusercontent.com/CatherineLiyuankun/PictureBed/master/blog/post/How-to-debug-openssl-command-line/openssl5.png" alt="Debug in VSCode"></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Linux/bash</category>
      </categories>
      <tags>
        <tag>Command line</tag>
      </tags>
  </entry>
  <entry>
    <title>IDEA 安装配置监控JVM 插件-VisualVM-解决jdk11无法启动VisualVM问题</title>
    <url>/IDEA-%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E7%9B%91%E6%8E%A7JVM-%E6%8F%92%E4%BB%B6-VisualVM-%E8%A7%A3%E5%86%B3jdk11%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8VisualVM%E9%97%AE%E9%A2%98.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>GitHub：<a href="https://github.com/oracle/visualvm" target="_blank" rel="noopener">VisualVM</a> 已经被 Oracle 在 GitHub 上开源了，因此我们可以直接在 GitHub 上下载安装包。</p>
<h2 id="idea-安装配置监控jvm-插件">IDEA 安装配置监控JVM 插件</h2>
<p>打开Preference --&gt; Plugins --&gt; 搜索VisualVM  --&gt; install --&gt; Apply</p>
<p><a href="https://plugins.jetbrains.com/plugin/7115-visualvm-launcher/" target="_blank" rel="noopener">VisualVM IDEA 插件链接</a></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Java/VisualVM/VisualVM-install.png" alt="VisualVM-install.png"></p>
<h2 id="idea配置visualvm">IDEA配置VisualVM</h2>
<p>重新打开Preference --&gt; Other Settings --&gt; VisualVM Launcher --&gt; VisualVM executable</p>
<p>Other Settings --&gt; VisualVM Launcher 这部分设置第一步&quot;plugins中安装VisualVM Launcher插件&quot;之后才会显示。</p>
<h3 id="jdk-8">jdk 8</h3>
<p>VisualVM executable 填 <code>你的jdk8路径/bin/jvisualvm.exe</code>, 例如<code>C:/Program Files/Java/jdk1.8.0_131/bin/jvisualvm.exe</code></p>
<h3 id="jdk-11">jdk 11</h3>
<p>发现JDK11的目录里，bin目录下并没有jvisualvm的可执行文件<code>jvisualvm.exe</code>.<br>
原来从jdk 9开始, visualVM不再集成在Oracle JDK中, 需要单独下载安装。</p>
<ul>
<li>
<p>IDEA 的VisualVM executable里也有提示链接： <a href="https://visualvm.github.io/" target="_blank" rel="noopener">VisualVM executable</a></p>
</li>
<li>
<p>下载地址: <a href="https://visualvm.github.io/download.html" target="_blank" rel="noopener">https://visualvm.github.io/download.html</a></p>
</li>
<li>
<p>与IDE集成方式： <a href="https://visualvm.github.io/idesupport.html" target="_blank" rel="noopener">https://visualvm.github.io/idesupport.html</a></p>
</li>
<li>
<p>Windows 下载visualvm_215.zip</p>
<!-- - 解压到JDK目录下，层级对应覆盖即可。bin目录下的内容copy到`你的jdk11路径/bin` (例如`C:/Program Files/Eclipse Adoptium/jdk-11.0.13.8-hotspot/bin/visualvm.exe`)下面，其他类似。 -->
<ul>
<li>解压visualvm_215.zip为visualvm_215，我是放在<code>Z:\Program Files\visualvm_215</code></li>
<li>VisualVM executable 填写<code>visualvm_215路径/bin/visualvm.exe</code></li>
<li><code>visualvm_215路径/etc/visualvm.conf</code> 里面配置JDK路径，例如 <code>visualvm_jdkhome=&quot;C:/Program Files/Eclipse Adoptium/jdk-11.0.13.8-hotspot&quot;</code></li>
<li>如果显示检测不到本地运行Java程序, 就到刚刚<code>visualvm_215路径/bin/jvisualvm.exe</code>的文件处，右击选择<code>以管理员身份运行</code>
<ul>
<li>监控的本地jdk路径（不修改也是能用，只是不能显示详细的包名和类名，只显示进程号难以区分）</li>
</ul>
</li>
</ul>
</li>
<li>
<p>MacOS 下载VisualVM_215.dmg 安装</p>
<ul>
<li>VisualVM executable 填写<code>/Applications/VisualVM.app/Contents/MacOS/visualvm</code></li>
<li><code>/Applications/VisualVM.app/Contents/Resources/visualvm/etc/visualvm.conf</code> 里面配置JDK路径，例如 <code>visualvm_jdkhome=&quot;/opt/homebrew/Cellar/openjdk@11/11.0.15/libexec/openjdk.jdk/Contents/Home&quot;</code> (参考：<a href="https://blog.51cto.com/u_15456153/4847185" target="_blank" rel="noopener">Mac安装VisualVM Mac版 V2.0.7</a>)</li>
</ul>
</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Java/VisualVM/VisualVM-config-mac.png" alt="VisualVM-config-mac"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Java/VisualVM/VisualVM-config-windows.png" alt="VisualVM-config-windows"></p>
<p>Preference --&gt; Other Settings --&gt; VisualVM Launcher --&gt; Custom JDK home path 默认使用project配置的JDK，如果找不到，就会使用填写的指定的jdk。</p>
<h2 id="idea启动visualvm">IDEA启动VisualVM</h2>
<p>然后重启IDEA，点击<code>Run</code>就发现多了两个选择。点击这两个选项，就可以启动VisualVM。</p>
<ul>
<li><code>Run with VisualVM</code></li>
<li><code>DeBug with VisualVM</code></li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Java/VisualVM/VisualVM-start.png" alt="启动VisualVM"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Java/VisualVM/VisualVM-run.png" alt="VisualVM-run"></p>
<h3 id="启动按钮diabled状态无法启动visualvm">启动按钮diabled状态无法启动VisualVM</h3>
<p>可以参考这篇文章：<a href="https://segmentfault.com/a/1190000040495117" target="_blank" rel="noopener">IDEA安装了VisualVM Launcher插件无法调试使用</a><br>
但是仍然没有解决我的问题，仍然是disabled状态。后来在左下方“Console” tab下看到了VisualVM一个图标，实测可用。</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Java/VisualVM/VisualVM-IDEAstart.pic.jpg" alt="“Console” tab下看到了VisualVM一个图标"></p>
<h3 id="命令行启动visualvm">命令行启动VisualVM</h3>
<ol>
<li>
<p>本地启动Java服务后，保持运行；打开终端，输入jps命令回车，查看进程ID，例如进程ID为44620；<br>
<code>jps</code></p>
</li>
<li>
<p>打开终端，输入jvisualvm命令、参数和进程ID后回车，会自动打开此软件，命令如下：</p>
</li>
</ol>
<p><code>jvisualvm --openpid 44620</code><br>
之后，稍等片刻，会自动弹出Java VisualVM软件界面。</p>
<h2 id="查看visualvm">查看VisualVM</h2>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Java/VisualVM/VisualVM-heap.png" alt="VisualVM-heap"></p>
<p>可以改变在VisualVM --&gt; Tool --&gt; Plugins --&gt; Settings --&gt; Edit<br>
Java VisualVM 插件各个版本： <a href="https://visualvm.github.io/pluginscenters.html" target="_blank" rel="noopener">https://visualvm.github.io/pluginscenters.html</a></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Java/VisualVM/VisualVM-plugin.png" alt="VisualVM-plugin.png"></p>
<h2 id="java-visualvm软件操作">Java VisualVM软件操作</h2>
<p>1、点击次级导航Tab中Threads项，之后点击Heap Dump按钮，会打印输出线程详细状态；</p>
<p>2、点击次级导航Tab中Monitor项，之后点击Heap Dump按钮，会输出内存镜像文件(.hprof文件，此文件可使用Eclipse平台的Memory Analyzer Tool，即MAT，进行详细分析)，此文件的完整路径，在界面中有显示；</p>
<p><a href="https://blog.csdn.net/u014427391/article/details/95347716?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-95347716-blog-124230445.pc_relevant_3mothn_strategy_recovery&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3" target="_blank" rel="noopener">Jvisualvm简单使用教程</a></p>
<h2 id="jdk-11使用jvisualvm-visualgc"><a href="https://blog.csdn.net/muxiaoshan/article/details/124230445" target="_blank" rel="noopener">jdk 11使用jvisualVM visualGC</a></h2>
<h2 id="其他相关文章">其他相关文章</h2>
<ul>
<li>
<p><a href="https://blog.csdn.net/wngpenghao/article/details/82884874" target="_blank" rel="noopener">VisualVM远程连接配置</a></p>
</li>
<li>
<p><a href="https://yanbin.blog/fix-jvisualvm-stuck-at-computing-description-issue/" target="_blank" rel="noopener">解决 jvisualvm 启动后长时间 Computing description… 的问题</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/6997281868362350599#heading-2" target="_blank" rel="noopener">环境篇：idea 安装VisualVM，Jprofiler，jclasslib</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/6997281868362350599#heading-2" target="_blank" rel="noopener">idea安装Jprofiler</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/liaoyue11/article/details/110853303?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-2-110853303-blog-123939267.pc_relevant_recovery_v2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-2-110853303-blog-123939267.pc_relevant_recovery_v2&amp;utm_relevant_index=5" target="_blank" rel="noopener">JAVA内存分析：idea集成jprofiler查看JVM内存使用情况</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/7081830261846982693" target="_blank" rel="noopener">JVM系列（二十）JVM监控及诊断工具-命令行篇</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
        <category>JVM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>IntelliJ</tag>
      </tags>
  </entry>
  <entry>
    <title>How to Set $JAVA_HOME environment variable on macOS</title>
    <url>/How-to-Set-JAVA-HOME-environment-variable-on-macOS.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><hr>
<h1 id="none"></h1>
<h1 id="reference-links">Reference Links</h1>
<ul>
<li><a href="../Install-Multiple-Java-Versions-on-Mac-by-Homebrew-Cask.html">Install Multiple Java Versions on Mac by Homebrew Cask</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Command line</tag>
      </tags>
  </entry>
  <entry>
    <title>Install Multiple Java Versions on Mac by Homebrew Cask</title>
    <url>/Install-Multiple-Java-Versions-on-Mac-by-Homebrew-Cask.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="安装homebrew-cask">安装<a href="https://github.com/Homebrew/homebrew-cask" target="_blank" rel="noopener">Homebrew Cask</a></h1>
<h2 id="brew-install-和-brew-cask-install-的区别"><a href="https://zhuanlan.zhihu.com/p/138059447" target="_blank" rel="noopener">brew install 和 brew cask install 的区别</a></h2>
<h2 id="homebrew-官网"><a href="https://brew.sh/" target="_blank" rel="noopener">homebrew</a> 官网</h2>
<p>Install <a href="https://github.com/Homebrew/homebrew-cask" target="_blank" rel="noopener">Homebrew Cask</a> first if you haven’t:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew update</span><br><span class="line"><span class="comment"># 老版本 brew tap caskroom/cask</span></span><br><span class="line"><span class="comment"># 会报错：</span></span><br><span class="line"><span class="comment"># Error: caskroom/cask was moved. Tap homebrew/cask instead.</span></span><br><span class="line"><span class="comment"># 2021 新版本：</span></span><br><span class="line">brew tap homebrew/cask </span><br><span class="line"><span class="comment"># 老版本： brew install brew-cask</span></span><br><span class="line">brew install homebrew/cask</span><br></pre></td></tr></table></figure>
<p>安装brew-cask-completion：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install brew-cask-completion</span><br></pre></td></tr></table></figure>
<p>But before doing that, let’s check if we already have JDK 7 installed by Homebrew Cask:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 老版本 brew tap caskroom/versions</span></span><br><span class="line"><span class="comment"># Error: caskroom/versions was moved. Tap homebrew/cask-versions instead.</span></span><br><span class="line">brew tap homebrew/cask-versions</span><br><span class="line"><span class="comment"># 老版本：brew cask info java7</span></span><br><span class="line">brew info --cask java7</span><br></pre></td></tr></table></figure>
<h2 id="how-to-use-homebrew-cask"><a href="https://github.com/Homebrew/homebrew-cask/blob/master/USAGE.md" target="_blank" rel="noopener">How to Use Homebrew Cask</a></h2>
<h1 id="安装java">安装Java</h1>
<h2 id="安装最新版本java">安装最新版本Java</h2>
<p>Otherwise, install Latest Version of Java Using Brew:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 老版本 brew cask install java</span></span><br><span class="line"><span class="comment"># 会报错：</span></span><br><span class="line"><span class="comment"># Error: Unknown command: cask</span></span><br><span class="line">brew install --cask java</span><br></pre></td></tr></table></figure>
<h2 id="安装指定版本java">安装指定版本Java</h2>
<h3 id="new-安装openjdk11-or-openjdk17">[New]安装openjdk11 or openjdk17</h3>
<p><a href="https://formulae.brew.sh/formula/openjdk@11" target="_blank" rel="noopener">Homebrew 安装openjdk11</a><br>
MACOS 升级M1芯片后，最好更新下jdk版本，运行效率更高。<br>
另外因为<code>CVE-2022-21476 vulnerability resolution</code> (aka Java upgrade to jdk-11.0.15+10) ，openjdk11最好更新到<code>11.0.15+10</code>.</p>
<ol>
<li>Install</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ brew install openjdk@11</span><br><span class="line"></span><br><span class="line">==&gt; openjdk@11</span><br><span class="line">For the system Java wrappers to find this JDK, symlink it with</span><br><span class="line">  sudo ln -sfn /opt/homebrew/opt/openjdk@11/libexec/openjdk.jdk /Library/Java/JavaVirtualMachines/openjdk-11.jdk</span><br><span class="line"></span><br><span class="line">openjdk@11 is keg-only, <span class="built_in">which</span> means it was not symlinked into /opt/homebrew,</span><br><span class="line">because this is an alternate version of another formula.</span><br><span class="line"></span><br><span class="line">If you need to have openjdk@11 first <span class="keyword">in</span> your PATH, run:</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">'export PATH="/opt/homebrew/opt/openjdk@11/bin:$PATH"'</span> &gt;&gt; ~/.zshrc</span><br><span class="line"></span><br><span class="line">For compilers to find openjdk@11 you may need to <span class="built_in">set</span>:</span><br><span class="line">  <span class="built_in">export</span> CPPFLAGS=<span class="string">"-I/opt/homebrew/opt/openjdk@11/include"</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install openjdk@17</span><br><span class="line"></span><br><span class="line">==&gt; Pouring openjdk@17--17.0.16.arm64_sequoia.bottle.tar.gz</span><br><span class="line">==&gt; Caveats</span><br><span class="line">For the system Java wrappers to find this JDK, symlink it with</span><br><span class="line">  sudo ln -sfn /opt/homebrew/opt/openjdk@17/libexec/openjdk.jdk /Library/Java/JavaVirtualMachines/openjdk-17.jdk</span><br><span class="line"></span><br><span class="line">openjdk@17 is keg-only, <span class="built_in">which</span> means it was not symlinked into /opt/homebrew,</span><br><span class="line">because this is an alternate version of another formula.</span><br><span class="line"></span><br><span class="line">If you need to have openjdk@17 first <span class="keyword">in</span> your PATH, run:</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">'export PATH="/opt/homebrew/opt/openjdk@17/bin:$PATH"'</span> &gt;&gt; ~/.zshrc</span><br><span class="line"></span><br><span class="line">For compilers to find openjdk@17 you may need to <span class="built_in">set</span>:</span><br><span class="line">  <span class="built_in">export</span> CPPFLAGS=<span class="string">"-I/opt/homebrew/opt/openjdk@17/include"</span></span><br><span class="line">==&gt; Summary</span><br><span class="line">🍺  /opt/homebrew/Cellar/openjdk@17/17.0.16: 636 files, 305MB</span><br><span class="line">==&gt; Running `brew cleanup openjdk@17`...</span><br><span class="line">Disable this behaviour by setting `HOMEBREW_NO_INSTALL_CLEANUP=1`.</span><br><span class="line">Hide these hints with `HOMEBREW_NO_ENV_HINTS=1` (see `man brew`).</span><br></pre></td></tr></table></figure>
<p>Add <code>export PATH=&quot;/opt/homebrew/opt/openjdk@17/bin:$PATH&quot;</code> to ~/.zshrc</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br><span class="line"></span><br><span class="line">java -version  <span class="comment"># 应显示 openjdk 17.x.x</span></span><br><span class="line">    openjdk version <span class="string">"17.0.16"</span> 2025-07-15</span><br><span class="line">    OpenJDK Runtime Environment Homebrew (build 17.0.16+0)</span><br><span class="line">    OpenJDK 64-Bit Server VM Homebrew (build 17.0.16+0, mixed mode, sharing)</span><br><span class="line"></span><br><span class="line">javac -version <span class="comment"># 应显示 javac 17.x.x[1,2](@ref)</span></span><br><span class="line">    javac 17.0.16</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Set jdk for jenv</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">where</span> java</span><br><span class="line">/opt/homebrew/opt/openjdk@17/bin/java</span><br><span class="line">/Users/yuanli/.jenv/shims/java</span><br><span class="line">/opt/homebrew/opt/openjdk@11/bin/java</span><br><span class="line"></span><br><span class="line">$ jenv versions</span><br><span class="line">openjdk64-11.0.11</span><br><span class="line"></span><br><span class="line">$ jenv add /opt/homebrew/opt/openjdk@11</span><br><span class="line">$ jenv add /opt/homebrew/opt/openjdk@17</span><br><span class="line"></span><br><span class="line">$ jenv versions</span><br><span class="line">* openjdk64-11.0.28 (<span class="built_in">set</span> by /Users/yuanli/.jenv/version)</span><br><span class="line">  openjdk64-17.0.16</span><br><span class="line"></span><br><span class="line">$ jenv <span class="built_in">enable</span>-plugin <span class="built_in">export</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set default jdk version</span></span><br><span class="line">$ jenv global openjdk64-17.0.16</span><br><span class="line"></span><br><span class="line">$ jenv versions</span><br><span class="line">  openjdk64-11.0.28</span><br><span class="line">* openjdk64-17.0.16 (<span class="built_in">set</span> by /Users/yuanli/.jenv/version)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>(Optional)删除旧的jdk</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo rm -rf /Library/Java/JavaVirtualMachines/adoptopenjdk-11.jdk/Contents/Home/bin/java</span><br><span class="line"></span><br><span class="line">jenv remove openjdk64-11.0.11</span><br><span class="line"></span><br><span class="line">jenv versions</span><br></pre></td></tr></table></figure>
<ol>
<li>Set jdk for IDE</li>
</ol>
<h4 id="error-in-terminal">ERROR in terminal</h4>
<p><code>~/.bash_profile</code> 或是<code>~/.zprofile</code> <code>~/.zshrc</code>里面配置了<code>JAVA_HOME</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=<span class="string">"/opt/homebrew/opt/openjdk@17"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>报错：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ERROR: JAVA_HOME is <span class="built_in">set</span> to an invalid directory: /opt/homebrew/opt/openjdk@11</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://stackoverflow.com/a/6588410" target="_blank" rel="noopener">解决方法1</a>：</li>
</ul>
<ol>
<li><code>JAVA_HOME</code> 修改为： <code>export JAVA_HOME=&quot;$(/usr/libexec/java_home)&quot;</code></li>
<li>Run <code>sudo ln -sfn /usr/local/opt/openjdk/libexec/openjdk.jdk</code></li>
</ol>
<p>推荐解决方法2： quite IDE</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ps aux | grep gradle</span><br><span class="line">yuanli           53967   0.3  0.0 408628368   1616 s004  S+    3:20PM   0:00.00 grep --color=auto --exclude-dir=.bzr --exclude-dir=CVS --exclude-dir=.git --exclude-dir=.hg --exclude-dir=.svn --exclude-dir=.idea --exclude-dir=.tox gradle</span><br><span class="line"><span class="built_in">kill</span> 53967</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jenv <span class="built_in">enable</span>-plugin <span class="built_in">export</span></span><br><span class="line">jenv <span class="built_in">local</span> openjdk64-17.0.16</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$JAVA_HOME</span></span><br></pre></td></tr></table></figure>
<h3 id="other">other</h3>
<p>Install Specific Versions of Java (Java8, Java11, Java13)<br>
To install previous or specific versions of JDKs, you can get them from AdoptOpenJDK:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew tap adoptopenjdk/openjdk</span><br><span class="line"></span><br><span class="line">brew install --cask adoptopenjdk8</span><br><span class="line">brew install --cask adoptopenjdk11</span><br><span class="line">brew install --cask adoptopenjdk13</span><br></pre></td></tr></table></figure>
<h1 id="java版本切换">Java版本切换</h1>
<p>Now it is time to install jEnv:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install jenv</span><br><span class="line"></span><br><span class="line">To activate jenv, add the following to your shell profile e.g. ~/.profile, ~/.bash_profile</span><br><span class="line">or ~/.zshrc:</span><br><span class="line">  <span class="built_in">export</span> PATH=<span class="string">"<span class="variable">$HOME</span>/.jenv/bin:<span class="variable">$PATH</span>"</span></span><br><span class="line">  <span class="built_in">eval</span> <span class="string">"<span class="variable">$(jenv init -)</span>"</span></span><br><span class="line">==&gt; Summary</span><br><span class="line">🍺  /opt/homebrew/Cellar/jenv/0.5.9: 91 files, 100.9KB</span><br><span class="line">==&gt; Running `brew cleanup jenv`...</span><br><span class="line">Disable this behaviour by setting `HOMEBREW_NO_INSTALL_CLEANUP=1`.</span><br><span class="line">Hide these hints with `HOMEBREW_NO_ENV_HINTS=1` (see `man brew`).</span><br></pre></td></tr></table></figure>
<p>jEnv doesn’t install JDKs, so we have to tell jEnv where to look for them. Type these commands to register JDKs in jEnv (replace the minor and patch versions with yours):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">where</span> java</span><br><span class="line">/usr/bin/java</span><br><span class="line">/Library/Java/JavaVirtualMachines/adoptopenjdk-11.jdk/Contents/Home/bin/java</span><br><span class="line">/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/bin/java</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 添加jdk变量到jenv，只有添加过jenv versions 才能显示出来</span></span><br><span class="line">$ jenv add /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home</span><br><span class="line">$ jenv add /Library/Java/JavaVirtualMachines/adoptopenjdk-11.jdk/Contents/Home</span><br><span class="line">$ jenv add /usr</span><br></pre></td></tr></table></figure>
<p>After that, run this command to list all registered JDKs:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ jenv versions</span><br><span class="line"></span><br><span class="line">openjdk64-1.8.0.292</span><br><span class="line">openjdk64-11.0.11</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 移除jdk变量</span></span><br><span class="line">jenv remove openjdk64-11.0.11</span><br></pre></td></tr></table></figure>
<p>The version with an asterisk is the active version.<br>
In my case, I need to keep JDK 7 as my default version, so I set the global version to 1.7:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jenv global oracle64-1.7.0.79</span><br></pre></td></tr></table></figure>
<p>And in my project, I set the local JDK version to 1.8:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;my project&gt;</span><br><span class="line">jenv <span class="built_in">local</span> oracle64-1.8.0.66</span><br></pre></td></tr></table></figure>
<p>The above command will create a .java-version file at project root. Its content is the version I just picked for this project:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">oracle64-1.8.0.66</span><br></pre></td></tr></table></figure>
<h2 id="jenv-enable-plugin-export"><code>jenv enable-plugin export</code></h2>
<p>用 jenv 管理 JDK 版本的小伙伴，可以通过这个命令让 <code>jenv</code> 在切版本的时候顺便把 <code>JAVA_HOME</code> 设置正确，运行一次即可。<br>
<code>jenv enable-plugin export</code></p>
<h1 id="reference">Reference</h1>
<ul>
<li><a href="http://davidcai.github.io/blog/posts/install-multiple-jdk-on-mac/" target="_blank" rel="noopener">Install Multiple Java Versions on Mac</a></li>
<li><a href="https://stackoverflow.com/questions/30413621/homebrew-cask-option-not-recognized" target="_blank" rel="noopener">Homebrew cask option not recognized?</a></li>
<li><a href="https://devqa.io/brew-install-java/" target="_blank" rel="noopener">How to Use Brew to Install Java on Mac</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>Environment setup</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Command line</tag>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>IDEA 插件</title>
    <url>/IDEA-%E6%8F%92%E4%BB%B6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://blog.csdn.net/21aspnet/article/details/104166965?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-104166965-blog-123939267.pc_relevant_recovery_v2&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3" target="_blank" rel="noopener">IDEA常用和实用配置以及各种必要插件</a></p>
<p><a href="https://cxyroad.blog.csdn.net/article/details/127543979?spm=1001.2101.3001.6650.3&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EYuanLiJiHua%7EPosition-3-127543979-blog-123939267.pc_relevant_recovery_v2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EYuanLiJiHua%7EPosition-3-127543979-blog-123939267.pc_relevant_recovery_v2&amp;utm_relevant_index=6" target="_blank" rel="noopener">这五款牛逼的 IDEA 插件，堪称代码质量检查利器！</a></p>
<ul>
<li>Alibaba Java Coding Guidelines</li>
<li>CheckStyle：</li>
<li>PMD</li>
<li>FindBugs：</li>
<li>SonarLint：</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>IntelliJ</tag>
      </tags>
  </entry>
  <entry>
    <title>IndexedDB-delete whole database by javaScript</title>
    <url>/IndexedDB-delete-whole-database-by-javaScript.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="使用indexeddb-deletedatabase：">使用<a href="https://developer.mozilla.org/en-US/docs/Web/API/IDBFactory/deleteDatabase" target="_blank" rel="noopener">indexedDB.deleteDatabase</a>：</h1>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> DBDeleteRequest = <span class="built_in">window</span>.indexedDB.deleteDatabase(<span class="string">"toDoList"</span>);</span><br><span class="line"></span><br><span class="line">DBDeleteRequest.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Error deleting database."</span>);</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">DBDeleteRequest.onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Database deleted successfully"</span>);</span><br><span class="line">    </span><br><span class="line">  <span class="built_in">console</span>.log(event.result); <span class="comment">// should be undefined</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// you must call db.close() before delete, if you already open. otherwise you will get onblocked event</span></span><br><span class="line">DBDeleteRequest.onblocked = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Couldn't delete database due to the operation being blocked"</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h1 id="indexeddb-databases">indexedDB.<a href="developer.mozilla.org/en-US/docs/Web/API/IDBFactory/databases">databases()</a></h1>
<p>可以使用indexedDB.databases() 得到所有的databases List.<br>
如果这个数据库已经open过，在删除数据库前需要调用<a href="https://developer.mozilla.org/en-US/docs/Web/API/IDBDatabase/close" target="_blank" rel="noopener">db.close() </a> 否则onblocked event会触发。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="built_in">window</span>.indexedDB.databases()</span><br><span class="line">    .then(<span class="function">(<span class="params">dbs</span>) =&gt;</span> &#123;</span><br><span class="line">        dbs.map(<span class="function"><span class="params">db</span> =&gt;</span> &#123;</span><br><span class="line">            db.close();</span><br><span class="line">            <span class="built_in">window</span>.indexedDB.deleteDatabase(db.name)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;).catch(<span class="built_in">console</span>.error);</span><br></pre></td></tr></table></figure>
<p>indexedDB.databases() 有一个很大问题就是支持的浏览器太少了。只有Chrome和Opera能很好的支持，IE11, Firefox, Safari都不太支持。</p>
<p>实例：删除除了此user的所有其他IndexedDB</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Checks IndexedDB for all IndexedDBs and deletes them if the username</span></span><br><span class="line"><span class="comment"> * is not the one provided. Used when changing users after session expires.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@static</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>usernameToKeep Current authenticated user</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@memberof <span class="variable">DB</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> purgeIndexedDB(usernameToKeep) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.indexedDB &amp;&amp; <span class="built_in">window</span>.indexedDB.databases) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.indexedDB.databases()</span><br><span class="line">      .then(<span class="function">(<span class="params">dbs</span>) =&gt;</span> </span><br><span class="line">          dbs.filter(<span class="function">(<span class="params">db</span>) =&gt;</span> (db.name.includes(<span class="string">'_pouch_'</span>) &amp;&amp; (!usernameToKeep || !db.name.includes(usernameToKeep)))))</span><br><span class="line">      .then(<span class="function">(<span class="params">IndexedDBS</span>) =&gt;</span> </span><br><span class="line">          <span class="built_in">Promise</span>.all(IndexedDBS.map(<span class="function">(<span class="params">IndexedDB</span>) =&gt;</span> <span class="built_in">window</span>.indexedDB.deleteDatabase(IndexedDB.name))))</span><br><span class="line">      .catch(<span class="built_in">console</span>.error);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="reference-links">Reference Links:</h1>
<ul>
<li><a href="https://stackoverflow.com/questions/15861630/how-can-i-remove-a-whole-indexeddb-database-from-javascript#" target="_blank" rel="noopener">How can I remove a whole IndexedDB database from JavaScript?</a></li>
<li><a href="developer.mozilla.org/en-US/docs/Web/API/IDBFactory/databases">indexedDB.databases()</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/IDBFactory/deleteDatabase" target="_blank" rel="noopener">indexedDB.deleteDatabase</a></li>
<li><a href="https://www.w3.org/TR/IndexedDB/#dom-idbfactory-deletedatabase" target="_blank" rel="noopener">dom-idbfactory-deletedatabase W3C</a></li>
<li><a href="https://www.w3.org/TR/IndexedDB/#delete-a-database" target="_blank" rel="noopener">5.3. Deleting a database W3C</a></li>
</ul>
<h2 id="pouch">Pouch</h2>
<ul>
<li><a href="https://github.com/pouchdb/pouchdb" target="_blank" rel="noopener">pouchdb/pouchdb</a></li>
<li><a href="http://webfuse.cn/2016/09/24/PouchDB%E7%AE%80%E5%8D%95%E5%85%A5%E9%97%A8/" target="_blank" rel="noopener">PouchDB简单入门</a></li>
<li><a href="http://www.vue5.com/pouchdb/pouchdb_delete_database.html" target="_blank" rel="noopener">学习PouchDB</a></li>
<li><a href="https://www.w3.org/TR/IndexedDB/#dom-idbfactory-deletedatabase" target="_blank" rel="noopener">dom-idbfactory-deletedatabase W3C</a></li>
<li><a href="https://www.w3.org/TR/IndexedDB/#delete-a-database" target="_blank" rel="noopener">5.3. Deleting a database W3C</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>Browser Caching</category>
        <category>IndexedDB</category>
      </categories>
      <tags>
        <tag>IndexedDB</tag>
      </tags>
  </entry>
  <entry>
    <title>Install/Upgrade node.js</title>
    <url>/Install-node-js-and-nvm.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="node-js-版本介绍">Node.js 版本介绍</h2>
<p><a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js官网下载</a>的时候会看到<code>LTS</code>和<code>Current</code>两个版本可以选项：</p>
<ul>
<li><code>Current</code>：一个新版本会先进入<code>Current</code>版本，将持续六个月的时间。
<ul>
<li>只有我们非生产环境需要尝试新版本的一些特性时，才会选择。</li>
</ul>
</li>
<li><code>LTS（Long Term Support）</code>： “长期维护版”，通常生产环境为了保证稳定性，选择这个版本。 它分为两个阶段：
<ul>
<li><code>Active LTS</code>： 正积极维护和升级的版本，持续18个月，到期后进入<code>Maintenance LTS</code></li>
<li><code>Maintenance LTS</code>： 维护的LTS版本，持续18个月，到期后进入<code>EOL</code>版本</li>
<li><code>EOL（End of life）</code>，正式退出历史舞台。</li>
</ul>
</li>
</ul>
<blockquote>
<p>主版本的 Node.js 进入<code>Current</code>版本将持续六个月的时间，在此期间库作者可以对其进行支持。 六个月之后，奇数版本（诸如 9、11 等）将变为不支持状态，只有偶数版本（诸如 10、12 等）变成 活跃 <code>LTS</code> 状态，并且准备投入使用。 <code>LTS</code> 发布版的状态是“长期维护版”，这意味着重大的 Bug 将在后续的 30 个月内持续得到不断地修复。 上线应该仅使用 活跃 <code>LTS</code> 或者是 维护 <code>LTS</code> 版。</p>
</blockquote>
<p>根据官网的描述，我们可以看出<code>Current</code>和<code>LTS</code>是随着时间相互转变的。</p>
<ul>
<li><code>Current</code>偶数版 6 months —&gt; <code>Active LTS</code> 18 months —&gt; <code>Maintenance LTS</code> 18 months  —&gt; <code>EOL</code></li>
<li><code>Current</code>奇数版 6 months —&gt; <code>unsupported</code></li>
</ul>
<p><img src="https://raw.githubusercontent.com/nodejs/Release/master/schedule.svg?sanitize=true" alt="Long Term Support (LTS) schedule"></p>
<h3 id="node-js-相关链接">node.js 相关链接</h3>
<ul>
<li><a href="https://github.com/nodejs/node/blob/master/doc/changelogs/CHANGELOG_V16.md#16.14.2" target="_blank" rel="noopener">Node.js Chagelog</a></li>
<li><a href="https://nodejs.org/tr/blog/" target="_blank" rel="noopener">Node.js News</a></li>
<li><a href="https://nodejs.org/en/about/releases/" target="_blank" rel="noopener">Long Term Support (LTS) schedule</a></li>
</ul>
<h2 id="node-js-安装方法">Node.js 安装方法</h2>
<p><code>node -v</code> 先查看是否安装node.js 和安装的版本。</p>
<h2 id="通过nvm安装node-js">通过<code>nvm</code>安装Node.js</h2>
<p>安装 Node.js 的最佳方式是使用 nvm（<code>Node Version Manager</code>）。</p>
<ul>
<li><a href="https://nodejs.org/zh-cn/download/package-manager/#nvm" target="_blank" rel="noopener">nvm</a>适用OS: Mac/Linux</li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fcoreybutler%2Fnvm-windows%2Freleases" target="_blank" rel="noopener">nvm-windows</a>则是其在windows平台的一个替代方案，两者有联系，但是各自独立的项目。
<ul>
<li><a href="https://docs.microsoft.com/en-us/windows/dev-environment/javascript/nodejs-on-windows" target="_blank" rel="noopener">Install NodeJS on Windows</a></li>
</ul>
</li>
</ul>
<h3 id="安装nvm">安装<code>nvm</code></h3>
<p>可以下载 安装程序 来安装。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install nvm</span><br></pre></td></tr></table></figure>
<p>cURL:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl https://raw.github.com/creationix/nvm/master/install.sh | sh</span><br></pre></td></tr></table></figure>
<p>或者Wget:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -qO- https://raw.github.com/creationix/nvm/master/install.sh | sh</span><br></pre></td></tr></table></figure>
<h3 id="配置nvm">配置nvm</h3>
<p>安装完成后，根据安装完的提示不要忘记</p>
<ol>
<li>创建nvm 工作路径： <code>mkdir ~/.nv</code></li>
<li>配置nvm的路径到~/.profile or ~/.zshrc， 然后<code>source ~/.zshrc</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">You should create NVM<span class="string">'s working directory if it doesn'</span>t exist:</span><br><span class="line">  mkdir ~/.nvm</span><br><span class="line"></span><br><span class="line">Add the following to your shell profile e.g. ~/.profile or ~/.zshrc:</span><br><span class="line">  <span class="built_in">export</span> NVM_DIR=<span class="string">"<span class="variable">$HOME</span>/.nvm"</span></span><br><span class="line">  [ -s <span class="string">"/opt/homebrew/opt/nvm/nvm.sh"</span> ] &amp;&amp; \. <span class="string">"/opt/homebrew/opt/nvm/nvm.sh"</span>  <span class="comment"># This loads nvm</span></span><br><span class="line">  [ -s <span class="string">"/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"</span> ] &amp;&amp; \. <span class="string">"/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"</span>  <span class="comment"># This loads nvm bash_completion</span></span><br><span class="line"></span><br><span class="line">You can <span class="built_in">set</span> <span class="variable">$NVM_DIR</span> to any location, but leaving it unchanged from</span><br><span class="line">/opt/homebrew/Cellar/nvm/0.40.3 will destroy any nvm-installed Node installations</span><br><span class="line">upon upgrade/reinstall.</span><br></pre></td></tr></table></figure>
<p>重启终端并执行下列命令即可安装 Node.js。</p>
<h3 id="安装问题1：command-not-found-nvm">安装问题1：command not found: nvm</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nvm</span><br><span class="line">zsh: <span class="built_in">command</span> not found: nvm</span><br></pre></td></tr></table></figure>
<h4 id="解决方法1">解决方法1</h4>
<p>忘记配置nvm</p>
<p>如果用的是<code>zsh</code>, 而不是<code>bash</code>. 将<code>.bashrc</code>中关于<code>nvm</code>的配置copy到<code>.zshrc</code>里边。<br>
将<code>.bashrc</code>中的copy到<code>~.zshrc</code>下就可以啦。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">"/usr/local/Cellar/nvm/0.38.0"</span></span><br><span class="line">[ -s <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span> ] &amp;&amp; \. <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span>  <span class="comment"># This loads nvm</span></span><br><span class="line">[ -s <span class="string">"<span class="variable">$NVM_DIR</span>/bash_completion"</span> ] &amp;&amp; \. <span class="string">"<span class="variable">$NVM_DIR</span>/bash_completion"</span> <span class="comment">#This loads nvm bash_completion</span></span><br></pre></td></tr></table></figure>
<p>然后再</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<h4 id="解决方法2">解决方法2</h4>
<p>There might be some problems installing nvm in new mac, caused by the shell is not bash by default, check if it is bash with command</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$0</span></span><br></pre></td></tr></table></figure>
<p>§ if it is not run command</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chsh -s /bin/bash</span><br></pre></td></tr></table></figure>
<p>And then reopen the terminal</p>
<h3 id="nvm安装-node-js"><code>nvm</code>安装 Node.js</h3>
<ol>
<li>
<p>Install Node.js</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 列出远程服务器上所有的可用版本</span></span><br><span class="line">nvm ls-remote</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">   v16.12.0</span><br><span class="line">   v16.13.0   (LTS: Gallium)</span><br><span class="line">   v16.13.1   (LTS: Gallium)</span><br><span class="line">   v16.13.2   (LTS: Gallium)</span><br><span class="line">   v16.14.0   (LTS: Gallium)</span><br><span class="line">   v16.14.1   (LTS: Gallium)</span><br><span class="line">   v16.14.2   (LTS: Gallium)</span><br><span class="line">-&gt; v16.15.0   (Latest LTS: Gallium)</span><br><span class="line">    v17.0.0</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装latest available version</span></span><br><span class="line">nvm install node</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装最新的LTS版本</span></span><br><span class="line">nvm install --lts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装16.14.x 中最高（最新）的版本</span></span><br><span class="line">nvm install 16.14</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装指定版本</span></span><br><span class="line">nvm install 10.15.0</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="nvm-切换版本"><code>nvm</code> 切换版本</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用latest available version</span></span><br><span class="line">nvm use node</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装stable版本</span></span><br><span class="line">nvm install stable</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用最新的LTS版本</span></span><br><span class="line">nvm use --lts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装16.14.x 中最高（最新）的版本</span></span><br><span class="line">nvm install 16.14</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装指定版本</span></span><br><span class="line">nvm install 10.15.0</span><br></pre></td></tr></table></figure>
<h3 id="nvm列出已安装版本"><code>nvm</code>列出已安装版本</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nvm list</span><br><span class="line">       v10.15.3</span><br><span class="line">       v12.22.9</span><br><span class="line">       v14.19.1</span><br><span class="line">       v16.14.2</span><br><span class="line">-&gt;     v16.15.0</span><br><span class="line">default -&gt; v10.15.3</span><br><span class="line">iojs -&gt; N/A (default)</span><br><span class="line">unstable -&gt; N/A (default)</span><br><span class="line">node -&gt; stable (-&gt; v16.15.0) (default)</span><br><span class="line">stable -&gt; 16.15 (-&gt; v16.15.0) (default)</span><br><span class="line">lts/* -&gt; lts/gallium (-&gt; v16.15.0)</span><br><span class="line">lts/argon -&gt; v4.9.1 (-&gt; N/A)</span><br><span class="line">lts/boron -&gt; v6.17.1 (-&gt; N/A)</span><br><span class="line">lts/carbon -&gt; v8.17.0 (-&gt; N/A)</span><br><span class="line">lts/dubnium -&gt; v10.24.1 (-&gt; N/A)</span><br><span class="line">lts/erbium -&gt; v12.22.12 (-&gt; N/A)</span><br><span class="line">lts/fermium -&gt; v14.19.2 (-&gt; N/A)</span><br><span class="line">lts/gallium -&gt; v16.15.0</span><br></pre></td></tr></table></figure>
<h3 id="nvm-设置default版本"><code>nvm</code> 设置default版本</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Set default node version as 8.1.0</span></span><br><span class="line">  nvm <span class="built_in">alias</span> default 8.1.0      </span><br><span class="line"><span class="comment"># Always default to the latest available node version on a shell         </span></span><br><span class="line">  nvm <span class="built_in">alias</span> default node</span><br></pre></td></tr></table></figure>
<h3 id="nvm-其他命令"><code>nvm</code> 其他命令</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Run app.js using node 6.10.3</span></span><br><span class="line">  nvm run 6.10.3 app.js</span><br><span class="line"><span class="comment"># Run `node app.js` with the PATH pointing to node 4.8.3</span></span><br><span class="line">  nvm <span class="built_in">exec</span> 4.8.3 node app.js</span><br><span class="line"><span class="comment"># 卸载指定版本 Uninstall a version</span></span><br><span class="line">  nvm uninstall &lt;version&gt;</span><br></pre></td></tr></table></figure>
<h2 id="node-js-升级">Node.js 升级</h2>
<h3 id="安装node-js-新版本">安装node.js 新版本</h3>
<ul>
<li>via npm</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm cache clean -f</span><br><span class="line">npm install -g n</span><br><span class="line">n 16.15.0</span><br></pre></td></tr></table></figure>
<ul>
<li>via nvm</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nvm install v16.15.0</span><br><span class="line">nvm use v16.15.0</span><br></pre></td></tr></table></figure>
<ul>
<li>via <a href="https://formulae.brew.sh/formula/node@16" target="_blank" rel="noopener">brew</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install node@16</span><br></pre></td></tr></table></figure>
<h3 id="remove-node-modules-folder-optional">Remove node_modules folder (optional)</h3>
<h3 id="reinstall-the-dependencies">Reinstall the dependencies</h3>
<p>by <code>yarn install</code> or <code>npm install</code></p>
<h2 id="参考文章">参考文章</h2>
<ul>
<li>
<p><a href="https://juejin.cn/post/7001401390983544840" target="_blank" rel="noopener">Node.js怎么选版本？</a></p>
</li>
<li>
<p><a href="https://www.runoob.com/w3cnote/nvm-manager-node-versions.html" target="_blank" rel="noopener">使用 nvm 管理不同版本的 node 与 npm</a></p>
</li>
<li>
<p><a href="https://blog.logrocket.com/how-switch-node-js-versions-nvm/" target="_blank" rel="noopener">How to switch Node.js versions with NVM</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/windows/dev-environment/javascript/nodejs-on-windows" target="_blank" rel="noopener">Install NodeJS on Windows</a></p>
</li>
<li>
<p><a href="https://codeforgeek.com/update-node-using-npm/" target="_blank" rel="noopener">How to Update Node to Any Version Using Npm</a></p>
</li>
<li>
<p><a href="https://phoenixnap.com/kb/update-node-js-version" target="_blank" rel="noopener">How to Update Node.js to Latest Version {Linux, Windows, and macOS}</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/10075990/upgrading-node-js-to-latest-version" target="_blank" rel="noopener">Upgrading Node.js to latest version</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>node.js</category>
      </categories>
      <tags>
        <tag>node.js</tag>
        <tag>Command line</tag>
      </tags>
  </entry>
  <entry>
    <title>IntelliJ IDEA-Share settings through a settings repository</title>
    <url>/IntelliJ-IDEA-Share-settings-through-a-settings-repository.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://www.jetbrains.com/help/idea/sharing-your-ide-settings.html#settings-repository" target="_blank" rel="noopener">IntelliJ 官方文档-Share settings through a settings repository</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>IntelliJ</tag>
      </tags>
  </entry>
  <entry>
    <title>Compare folder and all content of files</title>
    <url>/IntelliJ-compare-folder-and-all-content-of-files.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="需求">需求</h2>
<ul>
<li>文件夹比较：自动递归把所有子文件夹里的文件夹和文件内容都比较</li>
<li>.class 文件会自动decomple成.java文件查看和比较</li>
</ul>
<h2 id="工具">工具</h2>
<p>研究了下，有几个工具可以实现，不过很多都收费：</p>
<blockquote>
<p>Any tools for comparing decompiled classes to source code?<br>
I’d compile the .java files you have. Then decompile those .class files and the original .class files you have. A script should be able to get you this far. Then you can compare the resultant .java files with a tool like Meld, BeyondCompare or simply <code>diff -ur</code> on the command line. Running them through the same decompiler should at least give you better commonality so there’s less noise in your diffs. Good luck with that though, that doesn’t sound like fun any way you slice it.</p>
</blockquote>
<h3 id="meld"><a href="https://meldmerge.org/" target="_blank" rel="noopener">Meld</a></h3>
<blockquote>
<p>Meld 帮助您比较文件、目录和版本控制的项目。 它提供文件和目录的双向和三向比较，并支持许多流行的版本控制系统。<br>
Meld 可帮助您查看代码更改并了解补丁。 它甚至可以帮助您弄清楚在您一直避免的合并中发生了什么。</p>
</blockquote>
<p>Folder comparison</p>
<ul>
<li>Identify and manage missing or modified files across folders</li>
<li>Drill down into a file comparison for a detailed view of differences</li>
<li>Ignore certain files or folders for more useful comparisons</li>
</ul>
<h3 id="beyond-compare-4"><a href="https://www.scootersoftware.com/" target="_blank" rel="noopener">Beyond Compare 4</a></h3>
<blockquote>
<p>Intelligent Comparison<br>
Compare files and folders using simple, powerful commands that focus on the differences you’re interested in and ignore those you’re not.  Merge changes, synchronize files, and generate reports.</p>
</blockquote>
<p>To decompile Java class files to source code in Beyond Compare, install the Java Class to Source file format. With the file format installed, when you double click on a .class file inside a .war archive, it will display the decompiled source code in Beyond Compare’s Text Compare.<br>
Download page for file formats: <a href="http://www.scootersoftware.com/download.php?zz=kb_moreformatsv4" target="_blank" rel="noopener">http://www.scootersoftware.com/download.php?zz=kb_moreformatsv4</a></p>
<p>缺点： 免费试用30天</p>
<h3 id="diff-ur-on-the-command-line"><code>diff -ur</code> on the command line</h3>
<p>功能少，查看不方便</p>
<h2 id="intellij-自带-compare-directories">IntelliJ 自带 <code>Compare Directories</code></h2>
<blockquote>
<p>IntelliJ IDEA lets you compare files in two folders against their file size, content, or timestamp.<br>
The differences are displayed in the <a href="https://www.jetbrains.com/help/idea/comparing-files-and-folders.html#comparing_folders" target="_blank" rel="noopener">Differences Viewer for Folders</a></p>
</blockquote>
<p>优点： 免费， 使用方便，功能全！！！</p>
<ol>
<li>选中要比较的两个文件夹</li>
<li>右键 --&gt; <code>Compare Directories</code></li>
<li>可以加filter，过滤，例如*.class</li>
</ol>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/compareFolder.png" alt="Compare Directories"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/compareFolder-filter.png" alt="Compare Directories"></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>IntelliJ</tag>
      </tags>
  </entry>
  <entry>
    <title>IntelliJ IDEA:Unregistered VCS root detected</title>
    <url>/IntelliJ-IDEA-Unregistered-VCS-root-detected.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>如果还没有配置git，参考<a href="../IntelliJ-IDEA-Set-git.html">IntelliJ-IDEA-Set-git</a>。</p>
<h2 id="warning">warning</h2>
<p>在IntelliJ IDEA导入已有的git项目时，出现warning：</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/IntelliJ-IDEA-Unregistered-VCS-root-detected/1.png" alt="warning"></p>
<h2 id="解决方法">解决方法</h2>
<ol>
<li>打开Preference-&gt;Version Control，看到Unregistered的project目录：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/IntelliJ-IDEA-Unregistered-VCS-root-detected/2.png" alt="warning"></li>
</ol>
<ul>
<li>老版本Preference-&gt;Version Control-&gt;Ignored Files</li>
<li>新版本Preference-&gt;Version Control-&gt;Directory Mappings</li>
</ul>
<ol start="2">
<li>选中要配置的Unregistered的project，点击“+”，然后Apply，解决<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/IntelliJ-IDEA-Unregistered-VCS-root-detected/3.png" alt="warning"></li>
</ol>
<h2 id="参考链接">参考链接</h2>
<p><a href="https://intellij-support.jetbrains.com/hc/en-us/community/posts/360000013600--Unregistered-VCS-root-detected-" target="_blank" rel="noopener">Unregistered VCS root detected</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>IntelliJ</tag>
      </tags>
  </entry>
  <entry>
    <title>Java ==  equals() 区别</title>
    <url>/Java-and-equals-%E5%8C%BA%E5%88%AB.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="java-equals-区别">Java ==  equals() 区别</h1>
<table>
<thead>
<tr>
<th>类型</th>
<th>==</th>
<th><code>equals()</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>类型</td>
<td>operator 运算符</td>
<td>method 方法</td>
</tr>
<tr>
<td>基本类型</td>
<td>值是否相同，本质是比较其中的字节组合是否相同。<code>int a = 3; byte b = 3; if(a == b) {} // true</code> a 和 b 的字节码都是0000000011 == 00000011（忽略a有更多的0）</td>
<td></td>
</tr>
<tr>
<td>引用类型</td>
<td>引用变量是否相同，本质同样是是比较引用变量（对象在堆中的地址）的字节组合是否相同。<code>Foo a = new Foo(); Foo b = new Foo(); Foo c = a; if(a == b) {} // false if(a == c) {} // true if(c == b) {} // false</code> 对象是存储在堆上的，这里的a， b， c都是对象的引用变量（堆中的地址），而非堆上的对象的值。</td>
<td>1 如果是未被父类或自身重载override过，则与==相同 。Object类的equals方法：<code>public boolean equals(Object obj) {return (this == obj);}</code> 2 如果像String 和 Integer 等重载了 equals 方法，把它变成了对象的值比较。</td>
</tr>
</tbody>
</table>
<h1 id="参考文章">参考文章</h1>
<ul>
<li><a href="https://stackoverflow.com/questions/7520432/what-is-the-difference-between-and-equals-in-java" target="_blank" rel="noopener">What is the difference between == and equals() in Java?</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title>IntelliJ IDEA:Set git</title>
    <url>/IntelliJ-IDEA-Set-git.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="配置git路径">配置git路径</h2>
<p>打开Preference-&gt;Version Control-&gt;Git</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/IntelliJ-IDEA-Set-git/git.png" alt="Git"></p>
<h2 id="登陆github">登陆github</h2>
<p>打开Preference-&gt;Version Control-&gt;GitHub</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/IntelliJ-IDEA-Set-git/github.png" alt="GitHub"></p>
<h2 id="git插件">Git插件</h2>
<p>GitToolBox</p>
<h2 id="打开preference-version-control">打开Preference-&gt;Version Control</h2>
<ul>
<li>
<p>老版本Preference-&gt;Version Control-&gt;Ignored Files<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/IntelliJ-IDEA-Set-git/Ignored%20Files.png" alt="Ignored Files"></p>
</li>
<li>
<p>新版本Preference-&gt;Version Control-&gt;Directory Mappings</p>
</li>
</ul>
<h3 id="添加unregistered的project">添加Unregistered的project</h3>
<!-- [IntelliJ IDEA:Unregistered VCS root detected](../../../../2019/07/10/IntelliJ-IDEA-Unregistered-VCS-root-detected/) -->
<p><a href="../IntelliJ-IDEA-Unregistered-VCS-root-detected.html">IntelliJ IDEA:Unregistered VCS root detected</a></p>
<h2 id="ide最下方使用version-control工具">IDE最下方使用Version Control工具</h2>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/IntelliJ-IDEA-Set-git/Version%20Control.png" alt="Version Control"></p>
<p>Log branch commit信息</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/IntelliJ-IDEA-Set-git/log.png" alt="Log"></p>
<h2 id="reference-links">Reference links</h2>
<ul>
<li><a href="https://www.cnblogs.com/poscana/p/14920720.html" target="_blank" rel="noopener">最新 IntelliJ IDEA 配置 Git / GitHub 过程演示（2021超详细图文版）</a></li>
<li><a href="https://segmentfault.com/a/1190000041226135" target="_blank" rel="noopener">IntelliJ IDEA 中集成并使用 Git 图文教程</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>IntelliJ</tag>
      </tags>
  </entry>
  <entry>
    <title>Java request.getcontextPath()</title>
    <url>/Java-request-getcontextPath.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="解决相对路径的问题">解决相对路径的问题</h1>
<p><code>request.getContextPath()</code>：是在开发Web项目时，经常用到的方法，是为了解决相对路径的问题，可返回站点的根路径。</p>
<p>比如：要生成一个文件放在服务器上得一个目录下,可以使用request.getContextPath()+/dir,组成一个完整得目录结构.</p>
<p>当使用Tomcat作为Web服务器，项目一般部署在Tomcat下的webapps的目录下。具体来说主要用两种部署的路径：</p>
<ul>
<li>
<p>将web项目中的webRoot下的文件直接拷贝到webapps/ROOT下（删除ROOT下的原有文件）；</p>
</li>
<li>
<p>在Tomcat下的webapps中创建以项目名称命名（当然也可以用其他的名称）的文件夹，并将webRoot下的文件直接拷贝到该文件夹下。</p>
</li>
</ul>
<p>对于第一部署方法，<code>request.getContextPath()</code>的返回值为空（即：<code>&quot;&quot;</code>,中间无空格，注意区分<code>null</code>)。</p>
<p>对于第二部署方法，其返回值为：<code>/创建的文件夹的名称</code>。</p>
<h2 id="url实例">URL实例</h2>
<p>假定你的web application 名称为liyuankun,你在浏览器中输入请求路径：</p>
<p><code>http://localhost:8080/liyuankun/main/test.jsp</code></p>
<p>则执行下面向行代码后打印出如下结果：</p>
<ol>
<li><code>System.out.println(request.getContextPath());</code></li>
</ol>
<p>打印结果：<code>/liyuankun</code></p>
<ol start="2">
<li><code>System.out.println(request.getServletPath());</code></li>
</ol>
<p>打印结果：<code>/main/test.jsp</code></p>
<ol start="3">
<li><code>System.out.println(request.getRequestURI());</code></li>
</ol>
<p>打印结果：<code>/liyuankun/main/test.jsp</code></p>
<ol start="4">
<li><code>System.out.println(request.getRealPath(&quot;/&quot;));</code></li>
</ol>
<p>打印结果：<code>\Tomcat所在目录\webapps\liyuankun\test</code></p>
<p><code>request.getSchema()</code>可以返回当前页面使用的协议，http、https等, 这里是<code>http</code>;</p>
<p><code>request.getServerName()</code>可以返回当前页面所在的服务器的名字, 这里是<code>localhost</code>;</p>
<p><code>request.getServerPort()</code>可以返回当前页面所在的服务器使用的端口,这里是<code>8080</code>;</p>
<p>实际应用中，一般用来解决jsp测试和生产环境路径不同的问题：</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"> String appContext = request.getContextPath();</span><br><span class="line"> String basePath =request.getScheme()+<span class="string">"://"</span>+request.getServerName()+<span class="string">":"</span>+request.getServerPort() + appContext; </span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">buildAbsoluteUrl</span><span class="params">(HttpServletRequest request, String relativePath, String queryString)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> UrlUtils.buildFullRequestUrl(request.getScheme(), request.getServerName(), request.getServerPort(), request.getContextPath() + relativePath, queryString);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://blog.csdn.net/haojiahj/article/details/8796472" target="_blank" rel="noopener">request.getcontextPath() 详解</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>JSON Web Token (JWT) 入门教程</title>
    <url>/JSON-Web-Token-JWT-%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="json-web-token">JSON Web Token</h2>
<p><code>JWT (JSON Web Token)</code> is a compact, URL-safe means of representing claims to be transferred between two parties. The claims in a JWT are encoded as a JSON object that is used as the payload of the token. This JSON object is then digitally signed using a secret key or a public/private key pair.</p>
<h3 id="structure-of-a-jwt">Structure of a JWT</h3>
<p>它是一个很长的字符串，中间用点（.）分隔成三个部分。注意，JWT 内部是没有换行的，这里只是为了便于展示，将它写成了几行。<br>
A JWT consists of three parts, separated by dots (<code>.</code>):</p>
<ul>
<li><strong>Header</strong>: Contains metadata about the token, such as the type of token (<code>JWT</code>) and the signing algorithm (<code>HMAC SHA256</code> or <code>RSA</code>).</li>
<li><strong>Payload</strong>: Contains the claims, which are statements about an entity (typically, the user) and additional data.</li>
<li><strong>Signature</strong>: Used to verify that the token was not altered after it was issued.</li>
</ul>
<p>Example of a JWT:</p>
<pre><code><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Header.Payload.Signature</span></span><br><span class="line"></span><br><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.</span><br><span class="line">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.</span><br><span class="line">SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span><br></pre></td></tr></table></figure>
</code></pre>
<h3 id="common-use-cases-for-jwt">Common Use Cases for JWT</h3>
<ul>
<li>
<p><strong>Authentication</strong>: JWTs are often used for securing APIs, where the client receives a token upon successful login and then includes this token in the Authorization header of subsequent requests.</p>
</li>
<li>
<p><strong>Information Exchange</strong>: JWTs can be used to securely transmit information between parties. Since they can be signed, the information can be trusted to be accurate.</p>
</li>
</ul>
<h3 id="summary">Summary</h3>
<ul>
<li>
<p><strong>JWT</strong> is a way to securely transmit information between two parties.</p>
</li>
<li>
<p>It is composed of a header, payload, and signature.</p>
</li>
<li>
<p>JWTs are commonly used for authentication in web applications.</p>
</li>
<li>
<p>Libraries like <code>PyJWT</code> in Python and <code>jsonwebtoken</code> in Node.js make it easy to create and verify JWTs.</p>
</li>
<li>
<p>JWT 默认是不加密，但也是可以加密的。生成原始 Token 以后，可以用密钥再加密一次。</p>
</li>
<li>
<p>JWT 不加密的情况下，不能将秘密数据写入 JWT。</p>
</li>
<li>
<p>JWT 不仅可以用于认证，也可以用于交换信息。有效使用 JWT，可以降低服务器查询数据库的次数。</p>
</li>
<li>
<p>JWT 的最大缺点是，由于服务器不保存 session 状态，因此无法在使用过程中废止某个 token，或者更改 token 的权限。也就是说，一旦 JWT 签发了，在- 之前就会始终有效，除非服务器部署额外的逻辑</p>
</li>
<li>
<p>JWT 本身包含了认证信息，一旦泄露，任何人都可以获得该令牌的所有权限。为了减少盗用，JWT 的有效期应该设置得比较短。对于一些比较重要的权限，使用时应该再次对用户进行认证。</p>
</li>
<li>
<p>为了减少盗用，JWT 不应该使用 HTTP 协议明码传输，要使用 HTTPS 协议传输。</p>
</li>
</ul>
<h3 id="jwt-和-session-id-的区别总结">JWT 和 Session Id 的区别总结</h3>
<h3 id="jwt">JWT</h3>
<ul>
<li>服务器上不保存任何东西，JWT 存储于客户端中</li>
<li>由服务器 加密（可选）和签名</li>
<li>token 包含用户的所有信息</li>
<li>所有信息都存储于 token 本身中</li>
<li>易于扩展到cluster</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/JSON-Web-Token-JWT-%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/JWT.png" alt="JWT workflow"></p>
<h3 id="session-id">Session Id</h3>
<ul>
<li>Session Id 保存于服务器和客户端中</li>
<li>加密并签名</li>
<li>Session Id 是对用户的引用</li>
<li>服务器需要查找用户并进行必要的检查</li>
<li>难以扩展到cluster</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/JSON-Web-Token-JWT-%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/session.png" alt="Session workflow"></p>
<h2 id="jwt教程">JWT教程</h2>
<p><a href="https://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html" target="_blank" rel="noopener">JSON Web Token 入门教程 阮一峰</a><br>
<a href="https://www.cnblogs.com/ittranslator/p/14595165.html" target="_blank" rel="noopener">JWT 介绍 - Step by Step</a><br>
- <a href="https://dev.to/moe23/intro-to-jwt-mcb" target="_blank" rel="noopener">Intro to JWT - Step by Step</a></p>
<h2 id="jsonwebtoken-in-node-js"><code>jsonwebtoken</code> in Node.js</h2>
<ol>
<li>
<p>Installing Required Libraries</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install jsonwebtoken</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Creating a JWT</p>
 <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">'jsonwebtoken'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Define your secret key</span></span><br><span class="line"><span class="keyword">const</span> secretKey = <span class="string">'your-256-bit-secret'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create the payload (claims)</span></span><br><span class="line"><span class="keyword">const</span> payload = &#123;</span><br><span class="line">sub: <span class="string">'1234567890'</span>, <span class="comment">// subject</span></span><br><span class="line">name: <span class="string">'John Doe'</span>,</span><br><span class="line">iat: <span class="built_in">Math</span>.floor(<span class="built_in">Date</span>.now() / <span class="number">1000</span>), <span class="comment">// issued at</span></span><br><span class="line">exp: <span class="built_in">Math</span>.floor(<span class="built_in">Date</span>.now() / <span class="number">1000</span>) + (<span class="number">60</span> * <span class="number">30</span>) <span class="comment">// expiration time</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Encode the payload to create a JWT</span></span><br><span class="line"><span class="keyword">const</span> token = jwt.sign(payload, secretKey, &#123; <span class="attr">algorithm</span>: <span class="string">'HS256'</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(token);</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Verifying a JWT</p>
 <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">jwt.verify(token, secretKey, (err, decoded) =&gt; &#123;</span><br><span class="line"><span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">if</span> (err.name === <span class="string">'TokenExpiredError'</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Token has expired"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Invalid token"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(decoded);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="pyjwt-in-python"><code>PyJWT</code> in Python</h2>
<ol>
<li>
<p>Installing Required Libraries</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install PyJWT</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Creating a JWT</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define your secret key</span></span><br><span class="line">secret_key = <span class="string">'your-256-bit-secret'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the payload (claims)</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">'sub'</span>: <span class="string">'1234567890'</span>,  <span class="comment"># subject</span></span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'John Doe'</span>,</span><br><span class="line">    <span class="string">'iat'</span>: datetime.datetime.utcnow(),  <span class="comment"># issued at</span></span><br><span class="line">    <span class="string">'exp'</span>: datetime.datetime.utcnow() + datetime.timedelta(minutes=<span class="number">30</span>)  <span class="comment"># expiration time</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Encode the payload to create a JWT</span></span><br><span class="line">token = jwt.encode(payload, secret_key, algorithm=<span class="string">'HS256'</span>)</span><br><span class="line"></span><br><span class="line">print(token)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Verifying a JWT</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    decoded_token = jwt.decode(token, secret_key, algorithms=[<span class="string">'HS256'</span>])</span><br><span class="line">    print(decoded_token)</span><br><span class="line"><span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">    print(<span class="string">"Token has expired"</span>)</span><br><span class="line"><span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">    print(<span class="string">"Invalid token"</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
      <categories>
        <category>TECH</category>
      </categories>
      <tags>
        <tag>Authentication</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript比较两个Array数组/Object的内容是否相同</title>
    <url>/JavaScript%E6%AF%94%E8%BE%83%E4%B8%A4%E4%B8%AAArray%E6%95%B0%E7%BB%84%E7%9A%84%E5%86%85%E5%AE%B9%E6%98%AF%E5%90%A6%E7%9B%B8%E5%90%8C.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="why-can-not-use-to-compare-array">Why can not use === to compare Array?</h1>
<p>复习下javascript包括两个不同类型的值， 最新的 ECMAScript 标准定义了 8 种数据类型:</p>
<ul>
<li>基本数据类型(7种原始类型): 是按值访问的, 保存在栈内存（Stack）里, 基本类型的值是不可变的, 基本类型的比较是它们的值的比较。
<ul>
<li>Boolean</li>
<li>Null</li>
<li>Undefined</li>
<li>Number</li>
<li>BigInt</li>
<li>String</li>
<li>Symbol</li>
</ul>
</li>
<li>引用数据类型 (1种Object类型): 按引用访问的, 保存在堆内存(Heap)中的对象, 引用类型的值是可变的, 引用类型的比较是引用的比较。
<ul>
<li>Object</li>
<li>Array</li>
<li>Function</li>
<li>正则（RegExp）</li>
<li>日期（Date）</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> b = a;</span><br><span class="line">b = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(a);  <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>b获取的是a值的一份拷贝，虽然两个变量的值相等，但是两个变量保存了两个不同的基本数据类型值。b只是保存了a赋值的一个副本，所以，b的改变，对a没有影响。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = [];    <span class="comment">// 新建一个空数组 obj1</span></span><br><span class="line"><span class="keyword">var</span> obj2 = [];    <span class="comment">// 新建一个空数组 obj2</span></span><br><span class="line"><span class="built_in">console</span>.log(obj1 == obj2);    <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(obj1 === obj2);   <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>因为 obj1 和 obj2 分别引用的是存放在堆内存中的2个不同的对象，故变量 obj1 和 obj2 的值（引用地址）也是不一样的<br>
==或===操作符只能比较两个对象是否是同一个实例，也就是是否是同一个对象引用。目前JavaScript没有内置的操作符判断对象的内容是否相同。</p>
<h1 id="how-to-compare-array">How to compare Array?</h1>
<h2 id="method-1-transform-array-tostring">Method 1 Transform Array toString</h2>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">array1.toString() === array2.toString()</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="built_in">JSON</span>.stringify(array1) === <span class="built_in">JSON</span>.stringify(array2)</span><br></pre></td></tr></table></figure>
<p>不推荐，原因：</p>
<ul>
<li>首先要保证两个数组顺序一致，例如[1, 2] [2, 1] 顺序不一致，但内容相同。</li>
<li>其次，不是因为转换成字符串类型后才相等。<br>
例如array1=[1, 2], array1=[‘1’, ‘2’];<br>
array1.toString() === array2.toString() // true</li>
<li>简单数组[‘1’, ‘2’]，不是嵌套数组[‘1’, ‘2’, [‘1’, ‘2’]]</li>
</ul>
<h2 id="method-2-for-string">Method 2 For string[]</h2>
<p>如果保证：</p>
<ul>
<li>不是因为转换成字符串类型后才相等。<br>
例如array1=[1, 2], array1=[‘1’, ‘2’];<br>
array1.toString() === array2.toString() // true</li>
<li>简单数组[‘1’, ‘2’]，不是嵌套数组[‘1’, ‘2’, [‘1’, ‘2’]]</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// funtion for simple array string[]</span></span><br><span class="line">isArrayEquals(array1, array2) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!(array1 || array1)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Compare the length</span></span><br><span class="line">    <span class="keyword">if</span> (array1.length != array2.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 先排序再转化为string比较</span></span><br><span class="line">    <span class="keyword">if</span> (array1.sort().toString() === array2.sort().toString()) &#123;</span><br><span class="line">    <span class="comment">// if (JSON.stringify(array1.sort()) === JSON.stringify(array2.sort()) ) &#123;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="method-3-for-all-kinds-of-array">Method 3 For all kinds of array</h2>
<p>适应任何array, 包括嵌套数组。</p>
<p>for all kinds of array</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// prototype 方法</span></span><br><span class="line"><span class="comment">// Warn if overriding existing method</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Array</span>.prototype.equals) &#123;</span><br><span class="line">    <span class="built_in">console</span>.warn(<span class="string">"Overriding existing Array.prototype.equals. Possible causes: New API defines the method, there's a framework conflict or you've got double inclusions in your code."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.equals = <span class="function"><span class="keyword">function</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!array) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.length !== array.length) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>[i] <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; array[i] <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="keyword">this</span>[i].equals(array[i])) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>[i] !== array[i]) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// funtion for all kinds of array</span></span><br><span class="line">isArrayEquals(array1, array2) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!(array1 || array1)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Compare the length</span></span><br><span class="line">    <span class="keyword">if</span> (array1.length != array2.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; array1.length; i++) &#123;</span><br><span class="line">        <span class="comment">// check wheather it's nested arrays</span></span><br><span class="line">        <span class="keyword">if</span> (array1[i] <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; array2[i] <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">            <span class="comment">// Recursion</span></span><br><span class="line">            <span class="keyword">if</span> (!isArrayEquals(array1[i],array2[i]))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;       </span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>[i] != array[i]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;   </span><br><span class="line">        &#125;           </span><br><span class="line">    &#125;       </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="how-to-compare-object">How to compare Object?</h1>
<p>那么同样的道理怎么比较Object呢？</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.equals = <span class="function"><span class="keyword">function</span>(<span class="params">object2</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//For the first loop, we only check for types</span></span><br><span class="line">    <span class="keyword">for</span> (propName <span class="keyword">in</span> <span class="keyword">this</span>) &#123;</span><br><span class="line">        <span class="comment">//Check for inherited methods and properties - like .equals itself</span></span><br><span class="line">        <span class="comment">//https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty</span></span><br><span class="line">        <span class="comment">//Return false if the return value is different</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.hasOwnProperty(propName) != object2.hasOwnProperty(propName)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Check instance type</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>[propName] != <span class="keyword">typeof</span> object2[propName]) &#123;</span><br><span class="line">            <span class="comment">//Different types =&gt; not equal</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Now a deeper check using other objects property names</span></span><br><span class="line">    <span class="keyword">for</span> (propName <span class="keyword">in</span> object2) &#123;</span><br><span class="line">        <span class="comment">//We must check instances anyway, there may be a property that only exists in object2</span></span><br><span class="line">            <span class="comment">//I wonder, if remembering the checked values from the first loop would be faster or not </span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.hasOwnProperty(propName) != object2.hasOwnProperty(propName)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>[propName] != <span class="keyword">typeof</span> object2[propName]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//If the property is inherited, do not check any more (it must be equa if both objects inherit it)</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>.hasOwnProperty(propName))</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Now the detail check and recursion</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//This returns the script back to the array comparing</span></span><br><span class="line">        <span class="comment">/**REQUIRES Array.equals**/</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>[propName] <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; object2[propName] <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">                   <span class="comment">// recurse into the nested arrays</span></span><br><span class="line">           <span class="keyword">if</span> (!<span class="keyword">this</span>[propName].equals(object2[propName]))</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>[propName] <span class="keyword">instanceof</span> <span class="built_in">Object</span> &amp;&amp; object2[propName] <span class="keyword">instanceof</span> <span class="built_in">Object</span>) &#123;</span><br><span class="line">                   <span class="comment">// recurse into another objects</span></span><br><span class="line">                   <span class="comment">//console.log("Recursing to compare ", this[propName],"with",object2[propName], " both named ""+propName+""");</span></span><br><span class="line">           <span class="keyword">if</span> (!<span class="keyword">this</span>[propName].equals(object2[propName]))</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Normal value comparison for strings and numbers</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>[propName] != object2[propName]) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//If everything passed, let's say YES</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Data_structures" target="_blank" rel="noopener">JavaScript 数据类型和数据结构</a></li>
<li><a href="https://segmentfault.com/a/1190000006752076" target="_blank" rel="noopener">JavaScript 深入了解基本类型和引用类型的值</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title>Jconsole(Java Monitoring and Management Console)监控分析JVM性能</title>
    <url>/Jconsole-Java-Monitoring-and-Management-Console-%E7%9B%91%E6%8E%A7%E5%88%86%E6%9E%90JVM%E6%80%A7%E8%83%BD.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><ul>
<li><a href="https://www.cnblogs.com/kongzhongqijing/articles/3621441.html" target="_blank" rel="noopener">jconsole工具使用</a></li>
<li><a href="https://www.ibm.com/docs/zh/sdk-java-technology/8?topic=reference-using-jconsole" target="_blank" rel="noopener">IBM 使用 JConsole</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
        <category>JVM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>IntelliJ</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernates-upgrade</title>
    <url>/Kubernates-upgrade.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="确定要升级到哪个版本">确定要升级到哪个版本</h2>
<p>使用操作系统的包管理器找到最新的补丁版本 Kubernetes 1.24：</p>
<h3 id="ubuntu-debian-或-hypriotos">Ubuntu、Debian 或 HypriotOS</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt-cache madison kubeadm</span><br><span class="line"><span class="comment"># 在列表中查找最新的 1.24 版本</span></span><br><span class="line"><span class="comment"># 它看起来应该是 1.24.x-00，其中 x 是最新的补丁版本</span></span><br></pre></td></tr></table></figure>
<h3 id="centos-rhel-或-fedora">CentOS、RHEL 或 Fedora</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum list --showduplicates kubeadm --disableexcludes=kubernetes</span><br><span class="line"><span class="comment"># 在列表中查找最新的 1.24 版本</span></span><br><span class="line"><span class="comment"># 它看起来应该是 1.24.x-0，其中 x 是最新的补丁版本</span></span><br><span class="line"><span class="comment"># 参考文章</span></span><br></pre></td></tr></table></figure>
<h2 id="升级master">升级master</h2>
<p>控制面节点上的升级过程应该每次处理一个节点。 首先选择一个要先行升级的控制面节点。该节点上必须拥有 /etc/kubernetes/admin.conf 文件。</p>
<h3 id="kubeadm-upgrade">kubeadm upgrade</h3>
<h4 id="对于第一个控制面节点">对于第一个控制面节点</h4>
<h5 id="step-1-升级-kubeadm">Step 1 升级 kubeadm</h5>
<p>Ubuntu、Debian 或 HypriotOS</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 用最新的补丁版本号替换 1.24.x-00 中的 x</span></span><br><span class="line">apt-mark unhold kubeadm &amp;&amp; \</span><br><span class="line">apt-get update &amp;&amp; apt-get install -y kubeadm=1.24.x-00 &amp;&amp; \</span><br><span class="line">apt-mark hold kubeadm</span><br></pre></td></tr></table></figure>
<p>CentOS、RHEL 或 Fedora</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 用最新的补丁版本号替换 1.24.x-0 中的 x</span></span><br><span class="line">yum install -y kubeadm-1.24.x-0 --disableexcludes=kubernetes</span><br></pre></td></tr></table></figure>
<h5 id="step-2-kubeadm-version">Step 2 <code>kubeadm version</code></h5>
<p>验证下载操作正常，并且 kubeadm 版本正确：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubeadm version</span><br></pre></td></tr></table></figure>
<h5 id="step-3-验证升级计划">Step 3 验证升级计划</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubeadm upgrade plan</span><br></pre></td></tr></table></figure>
<h5 id="step-4-kubeadm-upgrade-apply">Step 4 <code>kubeadm upgrade apply</code></h5>
<p>选择要升级到的目标版本，运行合适的命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将 x 替换为你为此次升级所选择的补丁版本号</span></span><br><span class="line">sudo kubeadm upgrade apply v1.24.x</span><br></pre></td></tr></table></figure>
<h4 id="对于其它控制面节点">对于其它控制面节点</h4>
<p>与第一个控制面节点相同，但是使用：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo kubeadm upgrade node</span><br></pre></td></tr></table></figure>
<p>而不是：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo kubeadm upgrade apply</span><br></pre></td></tr></table></figure>
<p>此外，不需要执行 kubeadm upgrade plan 和更新 CNI 驱动插件的操作。</p>
<h3 id="腾空节点">腾空节点</h3>
<ul>
<li>通过将节点标记为不可调度并腾空节点为节点作升级准备：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将 &lt;node-to-drain&gt; 替换为你要腾空的控制面节点名称</span></span><br><span class="line">kubectl drain &lt;node-to-drain&gt; --ignore-daemonsets</span><br></pre></td></tr></table></figure>
<h3 id="升级-kubelet-和-kubectl">升级 kubelet 和 kubectl</h3>
<ul>
<li>升级 kubelet 和 kubectl：</li>
</ul>
<p>CentOS、RHEL 或 Fedora</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 用最新的补丁版本替换 1.24.x-00 中的 x</span></span><br><span class="line">apt-mark unhold kubelet kubectl &amp;&amp; \</span><br><span class="line">apt-get update &amp;&amp; apt-get install -y kubelet=1.24.x-00 kubectl=1.24.x-00 &amp;&amp; \</span><br><span class="line">apt-mark hold kubelet kubectl</span><br></pre></td></tr></table></figure>
<p>Ubuntu、Debian 或 HypriotOS</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 用最新的补丁版本号替换 1.24.x-00 中的 x</span></span><br><span class="line">yum install -y kubelet-1.24.x-0 kubectl-1.24.x-0 --disableexcludes=kubernetes</span><br></pre></td></tr></table></figure>
<ul>
<li>重启 kubelet：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart kubelet</span><br></pre></td></tr></table></figure>
<h3 id="解除节点的保护">解除节点的保护</h3>
<p>通过将节点标记为可调度，让其重新上线：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将 &lt;node-to-drain&gt; 替换为你的节点名称</span></span><br><span class="line">kubectl uncordon &lt;node-to-drain&gt;</span><br></pre></td></tr></table></figure>
<h1 id="参考文章">参考文章</h1>
<ul>
<li><a href="https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/" target="_blank" rel="noopener">kubernetes-upgrade kubeadm</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - Play with Kubernetes（PWK）</title>
    <url>/Kubernetes-Play-with-Kubernetes(PWK).html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="play-with-kubernetes-pwk"><a href="https://labs.play-with-k8s.com/" target="_blank" rel="noopener">Play with Kubernetes（PWK）</a></h2>
<h3 id="1-浏览器进入官网play-with-kubernetes">1 浏览器进入官网<a href="https://labs.play-with-k8s.com/" target="_blank" rel="noopener">Play with Kubernetes</a></h3>
<h3 id="2-点击-sign-in-使用github或者docker-hub-账号登陆-点击-start">2 点击“Sign in”， 使用GitHub或者Docker Hub 账号登陆，点击“Start”</h3>
<h3 id="3-左侧导航栏-点击-add-new-instance">3 左侧导航栏 点击“ADD NEW INSTANCE”</h3>
<p>右侧出现控制台窗口。这是一个Kubernetes节点（node1）</p>
<h3 id="4-执行命令查看节点上预装组件">4 执行命令查看节点上预装组件</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ docker version</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ kubectl version --output=yaml</span><br><span class="line"></span><br><span class="line">$ whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>
<h3 id="5-kubeadm-init-初始化一个新的集群">5  <code>kubeadm init</code> 初始化一个新的集群</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> 1. Initializes cluster master node:</span><br><span class="line"></span><br><span class="line"> kubeadm init --apiserver-advertise-address $(hostname -i) --pod-network-cidr 10.5.0.0/16</span><br><span class="line">    </span><br><span class="line">Your Kubernetes control-plane has initialized successfully!</span><br><span class="line">To start using your cluster, you need to run the following as a regular user:</span><br><span class="line"></span><br><span class="line">  mkdir -p <span class="variable">$HOME</span>/.kube</span><br><span class="line">  sudo cp -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line">  sudo chown $(id -u):$(id -g) <span class="variable">$HOME</span>/.kube/config</span><br><span class="line"></span><br><span class="line">Alternatively, <span class="keyword">if</span> you are the root user, you can run:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">export</span> KUBECONFIG=/etc/kubernetes/admin.conf</span><br><span class="line"></span><br><span class="line">You should now deploy a pod network to the cluster.</span><br><span class="line">Run <span class="string">"kubectl apply -f [podnetwork].yaml"</span> with one of the options listed at:</span><br><span class="line">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span><br><span class="line"></span><br><span class="line">Then you can join any number of worker nodes by running the following on each as root:</span><br><span class="line"></span><br><span class="line">kubeadm join 192.168.0.23:6443 --token 221f6u.1r9leb1snw0fngbo \</span><br><span class="line">    --discovery-token-ca-cert-hash sha256:dc7108dbbe961ecddada53f6597459e7bbccd046dc60900330d24ee94dbcb216 </span><br><span class="line">Waiting <span class="keyword">for</span> api server to startup</span><br><span class="line">Warning: resource daemonsets/kube-proxy is missing the kubectl.kubernetes.io/last-applied-configuration annotation <span class="built_in">which</span> is required by kubectl apply. kubectl apply should only be used on resources created declaratively by either kubectl create --save-config or kubectl apply. The missing annotation will be patched automatically.</span><br><span class="line">daemonset.apps/kube-proxy configured</span><br></pre></td></tr></table></figure>
<h3 id="6-kubectl-get-nodes-查看集群信息">6  <code>kubectl get nodes</code> 查看集群信息</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[node1 ~]$ kubectl get nodes</span><br><span class="line">NAME    STATUS     ROLES                  AGE    VERSION</span><br><span class="line">node1   NotReady   control-plane,master   111s   v1.20.1</span><br></pre></td></tr></table></figure>
<p>节点状态<code>NotReady</code>是由于尚未配置Pod网络。</p>
<h3 id="7-初始化pod网络-集群网络">7 初始化Pod网络（集群网络）</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">2. Initialize cluster networking:</span><br><span class="line"></span><br><span class="line">kubectl apply -f https://raw.githubusercontent.com/cloudnativelabs/kube-router/master/daemonset/kubeadm-kuberouter.yaml</span><br><span class="line"></span><br><span class="line">configmap/kube-router-cfg created</span><br><span class="line">daemonset.apps/kube-router created</span><br><span class="line">serviceaccount/kube-router created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/kube-router created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/kube-router created</span><br></pre></td></tr></table></figure>
<h3 id="8-kubectl-get-nodes-查看集群信息">8  <code>kubectl get nodes</code> 查看集群信息</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[node1 ~]$ kubectl get nodes</span><br><span class="line">NAME    STATUS   ROLES                  AGE   VERSION</span><br><span class="line">node1   Ready    control-plane,master   27m   v1.20.1</span><br></pre></td></tr></table></figure>
<p>节点状态<code>Ready</code><br>
Pod网络已经初始化，控制层也已经Ready。</p>
<h3 id="9-复制kuberadm-init执行后打印出的kuberadm-join命令">9 复制<code>kuberadm init</code>执行后打印出的<code>kuberadm join</code>命令</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 先复制好，但不执行</span></span><br><span class="line">kubeadm join 192.168.0.23:6443 --token 221f6u.1r9leb1snw0fngbo \</span><br><span class="line">    --discovery-token-ca-cert-hash sha256:dc7108dbbe961ecddada53f6597459e7bbccd046dc60900330d24ee94dbcb216</span><br></pre></td></tr></table></figure>
<p>如果忘记保存此命令，可用如下命令获取：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubeadm token create --<span class="built_in">print</span>-join-command</span><br></pre></td></tr></table></figure>
<h3 id="10-左侧导航栏-点击-add-new-instance">10 左侧导航栏 点击“ADD NEW INSTANCE”</h3>
<p>得到新节点node2</p>
<h3 id="11-在node2控制台中执行9的kuberadm-join命令">11 在node2控制台中执行9的<code>kuberadm join</code>命令</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[node2 ~]$ kubeadm join 192.168.0.23:6443 --token 221f6u.1r9leb1snw0fngbo \</span><br><span class="line">&gt;     --discovery-token-ca-cert-hash sha256:dc7108dbbe961ecddada53f6597459e7bbccd046dc60900330d24ee94dbcb216</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">This node has joined the cluster:</span><br><span class="line">* Certificate signing request was sent to apiserver and a response was received.</span><br><span class="line">* The Kubelet was informed of the new secure connection details.</span><br><span class="line"></span><br><span class="line">Run <span class="string">'kubectl get nodes'</span> on the control-plane to see this node join the cluster.</span><br></pre></td></tr></table></figure>
<h3 id="12-在node1控制台中执行-kubectl-get-nodes命令">12 在node1控制台中执行 <code>kubectl get nodes</code>命令</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[node1 ~]$ kubectl get nodes</span><br><span class="line">NAME    STATUS   ROLES                  AGE     VERSION</span><br><span class="line">node1   Ready    control-plane,master   41m     v1.20.1</span><br><span class="line">node2   Ready    &lt;none&gt;                 2m13s   v1.20.1</span><br></pre></td></tr></table></figure>
<p>node1为主节点（PWK页面蓝色图标），node2为工作节点（PWK页面灰色图标）。</p>
<h3 id="查看kubectl配置">查看kubectl配置</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[node1 ~]$ kubectl config view</span><br><span class="line">apiVersion: v1</span><br><span class="line">clusters:</span><br><span class="line">- cluster:</span><br><span class="line">    certificate-authority-data: DATA+OMITTED</span><br><span class="line">    server: https://192.168.0.23:6443</span><br><span class="line">  name: kubernetes</span><br><span class="line">contexts:</span><br><span class="line">- context:</span><br><span class="line">    cluster: kubernetes</span><br><span class="line">    user: kubernetes-admin</span><br><span class="line">  name: kubernetes-admin@kubernetes</span><br><span class="line">current-context: kubernetes-admin@kubernetes</span><br><span class="line">kind: Config</span><br><span class="line">preferences: &#123;&#125;</span><br><span class="line">users:</span><br><span class="line">- name: kubernetes-admin</span><br><span class="line">  user:</span><br><span class="line">    client-certificate-data: REDACTED</span><br><span class="line">    client-key-data: REDACTED</span><br></pre></td></tr></table></figure>
<h3 id="查看当前使用的context">查看当前使用的context</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[node1 ~]$ kubectl config current-context</span><br><span class="line">kubernetes-admin@kubernetes</span><br></pre></td></tr></table></figure>
<h3 id="改变当前使用的context">改变当前使用的context</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl config use-context contextName</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1. (Optional) Create an nginx deployment:</span><br><span class="line"></span><br><span class="line">kubectl apply -f &lt;https://raw.githubusercontent.com/kubernetes/website/master/content/en/examples/application/nginx-app.yaml&gt;</span><br></pre></td></tr></table></figure>
<h2 id="安装后设置">安装后设置</h2>
<h3 id="设置使用tab键">设置使用Tab键</h3>
<p>编辑/etc/profile, 在第二行加上source &lt;(kubectl completion bash)</p>
<ul>
<li>要让此设置生效，操作系统要安装bash-completion</li>
<li>注意小括号为英文版</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ head -3 /etc/profile</span><br><span class="line"><span class="comment"># /etc/profile</span></span><br><span class="line"><span class="built_in">source</span> &lt;(kubectl completion bash) <span class="comment"># 新增&lt;与(中间没有空格</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>
<h3 id="设置vim">设置vim</h3>
<p>创建/root/.vimrc</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat .vimrc</span><br><span class="line"><span class="built_in">set</span> paste</span><br></pre></td></tr></table></figure>
<h2 id="设置metric-server监控pod及node负载">设置metric-server监控pod及node负载</h2>
<h3 id="安装metric-server">安装metric-server</h3>
<ol>
<li>所有node上下载镜像</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ docker pull mirrorgooglecontainers/metrics-server-amd64:v0.3.6</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>所有node上tag操作，形成一个新镜像</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ docker tag mirrorgooglecontainers/metrics-server-amd64:v0.3.6 k8s.gcr.io/metrics-server-amd64:v0.3.6</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>master上下载metrics-server</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ curl -Ls https://api.github.com/repos/kubernetes-sigs/metrics-server/tarball/v0.3.6 -o metrics-server-v0.3.6.tar.gz</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>
<p>解压<code>metrics-server-v0.3.6.tar.gz</code>, 进入目录 <code>/root/kubernetes-sigs-metrics-server-d1f4f6f/deploy/1.8+</code></p>
</li>
<li>
<p>修改metrics-server-deployment.yaml</p>
</li>
<li>
<p>运行当前目录所有文件</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl apply -f .</span><br></pre></td></tr></table></figure>
<h3 id="查看负载">查看负载</h3>
<p>查看节点负载</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl top nodes --use-protocol-buffers</span><br></pre></td></tr></table></figure>
<p>查看pod负载</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl top pods -n kube-system --use-protocol-buffers</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>MacOS Karabiner-Elements配置+不生效解决方法</title>
    <url>/Karabiner-Elements%E4%B8%8D%E7%94%9F%E6%95%88.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="macos-karabiner-elements配置">MacOS Karabiner-Elements配置</h2>
<p><a href="https://pqrs.org/osx/karabiner/" target="_blank" rel="noopener"><strong>Karabiner Element</strong></a>，用于<a href="http://lucifr.com/2013/02/16/caps-lock-to-hyper-key/" target="_blank" rel="noopener">把右 Command 和 Capslock 键利用起来</a>，避免快捷键冲突，<a href="https://hackmd.io/s/rk4u9i-pG" target="_blank" rel="noopener">简单 note</a>，详见<a href="https://www.bilibili.com/video/av44127555" target="_blank" rel="noopener">sorrycc的《我的快捷键技巧》</a></p>
<ul>
<li>另外参考<a href="https://lhajh.github.io/mac/2017/12/05/.Mac-custom-application-shortcut-keys.html" target="_blank" rel="noopener">Mac 自定义应用程序快捷键</a>配置了Mac app，比如Chrome和iterm3的一些快捷键。免费，开源。</li>
</ul>
<h3 id="right-option-left-command">right_option --&gt; left_command</h3>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Karabiner-Elements%E4%B8%8D%E7%94%9F%E6%95%88/right_option_left_command.png" alt="right_option --&amp;gt; left_command"></p>
<h3 id="right-command-command-control-option-shift">right_command --&gt;  command+control+option+shift</h3>
<p>Add your own rule: right_command --&gt;  command+control+option+shift<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Karabiner-Elements%E4%B8%8D%E7%94%9F%E6%95%88/right_command%20to%20command%2Bcontrol%2Boption%2Bshift.png" alt="command+control+option+shift"></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"manipulators"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"description"</span>: <span class="string">"Change right_command to command+control+option+shift."</span>,</span><br><span class="line">            <span class="attr">"from"</span>: &#123;</span><br><span class="line">                <span class="attr">"key_code"</span>: <span class="string">"right_command"</span>,</span><br><span class="line">                <span class="attr">"modifiers"</span>: &#123; <span class="attr">"optional"</span>: [<span class="string">"any"</span>] &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">"to"</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">"key_code"</span>: <span class="string">"left_shift"</span>,</span><br><span class="line">                    <span class="attr">"modifiers"</span>: [<span class="string">"left_command"</span>, <span class="string">"left_control"</span>, <span class="string">"left_option"</span>]</span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"basic"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="macos-karabiner-elements-不生效解决方法">MacOS Karabiner-Elements 不生效解决方法</h2>
<p>每回MacOS一升级，总会遇到Karabiner-Elements不生效的问题，所以统一总结一下</p>
<h3 id="karabiner-elements">Karabiner-Elements</h3>
<p><a href="https://pqrs.org/osx/karabiner/" target="_blank" rel="noopener"><strong>Karabiner Element</strong></a>，作用是键盘按键改键。</p>
<p>我通常用于<a href="http://lucifr.com/2013/02/16/caps-lock-to-hyper-key/" target="_blank" rel="noopener">把右 Command 和 Capslock 键利用起来</a>，避免快捷键冲突，<a href="https://hackmd.io/s/rk4u9i-pG" target="_blank" rel="noopener">简单 note</a>，详见<a href="https://www.bilibili.com/video/av44127555" target="_blank" rel="noopener">sorrycc的《我的快捷键技巧》</a></p>
<ul>
<li>“<code>右 Command”改成F19</code>: 切换到Complex modifications --&gt; Add rule --&gt; “Change caps_lock to command+control+option+shift.” --&gt; 打开文件<code>~/.config/karabiner/karabiner.json</code> 把<code>caps_lock</code>替换成<code>right_command</code><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E5%A5%A5%E5%88%A9%E7%BB%99%E4%BD%A0%E7%9A%84iTerm2-%E5%BF%AB%E9%80%9F%E7%94%A8IDE%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6/Karabiner%20Element.png" alt="替换成"></li>
<li>我试了后, 把“右 Command”改成F19,发现我右 Command+delete还是经常用的，所以接着在Karabiner Element 的“Simple modifications” 把 “right_option” 改成了 “left_command”。</li>
<li>另外参考<a href="https://lhajh.github.io/mac/2017/12/05/.Mac-custom-application-shortcut-keys.html" target="_blank" rel="noopener">Mac 自定义应用程序快捷键</a>配置了Mac app，比如Chrome和iterm3的一些快捷键。免费，开源。</li>
</ul>
<h3 id="通用解决方法">通用解决方法</h3>
<p>系统权限保证都设置正确<br>
打开System Settings &gt; Security &amp; Privacy &gt; Privacy</p>
<h4 id="full-disk-access">Full Disk Access</h4>
<ul>
<li>Karabiner-Elements
<ul>
<li>/Applications/Karabiner-Elements.app</li>
</ul>
</li>
<li>karabiner_grabber
<ul>
<li>路径： /Library/Application Support/org.pqrs/Karabiner-Elements/bin/karabiner_grabber</li>
</ul>
</li>
</ul>
<h4 id="input-monitoring">Input monitoring</h4>
<ul>
<li>Karabiner-Eventviewer
<ul>
<li>/Applications/Karabiner-EventViewer.app</li>
</ul>
</li>
<li>karabiner_grabber
<ul>
<li>/Library/Application Support/org.pqrs/Karabiner-Elements/bin/karabiner_grabber</li>
</ul>
</li>
<li>karabiner_observer
<ul>
<li>/Library/Application Support/org.pqrs/Karabiner-Elements/bin/karabiner_observer</li>
</ul>
</li>
</ul>
<h4 id="accessibility">Accessibility</h4>
<ul>
<li>karabiner_grabber
<ul>
<li>/Library/Application Support/org.pqrs/Karabiner-Elements/bin/karabiner_grabber</li>
</ul>
</li>
<li>karabiner_observer
<ul>
<li>/Library/Application Support/org.pqrs/Karabiner-Elements/bin/karabiner_observer</li>
</ul>
</li>
</ul>
<h4 id="allow-driver">Allow driver</h4>
<p>打开System Settings &gt; Security &amp; Privacy &gt; Security<br>
Allow driver:<br>
<a href="https://karabiner-elements.pqrs.org/docs/help/troubleshooting/allow-button-does-not-appear/" target="_blank" rel="noopener">https://karabiner-elements.pqrs.org/docs/help/troubleshooting/allow-button-does-not-appear/</a></p>
<h4 id="重启">重启</h4>
<p>重启电脑<br>
多次重启Karabiner-Elements<br>
如果还不成功，就杀进程后重启Karabiner-Elements</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo killall karabiner_grabber</span><br><span class="line">sudo killall karabiner_observer</span><br></pre></td></tr></table></figure>
<h3 id="macos-14-4-1-karabiner-elements不生效">MacOS 14.4.1 Karabiner-Elements不生效</h3>
<p>额外把’karabiner_grabber’ full disk access rights makes it work. However, I had to restart Karabiner twice afterwards and 重启电脑.</p>
<p>参考链接：<a href="https://github.com/pqrs-org/Karabiner-Elements/issues/3620#issuecomment-1765946996" target="_blank" rel="noopener">https://github.com/pqrs-org/Karabiner-Elements/issues/3620#issuecomment-1765946996</a></p>
<h3 id="macos-10-14-6-karabiner-elements不生效">MacOS 10.14.6 Karabiner-Elements不生效</h3>
<p>遇到了<a href="https://www.v2ex.com/t/585453" target="_blank" rel="noopener">macOS 10.14.6 Karabiner-Elements</a> 疑似无法正常使用的问题<br>
参考<a href="https://github.com/pqrs-org/Karabiner-Elements/issues/1867" target="_blank" rel="noopener">Does not work on MacOS Catalina #1867</a></p>
<p>For some reason the permission prompt is not showing up for me when I open <code>Karabiner-EventViewer</code>. And EventViewer says “EventViewer failed to observe keyboard devices”. So I cannot find out a way to use saagarjha’s method as stated above.</p>
<ol>
<li>add <code>karabiner_grabber</code> and <code>karabiner_observer</code> to “Security &amp; Privacy &gt; Privacy &gt; Accessibility” apps.</li>
<li>And after sudo killall-ing both processes, Karabiner-Elements is working for me again.</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo killall karabiner_grabber</span><br><span class="line">sudo killall karabiner_observer</span><br></pre></td></tr></table></figure>
<p>In order to fix, I needed to add the following entries to the Security &amp; Privacy &gt; Privacy &gt; Input Monitoring list:</p>
<p>/Library/Application Support/org.pqrs/Karabiner-Elements/bin/karabiner_grabber<br>
/Library/Application Support/org.pqrs/Karabiner-Elements/bin/karabiner_observer</p>
<h3 id="其他改键工具">其他改键工具</h3>
<p>Some other tools that should work for you are:</p>
<ol>
<li>hidutil: macOS-native remapping tool. See <a href="https://github.com/pqrs-org/Karabiner-Elements/issues/3082#issuecomment-1137009173" target="_blank" rel="noopener">MX Keys not active in logi options+ via bluetooth #3082 (comment)</a>.   Only work for simple modifications</li>
<li>skhd: <a href="https://github.com/koekeishiya/skhd" target="_blank" rel="noopener">https://github.com/koekeishiya/skhd</a>.</li>
<li>Hammerspoon or BetterTouchTool.</li>
</ol>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>MAC OS常见问题集锦</title>
    <url>/MAC-OS%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E9%9B%86%E9%94%A6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="mac登陆无法用指纹解锁">MAC登陆无法用指纹解锁</h2>
<p>MAC登陆无法用指纹解锁，每次都需要重新输入密码</p>
<blockquote>
<p>your login password and keychain password must match. Update your keychain password and try again.</p>
</blockquote>
<p>原因：<br>
登录密码和钥匙串密码不匹配。需要更新钥匙串密码。</p>
<p>解决方法：<br>
<a href="https://support.apple.com/guide/keychain-access/if-you-need-to-update-your-keychain-password-kyca2429/mac" target="_blank" rel="noopener">If your Mac keeps asking for your keychain password</a></p>
<ul>
<li>在您的Mac上的“钥匙串访问”应用程序中，选择“钥匙串访问” &gt; “设置”。</li>
<li>点击“重置默认钥匙串”。</li>
<li>选择苹果菜单 &gt; “注销”。当您再次登录时，请将您当前的登录密码保存在一个钥匙串中。</li>
</ul>
<h2 id="修改-users-xxx-account-name">修改/Users/xxx account name</h2>
<p><a href="https://support.apple.com/en-us/HT201548" target="_blank" rel="noopener">Change the name of your macOS user account and home folder</a></p>
<!-- ## [Mac安装软件时提示已损坏的解决方法](http://liyuankun.top/Mac%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E6%97%B6%E6%8F%90%E7%A4%BA%E5%B7%B2%E6%8D%9F%E5%9D%8F%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95.html)

## [【macOS】删除启动台顽固图标](http://liyuankun.top/%E3%80%90macOS%E3%80%91%E5%88%A0%E9%99%A4%E5%90%AF%E5%8A%A8%E5%8F%B0%E9%A1%BD%E5%9B%BA%E5%9B%BE%E6%A0%87.html) -->]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - RBAC</title>
    <url>/Kubernetes-RBAC.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="role">Role</h1>
<h2 id="创建role">创建Role</h2>
<h3 id="apply-yaml">apply yaml</h3>
<ul>
<li>
<p><code>kubectl create role namex —verb=get,watch,list --resource=pods --dry-run=client -o yaml&gt;role1.yaml</code></p>
<ul>
<li>快速获取role1.yaml，再进行修改</li>
</ul>
</li>
<li>
<p><code>kubectl apply -f role1.yaml</code></p>
</li>
</ul>
<h3 id="kubectl-create-role-namex-verb-get-watch-list-resource-pods-deployment"><code>kubectl create role namex —verb=get,watch,list --resource=pods,deployment</code></h3>
<h2 id="查看role">查看Role</h2>
<h3 id="kubectl-get-role"><code>kubectl get role</code></h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">NAME       AGE</span><br><span class="line">od-reader  7s</span><br></pre></td></tr></table></figure>
<h3 id="kubectl-describe-role-pod-reader"><code>kubectl describe role pod-reader</code></h3>
]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux 命令总结</title>
    <url>/Linux-%E5%91%BD%E4%BB%A4%E6%80%BB%E7%BB%93.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://mp.weixin.qq.com/s/mhb02uSHkPAgIxwpiDN70Q" target="_blank" rel="noopener">2万字系统总结，带你实现Linux命令自由</a></li>
<li><a href="../cURL.html">cURL</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Linux/bash</category>
      </categories>
      <tags>
        <tag>Command line</tag>
        <tag>LinksSummary</tag>
      </tags>
  </entry>
  <entry>
    <title> Mac 上优化储存空间</title>
    <url>/Mac-%E4%B8%8A%E4%BC%98%E5%8C%96%E5%82%A8%E5%AD%98%E7%A9%BA%E9%97%B4.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><ol>
<li><a href="https://support.apple.com/zh-cn/guide/system-information/sysp4ee93ca4/mac" target="_blank" rel="noopener">在 Mac 上优化储存空间</a></li>
</ol>
<ol start="2">
<li><a href="https://support.apple.com/zh-cn/HT206996" target="_blank" rel="noopener">如何释放 Mac 上的储存空间</a></li>
</ol>
<ol start="3">
<li><a href="https://blog.csdn.net/nynkl/article/details/78050495" target="_blank" rel="noopener">Mac 下清理硬盘空间大小 很实用哦。</a></li>
</ol>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>Markdown表格中单元格合并</title>
    <url>/Markdown%E8%A1%A8%E6%A0%BC%E4%B8%AD%E5%8D%95%E5%85%83%E6%A0%BC%E5%90%88%E5%B9%B6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><ul>
<li><a href="https://3nice.cc/2018/10/01/markdowntable/" target="_blank" rel="noopener">解决在Markdown中的表格单元格合并的问题</a></li>
<li><a href="https://www.zhihu.com/question/50267650" target="_blank" rel="noopener">markdown的表格语法能合并单元格吗？</a><br>
<a href="https://blog.csdn.net/loongshawn/article/details/72829090" target="_blank" rel="noopener">Markdown表格之合并单元格效果</a></li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>Learning TypeScript with React</title>
    <url>/Learning-TypeScript-with-React.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://github.com/Microsoft/TypeScript" target="_blank" rel="noopener">TypeScript Github</a><br>
<a href="https://www.typescriptlang.org/docs/handbook/typescript-in-5-minutes.html" target="_blank" rel="noopener">官方文档： TypeScript in 5 minutes - TypeScript for JavaScript Programmers</a><br>
<a href="https://www.typescriptlang.org/docs/handbook/typescript-in-5-minutes.html" target="_blank" rel="noopener">Interfaces and Types</a><br>
<a href="https://stackoverflow.com/questions/37233735/typescript-interfaces-vs-types/52682220#52682220" target="_blank" rel="noopener">Interfaces and Types区别</a><br>
练习：<a href="https://github.com/type-challenges/type-challenges" target="_blank" rel="noopener">type-challenges</a> 推荐把Easy和Medium的做了。</p>
<p><a href="https://redux.js.org/usage/usage-with-typescript#type-checking-redux-thunks" target="_blank" rel="noopener">Type Checking Redux Thunks</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>TypeScript</category>
      </categories>
      <tags>
        <tag>TypeScript</tag>
      </tags>
  </entry>
  <entry>
    <title>MAC book pro 2015款换三星SSD硬盘970EVO 1T</title>
    <url>/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>升级MacBook Pro（15英寸，带有Retina显示屏，2015年）中的SSD硬盘。原SSD硬盘容量只有256GB, 相当不够用.<br>
虽然电脑是15款的，但还很好用，不如只换个SSD就行了。既然都换了，不如直接上1T的。</p>
<h1 id="1-准备">1 准备</h1>
<h2 id="1-1-硬件准备">1.1 硬件准备</h2>
<ul>
<li>P5 螺丝刀 + T6 螺丝刀 + 碳棒（或者不导电的其他工具，用于在2.2步骤里拆除电池连接器）</li>
<li>SSD硬盘：三星SSD硬盘970EVO 1T  ￥1296</li>
<li>M.2 NGFF转Macbook SSD转接卡：￥18<br>
虽然MacBook专用的SSD接口比较特殊，但是它仅仅只是接口形态有别于常规M.2，金手指定义和缺口位置不一样，转接卡甚至都不需要芯片，非常简单成本也很低，同时得益于它长度比一般常规的2280规格的M.2 SSD还更长一点，加个转接卡在前面装回去也完全可行。<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/0%E8%BD%AC%E6%8E%A5%E5%8D%A1.jpeg" alt="M.2 NGFF转Macbook SSD转接卡"></li>
</ul>
<h2 id="1-2-软件准备">1.2 软件准备</h2>
<ul>
<li>系统升级到 macOS Hight Serria (10.13)及以上：在 macOS 10.13 正式发布之后，支持原生 NVME 协议。</li>
<li>Time Machine 备份系统，可以实现整个系统完整迁移。</li>
<li><a href="../%E5%88%B6%E4%BD%9CMAC-OS-%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85U%E7%9B%98.md">制作U盘系统盘，安装全新的MAC OS系统</a>。</li>
</ul>
<h1 id="2-硬件-换ssd">2 硬件-换SSD</h1>
<h2 id="2-1拆底部盖板">2.1拆底部盖板</h2>
<p>取出固定Macbook Pro底壳的五角梅花螺丝，每颗螺丝按原位置摆放好，如下：</p>
<ul>
<li>8颗3.1mm</li>
<li>两颗2.3mm</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/1.1.png" alt="M.2 NGFF转Macbook SSD转接卡"></p>
<p>从屏幕转轴一侧的边缘抬起，把底部盖板从MacBook Pro上抬起来。</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/1.11.png" alt></p>
<p>底部盖板上有两个塑料夹子（红色），在上面的箱子里卡扣（橙色）可以装进塑料夹子。<br>
在重新组装过程中，轻轻地将盖板的中心推到它的两个塑料夹上。</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/1.12.png" alt></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/1.13.png" alt></p>
<h2 id="2-2-拆除电池连接器">2.2 拆除电池连接器</h2>
<ul>
<li>把电池连接器上的标签撕掉， 不撕也可以。</li>
<li>在逻辑板上轻轻抬起电池连接器的每一端，将连接器从其插座上撬开。</li>
<li>将连接器弯曲，确保电池连接器不意外地与逻辑板接触。</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/2.21.png" alt></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/2.22.png" alt></p>
<h2 id="2-3-拆除旧ssd-固态硬盘">2.3 拆除旧SSD（固态硬盘）</h2>
<ul>
<li>拧开将 SSD 固定在主板上的一颗 2.9 mm T5 梅花螺丝。</li>
<li>把SSD抬起足够高来从扬声器上方拿出。不要把SSD抬得太高，否则你可能会损坏触点或者插槽。</li>
<li>把SSD从主板上的插槽中拉出。</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/2.31.png" alt></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/2.32.png" alt></p>
<h2 id="2-4-换上新的ssd">2.4 换上新的SSD</h2>
<ul>
<li>把NVMe M.2 固态硬盘插在转接卡上</li>
<li>再安装到MacBook主板的SSD接口上。注意一定要卡紧咯。</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/0%E8%BD%AC%E6%8E%A5%E5%8D%A1.jpeg" alt="M.2 NGFF转Macbook SSD转接卡"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/2.4.png" alt></p>
<ul>
<li>安装好电池连接器，安装底部盖板。</li>
</ul>
<h1 id="3-软件-安装系统">3 软件-安装系统</h1>
<ol>
<li>电脑插上制作好之后的macOS Big Sur 系统启动U盘</li>
<li>点击电源键，启动Mac</li>
<li>一直按住<code>option</code>键，直到出现“安装 Big Sur”再松开，然后点击“安装 Big Sur”开始安装macOS Big Sur系统。</li>
</ol>
<blockquote>
<p>不要”command + R“, 否则后续”磁盘工具“内找不到新装的SSD硬盘。</p>
</blockquote>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/3.3.png" alt></p>
<ol start="4">
<li>
<p>出现白色apple 图标，读进度条(这一步可能出现，有些电脑不会出现)</p>
</li>
<li>
<p>选择语言 (这一步可能出现，有些电脑不会出现)<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/3.5.png" alt></p>
</li>
<li>
<p>出现“macOS 实用工具“ 界面, 选择”磁盘工具“<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/3.6.png" alt></p>
</li>
<li>
<p>格式化（抹掉）新装的SSD硬盘</p>
</li>
</ol>
<p>选择显示全部（这一步很重要！很重要！很重要！否则接下来你抹掉磁盘时有可能找不到 GUID 分区图的选项哦）<br>
找到新硬盘，抹掉，名称自定义（这里我为磁盘取名 Macintosh HD），方案：</p>
<ul>
<li>格式：<code>Mac OS扩展（日志式）</code>或者 <code>APFS</code>格式</li>
<li>方案：<code>GUID</code><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/3.7.png" alt><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/3.71.png" alt><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/3.72.png" alt></li>
</ul>
<ol start="8">
<li>退出”磁盘工具“， 回到“macOS 实用工具“ 界面, 选择”安装MacOS“ 或者 ”从Time machine 备份进行恢复“。<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/MAC-book-pro-2015%E6%AC%BE%E6%8D%A2%E4%B8%89%E6%98%9FSSD%E7%A1%AC%E7%9B%98970EVO-1T/3.8.png" alt></li>
</ol>
<h1 id="4-测试">4 测试</h1>
<p>系统安装完后，apple store （美国区）安装软件‎Blackmagic Disk Speed Test， 测试SSD速度。<br>
测试一下速度，读28xxMB/s，写24xxMB/s。</p>
<h1 id="参考文章">参考文章</h1>
<ul>
<li><a href="https://post.smzdm.com/p/a783vk9g/" target="_blank" rel="noopener">换个SSD再战3年，15款MacBook Pro升级1TB SSD，附13-17款升级指南</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>Python安装+python2和python3的版本切换设置</title>
    <url>/Mac%E4%B8%8Apython2%E5%92%8Cpython3%E7%9A%84%E7%89%88%E6%9C%AC%E5%88%87%E6%8D%A2%E8%AE%BE%E7%BD%AE.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="安装python">安装Python</h1>
<p><a href="https://liaoxuefeng.com/books/python/install/" target="_blank" rel="noopener">廖雪峰安装Python</a></p>
<p>如果你正在使用Mac，系统是OS X&gt;=10.9，那么系统自带的Python版本是2.7。要安装最新的Python，有两个方法：</p>
<h2 id="方法一：从python官网下载安装程序">方法一：从Python官网下载安装程序</h2>
<p><a href="https://www.python.org/downloads/" target="_blank" rel="noopener">从Python官网下载Python 最新的安装程序</a><br>
<a href="https://www.python.org/downloads/release/python-3119/" target="_blank" rel="noopener">从Python官网下载Python 3.11.9 安装程序</a><br>
<a href="https://www.python.org/downloads/release/python-2718/" target="_blank" rel="noopener">从Python官网下载Python 2.7.18 (python2最后一个版本)</a></p>
<p>下载后双击运行并安装:</p>
<p>安装目录：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> python3</span><br><span class="line">/Library/Frameworks/Python.framework/Versions/3.11/bin/python3</span><br><span class="line"><span class="comment"># python2</span></span><br><span class="line"><span class="built_in">which</span> python</span><br><span class="line">/Library/Frameworks/Python.framework/Versions/2.7/bin/python</span><br></pre></td></tr></table></figure>
<h2 id="方法二：homebrew-and-python">方法二：<a href="https://docs.brew.sh/Homebrew-and-Python" target="_blank" rel="noopener">Homebrew and Python</a></h2>
<p>如果安装了Homebrew，直接通过命令<code>brew install python3</code>安装即可。<br>
MAC Monterey 系统上新版本Homebrew， 例如 3.3.12，默认路径变为<code>/opt/homebrew/Cellar/python@3.10</code>, 下面的子目录就是用brew安装的其他包。</p>
<p>安装目录：<code>/usr/local/Cellar/python@3.11</code><br>
可执行文件目录：<code>/usr/local/bin/python3.11</code></p>
<h3 id="usr-local-bin和-opt-homebrew-bin都是用于存放可执行文件的目录-它们的区别在于"><code>/usr/local/bin</code>和<code>/opt/homebrew/bin</code>都是用于存放可执行文件的目录。它们的区别在于</h3>
<ul>
<li>
<p><code>/usr/local/bin</code>：这是Mac OS系统中的一个标准目录，用于存放用户自己安装的软件或第三方软件的可执行文件。当你使用Homebrew或其他包管理器安装软件时，它们通常会将可执行文件安装到<code>/usr/local/bin</code>目录下。这样做的好处是，你可以通过在终端中直接输入命令来运行这些软件。</p>
</li>
<li>
<p><code>/opt/homebrew/bin</code>：这是Homebrew软件包管理器的默认安装目录。当你使用Homebrew安装软件时，它会将软件的可执行文件安装到/opt/homebrew/bin目录下。这样做的好处是，Homebrew可以管理软件的版本和依赖关系，并确保这些软件在系统中正确地运行。</p>
</li>
</ul>
<p>总的来说，<code>/usr/local/bin</code>是一个通用的可执行文件目录，而<code>/opt/homebrew/bin</code>是Homebrew软件包管理器的特定安装目录。</p>
<h2 id="查找python路径">查找Python路径</h2>
<p>根据你实际的python安装路径，进行下一步的Environment path的设置。</p>
<h3 id="mac-自带python-路径">Mac 自带python 路径</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> python</span><br><span class="line">/usr/bin/python</span><br></pre></td></tr></table></figure>
<h3 id="从python官网下载python-的安装程序安装路径">从Python官网下载Python 的安装程序安装路径</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> python3</span><br><span class="line">/Library/Frameworks/Python.framework/Versions/3.11/bin/python3</span><br><span class="line"><span class="built_in">which</span> python</span><br><span class="line">/Library/Frameworks/Python.framework/Versions/2.7/bin/python</span><br></pre></td></tr></table></figure>
<h3 id="homebrew-python-路径">Homebrew python 路径</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> python3</span><br><span class="line">/opt/homebrew/bin/python3</span><br><span class="line"></span><br><span class="line"><span class="built_in">where</span> python</span><br><span class="line">/usr/<span class="built_in">local</span>/bin/python</span><br></pre></td></tr></table></figure>
<h2 id="查看python版本">查看python版本</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -V</span><br><span class="line"></span><br><span class="line">python --version</span><br><span class="line">Python 2.7.18</span><br><span class="line"></span><br><span class="line">python3 --version</span><br><span class="line">Python 3.12.5</span><br></pre></td></tr></table></figure>
<h1 id="python2和python3的版本切换设置">python2和python3的版本切换设置</h1>
<p>按这篇<a href="https://blog.csdn.net/Tyro_java/article/details/78510301" target="_blank" rel="noopener">Python笔记：Mac上python2和python3的版本切换的简单处理方式</a>的方法设置：</p>
<h2 id="修改bash-profile">修改bash_profile</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 我的.bash_profile没有python配置，都配在了~/.zprofile</span></span><br><span class="line">vi ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>如果使用zsh则相应修改<code>~/.zprofile</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi ~/.zprofile</span><br></pre></td></tr></table></figure>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"># -------------------- Python --------------------</span><br><span class="line"># Setting PATH <span class="keyword">for</span> Python <span class="number">2.7</span> MAC Default</span><br><span class="line"># The original <span class="keyword">version</span> <span class="keyword">is</span> saved in .bash_profile.pysave</span><br><span class="line"># export PATH=<span class="string">"/usr/bin:$&#123;PATH&#125;"</span></span><br><span class="line"></span><br><span class="line"># Setting PATH <span class="keyword">for</span> Python <span class="number">2.7</span></span><br><span class="line"># The original <span class="keyword">version</span> <span class="keyword">is</span> saved in .zprofile.pysave</span><br><span class="line">PATH=<span class="string">"/Library/Frameworks/Python.framework/Versions/2.7/bin:$&#123;PATH&#125;"</span></span><br><span class="line">export PATH</span><br><span class="line"></span><br><span class="line"># Setting PATH <span class="keyword">for</span> Python <span class="number">3.11</span></span><br><span class="line"># The original <span class="keyword">version</span> <span class="keyword">is</span> saved in .zprofile.pysave</span><br><span class="line">PATH=<span class="string">"/Library/Frameworks/Python.framework/Versions/3.11/bin:$&#123;PATH&#125;"</span></span><br><span class="line">export PATH</span><br><span class="line"></span><br><span class="line"># Setting PATH <span class="keyword">for</span> Python <span class="number">3.12</span> Homebrew</span><br><span class="line"># The original <span class="keyword">version</span> <span class="keyword">is</span> saved in .bash_profile.pysave</span><br><span class="line"># export PATH=<span class="string">"/opt/homebrew/bin:$&#123;PATH&#125;"</span></span><br><span class="line"># If you using Homebrew <span class="keyword">to</span> install Python <span class="number">3</span></span><br><span class="line"># export PATH=<span class="string">"/usr/local/bin:$&#123;PATH&#125;"</span></span><br></pre></td></tr></table></figure>
<h2 id="修改bashrc">修改bashrc</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi ~/.bashrc</span><br></pre></td></tr></table></figure>
<p>如果使用zsh则相应修改<code>~/.zshrc</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 我的~/.zshrc没有python配置，都配在了 ~/.bashrc</span></span><br><span class="line">vi ~/.zshrc</span><br></pre></td></tr></table></figure>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"># <span class="keyword">python</span></span><br><span class="line">alias python2=<span class="string">'/usr/bin/python2.7'</span></span><br><span class="line"># alias python2=<span class="string">'/Library/Frameworks/Python.framework/Versions/2.7/bin/python2'</span> # <span class="number">2.7</span>.<span class="number">18</span>  in work machine</span><br><span class="line">alias <span class="keyword">python3</span>=<span class="string">'/Library/Frameworks/Python.framework/Versions/3.11/bin/python3.11'</span> # <span class="number">3.11</span> in work machine</span><br><span class="line"></span><br><span class="line"># If you using Homebrew <span class="keyword">to</span> install Python <span class="number">3</span></span><br><span class="line"># alias <span class="keyword">python3</span>=<span class="string">'/usr/local/bin/python3.9'</span></span><br><span class="line"></span><br><span class="line">alias <span class="keyword">python</span>=<span class="keyword">python3</span></span><br></pre></td></tr></table></figure>
<p>使设置生效：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<p>设置完后：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python -V</span></span><br><span class="line">Python 3.8.0</span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">which</span> python2</span></span><br><span class="line">python2: aliased to /usr/bin/python2.7</span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">which</span> python3</span></span><br><span class="line">python3: aliased to /Library/Frameworks/Python.framework/Versions/3.11/bin/python3.9</span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">which</span> python</span></span><br><span class="line">python: aliased to python3</span><br></pre></td></tr></table></figure>
<h3 id="切换python版本">切换Python版本</h3>
<p>修改.bashrc文件中的刚添加的最后一行<br>
修改 <code>alias python=python3</code> 或者改为<code>alias python=python2</code></p>
<p>使设置生效：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<h1 id="python包管理工具">python包管理工具</h1>
<h2 id="pip">pip</h2>
<p><code>pip</code> 是 Python 的官方包管理工具，用于安装和管理 Python 包。它允许用户从 <code>Python Package Index (PyPI)</code> 上安装第三方库，并可以通过简单的命令来更新和卸载已安装的包。</p>
<h2 id="pipenv">pipenv</h2>
<p><code>pipenv</code> 是一个基于 <code>pip</code> 的虚拟环境管理工具，它可以帮助开发者更方便地管理项目的依赖关系。<code>pipenv</code> 可以自动为每个项目创建一个独立的虚拟环境，并且可以自动跟踪项目所需的包及其版本。它还提供了一些方便的命令，如安装、卸载、更新依赖等。<br>
因此，<code>pipenv</code> 可以看作是 <code>pip</code> 的一个扩展，它在 <code>pip</code> 的基础上提供了更强大的功能和更方便的使用方式，用于更好地管理 Python 项目的依赖关系。</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=6Qmnh5C4Pmo&amp;t=1s" target="_blank" rel="noopener">Pipenv Crash Course - Youtube</a>
<ul>
<li><a href="https://pipenv.pypa.io/en/latest/" target="_blank" rel="noopener">Pipenv官方文档</a></li>
<li><a href="https://juejin.cn/post/6844904202737713160" target="_blank" rel="noopener">Python—pipenv精心整理教程</a>
<ul>
<li>安装pipenv <code>sudo pip install pipenv</code>注：无法用pip管理的包，pipenv同样无法使用。pipenv依赖：psutil, virtualenv-clone, pew, certifi, urllib3, chardet, requests, mccabe, pyflakes, pycodestyle, flake8等第三方模块。</li>
<li><code>pipenv shell</code>  生成<code>Pipfile</code>文件</li>
<li><code>pipenv install langchain</code> 即可生成<code>Pipfile.lock</code>文件</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="报错解决">报错解决</h1>
<h2 id="pip3-install-成功-import-requests仍找不到module-modulenotfounderror"><a href="https://liyuankun.top/pip3-install-%E6%88%90%E5%8A%9F-import-requests%E4%BB%8D%E6%89%BE%E4%B8%8D%E5%88%B0module-ModuleNotFoundError.html">pip3 install 成功- import requests仍找不到module:ModuleNotFoundError</a></h2>
<h2 id="命令行报错-command-cannot-found-pip">命令行报错 command cannot found pip</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pip install wakatime</span><br><span class="line"><span class="built_in">command</span> cannot found pip</span><br></pre></td></tr></table></figure>
<p>Maybe you have installed both python2 and python3. python3 may have been installed later.</p>
<p>You may try to use <code>pip3</code> instead of <code>pip</code>.</p>
<p>First, input the command:</p>
<p><code>pip3 -V</code><br>
If you see the version, the pip3 can be used.</p>
<p>In case you do</p>
<p><code>which pip</code><br>
and it doesn’t show the path, just do</p>
<p><code>which pip3</code><br>
This will print the path which is <code>/usr/local/bin/pip3</code></p>
<p>Then do open <code>~/.zshrc</code> or <code>nano ~/.bash_profile</code>.</p>
<p>Make alias for pip like:</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">alias pip=/usr/local/bin/pip3</span><br></pre></td></tr></table></figure>
<p>N.B: You copy that line above and paste in your <code>.zshrc</code> file.</p>
<p>After do <code>source ~/.zshrc</code> and close <code>.zshrc</code></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Language</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Command line</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Max size for HTTP POST servlet parameter content?</title>
    <url>/Max-size-for-HTTP-POST-servlet-parameter-content.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="problem">Problem</h1>
<p>Recently i meet a issue that when user import large file to send request by HTTP POST and servlet. The page redirect to welcome page.<br>
Then i debug it and find that web server do not get the right parameter from servlet.</p>
<h1 id="the-root-reason">The root reason:</h1>
<p>Web client send the request by HTTP POST and Servlet to web server.<br>
When the size of imported file (as parameter of request) is larger than the max size of Servlet parameter content, web server can not get the right parameter of the request. So it return to default welcome page.<br>
So the root reason is max size of Servlet parameter limit the request. We should reset the servlet setting in tomcat.</p>
<h1 id="the-workaround">The workaround:</h1>
<h2 id="1-for-jsp-and-tomcat-environment">1 For JSP and Tomcat environment</h2>
<h3 id="1-1-maxpostsize">1.1 maxPostSize</h3>
<table>
<thead>
<tr>
<th>Tomcat Version</th>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://tomcat.apache.org/tomcat-5.5-doc/config/http.html" target="_blank" rel="noopener">Before 7.0.63</a></td>
<td>maxPostSize</td>
<td>Teh maximum size in bytes of teh POST which will be handled by teh container FORM URL parameter parsing. Teh limit can be disabled by setting dis attribute to a value <em><strong>less than or equal to 0</strong></em>. If not specified, dis attribute is set to 2097152 (2 megabytes).</td>
</tr>
<tr>
<td><a href="https://tomcat.apache.org/tomcat-7.0-doc/config/http.html" target="_blank" rel="noopener">After and including 7.0.63</a></td>
<td>maxPostSize</td>
<td>Teh maximum size in bytes of teh POST which will be handled by teh container FORM URL parameter parsing. Teh limit can be disabled by setting this attribute to <em><strong>a value less than zero</strong></em>. If not specified, this attribute is set to 2097152 (2 megabytes). Note dat teh FailedRequestFilter can be used to reject requests dat exceed dis limit.</td>
</tr>
</tbody>
</table>
<p>You can also set maxPostSize=&quot;-1&quot; or value less than zero, it means that no limit for all versions of Tomcat.</p>
<h3 id="1-2-modify-maxpostsize-of-server-xml">1.2 Modify maxPostSize of server.xml</h3>
<p>Edit Tomcat’s server.xml which location is <strong><em>…/Your tomcat folder/conf/server.xml</em></strong>.<br>
In the <em>&lt;Connector</em> element, add an attribute <em>maxPostSize</em> and set a larger value (in bytes) to increase the limit.<br>
If there is timeout error, you should also add or increase the value of connectionTimeout.</p>
<h4 id="1-2-1-for-http">1.2.1 For http:</h4>
<p>We modify connector for port=“8080” in /Your tomcat folder/conf/server.xml<br>
For example:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">redirectPort</span>=<span class="string">"8443"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">maxPostSize</span>=<span class="string">"10000000"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">redirectPort</span>=<span class="string">"8443"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">maxPostSize</span>=<span class="string">"-1"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="1-2-2-for-https">1.2.2 For https:</h4>
<p>We should also modify connector for port=“8443” /Your tomcat folder/conf/server.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8443"</span> <span class="attr">protocol</span>=<span class="string">"org.apache.coyote.http11.Http11NioProtocol"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">maxPostSize</span>=<span class="string">"-1"</span> <span class="attr">maxThreads</span>=<span class="string">"150"</span> <span class="attr">SSLEnabled</span>=<span class="string">"true"</span> <span class="attr">scheme</span>=<span class="string">"https"</span> <span class="attr">secure</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">clientAuth</span>=<span class="string">"false"</span> <span class="attr">sslProtocol</span>=<span class="string">"TLS"</span> <span class="attr">keystoreFile</span>=<span class="string">"/opt/apache/tomcat/apache-tomcat-9.0.12/keystore"</span> <span class="attr">keystorePass</span>=<span class="string">"opsworkstomcat"</span> <span class="attr">server</span>=<span class="string">"Mxxxx"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>If you wonder why use port 8443 rather than 443, you can see my another blog: <a href="http://liyuankun.top/2019/06/11/Difference-between-HTTPS-Port-443-and-Port-8443/">Difference between HTTPS Port 443 and Port 8443</a> and <a href="http://liyuankun.top/2019/06/11/Changing-SSL-port-from-8443-to-443/">Changing SSL port from 8443 to 443</a></p>
<h2 id="2-for-asp-and-iis-environment">2 For ASP and IIS environment</h2>
<p>In order to accept larger files you have to change two sets of setting in you’re web.config.<br>
C:\Program Files (x86)\yourcompanydomain\Web ASPx\web.config or Your ASP Folder\web.config</p>
<h3 id="2-1-iis-setting-request-limits">2.1 IIS Setting: Request Limits</h3>
<p>The following sets the max POST buffer size to 500 megs. The value is specified in bytes.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">security</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">requestFiltering</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">requestLimits</span> <span class="attr">maxAllowedContentLength</span>=<span class="string">"500000000"</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">requestFiltering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">security</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-2-asp-net-setting-httpruntime-maxrequestlength">2.2 <a href="http://ASP.NET" target="_blank" rel="noopener">ASP.NET</a> Setting: httpRuntime maxRequestLength</h3>
<p><a href="http://ASP.NET" target="_blank" rel="noopener">ASP.NET</a> uses the httpRuntime element to control a number of runtime related features including teh allowed inbound request length. Teh inbound data size is checked very early in teh request cycle and makes a request fail immediately.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.web</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">httpRuntime</span> <span class="attr">maxRequestLength</span>=<span class="string">"500000000"</span>  <span class="attr">executionTimeout</span>=<span class="string">"120"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">system.web</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-what-about-web-connection">2.3 What about Web Connection?</h3>
<p>Starting with Web Connection 6.0 teh .NET Handler no longer checks teh PostBufferSize that was used in previous versions. This value is now deferred in favor of the values above.<br>
Teh ISAPI module still has a PostBufferLimit setting in wc.ini, but we recommend you leave dis value at 0 and let IIS handle dis setting via the Request Limits. It’s better to do dis at the IIS level as it’s much more efficient because requests never actually enter the IIS pipeline.</p>
<h2 id="3-other-：modify-max-file-size-and-max-request-size-of-web-xml-in-linux">3 Other ：Modify max-file-size and max-request-size of web.xml in Linux</h2>
<p>On Amazon EC2 Linux instances, the only file that needs to be modified from the default installation of Tomcat (sudo yum install tomcat) is:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/share/tomcat7/webapps/manager/WEB-INF/web.xml</span><br></pre></td></tr></table></figure>
<p>their are only two values that need to be modified (max-file-size and max-request-size):</p>
<p>By default, the maximum upload size is exactly 50MB:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">multipart-config</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 50MB max --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">max-file-size</span>&gt;</span>52428800<span class="tag">&lt;/<span class="name">max-file-size</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">max-request-size</span>&gt;</span>52428800<span class="tag">&lt;/<span class="name">max-request-size</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">file-size-threshold</span>&gt;</span>0<span class="tag">&lt;/<span class="name">file-size-threshold</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">multipart-config</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Their are only two values that need to be modified (max-file-size and max-request-size):</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">multipart-config</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 100MB max --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">max-file-size</span>&gt;</span>104857600<span class="tag">&lt;/<span class="name">max-file-size</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">max-request-size</span>&gt;</span>104857600<span class="tag">&lt;/<span class="name">max-request-size</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">file-size-threshold</span>&gt;</span>0<span class="tag">&lt;/<span class="name">file-size-threshold</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">multipart-config</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="reference-links">Reference Links:</h1>
<p><a href="https://stackoverflow.com/questions/2943477/is-there-a-max-size-for-post-parameter-content" target="_blank" rel="noopener">Is there a max size for POST parameter content?</a></p>
<p><a href="https://webconnection.west-wind.com/docs/_4lp0zgm9d.htm#aspnet-setting-httpruntime-maxrequestlength" target="_blank" rel="noopener">Setting IIS and ASP.NET POST Size Request Limits</a></p>
<p><a href="https://blog.csdn.net/erlian1992/article/details/80209947" target="_blank" rel="noopener">关于Tomcat的maxPostSize属性的配置需要注意的问题</a></p>
<p><a href="https://stackoverflow.com/questions/2947683/httprequest-maximum-allowable-size-in-tomcat" target="_blank" rel="noopener">HttpRequest maximum allowable size in tomcat?</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Network</category>
        <category>Servlet/HTTP</category>
      </categories>
      <tags>
        <tag>Tomcat</tag>
        <tag>Servlet</tag>
        <tag>maxPostSize</tag>
      </tags>
  </entry>
  <entry>
    <title>Mac风扇不转or狂转不停？用smcFanControl手动控制风扇速度</title>
    <url>/Mac%E9%A3%8E%E6%89%87%E4%B8%8D%E8%BD%ACor%E7%8B%82%E8%BD%AC%E4%B8%8D%E5%81%9C%EF%BC%9F%E7%94%A8smcFanControl%E6%89%8B%E5%8A%A8%E6%8E%A7%E5%88%B6%E9%A3%8E%E6%89%87%E9%80%9F%E5%BA%A6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="起因">起因</h1>
<p>气死我了，最近我Mac Pro不知道怎么了，整个电脑没用两天就热的卡的不行。<br>
都濒临死机状态了，风扇也没怎么转。<br>
我本来都以为我电脑风扇坏了，这可怎么办，波兰这儿还是疫情期间，没法修啊，嘤嘤嘤。<br>
在网上搜了搜，就发现了smcfancontrol这个软件，可以自己控制电脑的风扇速度。<br>
心想，那就试试吧，反正是<strong>免费</strong>软件。<br>
一试，提高风扇转速，有用啊！我终于听到风扇的声音了！<br>
喜大普奔！不是风扇坏了。<br>
电脑凉爽多了！！！<br>
这么好用，顺便安利给大家。<br>
这个软件同样可以解决风扇狂转不止的问题。</p>
<h1 id="smcfancontrol-v2-6-下载地址">smcfancontrol V2.6 下载地址</h1>
<ul>
<li>
<p>smcfancontrol V2.6 <a href="http://www.macupdate.com/info.php/id/23049" target="_blank" rel="noopener">下载地址1</a>.</p>
</li>
<li>
<p>smcfancontrol V2.6 <a href="https://github.com/hholtmann/smcFanControl/releases/download/2.6.1%C3%9F1/smcFanControl_2_6_1.zip" target="_blank" rel="noopener">下载地址2</a></p>
</li>
<li>
<p>smcfancontrol V2.6 下载地址3：链接:<a href="https://pan.baidu.com/s/1AKkGjJxMeuXNzuvIAHqs2w" target="_blank" rel="noopener">https://pan.baidu.com/s/1AKkGjJxMeuXNzuvIAHqs2w</a>  密码:nmxq</p>
</li>
</ul>
<h1 id="smcfancontrol-介绍">smcfancontrol 介绍</h1>
<p>smcFanControl控制每台Intel Mac的风扇，使其运行温度更低。<br>
smcFanControl允许用户设置内置风扇的最低速度。因此，您可以提高最低风扇速度，以使Mac运行温度更低。但是，为了不损坏计算机，smcFanControl不允许您将最低速度设置为低于Apple默认值的值。</p>
<h2 id="smcfancontrol-的新功能">smcFanControl 的新功能</h2>
<p>2.6版：注意：现在需要OS X 10.7或更高版本</p>
<p>新功能：</p>
<ul>
<li>添加了法语本地化</li>
<li>更新了Sparkle Updater</li>
<li>smcFanControl现在需要macOS 10.7或更高版本</li>
</ul>
<p>已解决：</p>
<ul>
<li>Macbook 12&quot;崩溃问题。</li>
<li>在macOS Sierra上的Dark模式下“看不见文本”。</li>
</ul>
<p>免费：<br>
基础功能都是免费的，我觉得够用了。良心软件啊！</p>
<p>会员版：</p>
<ul>
<li>解锁个性化应用推荐</li>
<li>获得会员独享的折扣</li>
<li>轻松跟踪您的下载和购买历史记录</li>
<li>开始为最大的Mac社区做出贡献</li>
</ul>
<p>YouTube英文版使用视频：<br>
不想看英文的可以看我后面的图文介绍。</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Fco5F5EPwUo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2 id="smcfancontrol-安装">smcFanControl 安装</h2>
<p>下载完后解压,复制smcFanControl.app到应用程序：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Mac%E9%A3%8E%E6%89%87%E4%B8%8D%E8%BD%ACor%E7%8B%82%E8%BD%AC%E4%B8%8D%E5%81%9C%EF%BC%9F%E7%94%A8smcFanControl%E6%89%8B%E5%8A%A8%E6%8E%A7%E5%88%B6%E9%A3%8E%E6%89%87%E9%80%9F%E5%BA%A6/%E5%A4%8D%E5%88%B6%E5%88%B0%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F.gif" alt="安装"></p>
<p>双击smcFanControl.app打开，出现alert直接点击continue：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Mac%E9%A3%8E%E6%89%87%E4%B8%8D%E8%BD%ACor%E7%8B%82%E8%BD%AC%E4%B8%8D%E5%81%9C%EF%BC%9F%E7%94%A8smcFanControl%E6%89%8B%E5%8A%A8%E6%8E%A7%E5%88%B6%E9%A3%8E%E6%89%87%E9%80%9F%E5%BA%A6/smcfancontrol-alert.jpg" alt="alert"></p>
<p>使用：<br>
打开后，会在状态栏上显示 smcFanControl 目前设备温度和转速，也许刚打开时候 rpm 显示错误，重开一次 smcFanControl 即可，可先点「Preferences」进行设置。<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Mac%E9%A3%8E%E6%89%87%E4%B8%8D%E8%BD%ACor%E7%8B%82%E8%BD%AC%E4%B8%8D%E5%81%9C%EF%BC%9F%E7%94%A8smcFanControl%E6%89%8B%E5%8A%A8%E6%8E%A7%E5%88%B6%E9%A3%8E%E6%89%87%E9%80%9F%E5%BA%A6/%E7%8A%B6%E6%80%81%E6%A0%8F.png" alt="状态栏"></p>
<p>默认软件里面会有两组预设设定，分别为 Default 、 Higher RPM（高转速） 两个选项，如果想自定义转速，也可以通过右侧「+」新增。<br>
如要自定义名称可自己输入，比如「低速」、「高速」、等，设定完后点击「Save」储存。<br>
可以通过min.Speed 拉杆手动调整风扇转速，往左调整速度越慢，往右调整速度越快，相对越快风扇就会越大声，底下Menubar也可以选择数字颜色，至于下面选项则可参考底下翻译：</p>
<ul>
<li>Check for updates on startup：启动时检查更新</li>
<li>Autostart smcFanControl after login：开机后自动开启smcFanControl</li>
<li>Autoapply favorite when powersource changes：连接电源线自动切换风扇频率</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Mac%E9%A3%8E%E6%89%87%E4%B8%8D%E8%BD%ACor%E7%8B%82%E8%BD%AC%E4%B8%8D%E5%81%9C%EF%BC%9F%E7%94%A8smcFanControl%E6%89%8B%E5%8A%A8%E6%8E%A7%E5%88%B6%E9%A3%8E%E6%89%87%E9%80%9F%E5%BA%A6/Preferences.gif" alt="使用"></p>
<p>通常使用方式只要从 Active Setting 内选择你想使用的模式，过一会风扇就会调整。通常我是用来降温用，如发现 MacBook Pro 温度高过于50°就可以启动smcFanControl来增强风扇转速，提升散热效果。<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Mac%E9%A3%8E%E6%89%87%E4%B8%8D%E8%BD%ACor%E7%8B%82%E8%BD%AC%E4%B8%8D%E5%81%9C%EF%BC%9F%E7%94%A8smcFanControl%E6%89%8B%E5%8A%A8%E6%8E%A7%E5%88%B6%E9%A3%8E%E6%89%87%E9%80%9F%E5%BA%A6/active%20setting.png" alt="Active Setting"></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>Mac安装软件时提示已损坏的解决方法</title>
    <url>/Mac%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E6%97%B6%E6%8F%90%E7%A4%BA%E5%B7%B2%E6%8D%9F%E5%9D%8F%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Mac安装软件时提示已损坏的解决方法</p>
<p>最新Catalina报错问题汇总<br>
提示程序含有恶意代码或者已经打开所有来源还是提示扔到垃圾桶<br>
在终端输入 xattr -r -d com.apple.quarantine 加上程序的App绝对路径，App建议直接拖放到终端，会自动填写路径<br>
如这样：xattr -r -d com.apple.quarantine /Applications/QQ.app</p>
<p>常规报错解决方案一<br>
2019年7月10号开始，很多TNT破解软件大面积报错，原因不多说，讲一下具体的解决方案<br>
步骤一：<br>
安装xcode，这个在商店里面有，不想安装的，按步骤二来。<br>
步骤二：<br>
安装Command Line Tool 工具<br>
打开终端输入以下命令<br>
xcode-select --install （install前面为两个短横线）<br>
步骤三：<br>
终端继续输入以下命令<br>
codesign --force --deep --sign - （force、deep、sign前面为两个短横线）<br>
然后拖入需要签名的软件，最后类似于这样<br>
codesign --force --deep --sign - /Applications/name.app （/Applications前面有一个空格）<br>
回车搞定</p>
<p>常规报错解决方案二<br>
不想知道原理和偷懒的，安装软件，直接给报错程序签名。<br>
 免费下载 高速下载  荔枝正版</p>
<p>常规报错解决方案三<br>
从本站下载的Sketch、Principle等设计软件，以及输入法等常用软件，安装时总是提示“已损坏，移至废纸篓”这类信息，根本无法打开。如下图：</p>
<p>其实，这是新系统（macOS Sierra 10.12.X）惹的祸。新系统加强了安全机制，默认不允许用户自行下载安装应用程序，只能从Mac App Store里安装应用。<br>
解决方法<br>
步骤一：打开终端</p>
<p>步骤二：输入代码：sudo spctl --master-disable（master前面为两个短横线，看下面的截图）</p>
<p>注意红框处应有空格<br>
步骤三：按回车输入自己电脑密码，再次回车（密码不会显示出来，放心输就好）</p>
<p>不显示密码，输完按回车<br>
步骤四：打开系统偏好设置 » 安全性与隐私，若显示任何来源，大功告成；若没有此选项，一定是你前面的步骤不对</p>
<p>回到桌面双击安装文件，发现都可以打开啦，尽情享受Mac带给你的乐趣吧！</p>
<p>常规报错解决方案四<br>
32位程序不兼容，报类似以下的错误</p>
<p>终端输入<br>
defaults write -g CSUIDisable32BitWarning -boolean TRUE</p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>MAC</tag>
        <tag>TODO</tag>
      </tags>
  </entry>
  <entry>
    <title>OpenJS Node.js Application Developer (JSNAD)专业认证考试</title>
    <url>/OpenJS-Node-js-Application-Developer-JSNAD-%E4%B8%93%E4%B8%9A%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="考试">考试</h2>
<h3 id="考试内容">考试内容</h3>
<ul>
<li>
<p><a href="https://training.linuxfoundation.org/certification/jsnad/" target="_blank" rel="noopener">JSNAD</a><br>
全称是 <code>OpenJS Node.js Application Developer certification</code> ，即 OpenJS Node.js 应用开发者证书。设计初衷是，能够让任何人通过此证书，来证明自己有能力使用 Node.js 来创建任何类型的应用，其关注的重点是对 Node.js 核心 API 的掌握程度。</p>
</li>
<li>
<p><a href="https://training.linuxfoundation.org/certification/jsnsd/" target="_blank" rel="noopener">JSNSD</a><br>
全称是 <code>OpenJS Node.js Services Developer certification</code> ，即 OpenJS Node.js 服务开发者证书。设计初衷是，能够让任何人通过此证书，来证明自己能够创建 RESTful Node.js 服务器及服务（或微服务），且着重考察安全实践。</p>
</li>
<li>
<p>证书有效期</p>
<ul>
<li>证书有效期均为3年，如果到期了，需要再考。考试通过可以续签证书。重考必须在证书过期之前参加。续签的证书有效期同样是3年。</li>
</ul>
</li>
</ul>
<p>该考试是一项基于性能的在线、托管式测试，需要在远程桌面 Linux 环境中实施多种解决方案。在此环境中，Visual Studio Code 和 Vim 均作为编辑器包含在内。</p>
<p>本次考试含有模拟在职场景的项目，考生有<code>两个小时</code>的时间来完成测试。</p>
<h3 id="课程">课程</h3>
<p><a href="https://docs.linuxfoundation.org/tc-docs/certification/faq-openjs#is-there-training-to-prepare-for-the-certification-exam" target="_blank" rel="noopener">Is there training to prepare for the certification exam?</a></p>
<p>JSNAD:<br>
The Linux Foundation offers The Node.js Application Development (LFW211) a self-paced E-Learning course to improve your versatility in creating various types of Node.js applications. Covering a broad set of use cases and using Node.js core APIs with selected ecosystem libraries, this course prepares you for JSNAD Certification Exam.<br>
The following resources are considered Recommended Reading  for the JSNAD Exam:</p>
<ul>
<li>Node.js 18.x.Documentation, <a href="https://nodejs.org/dist/latest-v18.x/docs/api/" target="_blank" rel="noopener">https://nodejs.org/dist/latest-v18.x/docs/api/</a></li>
<li>Node Cookbook, 3rd Edition, Chapters 1, 2, 3, 4 and 9</li>
<li><a href="https://nodeschool.io/" target="_blank" rel="noopener">https://nodeschool.io/</a></li>
<li><a href="https://openjsf.org/blog/2022/04/29/using-abortsignal-in-node-js/" target="_blank" rel="noopener">https://openjsf.org/blog/2022/04/29/using-abortsignal-in-node-js/</a></li>
</ul>
<p>git上LFW211练习题：<a href="https://github.com/rodmoreno/lfw212" target="_blank" rel="noopener">https://github.com/rodmoreno/lfw212</a><br>
git上JSNAD主题： <a href="https://github.com/topics/jsnad" target="_blank" rel="noopener">https://github.com/topics/jsnad</a></p>
<p>JSNSD:<br>
The Linux Foundation offers Node.js Services Development (LFW212) a self-paced E-Learning course that provides a deep dive into Node core HTTP clients and servers, web servers, RESTful services and web security essentials.<br>
With a major focus on Node.js services and security this content is an essential counterpart to the Node.js Application Development (LFW211) course, and will prepare you for the OpenJS Node.js Services Developer (JSNSD) exam.<br>
The following resources are considered Recommended Reading for the JSNSD Exam:</p>
<ul>
<li>Node.js 18.x Documentation,  <a href="https://nodejs.org/dist/latest-v18.x/docs/api/" target="_blank" rel="noopener">https://nodejs.org/dist/latest-v18.x/docs/api/</a></li>
<li>Node Cookbook, 3rd Edition, Chapters 5, 7, 8, 10</li>
<li>Documentation of any preferred web frameworks</li>
<li><a href="https://nodeschool.io/" target="_blank" rel="noopener">https://nodeschool.io/</a></li>
</ul>
<p>Linux基金会提供了 <a href="https://training.linuxfoundation.org/training/nodejs-application-development-lfw211/" target="_blank" rel="noopener">Node.js Application Development （LFW211）</a>和 <a href="https://training.linuxfoundation.org/training/node-js-services-development-lfw212/" target="_blank" rel="noopener">Node.js Services Development （LFW212）</a>课程。可以在线进行学习。</p>
<p>JSNAD是JSNSD的基础。可以先考JSNAD，然后再考JSNSD。</p>
<p>The Candidate Handbook and the <a href="https://docs.linuxfoundation.org/tc-docs/certification/instructions-openjs" target="_blank" rel="noopener">Important Instructions: JSNAD and JSNSD</a> are two important documents I recommend you to read carefully.<br>
另外，官方还提到了 <code>Node Cookbook, 3rd Edition,</code> 一书。 JSNAD对应书中的第1，2，3，4，9章的内容。JSNSD则对应了书中的第5，7，8，10章的内容。</p>
<h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://github.com/topics/jsnad" target="_blank" rel="noopener">Git topic jsnad</a></li>
<li><a href="https://abba.dev/blog/jsnsd-exam" target="_blank" rel="noopener">Taking the JSNSD exam (OpenJS Node.js Services Developer Certification) - Review and Tips</a>
<ul>
<li>I wanted to check my preparation so I got real exam scenario type questions and practice test from <a href="https://www.study4exam.com/linux-foundation/jsnsd" target="_blank" rel="noopener">https://www.study4exam.com/linux-foundation/jsnsd</a> That helped me a lot make my JSNSD exam prep perfect and I passed the exam successfully.</li>
</ul>
</li>
<li><a href="https://www.nodecertification.com/" target="_blank" rel="noopener">Node.js Certification Study Guide by Hey</a></li>
<li><a href="https://javascript.plainenglish.io/taking-the-openjs-node-js-application-developer-certification-4081681bdfc4" target="_blank" rel="noopener">OpenJS Node.js Application Developer Certification: All You Need to Know</a></li>
</ul>
<table>
<thead>
<tr>
<th>名称</th>
<th>类别（草本/灌木/乔木）</th>
<th>科</th>
<th>属</th>
<th>阳光</th>
<th>需要日照时长</th>
<th>水</th>
<th>耐旱性</th>
<th>肥</th>
<th>适宜温度范围</th>
<th>通风</th>
<th>多年生/一年生</th>
<th>酸碱性</th>
<th>花期</th>
<th>土壤</th>
<th>种植时间</th>
<th>播种/扦插</th>
<th>换盆</th>
<th>气味</th>
<th>病虫害</th>
<th>修剪时间和方法</th>
<th>适宜阳台/露天/地栽</th>
</tr>
</thead>
<tbody>
<tr>
<td>茶花</td>
<td>灌木</td>
<td>山茶科</td>
<td>山茶属</td>
<td>阳光充足</td>
<td>约4-6小时</td>
<td>中等湿度</td>
<td>耐旱</td>
<td>春季施肥一次即可</td>
<td>5-28摄氏度</td>
<td>通风良好</td>
<td>多年生</td>
<td>酸性或微酸性</td>
<td>秋季或冬季</td>
<td>疏松肥沃、排水良好的酸性土壤</td>
<td>春季或秋季</td>
<td>插枝繁殖或嫁接</td>
<td>大盆不用换盆</td>
<td>芳香</td>
<td>叶螨、白粉虱、红蜘蛛</td>
<td>花落之后</td>
<td>阳台或露天</td>
</tr>
<tr>
<td>绣球</td>
<td>灌木</td>
<td>绣球科</td>
<td>绣球属</td>
<td>充足或半阴</td>
<td>约4-6小时</td>
<td>中等湿度</td>
<td>耐旱</td>
<td>生长期定期施肥</td>
<td>15-25摄氏度</td>
<td>通风良好</td>
<td>多年生</td>
<td>略微酸性或中性</td>
<td>夏季至秋季</td>
<td>疏松肥沃、排水良好的壤土</td>
<td>春季或秋季</td>
<td>插枝繁殖或扦插</td>
<td>2-3年换盆一次</td>
<td>芳香</td>
<td>霜霉病、白粉虱、蚜虫</td>
<td>花落之后</td>
<td>阳台或露天</td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>node.js</category>
      </categories>
      <tags>
        <tag>node.js</tag>
      </tags>
  </entry>
  <entry>
    <title>Minikube安装-MacOS M1</title>
    <url>/Minikube%E5%AE%89%E8%A3%85-MacOS-M1.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="minikube-是什么">Minikube 是什么</h1>
<p><a href="https://github.com/kubernetes/minikube" target="_blank" rel="noopener">Minikube Git</a></p>
<blockquote>
<p>Minikube是一个可以快速构建一个单节点本地运行Kubernetes环境的一个工具，它专注于让快速创建本地Kubernetes环境，用于学习和开发。<br>
抛去多集群有关的特性，Minukube构建的单节点集群，足以使用户探索和发现Kubernate的绝大多数主要功能。</p>
<p>如果你使用的是minikube, 注意, 你面对的minikube就是一个集群, 它有自己的IP, 可以采用<code>minikube ip</code>进行访问, 也就意味着minikube就是一个服务器, 那就是它的公网IP.<br>
Minikube 只能通过 <code>NodePort</code> 公开服务。<code>EXTERNAL-IP</code> 始终处于挂起状态</p>
</blockquote>
<h1 id="minikube-安装">Minikube 安装</h1>
<p>参考<a href="https://minikube.sigs.k8s.io/docs/start/" target="_blank" rel="noopener">Minikube 官方Installation文档</a></p>
<p>Minikube支持安装在OSX， Windows， Linux.</p>
<p>本篇文章是按照安装MacOS来写的，其他操作系统请参考：</p>
<ul>
<li><a href="https://www.zhaowenyu.com/minikube-doc/install/minikube-install-linux.html" target="_blank" rel="noopener">Minikube Linux 系统安装</a></li>
<li><a href="https://www.zhaowenyu.com/minikube-doc/install/minikube-install-windows.html" target="_blank" rel="noopener">Minikube Windows 系统安装</a></li>
</ul>
<h2 id="安装minikube">安装Minikube</h2>
<h3 id="通过homebrew安装在本地mac上">通过Homebrew安装在本地mac上</h3>
<p>最简单的安装方式Homebrew， 如果系统没有安装brew工具请参考<a href="./%E7%A8%8B%E5%BA%8F%E5%91%98-MAC-%E9%87%8D%E6%96%B0%E8%A3%85%E6%9C%BA%E5%BF%85%E5%A4%872%E5%91%BD%E4%BB%A4%E8%A1%8C-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.html#%E5%AE%89%E8%A3%85homebrew">之前的文章</a>。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install minikube</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看minikube</span></span><br><span class="line"><span class="built_in">which</span> minikube</span><br></pre></td></tr></table></figure>
<h3 id="通过git安装">通过<a href="https://www.zhaowenyu.com/minikube-doc/install/minikube-install-macos.html" target="_blank" rel="noopener">Git安装</a></h3>
<h2 id="安装docker">安装docker</h2>
<p>目前看只有<a href="https://docs.docker.com/desktop/install/mac-install/" target="_blank" rel="noopener">Docker Desktop for Mac (macOS)</a>可以下载.</p>
<h2 id="安装-kubectl-k8s的cli工具">安装 kubectl(K8s的CLI工具)</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install kubectl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看版本</span></span><br><span class="line">kubectl version --client</span><br></pre></td></tr></table></figure>
<h2 id="安装虚拟机管理器">安装虚拟机管理器</h2>
<h3 id="安装hyperkit-适合x86-64机器">安装<a href="https://minikube.sigs.k8s.io/docs/drivers/hyperkit/" target="_blank" rel="noopener">hyperkit</a> (适合x86_64机器)</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install hyperkit</span><br><span class="line"></span><br><span class="line"><span class="comment"># To check your current version, run: </span></span><br><span class="line">hyperkit -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># If the version didn’t change after upgrading verify the correct HyperKit is in the path. run: </span></span><br><span class="line"><span class="built_in">which</span> hyperkit</span><br><span class="line"></span><br><span class="line"><span class="comment">#Run to make sure the version matches minikube</span></span><br><span class="line">docker-machine-driver-hyperkit version</span><br></pre></td></tr></table></figure>
<h4 id="问题：mac-m1-hyperkit-not-supported">问题：Mac M1: hyperkit not supported</h4>
<p>如果在Mac M1上<code>brew install hyperkit</code>, 报错</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install hyperkit</span><br><span class="line"></span><br><span class="line">hyperkit: The x86_64 architecture is required <span class="keyword">for</span> this software.</span><br><span class="line">Error: hyperkit: An unsatisfied requirement failed this build.</span><br></pre></td></tr></table></figure>
<p>解决方法：</p>
<h3 id="安装qemu-兼容mac-m1">安装qemu (兼容MAC M1)</h3>
<ul>
<li><a href="https://github.com/kubernetes/minikube/issues/11885" target="_blank" rel="noopener">Mac M1: hyperkit not supported</a>
<ul>
<li>HyperKit is Intel-only, so the alternative to QEMU will be the new Virtualization.framework driver
<ul>
<li><code>brew install qemu</code></li>
<li><code>minikube start --driver=qemu --memory=4Gb</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="运行minikube">运行Minikube</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">minikube start --driver=hyperkit</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Mac M1</span></span><br><span class="line">minikube start --driver=qemu</span><br></pre></td></tr></table></figure>
<p>如果没有VPN，为了解决海外资源访问受限问题，可以使用阿里云提供的镜像地址。具体命令如下：</p>
<p>$ minikube start<br>
–cpus=4<br>
–memory=‘6000mb’<br>
–image-mirror-country=‘cn’<br>
–image-repository='<a href="http://registry.cn-hangzhou.aliyuncs.com/google_containers" target="_blank" rel="noopener">registry.cn-hangzhou.aliyuncs.com/google_containers</a>’<br>
命令参数说明如下：</p>
<p>–cpus=4：表示为minikube分配的CPU核数；<br>
–memory=‘6000mb’：表示为minikube虚拟机分配的内存数；<br>
–image-mirror-country=‘cn’：将缺省利用&quot;<a href="http://registry.cn-hangzhou.aliyuncs.com/google_containers" target="_blank" rel="noopener">registry.cn-hangzhou.aliyuncs.com/google_containers</a>&quot;作为安装Kubernetes的容器镜像仓库；<br>
–image-repository=“xx”：表示所使用的镜像仓库地址，这里为阿里云地址；</p>
<h1 id="minikube使用">Minikube使用</h1>
<h2 id="testing-minikube">Testing Minikube</h2>
<ul>
<li><code>minikube status</code>: shows current status</li>
<li><code>kubectl get all</code>: verifies kubectl client operation</li>
<li><code>minikube start</code>: starts Minikube</li>
<li><code>minikube stop</code>: stops Minikube</li>
<li><code>minikube ssh</code>: logs in to the Minikube host</li>
<li><code>docker ps</code>: shows all Docker processes on the Minikube host</li>
</ul>
<h2 id="managing-minikube">Managing Minikube</h2>
<p>The <strong>minikube</strong> command has different options</p>
<ul>
<li><code>minikube dashboard</code>: opens the K8s dashboard in the local browser</li>
<li><code>minikube delete</code>: deletes a cluster</li>
<li><code>minikube ip</code>: shows the currently used IP address</li>
<li><code>minikube start</code>: starts a cluster</li>
<li><code>minikube stop</code>: stops a cluster</li>
<li><code>minikube status</code>: gives current status</li>
<li><code>minikube version</code>: shows current version</li>
</ul>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://www.jianshu.com/p/92034019d7d6" target="_blank" rel="noopener">从零开始Minikube MAC</a></li>
<li><a href="https://blog.csdn.net/Apple_wolf/article/details/125360717" target="_blank" rel="noopener">解决老版本MacOS安装问题-Mac OS 安装minikube</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/112755080" target="_blank" rel="noopener">推荐一款Kubernetes神器“minikube”</a></li>
<li><a href="https://kubernetes.io/zh-cn/docs/tutorials/hello-minikube/" target="_blank" rel="noopener">k8s官方文档-Minikube</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>Node.js 知识索引</title>
    <url>/Node-js-%E7%9F%A5%E8%AF%86%E7%B4%A2%E5%BC%95.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="node-api"><a href="https://nodejs.github.io/node-addon-examples/about/what/" target="_blank" rel="noopener">Node-API</a></h2>
<h2 id="package-json">package.json</h2>
<ul>
<li><a href="https://www.ruanyifeng.com/blog/2016/10/npm_scripts.html" target="_blank" rel="noopener">阮一峰 npm_scripts</a></li>
<li><a href="./Difference-between-dependencies-devDependencies-and-peerDependencies.html">Difference between dependencies, devDependencies and peerDependencies</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>node.js</category>
      </categories>
      <tags>
        <tag>node.js</tag>
      </tags>
  </entry>
  <entry>
    <title>React 16 - DOM Attributes</title>
    <url>/React-16-DOM-Attributes.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>React</category>
      </categories>
      <tags>
        <tag>React 16</tag>
      </tags>
  </entry>
  <entry>
    <title>React 16 - Hooks</title>
    <url>/React-16-Hooks.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="hooks-faq">Hooks FAQ</h1>
<p>觉得<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html" target="_blank" rel="noopener">Hooks FAQ</a>里面回答了很多很实际的疑问。</p>
<h2 id="生命周期方法要如何对应到-hook？">生命周期方法要如何对应到 Hook？</h2>
<ul>
<li>
<p>constructor：函数组件不需要构造函数。你可以通过调用 <code>useState</code> 来初始化 state。如果计算的代价比较昂贵，你可以传一个函数给 <code>useState</code>。</p>
</li>
<li>
<p><code>getDerivedStateFromProps</code>：改为 在渲染时 安排一次更新。</p>
</li>
<li>
<p><code>shouldComponentUpdate</code>：详见 下方 React.memo.</p>
</li>
<li>
<p>render：这是函数组件体本身。</p>
</li>
<li>
<p><code>componentDidMount</code>, <code>componentDidUpdate</code>, <code>componentWillUnmount</code>：<code>useEffect</code> Hook 可以表达所有这些(包括 不那么 常见 的场景)的组合。</p>
</li>
<li>
<p><code>componentDidCatch</code> and <code>getDerivedStateFromError</code>：目前还没有这些方法的 Hook 等价写法，但很快会加上。</p>
</li>
</ul>
<h3 id="on-mounting-componentdidmount">On Mounting (componentDidMount)</h3>
<p>生命周期方法 <code>componentDidMount</code> 会在第一次render完成后立即调用。以前有一个 componentWillMount 会在第一次render之前调用，但它被认为是传统方法，不建议在较新版本的 React 中使用。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> FunctionalComponent = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"> React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"Hello"</span>);</span><br><span class="line"> &#125;, []); <span class="comment">// [] 作为依赖数组，与componentDidMount等效，会在第一次render完成后立即调用</span></span><br><span class="line"> <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>取代 <code>componentDidMount</code>，我们使用第二个参数为 <code>[]</code> 的 <code>useEffect</code> hook。 <code>useState</code> hook的第二个参数通常是一个包含变化状态的数组，而 <code>useEffect</code> 只会在这些选定的变化中被调用。但如果是像本例这样的空数组，则会在挂载时调用一次。这可以完美替代 <code>componentDidMount</code>。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"> componentDidMount() &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"Hello"</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> render() &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里发生的事情基本上是一样的：<code>componentDidMount</code> 是一个生命周期方法，在第一次render后会被调用一次。</p>
<h3 id="on-unmounting-componentwillunmount">On Unmounting (componentWillUnmount)</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"> componentWillUnmount() &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"Bye"</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> render() &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Bye, World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> FunctionalComponent = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"> React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;       <span class="comment">// 返回一个函数</span></span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">"Bye"</span>);</span><br><span class="line">   &#125;;</span><br><span class="line"> &#125;, []);</span><br><span class="line"> <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Bye, World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>好消息是，我们也可以使用 <code>useState</code> 钩子来卸载。但要注意，语法有些不同。你需要做的是在 <code>useEffect</code> 函数中返回一个在卸载时运行的<code>函数</code>。这在需要清理订阅（如 <code>clearInterval</code> 函数）时尤其有用，否则会在较大的项目中造成严重的内存泄漏。使用 useEffect 的一个好处是，我们可以在同一个地方编写挂载和卸载函数。例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Function to be called when the component mounts</span></span><br><span class="line">  <span class="keyword">const</span> handleEvent = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Event occurred:'</span>, event);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 挂载 Add event listener when the component mounts</span></span><br><span class="line">  <span class="built_in">window</span>.addEventListener(<span class="string">'yourEventType'</span>, handleEvent);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 卸载 Clean up the event listener when the component unmounts</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">'yourEventType'</span>, handleEvent);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, []); <span class="comment">// Empty dependency array means this effect runs only once (on mount)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// custom hook</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useDelayedRender = <span class="function">(<span class="params">delayTime: number</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [shouldRender, setShouldRender] = useState(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> timeoutId = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 挂载 </span></span><br><span class="line">      setShouldRender(<span class="literal">true</span>)</span><br><span class="line">    &#125;, delayTime)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearTimeout(timeoutId) <span class="comment">// 卸载</span></span><br><span class="line">  &#125;, [delayTime])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> shouldRender</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Function to be called at intervals</span></span><br><span class="line">  <span class="keyword">const</span> updateValue = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    setValue(<span class="function">(<span class="params">prevValue</span>) =&gt;</span> prevValue + <span class="number">1</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 挂载 Set an interval when the component mounts</span></span><br><span class="line">  <span class="keyword">const</span> intervalId = setInterval(updateValue, <span class="number">1000</span>); <span class="comment">// Replace 1000 with your desired interval in milliseconds</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Clean up the interval when the component unmounts</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    clearInterval(intervalId); <span class="comment">// 卸载</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, []); <span class="comment">// Empty dependency array means this effect runs only once (on mount)</span></span><br></pre></td></tr></table></figure>
<h2 id="我该如何使用-hook-进行数据获取？">我该如何使用 Hook 进行数据获取？</h2>
<p>该 <a href="https://codesandbox.io/s/jvvkoo8pq3" target="_blank" rel="noopener">demo</a> 会帮助你开始理解。欲了解更多，请查阅 <a href="https://www.robinwieruch.de/react-hooks-fetch-data" target="_blank" rel="noopener">react-hooks-fetch-data</a> 来了解如何使用 Hook 进行数据获取。</p>
<h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://react.docschina.org/docs/portals.html" target="_blank" rel="noopener">新一代 React API — React Hooks React Conf 2018 React Today and Tomorrow 重點回顧</a></li>
<li><a href="https://reactjs.org/docs/hooks-intro.html" target="_blank" rel="noopener">官方文档英文版：hooks-intro</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-intro.html" target="_blank" rel="noopener">官方文档中文版：hooks</a></li>
<li><a href="https://upmostly.com/tutorials/settimeout-in-react-components-using-hooks" target="_blank" rel="noopener">setTimeout in React Components Using Hooks</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>React</category>
      </categories>
      <tags>
        <tag>React 16</tag>
      </tags>
  </entry>
  <entry>
    <title>Python 资料教程汇总</title>
    <url>/Python-%E8%B5%84%E6%96%99%E6%95%99%E7%A8%8B%E6%B1%87%E6%80%BB.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="../Mac%E4%B8%8Apython2%E5%92%8Cpython3%E7%9A%84%E7%89%88%E6%9C%AC%E5%88%87%E6%8D%A2%E8%AE%BE%E7%BD%AE.html">Mac上python2和python3的版本切换设置</a></li>
<li><a href="https://blog.csdn.net/muzilanlan/category_3201921.html" target="_blank" rel="noopener">CSDN LYK Python分类</a></li>
<li>[PyCharm 安装 NumPy，SciPy 等科学计算包 （Anaconda）for mac OS X](<a href="https://blog.csdn.net/muzilanlan/article/details/50479931" target="_blank" rel="noopener">https://blog.csdn.net/muzilanlan/article/details/50479931</a></li>
<li><a href="https://mp.weixin.qq.com/s/vIZoE4BmXYlyhfFFmlhDWg" target="_blank" rel="noopener">Anaconda 介绍、安装及使用保姆级教程</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Language</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>LinksSummary</tag>
        <tag>Python</tag>
        <tag>TODO</tag>
      </tags>
  </entry>
  <entry>
    <title>React Folder Structure</title>
    <url>/React-Folder-Structure.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="reference-links">Reference Links</h2>
<p><a href="https://www.robinwieruch.de/react-folder-structure/" target="_blank" rel="noopener">React Folder Structure in 5 Steps [2022]</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>React</category>
      </categories>
  </entry>
  <entry>
    <title>React all articles</title>
    <url>/React-all-articles.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="../React-16-New-feature-Summary-Links.html">React 16 new feature</a><br>
<a href="https://juejin.im/post/5c7df2e7f265da2d8a55d49d" target="_blank" rel="noopener">【React深入】React事件机制</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>React</category>
      </categories>
      <tags>
        <tag>LinksSummary</tag>
      </tags>
  </entry>
  <entry>
    <title>Server Tomcat v8.0 Server at localhost was unable to start within 180 seconds in Eclipse</title>
    <url>/Server-Tomcat-v8-0-Server-at-localhost-was-unable-to-start-within-180-seconds-in-Eclipse.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>When I run the project in Eclipse, the error shows as:</p>
<blockquote>
<p>Server Tomcat v8.0 Server at localhost was unable to start within 180 seconds. If the server requires more time, try increasing the timeout in the server editor.</p>
</blockquote>
<p>In servers view，Double click the server you want to set，open the setting window of server，“Timeouts” in the top right corner，modify it:</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Server-Tomcat-v8-0-Server-at-localhost-was-unable-to-start-within-180-seconds-in-Eclipse/eclipse.png" alt="server setting"></p>
<h1 id="the-reference-link">The reference link</h1>
<p><a href="https://blog.csdn.net/cnham/article/details/6317396" target="_blank" rel="noopener">Eclipse中server启动超时的解决方法</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>eclipse</tag>
      </tags>
  </entry>
  <entry>
    <title>Responsive web - Flexbox</title>
    <url>/Responsive-web-Flexbox.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="基础教程：">基础教程：</h2>
<ul>
<li><a href="https://css-tricks.com/snippets/css/a-guide-to-flexbox/" target="_blank" rel="noopener"> 官方文档 A Complete Guide to Flexbox</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_blank" rel="noopener"> 阮一峰 Flex 布局教程：语法篇</a></li>
</ul>
<p>但是看完还是有些不懂的地方：</p>
<h2 id="flex-basis-具体的含义">Flex Basis 具体的含义:</h2>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/flex-basis" target="_blank" rel="noopener"> flex-basis MDN</a><br>
以及和width的区别：</li>
<li><a href="https://www.jianshu.com/p/17b1b445ecd4" target="_blank" rel="noopener"> Flex Basis与Width的区别</a></li>
<li><a href="https://gedd.ski/post/the-difference-between-width-and-flex-basis/" target="_blank" rel="noopener"> The Difference Between Width and Flex Basis</a></li>
</ul>
<h2 id="flex-grow-flex-shrink-flex-basis-是怎么此消彼长的">flex-grow、flex-shrink、flex-basis 是怎么此消彼长的</h2>
<p>如果分配剩余空间？</p>
<ul>
<li><a href="https://zhoon.github.io/css3/2014/08/23/flex.html" target="_blank" rel="noopener"> 深入理解css3中的flex-grow、flex-shrink、flex-basis</a></li>
</ul>
<h2 id="小实践：">小实践：</h2>
<p>Code Pen - Flexbox Form:<br>
<a href="https://codepen.io/catherineliyuankun/pen/dyyMKzW" target="_blank" rel="noopener">Flexbox Form</a><br>
有个困惑， 比如.wrapper 的width只有比如100px; 但是lable/span又不想换行，这时lable的flex-grow:1,.date的flex-grow:3. 也就是比例是1：3，lable就会被截断。 当然如果flex-grow:1都为1，input和lable同比例缩小，会解决。<br>
但是在lable不长的情况下，不想让lable 和 input 部分的比例为1：1.</p>
<p>当然通过 media query 来实现修改flex的值，但是如果我想以.wrapper的宽度来修改flex-grow的值要怎么做呢？或者以lable的长度来修改.date的flex-grow的值？（lable长的时候，lable: .date = 1：1，lable短的时候，1：3）?</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width:</span> <span class="number">768px</span>) &#123;</span><br><span class="line">   	<span class="selector-class">.form-row</span> &gt; <span class="selector-class">.date</span> &#123;</span><br><span class="line">    	<span class="attribute">flex</span>: <span class="number">3</span>;  </span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width:</span> <span class="number">992px</span>) &#123;</span><br><span class="line">   	<span class="selector-class">.form-row</span> &gt; <span class="selector-class">.date</span> &#123;</span><br><span class="line">    	<span class="attribute">flex</span>: <span class="number">4</span>;  </span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.form-row</span> &gt; <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">padding</span>: .<span class="number">5em</span> <span class="number">1em</span> .<span class="number">5em</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.form-row</span> &gt; <span class="selector-class">.date</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: baseline;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="reference-links">Reference Links:</h1>
<ul>
<li><a href="https://css-tricks.com/snippets/css/a-guide-to-flexbox/" target="_blank" rel="noopener"> 官方文档 A Complete Guide to Flexbox</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_blank" rel="noopener"> 阮一峰 Flex 布局教程：语法篇</a></li>
<li><a href="https://www.quackit.com/css/flexbox/tutorial/align_form_elements_with_flexbox.cfm" target="_blank" rel="noopener"> How to Align Form Elements with Flexbox</a></li>
<li><a href="https://www.jianshu.com/p/17b1b445ecd4" target="_blank" rel="noopener"> Flex Basis与Width的区别</a></li>
<li><a href="https://gedd.ski/post/the-difference-between-width-and-flex-basis/" target="_blank" rel="noopener"> The Difference Between Width and Flex Basis</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>CSS</category>
        <category>Flexbox</category>
      </categories>
      <tags>
        <tag>Flexbox</tag>
      </tags>
  </entry>
  <entry>
    <title>Spring 实战 - 3 最小化 Spring XML config</title>
    <url>/Spring-XML-config.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="3-最小化-spring-xml-config">3 最小化 Spring XML config</h1>
<h2 id="3-1-autowiring-自动装配-autowire">3.1 AutoWiring 自动装配 <code>autowire</code></h2>
<p>减少or消除配置<code>&lt;property&gt;</code> 和<code>&lt;constructor-arg&gt;</code>元素，让Spring自动识别如何装配Bean的依赖关系。</p>
<h3 id="3-1-1-自动装配类型">3.1.1 自动装配类型</h3>
<h4 id="byname">byName</h4>
<p><code>&lt;bean id=&quot;lyk&quot; class=&quot;com.xxx.yyy.zzz&quot; autowire=&quot;byName&quot;&gt; &lt;/bean&gt;</code></p>
<h4 id="bytype">byType</h4>
<p>解决多个bean匹配问题：</p>
<h5 id="primary-首选">primary 首选</h5>
<p>默认值true<br>
<code>primary=&quot;false&quot;</code> 非首选</p>
<h5 id="autowire-candidate">autowire-candidate</h5>
<p><code>autowire-candidate=&quot;false&quot;</code> 排除</p>
<h4 id="constructtor">constructtor</h4>
<h4 id="autodetect-constructtor-bytype">autodetect = constructtor || byType</h4>
<h3 id="3-1-2-默认自动装配default-autowire">3.1.2 默认自动装配default-autowire</h3>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-3.1.xsd"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">default-autowire</span>=<span class="string">"byType"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-1-3-自动装配-显示装配">3.1.3 自动装配+显示装配</h3>
<p>用<code>constructtor</code>自动装配时，不能混合使用<code>autowire=&quot;constructtor&quot;</code> 和<code>&lt;constructor-arg&gt;</code>.</p>
<h2 id="3-2-注解装配-context-annotation-config">3.2 注解装配 <code>&lt;context:annotation-config/&gt;</code></h2>
<p>减少or消除配置<code>&lt;property&gt;</code> 和<code>&lt;constructor-arg&gt;</code>元素，让Spring自动识别注解，装配Bean的依赖关系。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframewoirk.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-3.1.xsd"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">default-autowire</span>=<span class="string">"byType"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span>     </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-2-1-sping自带的-auttowired">3.2.1 Sping自带的<code>@Auttowired</code></h3>
<p>Spring使用byType自动装配<code>@Auttowired</code>注解</p>
<h4 id="可选装配属性required">可选装配属性<code>required</code></h4>
<p><code>@Auttowired(required=false)</code></p>
<h4 id="限定-qualifier-beanid">限定<code>@Qualifier(&quot;beanID&quot;)</code></h4>
<p>缩小匹配bean的选择范围，默认使用Bean的ID</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Auttowired</span></span><br><span class="line"><span class="meta">@Qualifier</span>(<span class="string">"beanID"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="3-2-2-jsr-330的-inject">3.2.2 JSR-330的<code>@Inject</code></h3>
<h4 id="没有required属性">没有<code>required</code>属性</h4>
<h4 id="限定-named-beanid">限定<code>@Named(&quot;beanID&quot;)</code></h4>
<p>通过Bean的ID来标识可选择的Bean</p>
<h3 id="3-2-3-jsr-3250的-resource">3.2.3 JSR-3250的<code>@Resource</code></h3>
<h2 id="3-3-autodiscovering-自动检测-context-component-scan">3.3 AutoDiscovering 自动检测 <code>&lt;context:component-scan&gt;</code></h2>
<p>自动识别哪些类要配置成Spring Bean, 减少<code>&lt;bean&gt;</code>元素的使用。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframewoirk.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-3.1.xsd"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">default-autowire</span>=<span class="string">"byType"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span>     </span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.microstrategy.auth.saml.config"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"assignable"</span> <span class="attr">expression</span>=<span class="string">"com.xxx.uuu"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"regex"</span> <span class="attr">expression</span>=<span class="string">"&gt;org.bouncycastle.*"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-3-1-自动检测标注bean">3.3.1 自动检测标注Bean</h3>
<h4 id="component-通用的构造型注解-将该类定义为spring-组件"><code>@Component</code> 通用的构造型注解，将该类定义为Spring 组件</h4>
<h4 id="controller-将该类定义为spring-mvc-controller"><code>@Controller</code> 将该类定义为Spring MVC Controller</h4>
<h4 id="repository-将该类定义为数据仓库"><code>@Repository</code> 将该类定义为数据仓库</h4>
<h4 id="service-将该类定义为服务"><code>@Service</code> 将该类定义为服务</h4>
<h4 id="用-component标注的任意自定义注解">用<code>@Component</code>标注的任意自定义注解</h4>
<h3 id="3-3-2-过滤-context-include-filter-context-exclude-filter">3.3.2 过滤 <code>&lt;context:include-filter&gt;``&lt;context:exclude-filter&gt;</code></h3>
<p>type 类型</p>
<h4 id="type-annotation"><code>type=&quot;annotation&quot;</code></h4>
<p>与expression属性所指定的注解所标注的那些类。</p>
<h4 id="type-assignable"><code>type=&quot;assignable&quot;</code></h4>
<p>与expression属性所指定类型的那些类。</p>
<h4 id="type-aspectj"><code>type=&quot;aspectj&quot;</code></h4>
<p>与expression属性所指定的AspectJ表达式所匹配的那些类。</p>
<h4 id="type-custom"><code>type=&quot;custom&quot;</code></h4>
<p>使用自定义org.springframework.core.type.TypeFilter实现类，由expression属性指定</p>
<h4 id="type-regex"><code>type=&quot;regex&quot;</code></h4>
<p>与expression属性所指定的正则表达式所匹配的那些类。</p>
<h2 id="3-4-使用spring基于java的配置">3.4 使用Spring基于Java的配置</h2>
<p>取代xml配置，但是仍需要少量xml配置：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframewoirk.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-3.1.xsd"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">default-autowire</span>=<span class="string">"byType"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.microstrategy.auth.saml.config"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3-4-1-configuration-对应-beans">3.4.1 <code>@Configuration</code> 对应 <code>&lt;beans&gt;</code></h2>
<h2 id="3-4-2-bean-对应-bean">3.4.2 <code>@Bean</code> 对应 <code>&lt;bean&gt;</code></h2>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>一次清理多个git Branch [SourceTree]</title>
    <url>/SourceTree-Delete-Multiple-Branches-at-One-Time.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>使用SourceTree来实现一次性实现多个git Branch清理：</p>
<h1 id="click-repository-then-click-branch">Click Repository then click Branch</h1>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/SourceTree-Delete-Multiple-Branches-at-One-Time/sourcetree1.png" alt="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/SourceTree-Delete-Multiple-Branches-at-One-Time/sourcetree1.png"></p>
<h1 id="click-delete-branches">Click Delete Branches</h1>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/SourceTree-Delete-Multiple-Branches-at-One-Time/sourcetree2.png" alt="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/SourceTree-Delete-Multiple-Branches-at-One-Time/sourcetree1.png"></p>
<h1 id="select-the-branch-es-you-want-to-delete">Select the branch(es) you want to delete</h1>
<p>选择要清理的branch，注意branch 分为local本地的和remote远程的。注意不要误删remote的branch，除非确实是要清理。</p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>Redux Toolkit createSlice怎么实现多个slice构成redux state tree</title>
    <url>/Redux-Toolkit-createSlice%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E5%A4%9A%E4%B8%AAslice%E6%9E%84%E6%88%90redux-state-tree.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="redux-toolkit-createslice">Redux Toolkit - createSlice</h2>
<p><a href="https://redux-toolkit.js.org/usage/usage-with-typescript#createslice" target="_blank" rel="noopener">Redux Toolkit - createSlice 官方文档</a>这里虽然介绍了<code>createSlice</code>的使用方法，但是比较简单，如果我有一个比较复杂，层级比较多的redux store，不同层级都用<code>createSlice</code>来实现要怎么做呢？</p>
<p>例如 state tree 的结构：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">    config: &#123;</span><br><span class="line">        a : &#123;</span><br><span class="line">            a1: &#123;&#125;,</span><br><span class="line">            a2: &#123;&#125;,</span><br><span class="line">            a3: &#123;&#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        b: &#123;&#125;</span><br><span class="line">    &#125;，</span><br><span class="line">    content: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="selector成功-reducer失败">selector成功，reducer失败</h3>
<h4 id="createstore">createStore</h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// createStore</span></span><br><span class="line"><span class="keyword">const</span> createStore = <span class="function">(<span class="params">extraArgument: ThunkArgument</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">    reducer: &#123;</span><br><span class="line">      content: contentReducer,</span><br><span class="line">      config: aTop,  <span class="comment">// config state</span></span><br><span class="line">    &#125;,</span><br><span class="line">    middleware: <span class="function"><span class="params">getDefaultMiddleware</span> =&gt;</span></span><br><span class="line">      <span class="comment">// other code</span></span><br><span class="line">  &#125;)</span><br><span class="line">  setupListeners(store.dispatch)</span><br><span class="line">  <span class="keyword">return</span> store</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="a1-index-tsx"><code>./a1/index.tsx</code></h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ./a1/index.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice, PayloadAction &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface A1 &#123;</span><br><span class="line">  enabled: boolean</span><br><span class="line">  a11: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState: A1 = &#123;</span><br><span class="line">  enabled: <span class="literal">false</span>,</span><br><span class="line">  a11: <span class="string">''</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> A1Slice = createSlice(&#123;</span><br><span class="line">  name: <span class="string">'a1Slice'</span>,</span><br><span class="line">  initialState,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    updateA1Enabled: <span class="function">(<span class="params">state, &#123; payload &#125;: PayloadAction&lt;boolean&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      state.enabled = payload</span><br><span class="line">    &#125;,</span><br><span class="line">    updateA11: <span class="function">(<span class="params">state, &#123; payload &#125;: PayloadAction&lt;string&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      state.a11 = payload</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123;</span><br><span class="line">  updateA1Enabled,</span><br><span class="line">  updateA11,</span><br><span class="line">&#125; = A1Slice.actions</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> A1Slice.reducer</span><br></pre></td></tr></table></figure>
<h4 id="configslice-tsx"><code>configSlice.tsx</code></h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// configSlice.tsx</span></span><br><span class="line"><span class="keyword">import</span> type &#123; Reducer &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice, PayloadAction, combineReducers &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span></span><br><span class="line"><span class="keyword">import</span> a1Reducer, <span class="keyword">from</span> <span class="string">'./a1'</span></span><br><span class="line"><span class="keyword">import</span> a2Reducer, <span class="keyword">from</span> <span class="string">'./a2'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> aReducer = combineReducers(&#123;</span><br><span class="line">  a1: a1Reducer,</span><br><span class="line">  a2: a2Reducer</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type AState = ReturnType&lt;<span class="keyword">typeof</span> aReducer&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface A &#123;</span><br><span class="line">  a: AState</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState: A = &#123;</span><br><span class="line">  a: aReducer(<span class="literal">undefined</span>, &#123; <span class="attr">type</span>: <span class="string">'INIT'</span> &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> configSlice = createSlice(&#123;</span><br><span class="line">  name: <span class="string">'configSlice'</span>,</span><br><span class="line">  initialState,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    updateConfig: <span class="function">(<span class="params">state, action: PayloadAction&lt;Config&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> action.payload</span><br><span class="line">    &#125;,</span><br><span class="line">    updateA: <span class="function">(<span class="params">state, action: PayloadAction&lt;AState&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      state.a = action.payload</span><br><span class="line">    &#125;,</span><br><span class="line">    updatePartialA: <span class="function">(<span class="params">state, action: PayloadAction&lt;Partial&lt;ReturnType&lt;<span class="keyword">typeof</span> aReducer&gt;&gt;&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      state.a = &#123; ...state.a, ...action.payload &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; updateConfig, updateA, updatePartialA &#125; = configSlice.actions</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> configSlice.reducer</span><br></pre></td></tr></table></figure>
<h3 id="成功实现-selector成功-reducer成功">成功实现(selector成功，reducer成功)</h3>
<h4 id="reduce-reducers"><code>./reduce-reducers</code></h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ./reduce-reducers</span></span><br><span class="line">type Action = &#123;</span><br><span class="line">  type: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Reducer&lt;S&gt; = <span class="function">(<span class="params">state: S, action: Action</span>) =&gt;</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (...args: Reducer&lt;unknown&gt;[]): Reducer&lt;unknown&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> initialState = <span class="keyword">typeof</span> args[<span class="number">0</span>] !== <span class="string">'function'</span> &amp;&amp; args.shift()</span><br><span class="line">  <span class="keyword">const</span> reducers = args</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> initialState === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(</span><br><span class="line">      <span class="string">'The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.'</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">prevState, value, ...args</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> prevStateIsUndefined = <span class="keyword">typeof</span> prevState === <span class="string">'undefined'</span></span><br><span class="line">    <span class="keyword">const</span> valueIsUndefined = <span class="keyword">typeof</span> value === <span class="string">'undefined'</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (prevStateIsUndefined &amp;&amp; valueIsUndefined &amp;&amp; initialState) &#123;</span><br><span class="line">      <span class="keyword">return</span> initialState</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> reducers.reduce(</span><br><span class="line">      (newState, reducer, index) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> reducer === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">`An undefined reducer was passed in at index <span class="subst">$&#123;index&#125;</span>`</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> reducer(newState, value, ...args)</span><br><span class="line">      &#125;,</span><br><span class="line">      prevStateIsUndefined &amp;&amp; !valueIsUndefined &amp;&amp; initialState ? initialState : prevState</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="combinslices"><code>./combinSlices</code></h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ./combinSlices</span></span><br><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span></span><br><span class="line"><span class="keyword">import</span> type &#123; Reducer &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> reduceReducers <span class="keyword">from</span> <span class="string">'./reduce-reducers'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> combineSlices = (sliceReducer: Reducer, <span class="attr">sliceInitialState</span>: object, <span class="attr">childSliceReducers</span>: unknown): <span class="function"><span class="params">Reducer</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> noopReducersFromInitialState: unknown = <span class="built_in">Object</span>.keys(sliceInitialState).reduce(<span class="function">(<span class="params">prev, curr</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      ...prev,</span><br><span class="line">      [curr]: <span class="function">(<span class="params">s = <span class="literal">null</span></span>) =&gt;</span> s</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, &#123;&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> childReducers = combineReducers(&#123;</span><br><span class="line">    ...(childSliceReducers <span class="keyword">as</span> object),</span><br><span class="line">    ...(noopReducersFromInitialState <span class="keyword">as</span> object)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> reduceReducers(sliceReducer, childReducers <span class="keyword">as</span> Reducer&lt;unknown&gt;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> combineSlices</span><br></pre></td></tr></table></figure>
<h4 id="configslice-tsx-version-2"><code>configSlice.tsx</code> version 2</h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// configSlice.tsx</span></span><br><span class="line"><span class="keyword">import</span> type &#123; Reducer &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice, PayloadAction, combineReducers &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span></span><br><span class="line"><span class="keyword">import</span> a1Reducer, <span class="keyword">from</span> <span class="string">'./a1'</span></span><br><span class="line"><span class="keyword">import</span> a2Reducer, <span class="keyword">from</span> <span class="string">'./a2'</span></span><br><span class="line"><span class="keyword">import</span> combineSlices <span class="keyword">from</span> <span class="string">'./combinSlices'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> aReducer = combineReducers(&#123;</span><br><span class="line">  a1: a1Reducer,</span><br><span class="line">  a2: a2Reducer</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type AState = ReturnType&lt;<span class="keyword">typeof</span> aReducer&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface A &#123;</span><br><span class="line">  a: AState</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState: A = &#123;</span><br><span class="line">  a: aReducer(<span class="literal">undefined</span>, &#123; <span class="attr">type</span>: <span class="string">'INIT'</span> &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// -----------------New added part 1-------------</span></span><br><span class="line"><span class="keyword">const</span> aSlice = createSlice(&#123;</span><br><span class="line">  name: <span class="string">'aSlice'</span>,</span><br><span class="line">  initialState,</span><br><span class="line">  reducers: &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// -----------------New added part 1-------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> configSlice = createSlice(&#123;</span><br><span class="line">  name: <span class="string">'configSlice'</span>,</span><br><span class="line">  initialState,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    updateConfig: <span class="function">(<span class="params">state, action: PayloadAction&lt;Config&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> action.payload</span><br><span class="line">    &#125;,</span><br><span class="line">    updateA: <span class="function">(<span class="params">state, action: PayloadAction&lt;AState&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      state.a = action.payload</span><br><span class="line">    &#125;,</span><br><span class="line">    updatePartialA: <span class="function">(<span class="params">state, action: PayloadAction&lt;Partial&lt;ReturnType&lt;<span class="keyword">typeof</span> aReducer&gt;&gt;&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      state.a = &#123; ...state.a, ...action.payload &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; updateConfig, updateA, updatePartialA &#125; = configSlice.actions</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> configSlice.reducer</span><br><span class="line"></span><br><span class="line"><span class="comment">// -----------------New added part 2-------------</span></span><br><span class="line"><span class="keyword">const</span> aCombine = combineSlices(</span><br><span class="line">  aSlice.reducer,</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    a1: a1Reducer,</span><br><span class="line">    a2: a2Reducer</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">const</span> aTop: Reducer&lt;Config&gt; = combineSlices(</span><br><span class="line">  configSlice.reducer,</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    a: aCombine</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">export</span> &#123; aCombine, aTop &#125;</span><br><span class="line"><span class="comment">// -----------------New added part 2-------------</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>Redux</category>
      </categories>
      <tags>
        <tag>Redux Toolkit</tag>
      </tags>
  </entry>
  <entry>
    <title>VirtualBox Error “kernel driver not installed (rc=-1908)” on macOS</title>
    <url>/VirtualBox-Error-%E2%80%9Ckernel-driver-not-installed-rc-1908-%E2%80%9D-on-macOS.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>I installed VirtualBox on Macbook Pro to run a new imported VM. Here is what I got when trying to start one:</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/VirtualBox-Error-%E2%80%9Ckernel-driver-not-installed-rc-1908-%E2%80%9D-on-macOS/Vitualbox%20error1.png" alt="Error1"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/VirtualBox-Error-%E2%80%9Ckernel-driver-not-installed-rc-1908-%E2%80%9D-on-macOS/Vitualbox%20error2.png" alt="Error2"></p>
<p>The error message is quite vague. It says On Linux, open returned ENOENT. What about on macOS? It turns out that I have to explicitly allow VirtualBox in the macOS system preference.</p>
<p>Go to System Preferences / Security &amp; Privacy.</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/VirtualBox-Error-%E2%80%9Ckernel-driver-not-installed-rc-1908-%E2%80%9D-on-macOS/Scurity.png" alt="Scurity"></p>
<p>Click “Allow” in the window below.</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/VirtualBox-Error-%E2%80%9Ckernel-driver-not-installed-rc-1908-%E2%80%9D-on-macOS/Allow.jpeg" alt="Scurity Allow"></p>
<p>Now VirtualBox no longer complains about kernel driver.</p>
<p>Update: some people don’t see this button. According to a comment from Albert Wolszon:</p>
<blockquote>
<p>This Allow button section shows up only after first 30 minutes after the installation of VirtualBox. If you have this error and don’t see the button, uninstall VirtualBox, remove its belongings (there are usually some files left) and install it once again, then check this button again.<br>
Thanks for the comments!</p>
</blockquote>
<p>#The reference Links:<br>
<a href="https://medium.com/@Aenon/mac-virtualbox-kernel-driver-error-df39e7e10cd8" target="_blank" rel="noopener">Solving VirtualBox “kernel driver not installed (rc=-1908)” Error on macOS</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>VirtualBox</tag>
      </tags>
  </entry>
  <entry>
    <title>System-V 与 SystemD 区别</title>
    <url>/System-V-%E4%B8%8E-SystemD-%E5%8C%BA%E5%88%AB.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>One of the most fundamental distinctions in modern Linux systems is whether they use SystemV or Systemd. Here are the main differences between the two.</p>
<ol>
<li>SystemV is older, and goes all the way back to original Unix.</li>
<li>SystemD is the new system that many distros are moving to.</li>
<li>SystemD was designed to provide faster booting, better dependency management, and much more.</li>
<li>SystemD handles startup processes through .service files.</li>
<li>SystemV handles startup processes through shell scripts in /etc/init*.</li>
</ol>
<p>Indicators</p>
<ul>
<li>If you’re starting and stopping things using <code>systemctl restart sshd</code>, etc, you’re on a SystemD system.</li>
<li>If you’re starting and stopping things using <code>/etc/init.d/sshd start</code>, etc, you’re on a SystemV system.</li>
</ul>
<p>Which distros use which?</p>
<p>Many older versions of SystemD distros were SystemV.<br>
Here’s an incomplete but hopefully useful breakdown of which distros are on which system.</p>
<p><code>Systemd</code>: Amazon Linux, Red Hat Enterprise, CentOS, Fedora, Debian/Ubuntu/Mint</p>
<p>Related<br>
an ics/scada primer<br>
<code>SystemV</code>: Gentoo, Alpine, Slackware, Linux from Scratch</p>
<p>Notes<br>
There are other startup systems as well, such as Upstart and BSD.</p>
</blockquote>
<h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://danielmiessler.com/study/the-difference-between-system-v-and-systemd/" target="_blank" rel="noopener">The Difference Between System V and SystemD</a></li>
<li><a href="https://blog.csdn.net/qinhan728/article/details/48792691" target="_blank" rel="noopener">system V与systemd</a></li>
<li><a href="https://www.cnblogs.com/baiyw/p/3504419.html" target="_blank" rel="noopener">systemd、upstart和system V</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Linux/bash</category>
      </categories>
      <tags>
        <tag>Command line</tag>
        <tag>TODO</tag>
      </tags>
  </entry>
  <entry>
    <title>Voice over for OSX Keyboard Shortcuts</title>
    <url>/Voice-over-for-OSX-Keyboard-Shortcuts.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="basic">Basic</h1>
<table>
<thead>
<tr>
<th>Task</th>
<th>Command</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>VO</td>
<td>Control 键 + Option 键</td>
<td></td>
</tr>
<tr>
<td>turn VoiceOver on or off</td>
<td>Command-F5 or Fn-Command-F5</td>
<td></td>
</tr>
<tr>
<td>or hold Command and triple-press Touch ID on supported models1</td>
<td></td>
<td></td>
</tr>
<tr>
<td>教程</td>
<td>VO-Command-F8</td>
<td></td>
</tr>
<tr>
<td>Keyboard Help</td>
<td>VO-K</td>
<td></td>
</tr>
<tr>
<td>Activate Link</td>
<td>Enter</td>
<td></td>
</tr>
<tr>
<td>Activate button</td>
<td>Enter or Space Bar</td>
<td></td>
</tr>
<tr>
<td>Read next/previous item</td>
<td>VO + Right/Left Arrow</td>
<td></td>
</tr>
<tr>
<td>Go to next heading</td>
<td>VO + Command + H</td>
<td></td>
</tr>
<tr>
<td>Go to next table</td>
<td>VO + command + T</td>
<td></td>
</tr>
<tr>
<td>Go to previous (heading, table, etc.)</td>
<td>VO + Command + [H, T, etc.]</td>
<td></td>
</tr>
<tr>
<td>Interact with (go into/out of) objects(like iframes, menus, application regions, etc.)</td>
<td>VO + Shift + Down/Up Arrows</td>
<td></td>
</tr>
<tr>
<td>Dock</td>
<td>VO-D</td>
<td>To move between icons in the Dock, press VO-Left Arrow or VO-Right Arrow</td>
</tr>
<tr>
<td>mac menu bar</td>
<td>VO-M</td>
<td>navigate to the status menus, press VO-M-M.</td>
</tr>
<tr>
<td>Lock (or unlock) VO keys</td>
<td>VO +</td>
<td></td>
</tr>
<tr>
<td>Adjust the Voice</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>VO-Command-Shift-Right Arrow several times</td>
<td>start setting</td>
</tr>
<tr>
<td></td>
<td>VO-Command-Shift-Up/Down Arrow</td>
<td>increase/decrease the setting’s value</td>
</tr>
</tbody>
</table>
<h1 id="navigation">Navigation</h1>
<table>
<thead>
<tr>
<th>Task</th>
<th>Command</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Go to next/previous focusable item</td>
<td>Tab / Shift + Tab</td>
<td>(link, button, input, etc.)</td>
</tr>
<tr>
<td>Move to the next control when a text field is selected</td>
<td>Control-Tab</td>
<td></td>
</tr>
<tr>
<td>Move the focus to the previous grouping of controls</td>
<td>Control-Shift-Tab</td>
<td></td>
</tr>
<tr>
<td>Move to the adjacent item in a list, tab group, or menu；Move sliders and adjusters (Up Arrow to increase values, Down Arrow to decrease values)</td>
<td>Arrow keys</td>
<td></td>
</tr>
<tr>
<td>move the VoiceOver cursor</td>
<td>VO-Up/Down/Left/Right Arrow</td>
<td></td>
</tr>
<tr>
<td>Move to a control adjacent to the text field</td>
<td>Control–Arrow keys</td>
<td></td>
</tr>
<tr>
<td>Click the default button or perform the default action</td>
<td>Return or Enter</td>
<td></td>
</tr>
<tr>
<td>Click the Cancel button or close a menu without choosing an item</td>
<td>Esc</td>
<td></td>
</tr>
<tr>
<td>Navigate Webpages</td>
<td>VO + U</td>
<td>Open rotor (see explanation below)</td>
</tr>
<tr>
<td>auto web spot</td>
<td>VO-Command-N / VO-Command-Shift-N</td>
<td>To jump to the next or previous auto web spot</td>
</tr>
<tr>
<td>VO-Right/Left Arrow</td>
<td>To move to the item before or after an auto web spot</td>
<td></td>
</tr>
<tr>
<td>select controls</td>
<td>VO-Space</td>
<td>interact with checkboxes, radio buttons, pop-up menus, and other onscreen controls</td>
</tr>
<tr>
<td>start/stop Interact with Elements</td>
<td>VO-Shift-Down/Up Arrow</td>
<td></td>
</tr>
<tr>
<td>Next link</td>
<td>VO + command + L</td>
<td></td>
</tr>
<tr>
<td>Next visited link</td>
<td>VO + command + V</td>
<td></td>
</tr>
<tr>
<td>Next form control</td>
<td>VO + command + J</td>
<td></td>
</tr>
<tr>
<td>Next list</td>
<td>VO + command + X</td>
<td></td>
</tr>
<tr>
<td>Next graphic</td>
<td>VO + command + G</td>
<td></td>
</tr>
<tr>
<td>Move the focus to the previous panel</td>
<td>Control-Shift-F6</td>
<td></td>
</tr>
<tr>
<td>Move to the status menu in the menu bar</td>
<td>Control-F8</td>
<td></td>
</tr>
<tr>
<td>Activate the next open window in the front app</td>
<td>Command-Accent (`)</td>
<td></td>
</tr>
<tr>
<td>Activate the previous open window in the front app</td>
<td>Shift-Command-Accent (`)</td>
<td></td>
</tr>
<tr>
<td>Move the focus to the window drawer</td>
<td>Option-Command-Accent (`)</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="data-tables">Data Tables</h1>
<table>
<thead>
<tr>
<th>Task</th>
<th>Command</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Go to next table</td>
<td>VO + command + T</td>
<td></td>
</tr>
<tr>
<td>Read column header</td>
<td>VO + C</td>
<td></td>
</tr>
<tr>
<td>Read row header</td>
<td>VO + R</td>
<td>/row from VO cursor location to end of row</td>
</tr>
<tr>
<td>read a table column</td>
<td>VO-C-C</td>
<td></td>
</tr>
<tr>
<td>read a row</td>
<td>VO-R-R</td>
<td></td>
</tr>
<tr>
<td>Read column from VO cursor location to bottom of column</td>
<td>VO + R + C</td>
<td></td>
</tr>
<tr>
<td>Navigate table cells</td>
<td>O + Arrow Keys (<img src="evernotecid://42B76B16-D58D-4F3C-B807-6F2A8086E7B7/appyinxiangcom/7963496/ENResource/p14465" alt="cdd13b4aaa32b8cfc4863a60d3882054.png"> or <img src="evernotecid://42B76B16-D58D-4F3C-B807-6F2A8086E7B7/appyinxiangcom/7963496/ENResource/p14466" alt="fd5faf1d96d8e526b6097b376d46b409.png"> or <img src="evernotecid://42B76B16-D58D-4F3C-B807-6F2A8086E7B7/appyinxiangcom/7963496/ENResource/p14467" alt="ab12b66bf3cd78a3e111fda1cef5e9fb.png"> or <img src="evernotecid://42B76B16-D58D-4F3C-B807-6F2A8086E7B7/appyinxiangcom/7963496/ENResource/p14468" alt="3cf03e7a94843864c6ed88c74c8247a1.png"> )</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="reading">Reading</h1>
<table>
<thead>
<tr>
<th>Task</th>
<th>Command</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Start reading</td>
<td>VO + A</td>
<td></td>
</tr>
<tr>
<td>Stop reading</td>
<td>Control</td>
<td></td>
</tr>
<tr>
<td>Read next item	VO + Right Arrow</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Read previous item	VO + Left Arrow</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Read paragraph	VO + P</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Read sentence	VO + S</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Read word (press W multiple times to spell words alphabetically and phonetically)</td>
<td>VO + W</td>
<td></td>
</tr>
<tr>
<td>Read from top to current location</td>
<td>VO + B</td>
<td></td>
</tr>
<tr>
<td>Jump to top of page (on desktop keyboard)</td>
<td>VO + Home</td>
<td></td>
</tr>
<tr>
<td>Jump to top of page (on laptop keyboards)</td>
<td>VO + fn + Left Arrow</td>
<td></td>
</tr>
<tr>
<td>Jump to bottom of page (on desktop keyboard)</td>
<td>VO + End</td>
<td></td>
</tr>
<tr>
<td>Jump to bottom of page (on laptop keyboards)</td>
<td>VO + fn + Right Arrow</td>
<td></td>
</tr>
<tr>
<td>Select speech setting option (speaking rate, voice, pitch, etc.)</td>
<td>VO + command + Right Arrow / Left Arrow</td>
<td></td>
</tr>
<tr>
<td>Modify the selected speech setting</td>
<td>VO + command + Up Arrow / Down Arrow</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="multi-touch-trackpad">Multi-Touch Trackpad</h1>
<table>
<thead>
<tr>
<th>Task</th>
<th>Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable/disable the Trackpad Commander</td>
<td>VO + rotate two fingers clockwise/counter clockwise on the trackpad</td>
</tr>
<tr>
<td>move to the next or previous item</td>
<td>flick right or left</td>
</tr>
<tr>
<td>start or stop interacting with the current item</td>
<td>flick two fingers right or left</td>
</tr>
<tr>
<td>select the current item</td>
<td>double tap</td>
</tr>
</tbody>
</table>
<h1 id="reference-links">Reference links</h1>
<p><a href="https://dequeuniversity.com/screenreaders/voiceover-keyboard-shortcuts" target="_blank" rel="noopener">https://dequeuniversity.com/screenreaders/voiceover-keyboard-shortcuts</a></p>
<p><a href="https://support.apple.com/en-gb/HT204434" target="_blank" rel="noopener">https://support.apple.com/en-gb/HT204434</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>Accessibility</category>
      </categories>
      <tags>
        <tag>Voice over</tag>
      </tags>
  </entry>
  <entry>
    <title>web容器对比</title>
    <url>/Web-containers-web%E5%AE%B9%E5%99%A8%E6%80%BB%E7%BB%93.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="web容器-vs-ejb容器-vs-java-ee容器">Web容器 Vs EJB容器 Vs Java EE容器</h1>
<p>Web容器和EJB容器是Java EE容器的子集。 Java EE容器还包含应用程序客户端容器和applet容器。<br>
*在文档中，他们使用多格式，但是实际上每个Java EE服务器只有一个Web容器和一个EJB容器。</p>
<blockquote>
<p>The deployment process installs Java EE application components in the Java EE containers.</p>
</blockquote>
<blockquote>
<p>Application client container: Manages the execution of application client components. Application clients and their container run on the client.</p>
</blockquote>
<blockquote>
<p>Applet container: Manages the execution of applets. Consists of a web browser and Java Plug-in running on the client together.</p>
</blockquote>
<h2 id="ejb容器">EJB容器</h2>
<blockquote>
<p>Enterprise JavaBeans (EJB) container: Manages the execution of enterprise beans for Java EE applications. Enterprise beans and their container run on the Java EE server.</p>
</blockquote>
<h2 id="java-ee容器">Java EE容器</h2>
<blockquote>
<p>Java EE server: The runtime portion of a Java EE product. A Java EE server provides EJB [container and web container].</p>
</blockquote>
<p>Java EE容器是一种应用程序服务器解决方案，它支持Web容器，EJB和其他Java EE API和服务。<br>
Orace WebLogic服务器，GlassFish服务器，IBM WebSphere应用程序服务器，JBoss应用程序服务器和Caucho Resin是Java EE容器的示例</p>
<h2 id="web容器">Web容器</h2>
<blockquote>
<p>Web container: Manages the execution of JSP page and servlet components for Java EE applications. Web components and their container run on the Java EE server.<br>
管理Java EE应用程序的网页，Servlet和某些EJB组件的执行。 Web组件及其容器运行在Web服务器上，例如Jetty，tomcat。</p>
</blockquote>
<h1 id="web容器对比">Web容器对比</h1>
<table>
<thead>
<tr>
<th>特性\web containers</th>
<th>Tomcat</th>
<th><a href="https://www.oracle.com/java/weblogic/" target="_blank" rel="noopener">WebLogic</a></th>
<th>WebSphere</th>
<th>JBOSS/WildFly</th>
<th>Jetty</th>
</tr>
</thead>
<tbody>
<tr>
<td>0官方文档</td>
<td></td>
<td>1. <a href="https://docs.oracle.com/en/middleware/standalone/weblogic-server/14.1.1.0/admrf/weblogicserver.html#GUID-3F753BDB-C28E-4A9F-B569-F34A032F96F5" target="_blank" rel="noopener">Command Reference for Oracle WebLogic Server 14.1.1</a>  2.<a href="https://docs.oracle.com/en/middleware/fusion-middleware/weblogic-server/index.html" target="_blank" rel="noopener">文档14.1.1.0</a></td>
<td>WebSphere</td>
<td><a href="https://developers.redhat.com/products/eap/download/" target="_blank" rel="noopener">JBOSS</a> / <a href="https://www.wildfly.org/downloads/" target="_blank" rel="noopener">WildFly</a></td>
<td>Jetty</td>
</tr>
<tr>
<td>0安装</td>
<td></td>
<td><a href="https://www.oracle.com/middleware/technologies/fusionmiddleware-downloads.html" target="_blank" rel="noopener">下载14.1.1.0</a></td>
<td>WebSphere</td>
<td><a href="https://developers.redhat.com/products/eap/download/" target="_blank" rel="noopener">JBOSS</a> / <a href="https://www.wildfly.org/downloads/" target="_blank" rel="noopener">WildFly</a></td>
<td>Jetty</td>
</tr>
<tr>
<td>1出品公司</td>
<td>Apache 软件基金会的 Jakarta 项目中的一个核心项目，由 Apache、 Sun 和其他一些公司及个人共同开发而成。</td>
<td>最早由WebLogic Inc.开发，后并入BEA公司，最终BEA公司又并入Oracle公司</td>
<td>IBM 的集成软件平台</td>
<td>2006 年,Jboss 公司被 Redhat 公司收购</td>
<td></td>
</tr>
<tr>
<td>2介绍</td>
<td>Jsp和Servlet容器。由于有了 Sun 的参与和支持，最新的 S ervlet 和 JSP 规范总是能在 Tomcat 中得到体现， Tomcat 5 支持最新的 Servlet 2. 4 和 JSP 2.0 规范。因为 Tomcat 技术先进、性能稳定，而且免费，因而深受 Java 爱好者的喜爱并得到了部分软件开发商的认可，成为目前比较流行的 Web 应用服务器。</td>
<td>application server 确切的说是一个基于 j2ee 架构的中间件。用于开发、集成、部署和管理大型分布式 Web 应用、网络应用和数据库应用的 Java 应用服务器。将 Java 的动态功能和 Java Enterprise 标准的安全性引入大型网络应用的开发、集成、部署和管理之中。</td>
<td>它包含了编写、运行和监视全天候的工业强度的随需应变 Web 应用程序和跨平台、 跨产品解决方案所需要的整个中间件基 础设施，如服务器、服务和工具。 WebSphere 提供了可靠、灵活和健壮的集成软件。</td>
<td>JBoss是一个基于J2EE的管理EJB的容器和服务器，支持 EJB 1.1、EJB 2.0 和 EJB3.0 的 规范。但 JBoss 核心服务不包括支持 servlet/JSP 的 WEB 容器，一般与 Tomcat 或 Jetty 绑定使用。（Jboss作为应用服务器，而Tomcat做web服务器。在 3.0 之前 JBoss 使用 Jetty 作为 Web Container，之后 JBoss 使用了 Tomcat 作为他的一个基础服务提供了 Web Container，所以 JBoss 4.x 里面你会看到一个 Embbed Tomcat。）EAP 7开始(因此已经在WildFly 8,9,10中使用)，开始使用自助研发的<code>Undertow</code>作为新Servlet容器/ http引擎</td>
<td>Servlet容器</td>
</tr>
<tr>
<td>3价位</td>
<td>免费</td>
<td>收费-高 对于开发者，有免费使用一年的许可证。</td>
<td>收费-高</td>
<td>免费（文档要收费）</td>
<td>免费</td>
</tr>
<tr>
<td>开源性</td>
<td>开源</td>
<td>不</td>
<td>不</td>
<td>开源 <code>LGPL</code></td>
<td>开源</td>
</tr>
<tr>
<td>优点</td>
<td>轻便小巧</td>
<td></td>
<td></td>
<td>热deploy</td>
<td>开源</td>
</tr>
<tr>
<td>技术支持</td>
<td><code>EJB</code> No</td>
<td>WebLogic 与 WebSphere 都是对业内多种标准的全面支持， 包括 EJB、 JSB、 JMS、 JDBC、XML 和 WML，使 Web 应用系统的实施更为简单，并且保护了投资，同时也使基于标准的解决方案的开发更加简便。</td>
<td></td>
<td><code>EJB</code> Yes JBoss 是实现了EJB 容器，再集成了 Tomcat</td>
<td></td>
</tr>
<tr>
<td>扩展性</td>
<td></td>
<td>高扩展的架构体系闻名于业内，包括客户机连接的共享、资源 pooling 以及动态网页和 EJB 组件群集。</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>应用范围</td>
<td>小型的轻量级应用服务器，在中小型系统和并发访问用户不是很多的场合下被普遍使用，是开发和调试 JSP 程序的首选。</td>
<td>大型企业的大型项目</td>
<td>大型企业的大型项目</td>
<td>EJB 服务的中小型公司</td>
<td></td>
</tr>
<tr>
<td>商业服务和技术支持</td>
<td>无</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td></td>
</tr>
<tr>
<td>与数据库的紧密结合性</td>
<td></td>
<td>如果硬件成本比软件成本高许多，那不如使用 Weblogic/Websphere。</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>安全性</td>
<td>相对低</td>
<td>相对高</td>
<td>相对高</td>
<td>相对低</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="jboss-wildfly-all-you-should-know"><a href="../JBoss-WildFly-all-you-should-know.html">JBoss/WildFly all you should know</a></h2>
<h2 id="weblogic-14c-下载与安装部署"><a href="../Weblogic-14c-%E4%B8%8B%E8%BD%BD%E4%B8%8E%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2.html">Weblogic-14c-下载与安装部署</a></h2>
<h1 id="相关cve">相关CVE</h1>
<h2 id="tomcat">Tomcat</h2>
<ul>
<li><a href="https://www.freebuf.com/vuls/228108.html" target="_blank" rel="noopener">CVE-2020-1938</a></li>
<li><a href="https://github.com/pyn3rd/CVE-2019-0232/" target="_blank" rel="noopener">CVE-2019-0232 远程代码执行</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI1NDg4MTIxMw==&amp;mid=2247483659&amp;idx=1&amp;sn=c23b3a3b3b43d70999bdbe644e79f7e5" target="_blank" rel="noopener">CVE-2017-12615 任意文件写入</a></li>
<li>CVE-2013-2067</li>
<li>CVE-2012-4534</li>
<li>CVE-2012-4431</li>
<li>CVE-2012-3546</li>
<li>CVE-2012-3544</li>
<li>CVE-2012-2733</li>
<li>CVE-2011-3375</li>
<li>CVE-2011-3190</li>
<li>CVE-2008-2938</li>
</ul>
<h2 id="weblogic">Weblogic</h2>
<ul>
<li>
<p>CVE-2019-2725</p>
<ul>
<li>wls-wsat 反序列化远程代码执行</li>
</ul>
</li>
<li>
<p>CVE-2019-2658</p>
</li>
<li>
<p>CVE-2019-2650</p>
</li>
<li>
<p>CVE-2019-2649</p>
</li>
<li>
<p>CVE-2019-2648</p>
</li>
<li>
<p>CVE-2019-2647</p>
</li>
<li>
<p>CVE-2019-2646</p>
</li>
<li>
<p>CVE-2019-2645</p>
</li>
<li>
<p>CVE-2019-2618</p>
<ul>
<li><a href="https://github.com/jas502n/cve-2019-2618/" target="_blank" rel="noopener">https://github.com/jas502n/cve-2019-2618/</a></li>
</ul>
</li>
<li>
<p>CVE-2019-2615</p>
</li>
<li>
<p>CVE-2019-2568</p>
</li>
<li>
<p>CVE-2018-3252</p>
</li>
<li>
<p>CVE-2018-3248</p>
</li>
<li>
<p>CVE-2018-3245</p>
</li>
<li>
<p>CVE-2018-3201</p>
</li>
<li>
<p>CVE-2018-3197</p>
</li>
<li>
<p>CVE-2018-3191</p>
<ul>
<li><a href="https://github.com/voidfyoo/CVE-2018-3191" target="_blank" rel="noopener">https://github.com/voidfyoo/CVE-2018-3191</a></li>
<li><a href="https://github.com/Libraggbond/CVE-2018-3191" target="_blank" rel="noopener">https://github.com/Libraggbond/CVE-2018-3191</a></li>
</ul>
</li>
<li>
<p>CVE-2018-2894</p>
<ul>
<li>任意文件上传</li>
<li><a href="https://xz.aliyun.com/t/2458" target="_blank" rel="noopener">https://xz.aliyun.com/t/2458</a></li>
</ul>
</li>
<li>
<p>CVE-2018-2893</p>
<ul>
<li>反序列化</li>
<li><a href="https://www.freebuf.com/vuls/178105.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/178105.html</a></li>
</ul>
</li>
<li>
<p>CVE-2018-2628</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/nYY4zg2m2xsqT0GXa9pMGA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/nYY4zg2m2xsqT0GXa9pMGA</a></li>
</ul>
</li>
<li>
<p>CVE-2018-1258</p>
</li>
<li>
<p>CVE-2017-10271</p>
<ul>
<li><a href="http://webcache.googleusercontent.com/search?q=cache%3AsH7j8TF8uOIJ%3Awww.freebuf.com%2Fvuls%2F160367.html" target="_blank" rel="noopener">XMLDecoder 反序列化漏洞</a></li>
</ul>
</li>
<li>
<p>CVE-2017-3248</p>
</li>
<li>
<p>CVE-2016-3510</p>
</li>
<li>
<p>CVE-2015-4852</p>
<ul>
<li><a href="https://github.com/roo7break/serialator" target="_blank" rel="noopener">https://github.com/roo7break/serialator</a></li>
</ul>
</li>
</ul>
<h2 id="jboss">JBoss</h2>
<ul>
<li>CVE-2017-12149
<ul>
<li>反序列化漏洞</li>
<li>访问 /invoker/readonly ，页面存在即有反序列化漏洞</li>
</ul>
</li>
</ul>
<h1 id="参考文章">参考文章</h1>
<ul>
<li><a href="https://websec.readthedocs.io/zh/latest/language/java/container.html" target="_blank" rel="noopener">Web安全学习笔记5.3.5. 容器</a></li>
<li><a href="https://www.codenong.com/17181292/" target="_blank" rel="noopener">Java EE容器与Web容器</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>WebContainer</tag>
      </tags>
  </entry>
  <entry>
    <title>Weblogic 14c 下载与安装部署</title>
    <url>/Weblogic-14c-%E4%B8%8B%E8%BD%BD%E4%B8%8E%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="web-containers-web容器总结"><a href="../Web-containers-web%E5%AE%B9%E5%99%A8%E6%80%BB%E7%BB%93.html">Web-containers-web容器总结</a></h1>
<h1 id="preface">Preface</h1>
<p><a href="https://docs.oracle.com/en/middleware/fusion-middleware/weblogic-server/index.html" target="_blank" rel="noopener">官方安装文档</a></p>
<h2 id="step-1-确保已正确安装jdk">step 1 确保已正确安装JDK</h2>
<p>JDK安装：  <a href="../Install-Multiple-Java-Versions-on-Mac-by-Homebrew-Cask.html">Install Multiple Java Versions on Mac by Homebrew Cask</a></p>
<blockquote>
<p>Verify that a certified JDK already exists on your system; the installer requires a certified JDK. See <a href="https://docs.oracle.com/pls/topic/lookup?ctx=en/middleware/standalone/weblogic-server/14.1.1.0/wlsig&amp;id=fmwsysreq" target="_blank" rel="noopener">Oracle Fusion Middleware Supported System Configurations</a>. To download the JDK, see <a href="https://docs.oracle.com/pls/topic/lookup?ctx=en/middleware/standalone/weblogic-server/14.1.1.0/wlsig&amp;id=ASINS-GUID-8AA3A3BA-27F0-43B8-8F62-1B2DC8C5DBB1" target="_blank" rel="noopener">About JDK Requirements for an Oracle Fusion Middleware Installation</a>.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure>
<h2 id="step-2-下载安装">step 2 下载安装</h2>
<p><a href="https://www.oracle.com/middleware/technologies/fusionmiddleware-downloads.html" target="_blank" rel="noopener">官方下载地址1</a><br>
<a href="https://www.oracle.com/middleware/technologies/weblogic-server-installers-downloads.html" target="_blank" rel="noopener">官方下载地址2</a></p>
<p>选择 “Generic Installer”，下载<code>fmw_14.1.1.0.0_wls_lite_Disk1_1of1.zip</code>.</p>
<p>解压<code>fmw_14.1.1.0.0_wls_lite_Disk1_1of1.zip</code>文件，得到安装包<code>fmw_14.1.1.0.0_wls_lite_generic.jar</code>文件。</p>
<p>安装：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -jar fmw_14.1.1.0.0_wls_lite_generic.jar</span><br></pre></td></tr></table></figure>
<h2 id="step-3-部署配置">step 3 部署配置</h2>
<p>出现图形化安装界面，大多数都选择默认。</p>
<p>创建管理账户和域：<br>
<img src="https://img-blog.csdnimg.cn/20200415100633131.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM4MTEyNDc1,size_16,color_FFFFFF,t_70" alt="创建管理账户和域"></p>
<p>域创建结束后就可以启动weblogic了。</p>
<h2 id="step-4-启动-关闭weblogic">step 4 启动/关闭weblogic</h2>
<h3 id="start-关闭weblogic">start 关闭weblogic</h3>
<p>Window 系统则使用./startWebLogic.cmd</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;weblogicFoder&gt;/user_projects/domains/base_domain</span><br><span class="line">./startWebLogic.sh</span><br></pre></td></tr></table></figure>
<p>浏览器登陆<a href="http://localhost:7001/console/" target="_blank" rel="noopener">http://localhost:7001/console/</a>进入weblogic控制台。</p>
<h3 id="stop-关闭weblogic">stop 关闭weblogic</h3>
<blockquote>
<p><a href="https://docs.oracle.com/en/middleware/standalone/weblogic-server/14.1.1.0/start/overview.html#GUID-9AD29794-B51A-4DFC-9DBD-6D1EAD9AECFE" target="_blank" rel="noopener">Shutting Down Instances of WebLogic Server</a></p>
</blockquote>
<p>Window 系统则使用./stopWebLogic.cmd</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;weblogicFoder&gt;/user_projects/domains/base_domain/bin</span><br><span class="line">./stopWebLogic.sh</span><br></pre></td></tr></table></figure>
<h2 id="配置文件">配置文件</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;weblogicFoder&gt;/user_projects/domains/base_domain/config</span><br><span class="line">vim config.xml</span><br></pre></td></tr></table></figure>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://www.cnblogs.com/xdp-gacl/p/4140683.html" target="_blank" rel="noopener">WebLogic使用总结(一)——WebLogic安装</a></li>
<li><a href="https://cloud.tencent.com/developer/article/1501376" target="_blank" rel="noopener">Weblogic运维使用手册</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>WebContainer</tag>
      </tags>
  </entry>
  <entry>
    <title>Vscode 配置和插件</title>
    <url>/Vscode-%E9%85%8D%E7%BD%AE%E5%92%8C%E6%8F%92%E4%BB%B6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="vscode-基本使用">VSCode 基本使用</h1>
<ul>
<li><a href="https://github.com/qianguyihao/Web/blob/master/00-%E5%89%8D%E7%AB%AF%E5%B7%A5%E5%85%B7/01-VS%20Code%E7%9A%84%E4%BD%BF%E7%94%A8.md" target="_blank" rel="noopener">VSCode的使用-Git 详细介绍</a></li>
<li><a href="./VSCode-%E5%BF%AB%E6%8D%B7%E9%94%AE.html">VSCode的常用快捷键</a>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/44044896" target="_blank" rel="noopener">VSCode的常用快捷键</a></li>
</ul>
</li>
<li>同步Vscode设置： built-in <a href="https://code.visualstudio.com/docs/editor/settings-sync" target="_blank" rel="noopener">Settings Sync</a> functionality</li>
</ul>
<h1 id="插件">插件</h1>
<h2 id="setting-sync在线同步vscode设置"><a href="http://shanalikhan.github.io/2015/12/15/Visual-Studio-Code-Sync-Settings.html" target="_blank" rel="noopener">setting sync在线同步Vscode设置</a></h2>
<p>弃用， This extension is deprecated as it is no longer being maintained. Please use the built-in <a href="https://code.visualstudio.com/docs/editor/settings-sync" target="_blank" rel="noopener">Settings Sync</a> functionality instead.</p>
<p><s><a href="http://www.chengpengfei.com/2018/08/27/" target="_blank" rel="noopener">使用方法</a></s></p>
<ul>
<li>
<p><s>如果是第一次使用，点击“Login with github”直接用github账号登陆，可以直接自动生成token，不需要自己手动生成。</s></p>
</li>
<li>
<p><s>即使你更换了新电脑B，只要你记得第三个步骤里保存的 Gist ID 和 Access token，同步也是非常方便的。</s></p>
<ul>
<li><s>不记得的话 老电脑A cmd + shift + P –&gt; sync 高级选项 Advanced Options –&gt; Open setting 里面有Access Token 和 Gist ID。</s></li>
<li><s>你可以通过 新电脑B cmd + shift + P –&gt; sync 高级选项 Advanced Options –&gt; 编辑本地扩展设置 syncLocalSettings ，将你的 token 粘贴在配置文件里，然后再执行同步/下载的配置即可。</s></li>
</ul>
</li>
<li>
<p><s>cmd + shift + P –&gt; sync 高级选项 Advanced Options –&gt; Open setting 里勾选Auto Download， Auto Upload， Remove Extensions<br>
Sync Extensions。</s></p>
</li>
</ul>
<h2 id="markdown-extension-pack"><a href="https://marketplace.visualstudio.com/items?itemName=bat67.markdown-extension-pack" target="_blank" rel="noopener">Markdown Extension Pack</a></h2>
<h2 id="gitlens">GitLens</h2>
<p><a href="https://cloud.tencent.com/developer/article/1810324" target="_blank" rel="noopener">VSCode 插件之 - GitLens</a></p>
<h1 id="设置">设置</h1>
<h2 id="代码高亮颜色设置">代码高亮颜色设置</h2>
<ol>
<li>
<p>File-》Preferences-》settings</p>
</li>
<li>
<p>在search settings中输入workbench.colorCustomizations</p>
</li>
</ol>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"workbench.colorCustomizations": &#123;</span><br><span class="line">  "editor.selectionBackground": "#135564", // 选中代码后，当前选中部分显示的颜色</span><br><span class="line">  "editor.selectionHighlightBackground": "#f9e44ae0", // 选中代码后，相同代码显示的颜色</span><br><span class="line">  "editor.lineHighlightBackground": "#f9c1c168", // 光标所在行的背景颜色</span><br><span class="line">  "editor.lineHighlightBorder": "#f8bcbc80" // 光标所在行的背景边框颜色</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="links">Links</h1>
<p><a href="https://juejin.im/post/5db66672f265da4d0e009aad#heading-31" target="_blank" rel="noopener">VSCode前端必备插件，有可能你装了却不知道如何使用？</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>VSCode</tag>
      </tags>
  </entry>
  <entry>
    <title>Z-index</title>
    <url>/Z-index.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://webdesign.tutsplus.com/zh-hans/articles/what-you-may-not-know-about-the-z-index-property--webdesign-16892" target="_blank" rel="noopener">关于z-index 那些你不知道的事</a></li>
</ul>
<!-- - [官方文档中文版：hooks](https://zh-hans.reactjs.org/docs/hooks-intro.html) -->]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>TODO</tag>
      </tags>
  </entry>
  <entry>
    <title>`delete`和Array.splice的区别[JavaScript]</title>
    <url>/delete-%E5%92%8CArray-splice%E7%9A%84%E5%8C%BA%E5%88%AB-JavaScript.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="delete"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/delete" target="_blank" rel="noopener"><code>delete</code></a></h2>
<p><code>delete</code> will delete the object property, but will not <strong>reindex</strong> the array or update its length. This makes it appears as if it is <code>undefined</code>:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Array</span></span><br><span class="line"><span class="keyword">const</span> myArray = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>];</span><br><span class="line">myArray.length  <span class="comment">// 4</span></span><br><span class="line"><span class="keyword">delete</span> myArray[<span class="number">0</span>];</span><br><span class="line">myArray.length  <span class="comment">// 4  不会重新index, 所以length也不会改变</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Note that it is not in fact set to the value undefined, rather the property is removed from the array, making it appear undefined.</span></span><br><span class="line">myArray[<span class="number">0</span>];   <span class="comment">// undefined</span></span><br><span class="line"><span class="comment">// The Chrome dev tools make this distinction clear by printing empty when logging the array.</span></span><br><span class="line">myArray <span class="comment">// [empty, "b", "c", "d"]</span></span><br></pre></td></tr></table></figure>
<p>但是当<code>delete</code> Object的property时候就没有这个问题：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Object</span></span><br><span class="line"><span class="keyword">const</span> myArray = &#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>, <span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'d'</span>: <span class="number">4</span>&#125;;</span><br><span class="line"><span class="built_in">Object</span>.keys(myArray).length <span class="comment">// 4</span></span><br><span class="line"><span class="keyword">delete</span> myArray[<span class="string">'a'</span>]</span><br><span class="line"><span class="built_in">Object</span>.keys(myArray).length <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line">myArray[<span class="string">'a'</span>] <span class="comment">// undefined</span></span><br><span class="line">myArray <span class="comment">// &#123;b: 2, c: 3, d: 4&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="array-splice"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice" target="_blank" rel="noopener">Array.splice</a></h2>
<p><code>myArray.splice(start, deleteCount)</code> actually removes the element, reindexes the array, and changes its length.<br>
实际上删除元素，重新索引数组，并更改其长度.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&gt; myArray = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line">  [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>]</span><br><span class="line">&gt; myArray.splice(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">  [<span class="string">"a"</span>, <span class="string">"b"</span>]</span><br><span class="line">&gt; myArray</span><br><span class="line">  [<span class="string">"c"</span>, <span class="string">"d"</span>]</span><br></pre></td></tr></table></figure>
<h3 id="array-remove-of-jquery"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice" target="_blank" rel="noopener">Array.remove of jQuery</a></h3>
<p>John Resig, creator of jQuery created a very handy Array.remove method that I always use it in my projects.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Array Remove - By John Resig (MIT Licensed)</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.remove = <span class="function"><span class="keyword">function</span>(<span class="params">from, to</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> rest = <span class="keyword">this</span>.slice((to || <span class="keyword">from</span>) + <span class="number">1</span> || <span class="keyword">this</span>.length);</span><br><span class="line">  <span class="keyword">this</span>.length = <span class="keyword">from</span> &lt; <span class="number">0</span> ? <span class="keyword">this</span>.length + <span class="keyword">from</span> : <span class="keyword">from</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.push.apply(<span class="keyword">this</span>, rest);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>and here’s some examples of how it could be used:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Remove the second item from the array</span></span><br><span class="line">array.remove(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// Remove the second-to-last item from the array</span></span><br><span class="line">array.remove(<span class="number">-2</span>);</span><br><span class="line"><span class="comment">// Remove the second and third items from the array</span></span><br><span class="line">array.remove(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="comment">// Remove the last and second-to-last items from the array</span></span><br><span class="line">array.remove(<span class="number">-2</span>,<span class="number">-1</span>);</span><br></pre></td></tr></table></figure>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/delete" target="_blank" rel="noopener">MDN <code>delete</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice" target="_blank" rel="noopener">MDN Array.splice</a></li>
<li><a href="https://stackoverflow.com/questions/500606/deleting-array-elements-in-javascript-delete-vs-splice" target="_blank" rel="noopener">What is the difference between using the delete operator on the array element as opposed to using the Array.splice method?</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>JavaScript</category>
      </categories>
  </entry>
  <entry>
    <title>cURL</title>
    <url>/cURL.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/CURL" target="_blank" rel="noopener">cURL维基百科</a></li>
<li><a href="https://curl.se/" target="_blank" rel="noopener">cURL官网</a></li>
<li><a href="https://github.com/curl/curl" target="_blank" rel="noopener">cURL Github</a></li>
<li><a href="https://www.ruanyifeng.com/blog/2011/09/curl.html" target="_blank" rel="noopener">阮一峰的网络日志：《curl 初学者教程》</a></li>
<li><a href="https://www.ruanyifeng.com/blog/2019/09/curl-reference.html" target="_blank" rel="noopener">阮一峰的网络日志：curl 的用法指南</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Linux/bash</category>
      </categories>
      <tags>
        <tag>Command line</tag>
        <tag>LinksSummary</tag>
      </tags>
  </entry>
  <entry>
    <title>cryptic abbreviations of Github comments</title>
    <url>/cryptic-abbreviations-of-Github-comments.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>我们Github code review 的时候第一次遇到这些缩写时，一脸懵逼，一无所知脸的偷偷去搜搜是什么意思？<br>
这里整理一下这些缩写都是什么含义，以后我们也可以欢快地装逼了，装作娴熟的司机们来使用缩写来达到提高逼格的效果~~</p>
<ul>
<li>PR: Pull Request. 拉取请求，给其他项目提交代码</li>
<li>LGTM: Looks Good To Me. <s>朕知道了</s> 代码已review，可以合并</li>
<li>SGTM: Sounds Good To Me. 和上面那句意思差不多，也是已经通过了 review 的意思</li>
<li>ACK — acknowledgement, i.e. agreed/accepted change 同意/接受改动</li>
<li>NACK/NAK —negative acknowledgement, i.e. disagree with change and/or concept 不同意/接受改动</li>
<li>RFC — request for comments, i.e. I think this is a good idea, lets discuss 我觉得不错，你怎么看？</li>
<li>AFAIK/AFAICT — as far as I know / can tell 据我所知</li>
<li>IIRC — if I recall correctly 如果我recall的正确的话</li>
<li>IANAL — “I am not a lawyer”, but I smell licensing issues</li>
<li>WIP: Work In Progress, do not merge yet. 传说中提 PR 的最佳实践是，如果你有个改动很大的 PR，可以在写了一部分的情况下先提交，但是在标题里写上 WIP，以告诉项目维护者这个功能还未完成，方便维护者提前 review 部分提交的代码。</li>
<li>PTAL: Please Take A Look. 你来瞅瞅？用来提示别人来看一下</li>
<li>TBR: To Be Reviewed. 提示维护者进行 review</li>
<li>TL;DR: Too Long; Didn’t Read. 太长懒得看。也有很多文档在做简略描述之前会写这么一句</li>
<li>TBD: To Be Done(or Defined/Discussed/Decided/Determined). 根据语境不同意义有所区别，但一般都是还没搞定的意思</li>
<li>NIT: Sometimes the reviewer will prefix his comments with “Nit:”. This means that he’s just “nitpicking” – you don’t have to fix these points, but we’d like you to. 指&quot;吹毛求疵&quot;, 小问题（small or unimportant errors or faults），不强制要求修改，但建议修改。</li>
</ul>
<p>有些也使用比特币的黑客术语：</p>
<ul>
<li>Concept ACK — agree with the concept, but haven’t reviewed the changes 理论上同意，但我还没review过。。。</li>
<li>utACK (aka. Untested ACK) — agree with the changes and reviewed them, but didn’t test review过并同意改动，但我没测过~~~</li>
<li>Tested ACK — agree with the changes, reviewed and tested 同意改动，我也review过并测过了</li>
</ul>
<p>Reference links:<br>
<a href="https://farer.org/2017/03/01/code-review-acronyms/" target="_blank" rel="noopener">LGTM? 那些迷之缩写</a><br>
<a href="https://www.freecodecamp.org/news/what-do-cryptic-github-comments-mean-9c1912bcc0a4/" target="_blank" rel="noopener">What do cryptic Github comments mean?</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>SE life</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>abbr</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo deploy error with wrong git user</title>
    <url>/hexo-deploy-error-with-wrong-git-user.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="error">error</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo d</span><br><span class="line">(node:52405) ExperimentalWarning: The fs.promises API is experimental</span><br><span class="line">INFO  [hexo-math] Using engine <span class="string">'mathjax'</span></span><br><span class="line">INFO  DPlayer.min.css is not found <span class="keyword">in</span> this version of dplayer, skip it.</span><br><span class="line">INFO  Deploying: git</span><br><span class="line">INFO  Clearing .deploy_git folder...</span><br><span class="line">INFO  Copying files from public folder...</span><br><span class="line">INFO  Copying files from extend <span class="built_in">dirs</span>...</span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line">remote: Permission to yourGitUserName/yourGitUserName.github.io.git denied to anotherGitUserName.</span><br><span class="line">fatal: unable to access <span class="string">'https://github.com/yourGitUserName/yourGitUserName.github.io/'</span>: The requested URL returned error: 403</span><br><span class="line">FATAL Something<span class="string">'s wrong. Maybe you can find the solution here: https://hexo.io/docs/troubleshooting.html</span></span><br><span class="line"><span class="string">Error: Spawn failed</span></span><br><span class="line"><span class="string">    at ChildProcess.task.on.code (/Users/yuanli/GitRepos/LYKGit/Blog/Hexo-theme-zilan/node_modules/hexo-deployer-git/node_modules/hexo-util/lib/spawn.js:51:21)</span></span><br><span class="line"><span class="string">    at ChildProcess.emit (events.js:189:13)</span></span><br><span class="line"><span class="string">    at Process.ChildProcess._handle.onexit (internal/child_process.js:248:12)</span></span><br></pre></td></tr></table></figure>
<p>这个报错<code>remote: Permission to yourGitUserName/yourGitUserName.github.io.git denied to anotherGitUserName.</code>表明使用错了这个repo的username，<code>anotherGitUserName</code>是我另一个repo的用户名，所以解决方法是设置对username。</p>
<h3 id="检查git-config-user-name">检查git config <a href="http://user.name" target="_blank" rel="noopener">user.name</a></h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global --list</span><br><span class="line">git config --<span class="built_in">local</span> --list</span><br><span class="line">user.name=xxx</span><br></pre></td></tr></table></figure>
<p>如果不正确，设置正确</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name <span class="string">"XXX</span></span><br><span class="line"><span class="string">git config --local user.name "</span>XXX</span><br></pre></td></tr></table></figure>
<p>发现还是不行，后来突然意识到这个设置的是hexo的这个repo使用的username, 而不是deploy到的那个repo的username</p>
<h3 id="改变deploy到repo的username">改变deploy到repo的username</h3>
<p>修改hexo repo里面的<code>_config.yml</code><br>
Make sure your <code>_config.yml</code> file in your Hexo project contains the correct repository URL and branch information under the deploy section. For example:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/yourusername/yourusername.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">gh-pages</span></span><br></pre></td></tr></table></figure>
<p>修改为：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://yourusername@github.com/yourusername/yourusername.github.io.git</span> <span class="comment"># 指定user</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">gh-pages</span></span><br><span class="line">  <span class="attr">token:</span> <span class="string">$LYK_GIT_TOKEN</span></span><br></pre></td></tr></table></figure>
<p>如果使用git token, 可以在<a href="https://hexo.io/zh-cn/docs/one-command-deployment.html#google_vignette" target="_blank" rel="noopener"><code>_config.yml</code>指定token</a></p>
<blockquote>
<p>Token Authentication: If you are using a private repository or facing authentication issues, consider using a personal access token instead of your GitHub password. Generate a personal access token on GitHub and use it as the password when prompted. “令牌身份验证：如果您正在使用私有仓库或遇到身份验证问题，请考虑使用个人访问令牌代替您的 GitHub 密码。在 GitHub 上生成个人访问令牌，并在提示时将其用作密码。”</p>
</blockquote>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Blog</tag>
      </tags>
  </entry>
  <entry>
    <title>husky with sourcetree Cant find node in PATH, trying to find a node binary on your system</title>
    <url>/husky-with-sourcetree-Cant-find-node-in-PATH-trying-to-find-a-node-binary-on-your-system.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>如果在 git GUI 软件, 例如sourcetree遇到 <code>pre-commit</code> / <code>pre-push</code> 报错找不到 yarn，可以参考这个 husky 的官方方案: <a href="https://github.com/typicode/husky/issues/390#issuecomment-1082345670" target="_blank" rel="noopener">https://github.com/typicode/husky/issues/390#issuecomment-1082345670</a></p>
<h2 id="solution">Solution</h2>
<ul>
<li>Create <code>~/.huskyrc</code> file in my home directory</li>
<li>With this content:<br>
如果使用<code>nvm</code>来管理node版本：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Load Yarn command coming from homebrew</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">"/opt/homebrew/bin/:<span class="variable">$PATH</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This loads nvm.sh and sets the correct PATH before running hook</span></span><br><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">"<span class="variable">$HOME</span>/.nvm"</span></span><br><span class="line">[ -s <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span> ] &amp;&amp; \. <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span></span><br><span class="line"></span><br><span class="line">nvm use default</span><br></pre></td></tr></table></figure>
<p>或者制定node版本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="string">"/opt/homebrew/bin/: <span class="variable">$PATH</span>"</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">"/opt/homebrew/opt/node@18/bin: <span class="variable">$PATH</span>"</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>Environment setup</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo-reference path for link to another blog post</title>
    <url>/hexo-reference%20path%20for%20link%20to%20another%20blog%20post.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="需求">需求</h2>
<p>Hexo blog里面，需要一篇文章里link到另一篇文章。最好是相对路径，绝对路径容易出错，而且不灵活，一换域名所有的link都不能用了。</p>
<h2 id="hexo的路径生成">Hexo的路径生成</h2>
<p>我们可以看到Hexo的路径生成：</p>
<p>例子1：<br>
<a href="http://localhost:4000/2019/06/11/BlogName1/" target="_blank" rel="noopener">http://localhost:4000/2019/06/11/BlogName1/</a></p>
<p>例子2：<br>
<a href="http://liyuankun.top/2019/06/11/Changing-SSL-port-from-8443-to-443/">http://liyuankun.top/2019/06/11/Changing-SSL-port-from-8443-to-443/</a></p>
<blockquote>
<p>域名：端口/YYYY/MM/DD/BlogName</p>
</blockquote>
<blockquote>
<p>域名/YYYY/MM/DD/BlogName</p>
</blockquote>
<p>YYYY/MM/DD 是BlogName的创建时间，date: 2019-06-11 16:55:24</p>
<h2 id="解决方法">解决方法</h2>
<p>例子1：</p>
<p>在BlogName1里面link到BlogName2 的链接就为：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">当_config.yml  permalink: :year/:month/:day/:title/</span><br><span class="line">[<span class="string">BlogName2</span>](<span class="link">../../../../2019/06/11/BlogName2</span>)</span><br><span class="line">或</span><br><span class="line">当_config.yml permalink: :title.html</span><br><span class="line">[<span class="string">BlogName2</span>](<span class="link">../BlogName2.html</span>)</span><br></pre></td></tr></table></figure>
<p>2019/06/11 必须是BlogName2的date</p>
<p>例子2：</p>
<p>本篇文章link到文章“Changing SSL port from 8443 to 443”</p>
<p>markdown写为：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">当_config.yml  permalink: :year/:month/:day/:title/</span><br><span class="line"></span><br><span class="line">[<span class="string">Changing-SSL-port-from-8443-to-443</span>](<span class="link">../../../../2019/06/11/Changing-SSL-port-from-8443-to-443/</span>)</span><br><span class="line">或</span><br><span class="line">当_config.yml permalink: :title.html</span><br><span class="line">[<span class="string">Changing-SSL-port-from-8443-to-443</span>](<span class="link">../Changing-SSL-port-from-8443-to-443.html</span>)</span><br></pre></td></tr></table></figure>
<p>效果为：<br>
当_config.yml  permalink: :year/:month/:day/:title/<br>
<a href="../../../../2019/06/11/Changing-SSL-port-from-8443-to-443/">Changing-SSL-port-from-8443-to-443</a><br>
或<br>
当_config.yml permalink: :title.html<br>
<a href="../Changing-SSL-port-from-8443-to-443.html">Changing-SSL-port-from-8443-to-443</a></p>
<h2 id="参考">参考</h2>
<p><a href="https://markdown-zh.readthedocs.io/en/latest/spanelements/" target="_blank" rel="noopener">Markdown 中文文档 内联元素</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Blog</tag>
      </tags>
  </entry>
  <entry>
    <title>[Hexo] Theme Zilan</title>
    <url>/hexo-theme-zilan.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>Ported Theme of <a href="https://github.com/Huxpro/huxpro.github.io" target="_blank" rel="noopener">Hux Blog</a>, Thank <a href="https://github.com/Huxpro" target="_blank" rel="noopener">Huxpro</a> for designing such a flawless theme.</p>
<p>This Zilan theme created by <a href="https://catherineliyuankun.github.io/" target="_blank" rel="noopener">YuankunLi</a> modified from the original Porter <a href="http://kaijun.rocks/hexo-theme-huxblog/" target="_blank" rel="noopener">Kaijun</a> and <a href="http://beantech.org/" target="_blank" rel="noopener">YuHsuan</a></p>
</blockquote>
<h1 id="demo-live-demo">Demo <a href="https://catherineliyuankun.github.io/" target="_blank" rel="noopener">Live Demo</a></h1>
<hr>
<p><a href="https://catherineliyuankun.github.io/" target="_blank" rel="noopener">Zilan Blog</a></p>
<h1 id="usage">Usage</h1>
<hr>
<p>I publish the whole project for your convenience, so you can just follow the instruction down below, then you can easily customiz your own blog!</p>
<p>Let’s begin!!!</p>
<h2 id="init">Init</h2>
<hr>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/catherineliyuankun/hexo-theme-zilan.git ./hexo-zilan</span><br><span class="line"><span class="built_in">cd</span> hexo-zilan</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>
<h2 id="modify">Modify</h2>
<hr>
<p>Modify <code>_config.yml</code> file with your own info.<br>
Especially the section:</p>
<h3 id="deployment">Deployment</h3>
<p>Replace to your own repo!</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/&lt;yourAccount&gt;/&lt;repo&gt;</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">&lt;your-branch&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="sidebar-settings">Sidebar settings</h3>
<p>Copy your avatar image to <code>&lt;root&gt;/img/</code> and modify the <code>_config.yml</code>:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">sidebar:</span> <span class="literal">true</span>    <span class="comment"># whether or not using Sidebar.</span></span><br><span class="line"><span class="attr">sidebar-about-description:</span> <span class="string">"&lt;your description&gt;"</span></span><br><span class="line"><span class="attr">sidebar-avatar:</span> <span class="string">img/&lt;your</span> <span class="string">avatar</span> <span class="string">path&gt;</span></span><br></pre></td></tr></table></figure>
<p>and activate your personal widget you like</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">widgets:</span>         <span class="comment"># here are widget you can use, you can comment out</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">featured-tags</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">short-about</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">recent-posts</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">friends-blog</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">archive</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">category</span></span><br></pre></td></tr></table></figure>
<p>if you want to add sidebar widget, please add at <code>layout/_widget</code>.</p>
<h3 id="signature-setup">Signature Setup</h3>
<p>Copy your signature image to <code>&lt;root&gt;/img/signature</code> and modify the <code>_config.yml</code>:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">signature:</span> <span class="literal">true</span>   <span class="comment"># show signature</span></span><br><span class="line"><span class="attr">signature-img:</span> <span class="string">img/signature/&lt;your-signature-ID&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="go-to-top-icon-setup">Go to top icon Setup</h3>
<p>My icon is using iron man, you can change to your own icon at <code>css/image</code>.</p>
<h3 id="post-tag-and-category">Post tag and category</h3>
<p>You can decide to show post tags and categories or not.</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">home_posts_tag:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">home_posts_category:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/hexotheme/home_posts_tag-true.png" alt="home_posts_tag-true"></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">home_posts_tag:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">home_posts_category:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/hexotheme/home_posts_tag-false.png" alt="home_posts_tag-false"></p>
<h3 id="page-header-category">Page Header category</h3>
<p>You can decide to show page_header categories or not.</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">page_header_category:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/hexotheme/page_header_category-true.png" alt="page_header_category-true"></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">page_header_category:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/hexotheme/page_header_category-false.png" alt="page_header_category-false"></p>
<h3 id="forkme">forkme</h3>
<p>forkme: false # Fork me on GitHub<br>
forkme-url: <a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan" target="_blank" rel="noopener">https://github.com/CatherineLiyuankun/Hexo-theme-zilan</a> # GitHub url</p>
<h3 id="donate">donate</h3>
<p>donate: true<br>
donate-alipay: <a href="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/alipay.png" target="_blank" rel="noopener">https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/alipay.png</a><br>
donate-wechat: <a href="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/wechatpay.png" target="_blank" rel="noopener">https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/wechatpay.png</a></p>
<h3 id="markdown-render">Markdown render</h3>
<p>My markdown render engine plugin is <a href="https://github.com/celsomiranda/hexo-renderer-markdown-it" target="_blank" rel="noopener">hexo-renderer-markdown-it</a>.</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Markdown-it config</span></span><br><span class="line"><span class="comment">## Docs: https://github.com/celsomiranda/hexo-renderer-markdown-it/wiki</span></span><br><span class="line"><span class="attr">markdown:</span></span><br><span class="line">  <span class="attr">render:</span></span><br><span class="line">    <span class="attr">html:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">xhtmlOut:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">breaks:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">linkify:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">typographer:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">quotes:</span> <span class="string">'“”‘’'</span></span><br></pre></td></tr></table></figure>
<p>and if you want to change the header anchor ‘ℒ’, you can go to <code>layout/post.ejs</code> to change it.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span>(<span class="string">"https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        anchors.options = &#123;</span><br><span class="line">          visible: <span class="string">'hover'</span>,</span><br><span class="line">          placement: <span class="string">'left'</span>,</span><br><span class="line">          icon: ℒ <span class="comment">// this is the header anchor "unicode" icon</span></span><br><span class="line">        &#125;;</span><br></pre></td></tr></table></figure>
<h2 id="hexo-basics">Hexo Basics</h2>
<hr>
<p>Some hexo command:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new post <span class="string">"&lt;post name&gt;"</span> <span class="comment"># you can change post to another layout if you want</span></span><br><span class="line">hexo clean &amp;&amp; hexo generate <span class="comment"># generate the static file</span></span><br><span class="line">hexo server <span class="comment"># run hexo in local environment</span></span><br><span class="line">hexo deploy <span class="comment"># hexo will push the static files automatically into the specific branch(gh-pages) of your repo!</span></span><br></pre></td></tr></table></figure>
<h1 id="start-your-own-blog">Start your own blog!</h1>
<hr>
<!-- Place this tag in your head or just before your close body tag. -->
<script async defer src="https://buttons.github.io/buttons.js"></script>
<!-- Place this tag where you want the button to render. -->
<p>Please <a class="github-button" href="https://github.com/catherineliyuankun/hexo-theme-zilan.git" data-icon="octicon-star" aria-label="Star Li,Yuankun/hexo-theme-zilan on GitHub" target="_blank" rel="noopener">Star</a> this Project if you like it! <a class="github-button" href="https://github.com/CatherineLiyuankun" aria-label="Follow @CatherineLiyuankun on GitHub" target="_blank" rel="noopener">Follow</a> would also be appreciated!<br>
Peace!</p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Blog</tag>
      </tags>
  </entry>
  <entry>
    <title>nano编辑器使用&amp;快捷键-Linux</title>
    <url>/nano%E7%BC%96%E8%BE%91%E5%99%A8%E4%BD%BF%E7%94%A8-%E5%BF%AB%E6%8D%B7%E9%94%AE-Linux.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="使用nano编辑器">使用nano编辑器</h1>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 编辑1.yaml文件，如果1.yaml文件不存在则新建</span></span><br><span class="line">nano 1.yaml</span><br><span class="line"><span class="comment"># 粘贴+编辑</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存 control + o</span></span><br><span class="line"><span class="comment"># 退出 control + x</span></span><br></pre></td></tr></table></figure>
<h2 id="nano快捷键">nano快捷键</h2>
<p>nano中被称为&quot;快捷方式&quot;，例如保存，退出，对齐等。最常见的功能在屏幕底部列出，但还有许多其他功能。</p>
<!-- 请注意，nano不使用快捷键中的<kbd>Shift</kbd>键。 所有快捷方式均使用小写字母和未修改的数字键，因此<kbd>Ctrl</kbd> + <kbd>G</kbd>不是<kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>G</kbd>。 -->
<ul>
<li>
<p>光标控制</p>
<ul>
<li>移动光标：使用用方向键移动。</li>
<li>选择文字：按住鼠标左键拖动</li>
<li>^A        move to the beginning of the current line.<br>
^E        move to the End of the current line.</li>
</ul>
</li>
<li>
<p>复制、剪贴和粘贴</p>
<!-- - 复制一整行：<kbd>option</kbd> + <kbd>6</kbd> -->
<ul>
<li>复制和粘贴快捷键<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>c</kbd> and <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>v</kbd></li>
<li>剪切一整行<kbd>control</kbd>  + <kbd>K</kbd></li>
<li>在当前光标处插入上次剪切的内容<kbd>control</kbd>  + <kbd>U</kbd></li>
</ul>
</li>
<li>
<p>选中：<kbd>control</kbd>  + <kbd>U</kbd></p>
<ul>
<li>如果需要复制／剪贴多行或者一行中的一部分，先将光标移动到需要复制／剪贴的文本的开头，按<kbd>control</kbd>  + <kbd>6</kbd>（或者<kbd>option</kbd> + <kbd>A</kbd>）做标记，然后移动光标到 待复制／剪贴的文本末尾。</li>
<li>这时选定的文本会反白，用<kbd>option</kbd> + <kbd>6</kbd>来复制，<kbd>control</kbd>  + <kbd>K</kbd> 来剪贴。若在选择文本过程中要取消，只需要再按一次<kbd>control</kbd>  + <kbd>6</kbd>。</li>
</ul>
</li>
<li>
<p>保存</p>
<ul>
<li>使用<kbd>control</kbd> + <kbd>O</kbd>来保存所做的修改</li>
</ul>
</li>
<li>
<p>退出</p>
<ul>
<li>按<kbd>control</kbd> + <kbd>X</kbd></li>
<li>如果你修改了文件，下面会询问你是否需要保存修改。
<ul>
<li>输入<kbd>Y</kbd>确认保存，输入<kbd>N</kbd>不保存，按<kbd>control</kbd>  + <kbd>U</kbd>取消返回。</li>
<li>如果输入了<kbd>Y</kbd>，下一步会让你输入想要保存的文件名。
<ul>
<li>如果不需要修改文件名直接回车就行；若想要保存成别的名字（也就是另存为）则输入新名称然后回车。这个时候也可用<kbd>control</kbd>  + <kbd>U</kbd>来取消返回。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Undo</p>
<ul>
<li><kbd>Meta</kbd> + <kbd>u</kbd></li>
<li>考试环境 + MAC OS 上的<kbd>Meta</kbd>实测是<kbd>Esc</kbd></li>
</ul>
</li>
<li>
<p>Redo</p>
<ul>
<li><kbd>Meta</kbd> + <kbd>e</kbd></li>
</ul>
</li>
<li>
<p>搜索</p>
<ul>
<li>按<kbd>control</kbd>  + <kbd>W</kbd>，然后输入你要搜索的关键字，回车确定。这将会定位到第一个匹配的文本，接着可以用<kbd>option</kbd> + <kbd>W</kbd>来定位到下一个匹配的文本。</li>
</ul>
</li>
<li>
<p>翻页</p>
<ul>
<li><kbd>control</kbd>  + <kbd>Y</kbd>到上一页 <kbd>control</kbd>  + <kbd>V</kbd>到下一页</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>  ^G (F1)   Display this help text.
</code></pre>
</blockquote>
<pre><code>    ^F        move Forward a character.
    ^B        move Backward a character.
    ^P        move to the Previous line.
    ^N        move to the Next line.
    ^A        move to the beginning of the current line.
    ^E        move to the End of the current line.
    ^V (F8)   move forward a page of text.
    ^Y (F7)   move backward a page of text.

    ^W (F6)   Search for (where is) text, neglecting case.
    ^L        Refresh the display.

    ^D        Delete the character at the cursor position.
    ^^        Mark cursor position as beginning of selected text.
              Note: Setting mark when already set unselects text.
    ^K (F9)   Cut selected text (displayed in inverse characters).
              Note: The selected text's boundary on the cursor side
                    ends at the left edge of the cursor.  So, with
                    selected text to the left of the cursor, the
                    character under the cursor is not selected.
    ^U (F10)  Uncut (paste) last cut text inserting it at the
              current cursor position.
    ^I        Insert a tab at the current cursor position.

    ^J (F4)   Format (justify) the current paragraph.
              Note: paragraphs delimited by blank lines or indentation.
    ^T (F12)  To invoke the spelling checker
    ^C (F11)  Report current cursor position

    ^R (F5)   Insert an external file at the current cursor position.
    ^O (F3)   Output the current buffer to a file, saving it.
    ^X (F2)   Exit pico, saving buffer.</code></pre>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Linux/bash</category>
      </categories>
      <tags>
        <tag>Command line</tag>
      </tags>
  </entry>
  <entry>
    <title>react class 组件继承</title>
    <url>/react-class-%E7%BB%84%E4%BB%B6%E7%BB%A7%E6%89%BF.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="react-class-组件继承坑点">react class 组件继承坑点</h2>
<p>A组件 extends B 组件，方法调用和改写</p>
<ul>
<li>A组件中要通过this.b调用B组件的b方法，则b方法的写法可以是箭头函数或者非箭头函数，但如果A组件中要通过super.b调用B组件中的b方法，则b的写法必须是非箭头函数。</li>
<li>如果A组件中只是要重写b方法，则b方法在B组件中如果是箭头函数的写法，在A组件中改写也必须是箭头函数的改写形式。</li>
<li>如果A组件中只是要重写b方法，则b方法在B组件中如果是非箭头函数的写法，在A组件中改写可以是箭头函数，也可以是非箭头函数。</li>
</ul>
<h2 id="参考文章">参考文章</h2>
<ul>
<li>
<p><a href="https://juejin.cn/post/7049552567746953230" target="_blank" rel="noopener">react class 组件继承坑点</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/6844903495116521486" target="_blank" rel="noopener">探索 React 中 es6 的继承机制</a></p>
</li>
<li>
<p><a href="https://zhuanlan.zhihu.com/p/57336944" target="_blank" rel="noopener">面试官问：JS的继承</a></p>
</li>
<li>
<p><a href="https://zhuanlan.zhihu.com/p/326254966" target="_blank" rel="noopener">10种React组件之间通信的方法</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/54257762/create-ref-using-react-createref-without-using-constructor-in-react" target="_blank" rel="noopener">Create Ref using React.createRef without using constructor in React?</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title>semver - 语义化版本（Semantic Versioning）规范</title>
    <url>/semver-%E8%AF%AD%E4%B9%89%E5%8C%96%E7%89%88%E6%9C%AC%EF%BC%88Semantic-Versioning%EF%BC%89%E8%A7%84%E8%8C%83.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="semver-官网-基本概念">semver 官网+基本概念</h2>
<ul>
<li><a href="https://www.npmjs.com/package/semver" target="_blank" rel="noopener">npm semver</a>
<ul>
<li><a href="https://github.com/npm/node-semver" target="_blank" rel="noopener">github npm/node-semver</a></li>
</ul>
</li>
<li><a href="https://semver.npmjs.com/" target="_blank" rel="noopener">npm semver calculator</a>
<ul>
<li><a href="https://docs.npmjs.com/about-semantic-versioning" target="_blank" rel="noopener">semantic versioning</a></li>
</ul>
</li>
<li><a href="https://juejin.cn/post/6844903516754935816" target="_blank" rel="noopener">语义化版本控制模块-Semver</a></li>
</ul>
<h3 id="x-x-通配符"><code>x、X、*</code> 通配符</h3>
<h4 id="不包括"><code>*</code> 不包括???</h4>
<ul>
<li>0.5.0-rc.1</li>
<li>1.0.0-rc.1</li>
<li>1.0.0-rc.2</li>
<li>1.0.0-rc.3</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/semver/*.png" alt="*"></p>
<h4 id="1-x-3-等同于1-x">1.x.3 等同于1.x</h4>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/semver/1.x.3.png" alt="1.x.3"></p>
<h3 id="none">^</h3>
<p><code>^</code> ：表示同一主版本号中，不小于指定版本号的版本号（允许在不修改[major, minor, patch]中最左非零数字的更改（匹配大于X、Y、Z的更新Y、Z的版本号））</p>
<p>在X.Y.Z结构的版本号中，X、Y、Z都是非负的整数，上面定义的意思就是说从左向右，遇到第一个非零数字是不可修改的，下一个数字可以更改，比如:</p>
<ul>
<li>X、Y、Z都不为0，<code>^15.6.1</code>,最左的非零数字是15，所以X是不允许更新的，也就是说主版本号不会超过15，表示的就是版本号<code>&gt;=15.6.1 &amp;&amp; &lt;16.0.0</code></li>
<li>如果X为0，那么第一个非零数字就是Y，就只能对z做出修改，<code>^0.1.2</code>表示版本号<code>&gt;=0.1.2 &amp;&amp; &lt; 0.2.0</code></li>
<li>如果X、Y的数字都是0的话，第一个非零数字就是Z，表示的就是版本号不允许更新；<code>^0.0.2</code>，主版本号和次版本号都是0，修订号为非零，表示的就是版本号<code>&gt;=0.0.2 &amp;&amp; &lt; 0.0.3</code></li>
</ul>
<p><code>^0.2.1</code> 表示 <code>&gt;=0.2.1 &amp;&amp; &lt; 0.3.0</code></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/semver/%5E0.2.1.png" alt="^0.2.1"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/semver/%5E1.2.1.png" alt="^1.2.1"></p>
<h3 id="none-v2">~</h3>
<p>~ ：表示同一主版本号和次版本号中，不小于指定版本号的版本号<br>
匹配大于X.Y.Z，更新Z的版本号</p>
<ul>
<li>X、Y、Z都不为0，<code>~1.2.3</code>表示版本号<code>&gt;=1.2.3 &amp;&amp; &lt; 1.3.0</code></li>
<li>X为0，<code>~0.2.3</code>表示版本号<code>&gt;=0.2.3 &amp;&amp; &lt; 0.3.0</code>，这种情况下，~等价于^</li>
<li>X、Y为0，<code>~0.0.3</code>表示版本号<code>&gt;=0.0.3 &amp;&amp; &lt; 0.1.0</code></li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/semver/~4.11.1.png" alt="~4.11.1"></p>
<h3 id="none-v3">-</h3>
<p><code>&gt;、&lt;、=、&gt;=、&lt;=、-</code>：用来指定一个版本号范围</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/semver/v2%20-%20v3.png" alt="v2 - v3"></p>
<h3 id="none-v4">||</h3>
<p>||：表示或<br>
<code>^2 &lt;2.2 || &gt; 2.3</code></p>
<h2 id="npm-中-package-lock-json-的一些坑">npm 中 package-lock.json 的一些坑</h2>
<p>在 npm install 后，会生成一个 package-lock.json 文件用于保存当前安装依赖的各种来源及版本号。</p>
<p>在 npm 5.4.2版本后，package-lock.json 的变动规则：</p>
<ul>
<li>当在 install dependency 的指定版本时，会自动更新 package-lock.json 文件中该 dependency 的 version 到指定的 version</li>
<li>当在 install dependency 的范围版本时
<ul>
<li>当前的 version <code>&lt;=</code> package-lock.json 文件中对应的 dependency 的 version 时，会安装 package-lock.json 中的 version；</li>
<li>当前的 version <code>&gt;</code> package-lock.json 中对应的 dependency 的 version 时，会安装当前范围版本号中最高的版本，会更新 package-lock.json 文件中对应的版本号；</li>
</ul>
</li>
</ul>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">package.json</span><br><span class="line">"antd": "^3.6.1", // eg：最新版本是 3.9.4</span><br><span class="line"></span><br><span class="line">package-lock.json</span><br><span class="line">"antd": "3.7.1",</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行npm install 会安装 3.7.1 版本</span></span><br></pre></td></tr></table></figure>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://www.jianshu.com/p/a7490344044f" target="_blank" rel="noopener">semver 语义化版本规范</a></li>
<li><a href="https://juejin.cn/post/6844903516754935816" target="_blank" rel="noopener">语义化版本控制模块-Semver</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>node.js</category>
      </categories>
      <tags>
        <tag>node.js</tag>
      </tags>
  </entry>
  <entry>
    <title>pip3 install 成功- import requests仍找不到module:ModuleNotFoundError</title>
    <url>/pip3-install-%E6%88%90%E5%8A%9F-import-requests%E4%BB%8D%E6%89%BE%E4%B8%8D%E5%88%B0module-ModuleNotFoundError.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="modulenotfounderror-报错">ModuleNotFoundError 报错</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装requests成功 -------------</span></span><br><span class="line">pip3 install requests</span><br><span class="line">Requirement already satisfied: requests <span class="keyword">in</span> /Users/yuanli/anaconda3/lib/python3.10/site-packages (2.28.1)</span><br><span class="line">Requirement already satisfied: certifi&gt;=2017.4.17 <span class="keyword">in</span> /Users/yuanli/anaconda3/lib/python3.10/site-packages (from requests) (2022.12.7)</span><br><span class="line">Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 <span class="keyword">in</span> /Users/yuanli/anaconda3/lib/python3.10/site-packages (from requests) (1.26.14)</span><br><span class="line">Requirement already satisfied: charset-normalizer&lt;3,&gt;=2 <span class="keyword">in</span> /Users/yuanli/anaconda3/lib/python3.10/site-packages (from requests) (2.0.4)</span><br><span class="line">Requirement already satisfied: idna&lt;4,&gt;=2.5 <span class="keyword">in</span> /Users/yuanli/anaconda3/lib/python3.10/site-packages (from requests) (3.4)</span><br><span class="line"><span class="comment"># 安装requests成功 -------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用import requests来验证，结果报错：仍然找不到requests module</span></span><br><span class="line">python3</span><br><span class="line">Python 3.10.8 (main, Oct 13 2022, 09:48:40) [Clang 14.0.0 (clang-1400.0.29.102)] on darwin</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import requests</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line 1, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ModuleNotFoundError: No module named <span class="string">'requests</span></span><br></pre></td></tr></table></figure>
<h2 id="解决方法">解决方法</h2>
<p>错误消息&quot;ModuleNotFoundError: 找不到名为 ‘requests’ 的模块&quot;发生的原因是Python解释器无法找到 ‘requests’ 模块，尽管已经使用pip3进行了安装。<br>
这个问题通常出现在系统上有多个Python安装，并且pip3安装与当前使用的Python版本不一致。</p>
<p>当运行Python解释器时，它显示正在使用Python 3.10.8。虽然补丁版本的差异（3.10.8与3.10）可能不是问题的原因，但是仍然值得检查pip3和python3是否引用相同的Python版本。</p>
<p>要解决这个问题，可以尝试以下步骤：</p>
<ol>
<li>验证与pip3关联的Python版本：<code>pip3 --version</code></li>
<li>检查Python路径：<br>
运行以下命令以检查Python解释器和pip3的路径：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> python3</span><br><span class="line"><span class="built_in">which</span> pip3</span><br></pre></td></tr></table></figure>
<p>尝试之后发现果然pip3 和 python3 对应的不是用一个python</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pip3 使用的是anaconda3里面带的pip3</span></span><br><span class="line">/Users/yuanli/anaconda3/bin/pip3</span><br><span class="line"><span class="comment"># python3 用的是hombrew里面安装的python</span></span><br><span class="line">python3: aliased to /opt/homebrew/Cellar/python@3.10/3.10.8/bin/python3.10</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>修改<code>~/.bash_profile</code>里面python3的路径</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 根据anaconda版本可能是/anaconda 或者/anaconda2 或者/anaconda3 目录名</span></span><br><span class="line"><span class="built_in">alias</span> python3=/Users/yuanli/anaconda3/bin/python <span class="comment"># yuanli修改为你的机器名</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Language</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Command line</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>__webpack_hmr 404 (Not Found)</title>
    <url>/webpack-hmr-404-Not-Found.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>调试 <code>webpack-dev-server</code> 和 <code>webpack-dev-middleware</code> 的时候，突然发现了控制台出现了一个错误提示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GET http://localhost:8080/__webpack_hmr 404 (Not Found)</span><br></pre></td></tr></table></figure>
<p>webpack.config.js 配置文件：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  entry: [</span><br><span class="line">    <span class="string">'webpack-hot-middleware/client'</span>,</span><br><span class="line">    <span class="string">'./src/index.js'</span></span><br><span class="line">  ],</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">    open: <span class="literal">true</span>,</span><br><span class="line">    inline: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现入口文件有一个 webpack-hot-middleware/client，经过一番搜索，在 Stack Overflow 有一个类似的提问 <a href="https://stackoverflow.com/questions/41342144/webpack-hmr-webpack-hmr-404-not-found" target="_blank" rel="noopener">Stack Overflow Webpack hmr: __webpack_hmr 404 not found</a>。</p>
<p>大概原因是，webpack-hot-middleware/client 是 webpack-hot-middleware 的要求，可用于除 webpack-dev-server 之外的任何服务器（例如 express 或类似服务器），所以把它从入口文件删去就好了。</p>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://www.jianshu.com/p/b4f70049afad" target="_blank" rel="noopener">__webpack_hmr 404 (Not Found)</a></li>
<li><a href="https://stackoverflow.com/questions/41342144/webpack-hmr-webpack-hmr-404-not-found" target="_blank" rel="noopener">Stack Overflow Webpack hmr: __webpack_hmr 404 not found</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>BuildTool</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>.yaml 配置文件教程</title>
    <url>/yaml-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%95%99%E7%A8%8B.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://www.ruanyifeng.com/blog/2016/07/yaml.html" target="_blank" rel="noopener">YAML 语言教程-阮一峰</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>配置文件</category>
      </categories>
  </entry>
  <entry>
    <title>【macOS】删除启动台顽固图标</title>
    <url>/%E3%80%90macOS%E3%80%91%E5%88%A0%E9%99%A4%E5%90%AF%E5%8A%A8%E5%8F%B0%E9%A1%BD%E5%9B%BA%E5%9B%BE%E6%A0%87.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>有些已经卸载的application在MAC launchpad (苹果启动台)无法删除：</p>
<h2 id="解决">解决</h2>
<p>通过命令行删除图标，分步骤：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1 进入到/private/var/folders目录</span></span><br><span class="line"><span class="built_in">cd</span> /private/var/folders</span><br><span class="line"><span class="comment"># 2 搜索com.apple.dock.launchpad/db</span></span><br><span class="line"><span class="built_in">cd</span> $(sudo find . -name <span class="string">"com.apple.dock.launchpad"</span>)/db</span><br><span class="line"><span class="comment"># 3 删除启动台图标</span></span><br><span class="line">sqlite3 db <span class="string">"delete from apps where title='要删除的application名称';"</span></span><br><span class="line"><span class="comment"># 4 关闭重启Dock</span></span><br><span class="line">killall Dock</span><br></pre></td></tr></table></figure>
<p>例子，我要删除Alfred 4，那么第3步骤的时候把<code>title</code>改成<code>'Alfred 4'</code>就可以了。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 例如我要删除Alfred 4</span></span><br><span class="line">sqlite3 db <span class="string">"delete from apps where title='Alfred 4';"</span>&amp;&amp;killall Dock</span><br></pre></td></tr></table></figure>
<p>命令合并起来就是：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /private/var/folders  &amp;&amp; <span class="built_in">cd</span> $(sudo find . -name <span class="string">"com.apple.dock.launchpad"</span>)/db &amp;&amp;  sqlite3 db <span class="string">"delete from apps where title='要删除的application名称';"</span>&amp;&amp;killall Dock</span><br></pre></td></tr></table></figure>
<h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://www.bilibili.com/video/BV1Cu411o7Zm/?p=2&amp;spm_id_from=pageDriver" target="_blank" rel="noopener">【macOS】删除启动台顽固图标与卸载残留</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>从微信链接爬取音频</title>
    <url>/%E4%BB%8E%E5%BE%AE%E4%BF%A1%E9%93%BE%E6%8E%A5-mpvoice-%E7%88%AC%E5%8F%96%E9%9F%B3%E9%A2%91.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="故事是这样的">故事是这样的</h1>
<p>报名了某英语课程, 进群后老师会发微信课程链接, 链接里有音频视频等. 我就想做笔记把这个文字和音频视频内容保存下来.</p>
<h1 id="看代码去">看代码去</h1>
<p>微信链接在浏览器打开, 视频的很好找 <code>&lt;video origin_src=&quot;里面的就是视频的链接&quot;&gt;</code> , 把链接直接粘贴到浏览器里就好了,右键save as 就可以保存下来了.<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E4%BB%8E%E5%BE%AE%E4%BF%A1%E9%93%BE%E6%8E%A5-mpvoice-%E7%88%AC%E5%8F%96%E9%9F%B3%E9%A2%91/%E8%A7%86%E9%A2%91.png" alt="视频"></p>
<p>有的音频的资源source也很好找, <code>&lt;audio src=&quot;里面的就是视频的链接&quot;&gt;</code>, 把链接直接粘贴到浏览器里就好了,右键save as 就可以保存下来了.<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E4%BB%8E%E5%BE%AE%E4%BF%A1%E9%93%BE%E6%8E%A5-mpvoice-%E7%88%AC%E5%8F%96%E9%9F%B3%E9%A2%91/%E9%9F%B3%E9%A2%911.png" alt="音频1"></p>
<p>但是后来遇到了个看不出直接source的<code>&lt;mpvoice&gt;</code>, 应该是微信的自定义html标签. 随便在网上一搜, 就看到了跟我一样目的童鞋, 哈哈.<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E4%BB%8E%E5%BE%AE%E4%BF%A1%E9%93%BE%E6%8E%A5-mpvoice-%E7%88%AC%E5%8F%96%E9%9F%B3%E9%A2%91/%E9%9F%B3%E9%A2%912.png" alt="音频2"></p>
<p>按照他的方法试了, 果然可以. Network中有获取media的请求 (开发者工具 --&gt; Network —&gt; “media” tab). 而且<code>&lt;mpvoice&gt;</code>标签上voice_encode_fileid属性的值就是mediaid的值。同样的粘贴链接&quot;<a href="https://res.wx.qq.com/voice/getvoice?mediaid=MzI1NDMxNTIxNF8xMDAwMDIxNjg=" target="_blank" rel="noopener">https://res.wx.qq.com/voice/getvoice?mediaid=MzI1NDMxNTIxNF8xMDAwMDIxNjg=</a>&quot;到浏览器里就好了,右键save as 就可以保存下来了.<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E4%BB%8E%E5%BE%AE%E4%BF%A1%E9%93%BE%E6%8E%A5-mpvoice-%E7%88%AC%E5%8F%96%E9%9F%B3%E9%A2%91/request.png" alt="request"></p>
<h1 id="todo-写个脚本自动爬">Todo 写个脚本自动爬</h1>
<h1 id="参考文章">参考文章</h1>
<p><a href="http://haijd.tech/golang/%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E9%80%BB%E8%BE%91%E8%8B%B1%E8%AF%AD%E9%9F%B3%E9%A2%91%E5%B0%8F%E7%88%AC%E8%99%AB/" target="_blank" rel="noopener">一个简单的逻辑英语音频小爬虫</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
      </categories>
      <tags>
        <tag>Weixin</tag>
        <tag>&lt;mpvoice&gt;</tag>
      </tags>
  </entry>
  <entry>
    <title>window.opener Vs window.parent</title>
    <url>/window-opener-Vs-window-parent.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://www.cnblogs.com/ilinuxer/p/5245983.html" target="_blank" rel="noopener">Javascript中window.opener的一点小总结</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
      </categories>
  </entry>
  <entry>
    <title>你不知道的Chrome的很多神奇版本</title>
    <url>/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Chrome%E7%9A%84%E5%BE%88%E5%A4%9A%E7%A5%9E%E5%A5%87%E7%89%88%E6%9C%AC.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://www.zhihu.com/question/28531079/answer/41319912" target="_blank" rel="noopener">https://www.zhihu.com/question/28531079/answer/41319912</a></p>
<p><a href="https://www.cnblogs.com/haochuang/p/7404339.html" target="_blank" rel="noopener">https://www.cnblogs.com/haochuang/p/7404339.html</a></p>
<p>Chrome update blog</p>
<ul>
<li><a href="https://developer.chrome.com/blog/new-in-devtools-108/?utm_source=devtools#recorder" target="_blank" rel="noopener">Chrome 108</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
      </categories>
      <tags>
        <tag>Chrome</tag>
      </tags>
  </entry>
  <entry>
    <title>从微信语音or笔记爬取音频</title>
    <url>/%E4%BB%8E%E5%BE%AE%E4%BF%A1%E8%AF%AD%E9%9F%B3or%E7%AC%94%E8%AE%B0%E7%88%AC%E5%8F%96%E9%9F%B3%E9%A2%91.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="方法">方法</h1>
<p><a href="https://www.zhihu.com/question/30112442/answer/561089000" target="_blank" rel="noopener">Leon 的回答</a>比较符合我的需求, 转化下就是:</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">If (MacOS)</span><br><span class="line">    If (语音 <span class="keyword">in</span> 电脑微信窗口记录)</span><br><span class="line">        在聊天窗口找个图片;</span><br><span class="line">        右键--&gt;打开文件夹;</span><br><span class="line">        里面看到的silk文件就是聊天的语音;</span><br><span class="line"></span><br><span class="line">    If (语音 <span class="keyword">not</span> <span class="keyword">in</span> 电脑微信窗口记录)</span><br><span class="line">        收藏(语音);</span><br><span class="line">        播放(语音);</span><br><span class="line">        去到(<span class="string">"/Users/&#123;用户名&#125;/Library/Containers/com.tencent.xinWeChat/Data/Library/Application Support/com.tencent.xinWeChat/"</span>);</span><br><span class="line">        搜索(Favorites目录);</span><br><span class="line">        然后data下面就有silk文件 </span><br><span class="line">        使用[kn007/silk-v3-decoder](https://github.com/kn007/silk-v3-decoder)</span><br><span class="line">            &gt; brew install lame</span><br><span class="line">            &gt; brew install ffmpeg  --enable-libmp3lame</span><br><span class="line"></span><br><span class="line">        将silk文件转为wav</span><br><span class="line">            &gt; silk-v3-decoder/converter.sh ab.silk wav</span><br><span class="line"></span><br><span class="line">    If (语音 <span class="keyword">in</span> 电脑微信窗口记录的链接内)</span><br><span class="line">        open(链接);</span><br><span class="line">        播放(语音);</span><br><span class="line">        去到(<span class="string">"/Users/&#123;用户名&#125;/Library/Containers/com.tencent.xinWeChat/Data/Library/Application Support/com.tencent.xinWeChat/"</span>);</span><br><span class="line">        搜索(⁨OpenData⁩);</span><br><span class="line">        下面的某个文件里的音频.wav文件</span><br><span class="line">        例如:Macintosh HD⁩ ▸ ⁨Users⁩ ▸ ⁨muzilan⁩ ▸ ⁨Library⁩ ▸ ⁨Containers⁩ ▸ ⁨com.tencent.xinWeChat⁩ ▸ ⁨Data⁩ ▸ ⁨Library⁩ ▸ ⁨Application Support⁩ ▸ ⁨com.tencent.xinWeChat⁩ ▸ ⁨<span class="number">2.0b4</span><span class="number">.0</span><span class="number">.9</span>⁩ ▸ ⁨f68564a536bd7f4613c075bf2be66c8e⁩ ▸ ⁨Message⁩ ▸ ⁨MessageTemp⁩ ▸ ⁨9e20f478899dc29eb19741386f9343c8⁩ ▸ ⁨OpenData⁩ ▸ ⁨<span class="number">177</span>⁩▸a8b51cec5109b6774a1efcac305692c4.wav</span><br><span class="line">        直接拷贝;</span><br><span class="line"></span><br><span class="line">        搜索(⁨Audio);</span><br><span class="line">        下面的某个文件里的音频.silk文件</span><br><span class="line">        例如:‎⁨ Macintosh HD⁩ ▸ ⁨Users⁩ ▸ ⁨muzilan⁩ ▸ ⁨Library⁩ ▸ ⁨Containers⁩ ▸ ⁨com.tencent.xinWeChat⁩ ▸ ⁨Data⁩ ▸ ⁨Library⁩ ▸ ⁨Application Support⁩ ▸ ⁨com.tencent.xinWeChat⁩ ▸ ⁨<span class="number">2.0b4</span><span class="number">.0</span><span class="number">.9</span>⁩ ▸ ⁨f68564a536bd7f4613c075bf2be66c8e⁩ ▸ ⁨Message⁩ ▸ ⁨MessageTemp⁩ ▸ ⁨fce9f67a422f2c52cee716585240bf41⁩ ▸ ⁨Audio ▸ <span class="number">111.</span>aud.silk</span><br><span class="line"></span><br><span class="line">        使用[kn007/silk-v3-decoder](https://github.com/kn007/silk-v3-decoder)</span><br><span class="line">            &gt; brew install lame</span><br><span class="line">            &gt; brew install ffmpeg  --enable-libmp3lame</span><br><span class="line"></span><br><span class="line">        将silk文件转为wav</span><br><span class="line">            &gt; silk-v3-decoder/converter.sh ab.silk wav</span><br><span class="line"></span><br><span class="line">        Or 按修改时间排序，最近被改的文件夹</span><br><span class="line">        ‎⁨Macintosh HD⁩ ▸ ⁨Users⁩ ▸ ⁨muzilan⁩ ▸ ⁨Library⁩ ▸ ⁨Containers⁩ ▸ ⁨com.tencent.xinWeChat⁩ ▸ ⁨Data⁩ ▸ ⁨Library⁩ ▸ ⁨Application Support⁩ ▸ ⁨com.tencent.xinWeChat⁩ ▸ ⁨<span class="number">2.0b4</span><span class="number">.0</span><span class="number">.9</span>⁩ ▸ ⁨f68564a536bd7f4613c075bf2be66c8e⁩ ▸ ⁨Message⁩ ▸ ⁨MessageTemp</span><br></pre></td></tr></table></figure>
<h1 id="参考链接">参考链接</h1>
<p><a href="https://www.zhihu.com/question/30112442" target="_blank" rel="noopener">知乎: 如何导出微信【收藏】中的语音文件？</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
      </categories>
      <tags>
        <tag>Weixin</tag>
      </tags>
  </entry>
  <entry>
    <title>制作MAC OS 系统安装U盘</title>
    <url>/%E5%88%B6%E4%BD%9CMAC-OS-%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85U%E7%9B%98.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1-u盘">1 U盘</h2>
<p>在创建macOS U盘启动之前，必须拥有一个U盘。</p>
<ul>
<li>U盘大小 &gt;= 16G</li>
<li>U盘确保 不含有重要数据，因为会初始化U盘.</li>
</ul>
<p>插入u盘，将U盘在「磁盘工具」中初始化，其中<code>MyVolume</code>代表自己的U盘名称. 可以命名为其他名称，但要和步骤3中的命令一致。</p>
<ul>
<li>格式：Mac OS扩展（日志式）</li>
<li>方案：GUID 分区图</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E5%88%B6%E4%BD%9CMAC-OS-%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85U%E7%9B%98/u%E7%9B%98%E6%A0%BC%E5%BC%8F%E5%8C%96.jpg" alt="格式化"></p>
<h2 id="2-下载macos-系统">2 下载macOS 系统</h2>
<p>Apple Store 官方下载链接：</p>
<ul>
<li>下载：<a href="https://apps.apple.com/cn/app/macos-big-sur/id1526878132?mt=12" target="_blank" rel="noopener">macOS Big Sur</a>、<a href="https://apps.apple.com/cn/app/macos-catalina/id1466841314?mt=12" target="_blank" rel="noopener">macOS Catalina</a>、<a href="https://apps.apple.com/cn/app/macos-mojave/id1398502828?mt=12" target="_blank" rel="noopener">macOS Mojave</a> 或 <a href="https://apps.apple.com/cn/app/macos-high-sierra/id1246284741?mt=12" target="_blank" rel="noopener">macOS High Sierra</a><br>
这些内容会作为名为“安装 macOS [版本名称]”的 App 下载到您的<code>应用程序</code>文件夹。<br>
如果安装器在下载后打开，请退出而不要继续安装。要获取正确的安装器，请从运行 <a href="https://support.apple.com/zh-cn/HT201260" target="_blank" rel="noopener">macOS Sierra 10.12.5 或更高版本</a>或者 El Capitan 10.11.6 的 Mac 上进行下载。如果您是企业管理员，请通过 Apple 下载，而不要通过本地托管的软件更新服务器进行下载。</li>
<li>下载：<a href="http://updates-http.cdn-apple.com/2019/cert/061-41424-20191024-218af9ec-cf50-4516-9011-228c78eda3d2/InstallMacOSX.dmg" target="_blank" rel="noopener">OS X El Capitan</a><br>
这个内容会作为名为“InstallMacOSX.dmg”的磁盘映像下载。在与 El Capitan 兼容的 Mac 上，打开下载的磁盘映像，并运行其中名为“InstallMacOSX.pkg”的安装器。这时会在您的“应用程序”文件夹中安装一个名为“安装 OS X El Capitan”的 App。您将通过这个 App（而不是通过磁盘映像或 .pkg 安装器）创建可引导安装器。</li>
</ul>
<h2 id="3-在-终端-中使用-createinstallmedia-命令">3 在“终端”中使用“createinstallmedia”命令</h2>
<p><code>MyVolume</code>代表自己的U盘名称, 要和步骤1中U盘名称一致.</p>
<p>例如安装Big Sur*：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /Applications/Install\ macOS\ Big\ Sur.app/Contents/Resources/createinstallmedia --volume /Volumes/MyVolume</span><br></pre></td></tr></table></figure>
<p>Catalina*：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /Applications/Install\ macOS\ Catalina.app/Contents/Resources/createinstallmedia --volume /Volumes/MyVolume</span><br></pre></td></tr></table></figure>
<p>Mojave*：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /Applications/Install\ macOS\ Mojave.app/Contents/Resources/createinstallmedia --volume /Volumes/MyVolume</span><br></pre></td></tr></table></figure>
<p>High Sierra*：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /Applications/Install\ macOS\ High\ Sierra.app/Contents/Resources/createinstallmedia --volume /Volumes/MyVolume</span><br></pre></td></tr></table></figure>
<p>El Capitan：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /Applications/Install\ OS\ X\ El\ Capitan.app/Contents/Resources/createinstallmedia --volume /Volumes/MyVolume --applicationpath /Applications/Install\ OS\ X\ El\ Capitan.app</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果您的 Mac 运行的是 macOS Sierra 或更低版本，请使用 --applicationpath 参数和安装器路径，具体方法与在适用于 El Capitan 的命令中完成这个操作的方法类似。</p>
</blockquote>
<p>键入命令后：</p>
<ol>
<li>按下 Return 键以输入这个命令。</li>
<li>出现提示时，请键入您的管理员密码，然后再次按下 Return 键。在您键入密码时，“终端”不会显示任何字符。</li>
<li>出现提示时，请键入 <code>Y</code> 以确认您要抹掉宗卷，然后按下 Return 键。在抹掉宗卷的过程中，“终端”会显示进度。</li>
<li>宗卷被抹掉后，您可能会看到一条提醒，提示“终端”要访问可移除宗卷上的文件。点按“好”以允许继续拷贝。</li>
<li>当“终端”显示操作已完成时，相应宗卷将拥有与您下载的安装器相同的名称，例如“安装 macOS Big Sur”。您现在可以退出“终端”并弹出宗卷。</li>
</ol>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E5%88%B6%E4%BD%9CMAC-OS-%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85U%E7%9B%98/macos-big-sur-terminal-create-bootable-installer.jpg" alt=" 在“终端”中使用“createinstallmedia”命令"></p>
<h1 id="参考链接">参考链接</h1>
<p><a href="https://support.apple.com/zh-cn/HT201372" target="_blank" rel="noopener">如何创建可引导的 macOS 安装器</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>你不知道的Redux</title>
    <url>/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Redux.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="redux-toolkit">Redux Toolkit</h2>
<ul>
<li><a href="https://juejin.cn/post/7239187734417244216" target="_blank" rel="noopener">Redux Toolkit 可能是目前 Redux 的最佳实践</a></li>
<li><a href="https://juejin.cn/post/7239633419785027639" target="_blank" rel="noopener">Redux toolkit 如何优雅的实现范式化</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>Redux</category>
      </categories>
  </entry>
  <entry>
    <title>图片处理软件推荐</title>
    <url>/%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86%E8%BD%AF%E4%BB%B6%E6%8E%A8%E8%8D%90.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://www.kamilet.cn/the-best-free-raw-image-processors-for-mac-os-x/" target="_blank" rel="noopener">Mac上免费的6款RAW格式图片处理软件推荐</a><br>
1. 制造商提供的软件<br>
2. Apple Photos<br>
3. darktable<br>
4. RawTherapee<br>
5. Picktorial<br>
6. digiKam</p>
<p><a href="https://m.wwwjamendo.com/best-raw-photo-editor.html" target="_blank" rel="noopener">2021年13位最佳RAW图片编辑</a></p>
<ul>
<li>
<p>Adobe Lightroom-基于云的专业编辑器</p>
</li>
<li>
<p>极光HDR- 天然色调和颜色渐变</p>
</li>
<li>
<p>Luminar 4- AI天空替换功能</p>
</li>
<li>
<p>亲和力的照片-非破坏性过滤器</p>
</li>
<li>
<p>看图软件摄影工作室-最好的图像编目与RAW处理</p>
</li>
<li>
<p>捕获一个职业-成熟的图像处理程序</p>
</li>
<li>
<p>dxo photolab.- 高级原料加工技术</p>
</li>
<li>
<p>astershot pro- 优异的降噪</p>
</li>
<li>
<p>Darktable-完全免费的强大的RAW编辑器</p>
</li>
<li>
<p>PaintShop职业- 简化原始编辑</p>
</li>
<li>
<p>微软的照片- Windows可替代苹果照片</p>
</li>
<li>
<p>原始力量- 一流的原始编辑器</p>
</li>
<li>
<p>图示- Mac用户的照片组织和编辑</p>
</li>
<li>
<p>camera raw</p>
</li>
</ul>
<p><a href="https://www.zhihu.com/question/21984276" target="_blank" rel="noopener">zhihu: JPEG 和 RAW 格式的相片，后期处理模式有哪些不同？</a></p>
]]></content>
  </entry>
  <entry>
    <title>如何向window.setInterval的回调函数传递参数</title>
    <url>/%E5%A6%82%E4%BD%95%E5%90%91window-setInterval%E7%9A%84%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="example">Example</h2>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myCallback</span>(<span class="params">a, b</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="comment">// Your code here</span></span><br><span class="line"> <span class="comment">// Two Parameters of the myCallback function.</span></span><br><span class="line"> <span class="built_in">console</span>.log(a);</span><br><span class="line"> <span class="built_in">console</span>.log(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误传参方法</span></span><br><span class="line"><span class="keyword">var</span> intervalIDWrong = <span class="built_in">window</span>.setInterval(myCallback(<span class="string">'parameterWrong1'</span>, <span class="string">'parameterWrong2'</span>), <span class="number">5000</span>, );  </span><br><span class="line"><span class="comment">//Wrong way, it will eval and excute myCallback('parameter2') immediately, and return undefined to  window.setInterval as first parameter actually</span></span><br><span class="line"><span class="comment">//运行后发现，参数会被立即打印出来，这是因为func并不是setInterval的回调函数，因为func会立即执行（也就是网址会被立即打印的原因），实际传递给setInterval的是func的返回值（当然它的返回值为undefined）。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Solution 1</span></span><br><span class="line"><span class="keyword">var</span> intervalID1 = <span class="built_in">window</span>.setInterval(myCallback, <span class="number">5000</span>, <span class="string">'parameter1-1'</span>,  <span class="string">'parameter1-2'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Solution 2</span></span><br><span class="line"><span class="keyword">var</span> intervalID2 = <span class="built_in">window</span>.setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;myCallback(<span class="string">'parameter2-1'</span> , <span class="string">'parameter2-2'</span>);&#125;, <span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Solution 3</span></span><br><span class="line"><span class="keyword">var</span> intervalID3 =setInterval(myCallback.bind(<span class="literal">null</span>, <span class="string">'parameter3-1'</span> , <span class="string">'parameter3-2'</span>), <span class="number">5000</span>);</span><br></pre></td></tr></table></figure>
<h2 id="错误传参方法">错误传参方法</h2>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> intervalIDWrong = <span class="built_in">window</span>.setInterval(myCallback(<span class="string">'parameterWrong1'</span>, <span class="string">'parameterWrong2'</span>), <span class="number">5000</span>, );  </span><br><span class="line"></span><br><span class="line"><span class="comment">// VM1417:1 Refused to evaluate a string as JavaScript because 'unsafe-eval' is not an allowed source of script in the following Content Security Policy directive: "script-src 'self'".</span></span><br></pre></td></tr></table></figure>
<p>Wrong way, it will eval and excute myCallback(‘parameter2’) immediately, and return undefined to  window.setInterval as first parameter actually<br>
运行后发现，参数会被立即打印出来，这是因为func并不是setInterval的回调函数，因为func会立即执行（也就是网址会被立即打印的原因），实际传递给setInterval的是func的返回值（当然它的返回值为undefined）。</p>
<p>因为是通过<code>eval</code>立即执行myCallback，所以有些设置有较高安全Content Security Policy的网页上会报错：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line">VM1417:1 Refused to evaluate a string as JavaScript because 'unsafe-eval' is not an allowed source of script in the following Content Security Policy directive: "script-src 'self'".</span><br></pre></td></tr></table></figure>
<h2 id="solution-1-third-parameter-of-window-setinterval">Solution 1 third parameter of window.setInterval</h2>
<p>If you don’t need to support IE</p>
<p><code>var intervalID = window.setInterval(myCallback, 5000, 'parameter1-1', 'parameter1-2');</code></p>
<p>由于IE9和IE9以下浏览器不支持第三个参数，所以较早的教程很少教程。</p>
<h2 id="solution-2-a-wrapper-function">Solution 2  a wrapper function</h2>
<p>If you want to support IE &lt;=9</p>
<p><code>var intervalID2 = window.setInterval(function() {myCallback('parameter2-1' , 'parameter2-2');}, 5000);</code></p>
<ol>
<li>setInterval第一个参数是一个匿名函数。</li>
<li>此匿名函数执行后返回一个函数，返回的函数才是真正传递给setInterval的回调函数。</li>
<li>根据作用域与作用域链的原理，返回的函数可以使用通过外层函数传递进来的参数。</li>
<li>于是可以正常打印出传递的参数。</li>
</ol>
<h2 id="solution-3-function-prototype-bind-method">Solution 3 Function.prototype.bind() method</h2>
<p>If you want to support IE &lt;=9</p>
<p>now with ES5, bind method Function prototype: <a href="https://javascript.info/bind" target="_blank" rel="noopener">Function.prototype.bind()</a></p>
<p><code>var intervalID3 =setInterval(myCallback.bind(null, 'parameter2-1' , 'parameter2-2'), 5000);</code></p>
<h2 id="solution-4-替换掉ie内置的settimeout-setinterval">Solution 4 替换掉IE内置的setTimeout/setInterval</h2>
<p>时至此刻，要想在IE下也能使用，就只有替换掉IE内置的setTimeout/setInterval方法了。如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">// reset timer for IE</span></span><br><span class="line">    <span class="keyword">if</span> (navigator.appName == <span class="string">'Microsoft Internet Explorer'</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _preTimeout = <span class="built_in">window</span>.setTimeout,_preInterval = <span class="built_in">window</span>.setInterval;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">window</span>.setTimeout = <span class="function"><span class="keyword">function</span>(<span class="params">callback, after</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> l = <span class="built_in">arguments</span>.length;</span><br><span class="line">            <span class="keyword">if</span> (l &gt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> args = [];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">2</span>; i &lt; l; i++) &#123;</span><br><span class="line">                    args.push(<span class="built_in">arguments</span>[i]);</span><br><span class="line">                &#125;</span><br><span class="line">                 </span><br><span class="line">                <span class="keyword">return</span> _preTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                    callback.apply(<span class="keyword">this</span>, args);</span><br><span class="line">                &#125;, after); <span class="comment">//记得返回timer id</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> _preTimeout.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        <span class="built_in">window</span>.setInterval = <span class="function"><span class="keyword">function</span>(<span class="params">callback, cycle</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> l = <span class="built_in">arguments</span>.length;</span><br><span class="line">            <span class="keyword">if</span> (l &gt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> args = [];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">2</span>; i &lt; l; i++) &#123;</span><br><span class="line">                    args.push(<span class="built_in">arguments</span>[i]);</span><br><span class="line">                &#125;</span><br><span class="line">                 </span><br><span class="line">                <span class="keyword">return</span> _preInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                    callback.apply(<span class="keyword">this</span>, args);</span><br><span class="line">                &#125;, cycle);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> _preInterval.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/setInterval" target="_blank" rel="noopener">Mdn web docs window.setInterval 英文版</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/setInterval#%E5%9B%9E%E8%B0%83%E5%8F%82%E6%95%B0" target="_blank" rel="noopener">Mdn web docs window.setInterval 中文版</a></li>
<li><a href="https://stackoverflow.com/questions/457826/pass-parameters-in-setinterval-function" target="_blank" rel="noopener">stackoverflow</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>JavaScript</category>
      </categories>
  </entry>
  <entry>
    <title>必备网络请求工具Postman、Paw or 插件Advanced REST client、DHC</title>
    <url>/%E5%BF%85%E5%A4%87%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%B7%A5%E5%85%B7Postman%E3%80%81Paw-or-%E6%8F%92%E4%BB%B6Advanced-REST-client%E3%80%81DHC.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="软件">软件</h1>
<h2 id="postman">Postman</h2>
<p><a href="https://cloud.tencent.com/developer/article/1490715" target="_blank" rel="noopener">Postman最详使用教程</a></p>
<h2 id="paw"><a href="https://paw.cloud/" target="_blank" rel="noopener">Paw</a></h2>
<p><a href="https://sq.163yun.com/blog/article/180043791449546752" target="_blank" rel="noopener">介绍一款API调试工具—Paw</a><br>
<a href="https://www.jianshu.com/p/eb8bf8362c81" target="_blank" rel="noopener">Paw:网络请求工具</a><br>
<a href="https://yq.aliyun.com/articles/29772" target="_blank" rel="noopener">教你使用Paw解析http请求</a><br>
<a href="https://blog.csdn.net/handsomekang/article/details/78943019" target="_blank" rel="noopener">Paw —— 比Postman更舒服的API利器</a><br>
<a href="https://zhuanlan.zhihu.com/p/25708128" target="_blank" rel="noopener">Android Http网络开发神兵利器</a></p>
<h1 id="chrome插件">chrome插件</h1>
<h2 id="dhc-rest-http-api-client">DHC - REST/HTTP API Client</h2>
<p>项目存储，历史记录看起来也很直观 功能、界面风格都很好</p>
<h2 id="advanced-rest-client">Advanced REST client</h2>
<p>这个可以按项目储存，还可以显示JSON格式数据，虽然界面不算新潮，但该有的还都有，很不错</p>
<h1 id="links">Links</h1>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Network</tag>
      </tags>
  </entry>
  <entry>
    <title>快速解决windows下 cd 无法切换盘符目录</title>
    <url>/%E5%BF%AB%E9%80%9F%E8%A7%A3%E5%86%B3windows%E4%B8%8B-cd-%E6%97%A0%E6%B3%95%E5%88%87%E6%8D%A2%E7%9B%98%E7%AC%A6%E7%9B%AE%E5%BD%95.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>在windows系统， 打开cmd.exe 或者 Command prompt。<br>
默认进入到当前用户主目录下， 发现除了C:\， 可以通过cd … , cd , dir 去到C:\下的各个目录， 可以在c盘下的各个目录自由切换。<br>
但是不能通过 <code>cd e:\</code> 进入到e盘，仍停留在原来C:\盘的位置。</p>
<h2 id="解决方法1">解决方法1</h2>
<p>在 cd 和盘符之间加上 /e</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /e e:</span><br></pre></td></tr></table></figure>
<h2 id="解决方法2">解决方法2</h2>
<p>不用cd指令,直接用e盘符</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">e:</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E5%BF%AB%E9%80%9F%E8%A7%A3%E5%86%B3windows%E4%B8%8B-cd-%E6%97%A0%E6%B3%95%E5%88%87%E6%8D%A2%E7%9B%98%E7%AC%A6%E7%9B%AE%E5%BD%95/command.png" alt="https://github.com/CatherineLiyuankun/PictureBed/blob/master/blog/post/%E5%BF%AB%E9%80%9F%E8%A7%A3%E5%86%B3windows%E4%B8%8B-cd-%E6%97%A0%E6%B3%95%E5%88%87%E6%8D%A2%E7%9B%98%E7%AC%A6%E7%9B%AE%E5%BD%95/command.png"></p>
<p>我使用方法1，不管用，方法2成功。</p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Command line</tag>
      </tags>
  </entry>
  <entry>
    <title>安装/使用/卸载Anaconda</title>
    <url>/%E5%AE%89%E8%A3%85-%E4%BD%BF%E7%94%A8-%E5%8D%B8%E8%BD%BDAnaconda.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="安装anaconda">安装Anaconda</h2>
<p><a href="https://www.anaconda.com/download" target="_blank" rel="noopener">Anaconda官网下载</a></p>
<p>如果下载网速过慢，可以使用清华大学镜像：</p>
<ul>
<li>下载列表：<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/</a></li>
<li>使用说明：<a href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/</a></li>
</ul>
<h2 id="卸载anaconda">卸载Anaconda</h2>
<ul>
<li><a href="https://docs.anaconda.com/free/anaconda/install/uninstall/" target="_blank" rel="noopener">Anaconda官方卸载方法-英文版</a></li>
<li><a href="https://anaconda.org.cn/anaconda/install/uninstall/" target="_blank" rel="noopener">Anaconda官方卸载方法-中文版</a></li>
</ul>
<h3 id="step1-彻底卸载anaconda">Step1 彻底卸载Anaconda</h3>
<ol>
<li>安装 Anaconda-Clean package</li>
</ol>
<p>打开 Anaconda Prompt 或者命令行， 输入如下命令：</p>
<figure class="highlight plain"><figcaption><span>install anaconda-clean```</span></figcaption><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">如果安装失败，参考[如何完全卸载Anaconda（如何下载Anaconda-Clean package）](https://developer.aliyun.com/article/936211)</span><br><span class="line"></span><br><span class="line">- 删除`.condarc`文件里面的内容（不是删文件）</span><br><span class="line">  - [MacOS] `~/.condarc`</span><br><span class="line">  - [Window]C盘下`.condarc`</span><br><span class="line">- 重新`conda install anaconda-clean`</span><br><span class="line"></span><br><span class="line">2. 输入如下命令卸载</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line"># If you want to confirm each file and directory you are deleting</span><br><span class="line">anaconda-clean</span><br><span class="line"></span><br><span class="line"># If you don&apos;t want to be asked about each file and directory</span><br><span class="line">anaconda-clean --yes</span><br></pre></td></tr></table></figure>
<h3 id="step2-简单移除anaconda文件">Step2 简单移除Anaconda文件</h3>
<h4 id="macos">MacOS</h4>
<p>Open your terminal application.<br>
Remove your entire Anaconda directory with <code>rm -rf</code>. Depending on your installation, your anaconda2 or anaconda3 directory will be in your root folder or in your opt folder.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># The following are a few examples of how you may need to delete your Anaconda folder</span></span><br><span class="line">rm -rf anaconda3</span><br><span class="line">rm -rf ~/anaconda3</span><br><span class="line">rm -rf ~/opt/anaconda3</span><br></pre></td></tr></table></figure>
<p>Close and reopen your terminal to refresh it. You should no longer see (base) in your terminal prompt.</p>
<h3 id="step3-removing-anaconda-path-from-bash-profile">Step3 Removing Anaconda path from <code>.bash_profile</code></h3>
<p>If you use Linux or macOS, you may also wish to check your <code>.bash_profile</code> or <code>.zprofile</code> file in your home directory for a line such as:<br>
<code>export PATH=&quot;/Users/yourname/anaconda3/bin:$PATH&quot;</code></p>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://mp.weixin.qq.com/s/vIZoE4BmXYlyhfFFmlhDWg" target="_blank" rel="noopener">Anaconda 介绍、安装及使用保姆级教程</a></li>
<li>[PyCharm 安装 NumPy，SciPy 等科学计算包 （Anaconda）for mac OS X](<a href="https://blog.csdn.net/muzilanlan/article/details/50479931" target="_blank" rel="noopener">https://blog.csdn.net/muzilanlan/article/details/50479931</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Language</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Command line</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>浏览器报错“localhost sent an invalid response.ERR_SSL_PROTOCOL_ERROR”</title>
    <url>/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8A%A5%E9%94%99%E2%80%9Clocalhost-sent-an-invalid-response-ERR-SSL-PROTOCOL-ERROR%E2%80%9D.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>当浏览器访问http的本地开发环境时，<code>http://localhost:4000/</code> , 浏览器报错：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">localhost sent an invalid response.</span><br><span class="line">ERR_SSL_PROTOCOL_ERROR</span><br></pre></td></tr></table></figure>
<p>The <code>ERR_SSL_PROTOCOL_ERROR</code> in Chrome typically occurs when you’re trying to access a local development server (like one running on <code>http://localhost:4000</code>) over HTTPS <code>https://localhost:4000</code> instead of HTTP. If your server isn’t set up to handle HTTPS, Chrome may block the connection because it expects a valid SSL certificate, which isn’t usually present on local servers.</p>
<h2 id="解决方法">解决方法</h2>
<p>因为HSTS，浏览器会自动把我的http的网址<code>http://localhost:4000/</code> 自动redirect到HTTPS <code>https://localhost:4000</code>, 所以用方法1，2都可以解决。</p>
<h3 id="前提-确保使用的是http">前提 确保使用的是HTTP</h3>
<p>Ensure You’re Using HTTP, Not HTTPS:</p>
<ul>
<li>Make sure you’re visiting <code>http://localhost:4000</code> (not <code>https://localhost:4000</code>).</li>
<li>Check the URL bar and explicitly type <code>http://</code> before <code>localhost:4000</code> if necessary.</li>
</ul>
<h3 id="方法一-清除hsts设置">方法一 清除HSTS设置</h3>
<p>Disable HTTPS Enforcement in Chrome:<br>
Chrome may automatically redirect to HTTPS if it previously visited the site over HTTPS. You can clear this by:</p>
<ul>
<li>Clearing the HSTS Settings for localhost:
<ul>
<li>Go to chrome://net-internals/#hsts in your Chrome browser.</li>
<li>Under the “Delete domain security policies” section, type localhost and click “Delete”.</li>
</ul>
</li>
</ul>
<h3 id="方法二-使用浏览器匿名模式-incognito-window">方法二 使用浏览器匿名模式 Incognito Window</h3>
<p>Sometimes, Chrome caches HSTS settings. Opening an incognito window might avoid the cached redirection to HTTPS.</p>
<h3 id="方法三-check-for-extensions-or-proxy-settings">方法三 Check for Extensions or Proxy Settings</h3>
<p>Ensure no Chrome extensions or proxy settings are forcing HTTPS. Disable any such extensions or settings temporarily to test.</p>
<h3 id="方法四-update-your-server-configuration-optional">方法四 Update Your Server Configuration (Optional)</h3>
<p>If you need to serve your local site over HTTPS, configure your development server to support HTTPS. This typically involves generating a self-signed SSL certificate and configuring your server to use it.</p>
<h3 id="方法五-ypass-the-ssl-error-not-recommended-for-regular-use">方法五 ypass the SSL Error (Not Recommended for Regular Use)</h3>
<p>If you still need to bypass the SSL check, you can type <code>thisisunsafe</code> directly on the error page in Chrome. It will bypass the SSL warning, but this is generally not recommended for regular use.</p>
<h3 id="总结">总结</h3>
<ul>
<li>Start by confirming you’re accessing <code>http://localhost:4000</code>, not <code>https://localhost:4000</code>.</li>
<li>If Chrome still redirects to HTTPS or shows an SSL error, try clearing the HSTS settings for <code>localhost</code> or using an incognito window.</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
      </categories>
  </entry>
  <entry>
    <title>英文标点符号+运算符号</title>
    <url>/%E8%8B%B1%E6%96%87%E6%A0%87%E7%82%B9%E7%AC%A6%E5%8F%B7-%E8%BF%90%E7%AE%97%E7%AC%A6%E5%8F%B7.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><table>
<thead>
<tr>
<th>符号</th>
<th>英文含义</th>
<th>读音</th>
<th>中文含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>．</td>
<td>period or full stop</td>
<td>英  [ˌsemiˈkəʊlən; ˌsemiˈkəʊlɒn]  美  [ˈsemikoʊlən]</td>
<td>句号</td>
</tr>
<tr>
<td>，</td>
<td>comma</td>
<td></td>
<td>逗号</td>
</tr>
<tr>
<td>：</td>
<td>colon</td>
<td></td>
<td>冒号</td>
</tr>
<tr>
<td>；</td>
<td>semicolon</td>
<td></td>
<td>分号</td>
</tr>
<tr>
<td>！</td>
<td>exclamation mark</td>
<td></td>
<td>惊叹号</td>
</tr>
<tr>
<td>？</td>
<td>question mark</td>
<td></td>
<td>问号</td>
</tr>
<tr>
<td>-</td>
<td>hyphen</td>
<td></td>
<td>连字符</td>
</tr>
<tr>
<td>*</td>
<td>asterisk</td>
<td></td>
<td>星号</td>
</tr>
<tr>
<td>’</td>
<td>apostrophe</td>
<td></td>
<td>所有格符号，单词内部的省略</td>
</tr>
<tr>
<td>—</td>
<td>dash</td>
<td></td>
<td>破折号</td>
</tr>
<tr>
<td>_</td>
<td>underscore</td>
<td></td>
<td></td>
</tr>
<tr>
<td>‘’</td>
<td>single quotation marks</td>
<td>英  [kwəʊˈteɪʃn]  美  [kwoʊˈteɪʃn]</td>
<td>单引号</td>
</tr>
<tr>
<td>“ ”</td>
<td>double quotation marks</td>
<td></td>
<td>双引号</td>
</tr>
<tr>
<td>( )</td>
<td>parenthesis or round brackets</td>
<td></td>
<td>圆括号</td>
</tr>
<tr>
<td>[ ]</td>
<td>square brackets</td>
<td>美  ['brækɪts]</td>
<td>方括号</td>
</tr>
<tr>
<td>&lt;&gt;</td>
<td>Angle brackets</td>
<td></td>
<td>尖括号</td>
</tr>
<tr>
<td>{}</td>
<td>curly brackets or braces</td>
<td></td>
<td>大括号</td>
</tr>
<tr>
<td>《》</td>
<td>French quotes</td>
<td></td>
<td>法文引号；书名号</td>
</tr>
<tr>
<td>…</td>
<td>ellipsis</td>
<td></td>
<td>省略号</td>
</tr>
<tr>
<td>¨</td>
<td>tandem colon</td>
<td></td>
<td>双点号</td>
</tr>
<tr>
<td>&quot;</td>
<td>ditto</td>
<td></td>
<td>同上</td>
</tr>
<tr>
<td>‖</td>
<td>parallel</td>
<td></td>
<td>双线号</td>
</tr>
<tr>
<td>／</td>
<td>slash or virgule or diagonal mark</td>
<td></td>
<td>斜线号</td>
</tr>
<tr>
<td>＆</td>
<td>ampersand = and</td>
<td></td>
<td></td>
</tr>
<tr>
<td>～</td>
<td>tilde or swung dash</td>
<td></td>
<td>代字号</td>
</tr>
<tr>
<td>§</td>
<td>section; division</td>
<td></td>
<td>分节号</td>
</tr>
<tr>
<td>→</td>
<td>arrow</td>
<td></td>
<td>箭号；参见号</td>
</tr>
<tr>
<td></td>
<td>vertical bar</td>
<td></td>
<td>竖线</td>
</tr>
<tr>
<td>\</td>
<td>backslash</td>
<td></td>
<td>反斜线</td>
</tr>
</tbody>
</table>
<p>=====================</p>
<p>附：部分数学符号的英文名称</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>英文含义</th>
<th>中文含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>＋</td>
<td>plus</td>
<td>加号；正号</td>
</tr>
<tr>
<td>－</td>
<td>minus</td>
<td>减号；负号</td>
</tr>
<tr>
<td>±</td>
<td>plus or minus</td>
<td>正负号</td>
</tr>
<tr>
<td>×</td>
<td>is multiplied by</td>
<td>乘号</td>
</tr>
<tr>
<td>÷</td>
<td>is divided by</td>
<td>除号</td>
</tr>
<tr>
<td>＝</td>
<td>is equal to</td>
<td>等于号</td>
</tr>
<tr>
<td>≠</td>
<td>is not equal to</td>
<td>不等于号</td>
</tr>
<tr>
<td>≡</td>
<td>is equivalent to</td>
<td>全等于号</td>
</tr>
<tr>
<td>≌</td>
<td>is equal to or approximately equal to</td>
<td>等于或约等于号</td>
</tr>
<tr>
<td>≈</td>
<td>is approximately equal to</td>
<td>约等于号</td>
</tr>
<tr>
<td>＜</td>
<td>less than sign</td>
<td>小于号</td>
</tr>
<tr>
<td>＞</td>
<td>more than or greater than sign</td>
<td>大于号</td>
</tr>
<tr>
<td>≮</td>
<td>is not less than</td>
<td>不小于号</td>
</tr>
<tr>
<td>≯</td>
<td>is not more than</td>
<td>不大于号</td>
</tr>
<tr>
<td>≤</td>
<td>is less than or equal to</td>
<td>小于或等于号</td>
</tr>
<tr>
<td>≥</td>
<td>is more than or equal to</td>
<td>大于或等于号</td>
</tr>
<tr>
<td>％</td>
<td>per cent</td>
<td>百分之…</td>
</tr>
<tr>
<td>‰</td>
<td>per mill</td>
<td>千分之…</td>
</tr>
<tr>
<td>∞</td>
<td>infinity</td>
<td>无限大号</td>
</tr>
<tr>
<td>∝</td>
<td>varies as</td>
<td>与…成比例</td>
</tr>
<tr>
<td>√</td>
<td>(square) root</td>
<td>平方根</td>
</tr>
<tr>
<td>∵</td>
<td>since; because</td>
<td>因为</td>
</tr>
<tr>
<td>∴</td>
<td>hence</td>
<td>所以</td>
</tr>
<tr>
<td>∷</td>
<td>equals, as (proportion)</td>
<td>等于，成比例</td>
</tr>
<tr>
<td>∠</td>
<td>angle</td>
<td>角</td>
</tr>
<tr>
<td>⌒</td>
<td>semicircle</td>
<td>半圆</td>
</tr>
<tr>
<td>⊙</td>
<td>circle</td>
<td>圆</td>
</tr>
<tr>
<td>○</td>
<td>circumference</td>
<td>圆周</td>
</tr>
<tr>
<td>△</td>
<td>triangle</td>
<td>三角形</td>
</tr>
<tr>
<td>⊥</td>
<td>perpendicular to</td>
<td>垂直于</td>
</tr>
<tr>
<td>∪</td>
<td>union of</td>
<td>并，合集</td>
</tr>
<tr>
<td>∩</td>
<td>intersection of</td>
<td>交，通集</td>
</tr>
<tr>
<td>∫</td>
<td>the integral of</td>
<td>…的积分</td>
</tr>
<tr>
<td>∑</td>
<td>(sigma) summation of</td>
<td>总和</td>
</tr>
<tr>
<td>°</td>
<td>degree</td>
<td>度</td>
</tr>
<tr>
<td>′</td>
<td>minute</td>
<td>分</td>
</tr>
<tr>
<td>″</td>
<td>second</td>
<td>秒</td>
</tr>
<tr>
<td>＃</td>
<td>number</td>
<td>…号</td>
</tr>
<tr>
<td>℃</td>
<td>Celsius system</td>
<td>摄氏度</td>
</tr>
<tr>
<td>＠</td>
<td>at</td>
<td>在</td>
</tr>
</tbody>
</table>
<h1 id="参考文章">参考文章</h1>
<ul>
<li><a href="http://www.ruanyifeng.com/blog/2007/07/english_punctuation.html" target="_blank" rel="noopener">标点符号的英语名称</a></li>
</ul>
]]></content>
      <categories>
        <category>English Learning</category>
        <category>日常英语</category>
      </categories>
  </entry>
  <entry>
    <title>奥利给你的iTerm2-快速用IDE打开文件</title>
    <url>/%E5%A5%A5%E5%88%A9%E7%BB%99%E4%BD%A0%E7%9A%84iTerm2-%E5%BF%AB%E9%80%9F%E7%94%A8IDE%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="mac终端命令行下用sublime-vscode-atom打开文件或目录"><a href="https://www.cnblogs.com/hongrunhui/p/5928833.html" target="_blank" rel="noopener">MAC终端命令行下用sublime、vscode、atom打开文件或目录</a></h1>
<p>打开~/.zshrc</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>添加内容:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Set personal aliases, overriding those provided by oh-my-zsh libs,</span></span><br><span class="line"><span class="comment"># plugins, and themes. Aliases can be placed here, though oh-my-zsh</span></span><br><span class="line"><span class="comment"># users are encouraged to define aliases within the ZSH_CUSTOM folder.</span></span><br><span class="line"><span class="comment"># For a full list of active aliases, run `alias`.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example aliases</span></span><br><span class="line"><span class="comment"># alias zshconfig="mate ~/.zshrc"</span></span><br><span class="line"><span class="comment"># alias ohmyzsh="mate ~/.oh-my-zsh"</span></span><br><span class="line"><span class="built_in">alias</span> atom=<span class="string">'/Applications/Atom.app/Contents/MacOS/Atom'</span></span><br><span class="line"><span class="built_in">alias</span> subl=<span class="string">'/Applications/Sublime\ Text.app/Contents/SharedSupport/bin/subl'</span></span><br><span class="line"><span class="built_in">alias</span> vsc=<span class="string">'/Applications/Visual\ Studio\ Code.app/Contents/Resources/app/bin/code'</span></span><br></pre></td></tr></table></figure>
<h1 id="mac-配置finder当前目录打开iterm2"><a href="https://www.jianshu.com/p/445d3f754c4d" target="_blank" rel="noopener">Mac 配置Finder当前目录打开iTerm2</a></h1>
<p>MAC版本升级到Monterey后，Go2Shell不能使用，转用Qmenu 或 OpenInTerminal。</p>
<ul>
<li>
<p>MAC OS 版本 &lt;= Big Sur, 使用Go2Shell</p>
</li>
<li>
<p>MAC OS 版本 &gt;= Monterey, 使用OpenInTerminal</p>
<ul>
<li>方法一：安装Go2Shell【MAC OS 版本 &lt;= Big Sur】,  <code>!!!!!亲测版本V2.5, Mac OS Big Sur可以使用，Monterey不能使用</code>【我的百度网盘】</li>
<li>[x] <a href="http://liyuankun.top/%E5%A5%A5%E5%88%A9%E7%BB%99%E4%BD%A0%E7%9A%84iTerm2-%E5%BF%AB%E9%80%9F%E7%94%A8IDE%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6.html#%E9%99%A4go2shell%E7%9A%84%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95-mac-os-%E7%89%88%E6%9C%AC-monterey">方法二：安装OpenInTerminal【MAC OS 版本 &gt;= Monterey】</a>
<ul>
<li><a href="https://apps.apple.com/cn/app/qmenu/id1567442612?l=en&amp;mt=12" target="_blank" rel="noopener"><strong>Qmenu</strong></a> 【免费, App strore】访达扩展，拥有QSpace【付费, App strore】的部分功能。 【推荐】现在用Qmenu，功能比OpenInTerminal 更多。</li>
<li><a href="https://github.com/Ji4n1ng/OpenInTerminal/blob/master/Resources/README-zh.md" target="_blank" rel="noopener">OpenInTerminal</a>  个人目前选择使用这个开源软件了，不仅可以用iTerm2打开，还可以配置用其他IDE例如VScode打开。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="qmenu-or-openinterminal-mac-os-版本-monterey">Qmenu OR OpenInTerminal（MAC OS 版本 &gt;= Monterey）</h2>
<ul>
<li>参考文章： <a href="https://xa8.net/post/34806729" target="_blank" rel="noopener">Mac 系統升級， go2shell 不能用了，求大佬們推薦類似功能的軟體</a>整理的几种方法：
<ul>
<li><a href="https://apps.apple.com/cn/app/qmenu/id1567442612?l=en&amp;mt=12" target="_blank" rel="noopener"><strong>Qmenu</strong></a> 【免费, App strore】访达扩展，拥有QSpace【付费, App strore】的部分功能。 现在用Qmenu，功能比OpenInTerminal 更多。
<ul>
<li>【新建文件】</li>
<li>【<strong>计算文件哈希值</strong>】</li>
<li>【Open in Item2】</li>
<li>【Open in VScode】</li>
<li>【Open in Sublime】</li>
<li>【Copy path】</li>
</ul>
</li>
<li><a href="https://github.com/Ji4n1ng/OpenInTerminal/blob/master/Resources/README-zh.md" target="_blank" rel="noopener">OpenInTerminal</a>  【开源免费】访达扩展，不仅可以用iTerm2打开，还可以配置用其他IDE打开。
<ul>
<li>Support Terminal: iTerm, Hyper, Alacritty and kitty.</li>
<li>Support TextEdit, Visual Studio Code, VSCode Insiders, Atom, Sublime Text, VSCodium, BBEdit, TextMate, CotEditor, MacVim, JetBrains(AppCode, CLion, GoLand, IntelliJ IDEA, PhpStorm, PyCharm, RubyMine, WebStorm), and Typora.</li>
<li>因为部分功能与<code>Qmenu</code>重复，所以<code>OpenInTerminal</code>只设置了下面选项：
<ul>
<li>【Open in IntelliJ IDEA】</li>
<li>【Open in PyCharm】</li>
<li>【Copy path】</li>
</ul>
</li>
</ul>
</li>
<li>直接拖文件夾 /文件到 Dock 上的 iTerm2 的圖標上。。。哈哈，这是一直都有的原生功能，虽然可以。。。但是不好用</li>
<li><a href="https://github.com/jbtule/cdto" target="_blank" rel="noopener">cdto</a></li>
<li><a href="https://github.com/LeEnno/alfred-terminalfinder" target="_blank" rel="noopener">Alfred 有TerminalFinder workflow</a></li>
<li><a href="https://www.macwk.com/soft/xtrafinder" target="_blank" rel="noopener">XtraFinder</a>，附贈这个功能： XtraFinder 设置 -&gt; Menus -&gt; 从这里启动，设置个快捷键，选择 iTerm，完事。</li>
<li>MAC Automator，找到個更原生的辦法 <a href="http://azaleasays.com/2017/09/21/mac-os-x-open-iterm-here/" target="_blank" rel="noopener">http://azaleasays.com/2017/09/21/mac-os-x-open-iterm-here/</a></li>
</ul>
</li>
</ul>
<h2 id="go2shell-mac-os-版本-big-sur">Go2Shell（MAC OS 版本 &lt;= Big Sur）</h2>
<h3 id="安装go2shell">安装Go2Shell</h3>
<ul>
<li>
<p><a href="http://zipzapmac.com/Go2Shell" target="_blank" rel="noopener">Go2Shell官方安装</a> 【我的百度网盘】<code>!!!!!亲测版本V2.5, Mac OS Big Sur可以使用</code>。</p>
</li>
<li>
<p>苹果应用商店安装<a href="https://apps.apple.com/cn/app/go2shell/id445770608?mt=12" target="_blank" rel="noopener">Go2Shell</a>，只支持Mac OS 到Yosemite。新版Mac OS Big Sur 不能使用。</p>
</li>
</ul>
<h3 id="设置go2shell">设置Go2Shell</h3>
<h4 id="1-进入-preferences-的方式">1 进入 Preferences 的方式</h4>
<ol>
<li>
<p>v2.3 和 v2.5 直接在应用文件中打开 Go2Shell 就行。</p>
</li>
<li>
<p>新老版本都可以通过命令行打开:</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 新老版本都可以通过命令行打开</span></span><br><span class="line">open -a Go2Shell --args configGo</span><br></pre></td></tr></table></figure>
<h4 id="2-设置选择">2 设置选择</h4>
<ul>
<li><code>iTerm2</code></li>
<li><code>New Tab</code>
<ul>
<li>优点：Find直接点Go2Shell按钮就可以在当前目录打开终端了</li>
<li>缺点：iTerm2 APPStore 版本每次都是在新的终端窗口中打开，而不是在新的终端标签中打开</li>
</ul>
</li>
<li>Command to execute in terminal:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> %PATH%; clear; <span class="built_in">echo</span> -e <span class="string">"Last login: `date`"</span>; <span class="built_in">pwd</span></span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E5%A5%A5%E5%88%A9%E7%BB%99%E4%BD%A0%E7%9A%84iTerm2-%E5%BF%AB%E9%80%9F%E7%94%A8IDE%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6/Go2Shell.png" alt="Go2Shell设置"></p>
<h4 id="3-添加go2shell-图标到finder">3 添加Go2Shell 图标到finder</h4>
<p>上一步点击： “Install Go2Shell to Finder”后, Finder出现图标：</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E5%A5%A5%E5%88%A9%E7%BB%99%E4%BD%A0%E7%9A%84iTerm2-%E5%BF%AB%E9%80%9F%E7%94%A8IDE%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6/Go2Shell2.png" alt="Go2Shell图标"></p>
<p>点击右边这个<code>&gt;_&lt;</code>图标，就可以在 iterm2 中以新窗口的模式打开一个 terminal。</p>
<blockquote>
<p>删除这个功能，或者图标显示错误很好处理，按住 cmd 键，鼠标拖拽这个图标到外面释放图标，就可以删除这个功能了。<br>
或者重新打开Go2Shell设置， 点击“Uninstall Go2Shell from Finder”</p>
</blockquote>
<h2 id="links">Links</h2>
<ul>
<li><a href="https://www.cnblogs.com/hongrunhui/p/5928833.html" target="_blank" rel="noopener">MAC终端命令行下用sublime、vscode、atom打开文件或目录</a></li>
<li><a href="https://www.jianshu.com/p/445d3f754c4d" target="_blank" rel="noopener">Mac 配置Finder当前目录打开iTerm2</a></li>
<li><a href="https://link.jianshu.com/?t=http://www.iterm2.com/documentation.html" target="_blank" rel="noopener">iTerm2 官方文档</a></li>
<li><a href="https://link.jianshu.com/?t=http://foocoder.com/blog/wo-zai-yong-de-macruan-jian.html/" target="_blank" rel="noopener">终端环境之iTerm2</a></li>
<li><a href="https://link.jianshu.com/?t=http://blog.csdn.net/thinkdiff/article/details/25075047" target="_blank" rel="noopener">mac下超好用的终端–iterm2用法与技巧</a></li>
<li><a href="https://link.jianshu.com/?t=http://hiltmon.com/blog/2013/07/18/fast-ssh-windows-with-iterm-2/" target="_blank" rel="noopener">使用profiles功能快速ssh机器-Fast SSH Windows With iTerm 2</a> 或者看这篇中文文章 <a href="http://fuweiyi.com/mac/2015/03/06/a-mac-iterm2-ssh-profile.html" target="_blank" rel="noopener">http://fuweiyi.com/mac/2015/03/06/a-mac-iterm2-ssh-profile.html</a>
<ul>
<li>
<ul>
<li><a href="https://xa8.net/post/34806729" target="_blank" rel="noopener">Mac 系統升級， go2shell 不能用了，求大佬們推薦類似功能的軟體</a></li>
</ul>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>Environment setup</category>
      </categories>
      <tags>
        <tag>Command line</tag>
      </tags>
  </entry>
  <entry>
    <title>改变echo的颜色-change the output color of echo in Linux</title>
    <url>/%E6%94%B9%E5%8F%98echo%E7%9A%84%E9%A2%9C%E8%89%B2-change-the-output-color-of-echo-in-Linux.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GREEN=<span class="string">'\033[0;32m'</span></span><br><span class="line">Yellow=<span class="string">'\033[0;33m'</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;GREEN&#125;</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"green string"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;Yellow&#125;</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"yellow string"</span></span><br></pre></td></tr></table></figure>
<p>希望的输出：<br>
“green string” 应该是绿色的<br>
&quot;yellow string&quot; 应该是黄色的</p>
<p>实际输出：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">\033[0;32m</span><br><span class="line">green string</span><br><span class="line">\033[0;33m</span><br><span class="line">yellow string</span><br></pre></td></tr></table></figure>
<blockquote>
<p>if you are using the echo command, be sure to use the -e flag to allow backslash escapes.<br>
所以我们应该把<code>echo &quot;${GREEN}&quot;</code> 改成 <code>echo -e &quot;${GREEN}&quot;</code></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GREEN=<span class="string">'\033[0;32m'</span></span><br><span class="line">Yellow=<span class="string">'\033[0;33m'</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"<span class="variable">$&#123;GREEN&#125;</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"green string"</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"<span class="variable">$&#123;Yellow&#125;</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"yellow string"</span></span><br></pre></td></tr></table></figure>
<p>实际输出：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">green string</span><br><span class="line">yellow string</span><br></pre></td></tr></table></figure>
<p><code>green string</code> 是绿色的<br>
<code>yellow string</code> 是黄色的</p>
<h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/5947742/how-to-change-the-output-color-of-echo-in-linux" target="_blank" rel="noopener">How to change the output color of echo in Linux</a></li>
<li><a href="https://gist.github.com/vratiu/9780109" target="_blank" rel="noopener">Git shell coloring</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Linux/bash</category>
      </categories>
      <tags>
        <tag>Command line</tag>
      </tags>
  </entry>
  <entry>
    <title>解决 No matching host key type found. Their offer ssh-rsa</title>
    <url>/%E8%A7%A3%E5%86%B3-No-matching-host-key-type-found-Their-offer-ssh-rsa.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="no-matching-host-key-type-found-their-offer-ssh-rsa问题处理-知乎">No matching host key type found. Their offer: ssh-rsa问题处理 - 知乎</h1>
<p><a href="https://zhuanlan.zhihu.com/p/616716090" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/616716090</a></p>
<h2 id="mac-上iterm2-脚本连接堡垒机报错">Mac 上iterm2 脚本连接堡垒机报错</h2>
<p><img src="https://pic2.zhimg.com/80/v2-93fa626b6fa7f63932f9ab61102856ad_1440w.webp" alt="Mac 上iterm2 脚本连接堡垒机报错"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(base)x xxx@xxxMacBook-ProD &gt; /usr/<span class="built_in">local</span>/bin &gt; expect /usr/<span class="built_in">local</span>/bin/login/login-jumper.exp</span><br><span class="line">spawn ssh -p 2xxxxxx</span><br><span class="line">Unable to negotiate with 106.75.36.157 port 22222: no matching host key <span class="built_in">type</span> found. Their offer: ssh-rsa spawn_id: spawn id exp6 not open</span><br><span class="line">    <span class="keyword">while</span> executing</span><br><span class="line"><span class="string">"interact"</span></span><br><span class="line">    (file <span class="string">"/usr/local/bin/login/login-jumper.exp"</span> line 29)</span><br></pre></td></tr></table></figure>
<h2 id="原因">原因</h2>
<p>openssh觉得ssh-rsa加密方式不安全, 直接从8.8开始默认不允许这种密钥用于登陆了</p>
<h2 id="解决方案">解决方案</h2>
<h3 id="方案1-临时性方案-命令行增加参数-ohostkeyalgorithms-ssh-rsa">方案1: 临时性方案（命令行增加参数 <code>-oHostKeyAlgorithms=+ssh-rsa</code>）</h3>
<p><img src="https://pic2.zhimg.com/80/v2-dd2b52f6308497be0c2ff14ae194d225_1440w.webp" alt="命令行增加参数 "></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ssh -oHostkeyALgorithms=+ssh-rsa -p 22222 -l</span><br><span class="line">The authenticity of host <span class="string">'[baolei.zen-game.com]:22222 ([106.75.36.157]:22222)'</span> can<span class="string">'t be established.</span></span><br><span class="line"><span class="string">RSA key fingerprint is SHA256:2wywU82+91MJq5vxjwWWOIpTNdVal2GYAOi35/FWm4.</span></span><br><span class="line"><span class="string">This host key is known by the following other names/addresses:</span></span><br><span class="line"><span class="string">    ~/.ssh/known_hosts:16: [zengame.uhasadmin.com]: 22222</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added "[baolei.zen-game.com]:22222 (RSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Password authentication (mars.cai@baolei.zen-game.com) Password:</span></span><br><span class="line"><span class="string">Welcome to SSHD</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">请选择多因子认证方式：</span></span><br><span class="line"><span class="string">[1] 短信验证码</span></span><br><span class="line"><span class="string">[2] 手机令牌OTP</span></span><br><span class="line"><span class="string">[x] English</span></span><br><span class="line"><span class="string">[e] 退出</span></span><br></pre></td></tr></table></figure>
<p>连接成功</p>
<h3 id="方案2-持久化方案-配置文件持久化">方案2:持久化方案（配置文件持久化）</h3>
<p>输入<code>sudo nano ~/.ssh/config</code>，然后在出现提示时，输入您的管理密码</p>
<p><img src="https://pic1.zhimg.com/80/v2-9f68694841e5892aae8a4c58811ae4cc_1440w.webp" alt="输入您的管理密码"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Host baolie .xxxxxx</span><br><span class="line">HostKeyAlgorithms +ssh-rsa</span><br></pre></td></tr></table></figure>
<p>输入上面内容，将需要连接的服务器IP加入到host，可以用 * 对所有主机生效</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Host</span> *</span><br><span class="line"></span><br><span class="line">PubkeyAcceptedKeyTypes +ssh-rsa</span><br><span class="line"></span><br><span class="line">HostKeyAlgorithms +ssh-rsa</span><br></pre></td></tr></table></figure>
<p>第一行说明对所有主机生效, 第二行是将ssh-rsa加会允许使用的范围, 第三行是指定所有主机使用的都是ssh-rsa算法的key</p>
<p>连接测试成功，可以像往常一样通过SSH连接到服务器。</p>
]]></content>
  </entry>
  <entry>
    <title>11秦小明-新金融思维训练笔记第11讲-资本资产定价-股票与债券</title>
    <url>/11%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC11%E8%AE%B2-%E8%B5%84%E6%9C%AC%E8%B5%84%E4%BA%A7%E5%AE%9A%E4%BB%B7-%E8%82%A1%E7%A5%A8%E4%B8%8E%E5%80%BA%E5%88%B8.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC11%E8%AE%B2-%E8%B5%84%E4%BA%A7%E5%AE%9A%E4%BB%B7.png" alt="思维导图"></p>
<h1 id="资产定价">资产定价</h1>
<h2 id="预期">预期</h2>
<h3 id="price-in-已经发生的事-已经计入原来的资产价格了-不会对未来产生影响">Price In 已经发生的事，已经计入原来的资产价格了，不会对未来产生影响</h3>
<h3 id="定价是基于对未来的预期">定价是基于对未来的预期</h3>
<h3 id="打提前量">打提前量</h3>
<ul>
<li>1 预期 -&gt; 2市场根据预期运行 -&gt; 3实际情况出来，证实/修正预期</li>
</ul>
<h3 id="疑问">疑问</h3>
<ul>
<li>1.1 上个季度财报一出，不好！为什么也影响了股价？
<ul>
<li>其实直接影响的不是股价 是人们对股票未来的预期</li>
<li>对股票未来的预期⤵-&gt;股价⤵</li>
</ul>
</li>
<li>1.2 上个季度财报一出，不好！为什么没影响股价？
<ul>
<li>大家已经预期很烂，财报出来的没有比预期更烂</li>
</ul>
</li>
<li>2 经济这么差，为什么股票还在涨？</li>
<li>3 这个公司很厉害，为什么股价⤵？</li>
</ul>
<h2 id="预期是主观的">预期是主观的</h2>
<h3 id="股价反映大部分人的预期">股价反映大部分人的预期</h3>
<ul>
<li>不一定对</li>
<li>英国脱欧、特朗普选举胜利</li>
<li>情绪（是否超预期）推荐读书：反身术</li>
</ul>
<h3 id="你自己的主观认知-vs-主流市场的主观认知的差距-决定你能忍受多大的波动">你自己的主观认知 Vs 主流市场的主观认知的差距，决定你能忍受多大的波动</h3>
<h3 id="你自己的主观认知-vs-未来客观事实越接近-决定你能赚多少钱">你自己的主观认知 Vs 未来客观事实越接近， 决定你能赚多少钱</h3>
<h2 id="组合理论"><a href="https://wiki.mbalib.com/wiki/%E6%8A%95%E8%B5%84%E7%BB%84%E5%90%88%E7%90%86%E8%AE%BA" target="_blank" rel="noopener">组合理论</a></h2>
<h3 id="1不要把鸡蛋放同一个篮子">1不要把鸡蛋放同一个篮子</h3>
<ul>
<li>不同行业，关联性低
<ul>
<li>周期性行业，非周期性行业【医药】</li>
</ul>
</li>
</ul>
<h3 id="2组合中资产数量越多-分散风险越大">2组合中资产数量越多，分散风险越大</h3>
<h3 id="缺点">缺点</h3>
<ul>
<li>巴菲特反对组合理论，对冲风险也对冲了收益</li>
<li>钱多的时候，组合理论</li>
<li>钱少的时候，没必要组合理论，通过充分了解企业资产来降低风险</li>
<li>用多数时间研究，少数时间交易</li>
</ul>
<h2 id="capm资产定价模型"><a href="https://wiki.mbalib.com/wiki/%E8%B5%84%E6%9C%AC%E8%B5%84%E4%BA%A7%E5%AE%9A%E4%BB%B7%E6%A8%A1%E5%9E%8B" target="_blank" rel="noopener">CAPM资产定价模型</a></h2>
<h3 id="风险资产预期收益率-无风险回报率-beta系数-市场期望回报率-无风险回报率">风险资产预期收益率 = 无风险回报率+Beta系数*（市场期望回报率-无风险回报率）</h3>
<p>夏普发现单个股票或者股票组合的预期回报率(Expected Return)的公式如下：</p>
<p>$\overline r_a=r_f + \beta_a *(\overline r_m-\overline r_f)$</p>
<p>其中，rf(Risk free rate),是无风险回报率，纯粹的货币时间价值；</p>
<p>βa是证券的Beta系数，受市场大周期影响。</p>
<p>\bar{r_m}是市场期望回报率 (Expected Market Return)，</p>
<p>(\bar{r_m}-\bar{r_f})是股票市场溢价 (Equity Market Premium).</p>
<h3 id="股票定价绝对法-贴现现金流-discounted-cash-flow-dcf">股票定价绝对法 <a href="https://wiki.mbalib.com/wiki/DCF" target="_blank" rel="noopener">贴现现金流（Discounted Cash Flow,DCF）</a></h3>
<ul>
<li>
<p>绝对估值法称自由现金流贴现法【巴菲特用】</p>
</li>
<li>
<p>一项资产的内在价值是在生命周期里所产生的预期现金流，还有这些现金流的确定性。一家企业值多少钱，要看在其生命周期内，能从中拿回多少钱，未来可以拿到的钱折合到现在的钱是多少，然后通过总数和我们付出的金钱对比，看划算不划算。</p>
</li>
<li>
<p>1 估计公司未来自由现金流折现</p>
</li>
<li>
<p>2 多少年？无限期【永续经营】1-5年，后面跟第5年一样[假设稳定]</p>
</li>
<li>
<p>2 加起来</p>
</li>
</ul>
<h3 id="股票定价相对法"><a href="https://wiki.mbalib.com/wiki/%E7%9B%B8%E5%AF%B9%E4%BC%B0%E5%80%BC" target="_blank" rel="noopener">股票定价相对法</a></h3>
<ul>
<li>利润*倍数</li>
<li>相对估值包括PE、PB、PEG、EV/EBITDA等估值法。</li>
<li>通常的做法是对比
<ul>
<li>一个是和该公司历史数据进行对比，</li>
<li>二是和国内同行业企业的数据进行对比，确定它的位置</li>
<li>三是和国际上的(特别是香港和美国)同行业重点企业数据进行对比。</li>
</ul>
</li>
<li><a href="https://wiki.mbalib.com/wiki/%E5%B8%82%E7%9B%88%E7%8E%87" target="_blank" rel="noopener">PE</a>(Price/Earnings)＝p/e，即价格与每股收益的比值
<ul>
<li><a href="https://www.zhihu.com/question/20245733" target="_blank" rel="noopener">市盈率</a>＝普通股每股市场价格÷普通股每年每股盈利</li>
<li>市盈率过高，说明估值过高，不好</li>
<li>代表多少年能回本，50w买包子铺，每年赚5w 10年后回本</li>
<li>1 静态市盈率PE LYR=当前总市值除以去年一年的总净利润 【意义不大】</li>
<li>2 滚动市盈率PE-TTM=当前总市值除以前面四个季度的总净利润
<ul>
<li>简单点想就是PE TTM要比PE LYR更加准确一点，数据来得更新一些。</li>
</ul>
</li>
<li>3 动态市盈率PE TTM（此外在我国现通用）= 当前总市值除以明年的净利润
<ul>
<li>其计算公式是以静态市盈率为基数，乘以动态系数，该系数为$1 / [(1 + i)^n]$，i为企业每股收益的增长性比率，n为企业的可持续发展的存续期。</li>
<li>比如说，上市公司目前股价为20元，每股收益为0．38元，去年同期每股收益为0．28元，成长性为35％，即i＝35％，该企业未来保持该增长速度的时间可持续5年，即n＝5，则动态系数为$\frac{1}{(1+35%)^5}=22.3%$。相应地，动态市盈率为11.74。即：52.63（静态市盈率：20元／0.38元＝52）×22.3%。</li>
<li>帮助我们站在未来的角度来判断公司的估值贵贱。</li>
</ul>
</li>
</ul>
</li>
<li><a href="https://wiki.mbalib.com/wiki/%E5%B8%82%E5%87%80%E7%8E%87" target="_blank" rel="noopener">PB 市净率</a>
<ul>
<li>市净率=每股市价/每股净资产</li>
<li>市净率越低越好</li>
<li>金融类通常用PB来估值</li>
<li><a href="https://wiki.mbalib.com/wiki/%E5%87%80%E8%B5%84%E4%BA%A7" target="_blank" rel="noopener">净资产=资产-负债</a></li>
</ul>
</li>
<li><a href="https://wiki.mbalib.com/wiki/PEG" target="_blank" rel="noopener">PEG</a>=市盈率÷盈利增长比率
<ul>
<li>PEG值越低，说明该股的市盈率越低，或者盈利增长率越高，从而越具有投资价值。</li>
<li>假设某只股票的市盈率为30，通过计算和预测，得到企业盈利增长率为15%，则该股票的PEG为30÷15=2，如果盈利增长率为30%，则PEG为30÷30=1，如果盈利增长率为60%，则PEG为30÷60=0.5。显然，PEG值越低，说明该股的市盈率越低，或者盈利增长率越高，从而越具有投资价值。</li>
<li>如果PEG大于1，则这只股票的价值就可能被高估，或市场认为这家公司的业绩成长性会高于市场的预期。</li>
</ul>
</li>
</ul>
<p>通常，那些成长型股票的PEG都会高于1，甚至在2以上，投资者愿意给予其高估值，表明这家公司未来很有可能会保持业绩的快速增长，这样的股票就容易有超出想象的市盈率估值。</p>
<p>当PEG小于1时，要么是市场低估了这只股票的价值，要么是市场认为其业绩成长性可能比预期的要差。通常价值型股票的PEG都会低于1，以反映低业绩增长的预期。投资者需要注意的是，像其他财务指标一样，PEG也不能单独使用，必须要和其他指标结合起来，这里最关键的还是对公司业绩的预期。</p>
<h2 id="债券定价">债券定价</h2>
<ul>
<li>绝对法：未来的本金（现金流折现）+ 利息</li>
<li><a href="https://wiki.mbalib.com/wiki/%E7%A5%A8%E9%9D%A2%E5%88%A9%E7%8E%87" target="_blank" rel="noopener">票面利率Coupon rate</a>
<ul>
<li>发行债券时规定应付的并直接印刷在债券票面上的利率，表示每年应付的利息额与债券面额之比。</li>
</ul>
</li>
<li>收益率
<ul>
<li>由于债券交易价格变动，最终事实上实现的收益率</li>
<li>= 债券承诺到期价格（含承诺利率）- 债券交易价格</li>
<li>负相关 债券交易价格⤴债券牛市⤴收益率⤵</li>
<li>负相关 通胀 -&gt; 没人买债券 -&gt; 债券交易价格⤵收益率⤴</li>
<li>加息⤴新发行的债券承诺利率⤴ -&gt; 过去发行债券价格⤵  过去发行债券收益率⤴</li>
</ul>
</li>
<li>折现率</li>
<li>债券分类
<ul>
<li>利率债
<ul>
<li>基于利率</li>
<li>国债</li>
</ul>
</li>
<li>信用债
<ul>
<li>基于利率+发行方信用</li>
<li>企业债、公司债
<ul>
<li>公司债 上市公司发行，在交易所交易</li>
<li>企业债 国企等发行，在银行交易</li>
</ul>
</li>
<li>信用利差</li>
</ul>
</li>
<li>信用债利率通常&gt;利率债</li>
</ul>
</li>
<li>美国十年期国券 收益率 对全球经济影响
<ul>
<li>经济衰退 -&gt; 买债券 -&gt; 债券交易价格⤴收益率⤵ -&gt; 收益率曲线倒挂⤵
<ul>
<li>收益率曲线倒挂: 10年债券收益率通常比5年债券高，倒挂就是10年债券收益率通常比5年债券还低</li>
</ul>
</li>
<li>if 长期 美国国券收益率曲线倒挂 then 怀疑经济衰退</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>1秦小明 | 新金融思维训练笔记第01讲-金融的认知基础</title>
    <url>/1%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC01%E8%AE%B2-%E9%87%91%E8%9E%8D%E7%9A%84%E8%AE%A4%E7%9F%A5%E5%9F%BA%E7%A1%80.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC01%E8%AE%B2%20%E9%87%91%E8%9E%8D%E7%9A%84%E8%AE%A4%E7%9F%A5%E5%9F%BA%E7%A1%80.png" alt="思维导图"></p>
<h1 id="我的想法">我的想法</h1>
<p>一直想补充一下经济学知识，之前是伏地魔给我推荐的秦小明的公众号。后来伏地魔看到秦小明有开课程，他想跟着学，我就决定跟着听一听。他的课也许并不是最好的课，但对我这个金融小白入门来说肯定是够了。尤其是知道了一点点秦小明之前的黑料后，他的人设在我这里是倒了的。但是客观的说，他的课也非无用，只不过他的课对我来说的售价远远&gt;课程本身价格。简单说就是价格虚高，不值。</p>
<p>在现在这个时代，一不小心或者说即使万般小心，也难免被割韭菜。股市，房市，币圈，知识付费甚至是跑路的理发店，花店，健身房。<br>
别问我为啥知道，问就是被割了。<br>
知识付费在<br>
“<em><em>你是投资不是消费</em>*</em>”<br>
很安慰人心的口号下，对很多人来说也是割韭菜罢了。</p>
<p>对，股市也是<strong>投资</strong>，该被割还是被割！</p>
<p>当然这里也不是全然否定知识付费，就像是两个人都买了同一家健身房的健身卡。一个人每天都去健身，对他来说就是值得。对另一个人，健身房成了洗澡堂，那对他来说就是不值的。<br>
所以我只是想强调，在知识付费的时代，我们在知识付费前一定要想清楚：</p>
<ul>
<li>我是否会真正去认真的把课程学完？</li>
<li>我对这个课程的定位跟预期是什么样的？</li>
<li>这个课程值不值这个价钱？</li>
</ul>
<p>$$买了化妆品 \neq 变美了$$<br>
$$买了健身卡 \neq 身材变好$$<br>
$$买了课程 \neq 学会了$$</p>
<ul>
<li>
<p>我对这个课程的定位就是入门。如果今后对经济学还有兴趣，肯定还需要读更多的书来补充。仅靠这一个快餐式的课程肯定是不行的，但作为敲门砖应该还可。</p>
</li>
<li>
<p>感觉既然学了，就认真学，记下笔记，同时制作Xmind图来辅助。</p>
</li>
<li>
<p>个人认为他课的售价远远&gt;课程本身价格。简单说就是价格虚高，不值。因为他讲的是经济学的一些的基础知识，很多大学经济学的课本都可以涵盖。看其他人说当年课程的价格：299-&gt;599或699-&gt;…-&gt;2999，再到后来的8999，这涨价涨的太凶猛了，但据很多原来的学员说内容变化不大（可能包含学员主观因素，这里我们仅供参考。本人觉得这种可能性比较大，尤其学过几节课后。）。另外他的一些饥饿营销的手段（比如盲报阶段【不知课程内容和大纲】8000元，过了盲报期限后，后面价格8999元）也让我感觉微微不适。2999、8999的价格对我来说肯定不值，也许之前的299，599对我来说还值这个价。反正我是蹭伏地魔的课，白嫖，不亏，值。</p>
</li>
<li>
<p>找个一起学习的伙伴，可以相互监督，还可以讨论课程。你值得拥有！</p>
</li>
</ul>
<p>以上为个人主观观点，大家可以有自己不同的想法。</p>
<p>这节课比较基础, 大概形成理论。</p>
<hr>
<h1 id="课程目录">课程目录</h1>
<h2 id="day1-4：金融的认知基础">Day1-4：金融的认知基础</h2>
<h3 id="day2-第01讲-金融的认知基础：信息处理的ipo模型">Day2 第01讲 金融的认知基础：信息处理的IPO模型</h3>
<ul>
<li>客观经济金融世界VS参与者的主观世界</li>
<li>金融的认知基础：客观-认知-主观-行为</li>
</ul>
<h3 id="day4-第02讲-金融处理的核心问题">Day4 第02讲 金融处理的核心问题</h3>
<ul>
<li>金融处理的核心问题I：时间、空间、信息</li>
<li>金融处理的核心问题II：风险、定价、交易</li>
</ul>
<h2 id="day5-6：金融的微观基础-微观经济分析">Day5-6：金融的微观基础-微观经济分析</h2>
<h3 id="day6-第03讲-金融的微观基础-微观经济分析">Day6 第03讲 金融的微观基础-微观经济分析</h3>
<ul>
<li>理性人：大众误解最深的经济学概念，没有之一</li>
<li>效用理论：从我“最爽”出发，推出整个经济金融理论大厦</li>
<li>沉没成本：如何看待过去？止损的智慧</li>
<li>边际成本：边际思维的革命，财富为什么集中在特定行业</li>
<li>机会成本：做选择的终极法则，战略、格局、胸怀、眼光，皆源于此</li>
<li>竞争与套利：为什么大部分人都趋于平庸？套利均衡的必然</li>
</ul>
<h2 id="day7-10：金融的宏观基础-宏观经济分析">Day7-10：金融的宏观基础-宏观经济分析</h2>
<h3 id="day8-第04讲-金融的宏观基础-宏观经济分析i">Day8 第04讲 金融的宏观基础-宏观经济分析I</h3>
<h3 id="day10-第05讲-金融的宏观基础-宏观经济分析ii">Day10 第05讲 金融的宏观基础-宏观经济分析II</h3>
<ul>
<li>经典的凯恩斯宏观分析框架</li>
<li>基于债务和信用周期的分析框架</li>
<li>增长：为什么GDP的增长如此重要？从6.6%跌倒6%不行吗</li>
<li>GDP的构成：投资/消费/进出口到底是什么</li>
<li>通胀：只有跑得赢CPI的存款，才能赢得爱情</li>
<li>就业：全球央行死盯的目标，理解中国政策的核心变量</li>
<li>利率：核心中的核心，对人们的影响远超你的想象</li>
<li>汇率：为什么贸易谈判，要把汇率作为重点之一</li>
<li>货币政策：准备金、利率、各种“粉”（slf，mlf，tmlf）</li>
<li>财政政策：财政纪律vs刺激经济，谁优先</li>
<li>信用：从央妈到你的口袋，钱是怎么一步步流动的</li>
</ul>
<h2 id="day11-16：金融的财务会计基础-财务报表的理解">Day11-16：金融的财务会计基础-财务报表的理解</h2>
<h3 id="day12-第06讲-金融的财务会计基础i-商业分析的演绎框架">Day12 第06讲 金融的财务会计基础I-商业分析的演绎框架</h3>
<h3 id="day14-第07讲-金融的财务会计基础ii-会计思想及利润表">Day14 第07讲 金融的财务会计基础II-会计思想及利润表</h3>
<h3 id="day16-第08讲-金融的财务会计基础iii-资产负债表-现金流量表-财务分析">Day16 第08讲 金融的财务会计基础III-资产负债表&amp;现金流量表&amp;财务分析</h3>
<ul>
<li>商业分析的演绎框架，物理学第一性思维</li>
<li>会计的缘起：如何评价一个生意的好坏</li>
<li>会计的思想：从一个包子铺的故事说起</li>
<li>第一个报表：资产=负债+权益</li>
<li>第二个报表：利润=收入-成本</li>
<li>第三个报表：现金流跟利润有何不同</li>
<li>三张表的统一：财务模型的搭建</li>
<li>财务思想的运用：资本化vs费用化，构建资产vs构建收入</li>
</ul>
<h2 id="day17-21：公司金融及资本资产定价">Day17-21：公司金融及资本资产定价</h2>
<h3 id="day18-第09讲-金融的财务会计基础iv-财务建模-公司研究">Day18 第09讲 金融的财务会计基础IV-财务建模&amp;公司研究</h3>
<h3 id="day20-第10讲-公司金融与资本运作">Day20 第10讲 公司金融与资本运作</h3>
<ul>
<li>公司金融、资本运作（投融资/兼并收购）</li>
<li>股票定价模型</li>
<li>债券定价模型</li>
<li>商品定价模型</li>
<li>汇率定价模型</li>
<li>定价思想：无套利均衡</li>
</ul>
<h2 id="day22-24：金融市场及金融子行业">Day22-24：金融市场及金融子行业</h2>
<h3 id="day22-第11讲-资本资产定价-股票与债券">Day22 第11讲 资本资产定价-股票与债券</h3>
<h3 id="day24-第12讲-金融市场-股-债-商-汇">Day24 第12讲 金融市场-股、债、商、汇</h3>
<ul>
<li>金融市场：外汇/商品/股票/债市/房地产</li>
<li>新闻与政策：为何新闻对金融市场冲击很大</li>
<li>VC/PE的投资逻辑/交易/及其职业发展路径</li>
<li>投资银行/基金公司/商业银行等系统介绍</li>
</ul>
<h2 id="day25-29：投资交易实践">Day25-29：投资交易实践</h2>
<h3 id="day26-第13讲-金融行业-vcpe-商业银行-投资银行-基金公司等">Day26 第13讲 金融行业-VCPE、商业银行、投资银行、基金公司等</h3>
<h3 id="day28-第14讲-hpr-新闻政策对金融市场的冲击机制">Day28 第14讲 HPR、新闻政策对金融市场的冲击机制</h3>
<ul>
<li>HPR：一个通用的投资实务理解框架</li>
<li>一级市场及二级市场的投资实务</li>
<li>实务的概念和流程：开户、多空、杠杆、仓位</li>
<li>金融衍生品初步介绍（远期/期货/期权等）</li>
<li>投资心理：恐惧、贪婪、自信</li>
</ul>
<h2 id="day30：线下深度课程">Day30：线下深度课程</h2>
<h3 id="day30-第15讲-交易实务-金融衍生品初步与交易心理">Day30 第15讲 交易实务、金融衍生品初步与交易心理</h3>
<hr>
<h1 id="第01讲-金融的认知基础">第01讲 金融的认知基础</h1>
<h2 id="怎么学习更有效？">怎么学习更有效？</h2>
<h3 id="听音频会更加专注">听音频会更加专注</h3>
<h3 id="做学习笔记会印象更深刻">做学习笔记会印象更深刻</h3>
<h3 id="对比其他笔记进行回溯与修改">对比其他笔记进行回溯与修改</h3>
<ul>
<li>学习要有连续性，不能学一天休息一天</li>
</ul>
<h2 id="预期目标不要过高">预期目标不要过高</h2>
<h2 id="认知基础">认知基础</h2>
<h3 id="信息处理的ipo模型">信息处理的IPO模型</h3>
<p>（秦小明自己总结的认知IPO，同IPO（首次公开募股 Initial Public Offerings）不同）</p>
<ul>
<li>
<p>Input: 知识、理念、信息等外在刺激</p>
<ul>
<li>
<p>对象</p>
<ul>
<li>客观世界（自然世界）
<ul>
<li>（遵循数理逻辑）更容易形成共识，导致确定的逻辑结果</li>
</ul>
</li>
<li>主观世界（人、观念、想法）
<ul>
<li>（遵循概率逻辑）不能准确测量与推论，认知分歧，是不确定的猜测推论</li>
</ul>
</li>
</ul>
</li>
<li>
<p>认知机制：因为进化相关，更能准确处理客观外在内容，对主观内容辨别有限（听信谣言等人性弱点），因此更要刻意训练批判性思维</p>
</li>
<li>
<p>提升信息质量</p>
<ul>
<li>量：保证大量阅读</li>
<li>质：锻炼信息质量的分辨能力</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Processing: 信息处理方式</p>
<ul>
<li>
<p>工具</p>
<ul>
<li>学科方法论（跨学科思维）
<ul>
<li>数学推理</li>
<li>心理学常识</li>
<li>宏观经济传导</li>
<li>微观企业财务–&gt;资产定价</li>
</ul>
</li>
</ul>
</li>
<li>
<p>训练</p>
<ul>
<li>像训练AI一样做模型
<ul>
<li>大量数据</li>
<li>算法训练
<ul>
<li>Loop闭环式对加工后的输入进行正负反馈</li>
</ul>
</li>
</ul>
</li>
<li>提高算法精度：
<ul>
<li>领域基础（底层）逻辑（eg.赚钱（差价）=卖出-买入）</li>
<li>K线等工具都是服务于金融基础逻辑</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Output：输出</p>
<ul>
<li>不确定性-真实世界面临的结果往往具有不确定性
<ul>
<li>概率思维</li>
<li>不断提高概率</li>
<li>找到信息差
<ul>
<li>个人信息与群体信息偏差</li>
</ul>
</li>
</ul>
</li>
<li>质量提升
<ul>
<li>对比反馈：计算与实际结果的偏差，并进行优化</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ipo模型的实际作用">IPO模型的实际作用</h3>
<ul>
<li>检视：看看哪里出了错？</li>
<li>学习：提供知识关联的骨架与套路</li>
</ul>
<h3 id="投资的核心">投资的核心</h3>
<p>往往是获得信息差，以此基础进行套利。</p>
<ul>
<li>客观信息差
<ul>
<li>比如资产统计套利（一个资产场内场外价格不同）、或是提前知晓重要的信息（央行降息）</li>
<li>机会越来越少了</li>
</ul>
</li>
<li>主观信息差
<ul>
<li>大众预期与实际预期的偏差（比如对经济基本面的看法、G20事件的预判）</li>
<li>心理偏误，心理惯性（房子原来一直涨，认为房子一直会涨），考验的是对交易心理的考察</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>2秦小明 | 新金融思维训练笔记第02讲-金融处理的核心问题</title>
    <url>/2%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC02%E8%AE%B2-%E9%87%91%E8%9E%8D%E5%A4%84%E7%90%86%E7%9A%84%E6%A0%B8%E5%BF%83%E9%97%AE%E9%A2%98.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC02%E8%AE%B2%EF%BC%9A%E9%87%91%E8%9E%8D%E5%A4%84%E7%90%86%E7%9A%84%E6%A0%B8%E5%BF%83%E9%97%AE%E9%A2%98.png" alt="思维导图"></p>
<h1 id="第02讲：金融处理的核心问题">第02讲：金融处理的核心问题</h1>
<p>思维方法：思维方法永远比具体方法更有用</p>
<h2 id="第一性思维原理-演绎思维-：从根本的逻辑点出发进行推演-寻找证据-补充证明">第一性思维原理（演绎思维）：从根本的逻辑点出发进行推演，寻找证据，补充证明</h2>
<p>（秦小明的文章大多采用该方法组织）</p>
<h3 id="投资的第一性思维原理：hpr公式-持有收益-期末价格-成本-p1-p0">投资的第一性思维原理：HPR公式（持有收益=期末价格-成本=P1-P0）</h3>
<h3 id="投资目的就是赚取差价-其实就是要看公司目前的成本-p0-是否合理-未来-p1-是否有升值空间">投资目的就是赚取差价，其实就是要看公司目前的成本（P0）是否合理，未来（P1）是否有升值空间</h3>
<h2 id="hpr公式-holding-period-return">HPR公式（Holding Period Return）</h2>
<blockquote>
<p>持有期回报(HPR)是Holding Period Return持有期收益率<br>
（HPY）Holding Period yield两者计算方式一样的P1/P0-1，yield更多的考虑债券市场，来进行T-bill各种年化收益率的转换，而return是考量股票持有期收益，衡量投资组合业绩。持有期的收益率是时间无效的，一般要年化来进行比较。<br>
作者：李子<br>
链接：<a href="https://www.zhihu.com/question/65764013/answer/826585372" target="_blank" rel="noopener">https://www.zhihu.com/question/65764013/answer/826585372</a><br>
来源：知乎<br>
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
</blockquote>
<ul>
<li>持有期间收益=P1/P0-1=(P1-P0)/P0=期末价格/期初价格-1</li>
<li>定价是现代金融的核心
<ul>
<li>P0是否合理，低/高估，（用定价模型）给公司估值定价</li>
<li>P1到哪里，也涉及到定价问题，宏观情况（宏观知识），微观基础（企业财务报表），参数做定价模型</li>
</ul>
</li>
<li>P0到P1的过程，要经历风险、降低风险、风险定价，实现投资结果</li>
</ul>
<h2 id="第一性原理-first-principle-thinking">第一性原理 First principle thinking</h2>
<p>什麽是第一性原理<br>
　　第一性原理又称“第一原理”。其实是古希腊哲学家亚里士多德提出的一个哲学术语：“每个系统中存在一个最基本的命题，它不能被违背或删除。”</p>
<p>这个名词被炒的很火主要得益于“钢铁侠”埃隆·马斯克（特斯拉汽车CEO）。他曾在採访中提到自己特别推崇“第一原理”思考法：“通过第一原理，我把事情升华到最根本的真理，然后从最核心处开始推理……”</p>
<p>“我们运用第一性原理，而不是比较思维去思考问题是非常重要的。我们在生活中总是倾向于比较，对别人已经做过或者正在做的事情我们也都去做，这样发展的结果只能产生细小的迭代发展。第一性原理的思想方式是用物理学的角度看待世界，也就是说一层层拨开事物表象，看到裡面的本质，再从本质一层层往上走。”这是他眼中的“第一性原理思维模型”——回溯事物的本质，重新思考怎麽做。</p>
<p>比如他的Hyperloop（真空胶囊高铁）。如果他用比较性思维去做高铁，那最多也就在参数上提高，动力更强，流体力学更好等等。但他回溯到人类造火车的本质目的——将较多的人或货物从指定地点A运送到指定地点B。这是造火车的本质目的，并没有人规定必须用动力牵引的形式造火车。但因为我们长时间以来都是这样造火车的，导致我们固化地认为，火车就应该长成那样子。而伊隆·马斯克却用批判性思维和怀疑精神拷问这个固化认知，回溯到事物的本质，重新设计出颠覆人们观念的东西。</p>
<p>第一性原理思考举例<br>
1.键盘滑鼠是我们的真实需求吗？</p>
<p>我们使用键盘滑鼠的本质目的是什麽——向电脑输入指令和信息。为啥要用键盘滑鼠，因为技术限制，我们只能通过这样的方式向电脑输入指令和信息。但是，如果我们的大脑能够直接与电脑交互，那我们就不需要键盘滑鼠了。可是我们长时间以来习惯了用键盘和滑鼠，所以在大多数人的认知中，电脑就应该长成那样，有屏幕，有键盘，有滑鼠，或者触摸屏。大部分人固化了这个认知，但伊隆·马斯克却用批判性思维和怀疑的精神拷问这个认知，于是有了他的另一个项目——neuralink（脑机融合）</p>
<p>2.“便利的获取内容”更重要</p>
<p>20世纪80年代，互联网诞生早期，多数互联网企业都倾力于为网民提供各种网站内容，80后应该有印象，我们一上网就登录搜狐、新浪之类的门户网站。</p>
<p>但远比门户时代更早的十多年前，就有两个年轻人认为：比起内容本身，如何让用户“便利的获取内容”更重要，这将产生万亿美元级的市场潜力。那个年代，网民总量少、互联网上内容稀少、许多服务还是付费，如果这两个年轻人对外宣扬这种想法，公众只会嗤之以鼻，没人会认为他们高瞻远瞩。</p>
<p>但历史证明，少数人的观点多半是对的。这两个年轻人是布林和佩奇，Google创始人。他们对互联网产业的核心洞察：“便利、免费”贯穿了Google从创立到强盛的整个历程。</p>
<h3 id="例子：一家公司是否值得投资？">例子：一家公司是否值得投资？</h3>
<ul>
<li>漏洞思维：评估这家公司是否是一家好公司？好公司：投资 不好公司：不投资</li>
<li>正确思维：现公司估值是偏高/低？我的P1-P0是否能盈利？ 而非一家好公司就值得投资</li>
</ul>
<h2 id="金融处理的六大对象">金融处理的六大对象</h2>
<h3 id="时间">时间</h3>
<p>10年盈利2%与1年是不同的。</p>
<ul>
<li>周期性
<ul>
<li>人为定周期</li>
<li>经济具有周期性，由人性变化产生</li>
</ul>
</li>
<li>连续性
<ul>
<li>投资时间是连续的不可逆，不同的时间回报不同</li>
<li>结合当时的时代背景，投资方法需要随着时间进行进化</li>
</ul>
</li>
<li>延迟满足
<ul>
<li>跨时间的交易行为：比如借贷–&gt;利息</li>
<li>时间周期↗ 收益（回报）↗</li>
<li>统一时间框架就是“年化收益率“</li>
</ul>
</li>
</ul>
<h3 id="空间">空间</h3>
<ul>
<li>主要是跨空间的贸易往来与结算，比如跨区域结算，也产生了汇率</li>
<li>区域会产生套利机会
<ul>
<li>A市场2元，B市场3元,A运到B运费0.5元。A倒卖到B价格2.5元，卖3元，挣0.5元。</li>
</ul>
</li>
<li>套利行为消灭套利机会（无套利均衡）
<ul>
<li>随着越来越多A卖到B,A供给减少价格上升，B供给增加价格下降，最终AB价格一样。</li>
<li>行业内要趁早，存在套利机会，之后大家都知道后，套利机会就没有了。</li>
</ul>
</li>
<li>商品本位的货币制度
<ul>
<li>结算需要一致货币体系，发展出商品为锚定物的货币制度贝壳-&gt;金银本位），但是现在美元政策已经脱钩了</li>
<li>例如，以包子为锚定物的货币制度。银行印1元，银行里要有一个包子。市场上一个包子1.2元（通胀），人会拿钱去银行买包子，到市场卖。市场上包子↗货币↘，银行货币↗，包子价格↘又回到1元；市场上一个包子0.8元（通缩），人会拿钱去市场买包子，到银行卖。市场上包子↘货币↗，银行货币↘，包子价格↗。</li>
</ul>
</li>
</ul>
<h3 id="信息">信息</h3>
<ul>
<li>信息是认知的先决条件，包括新闻、年报、公告</li>
<li>IPO模型的关键Input</li>
<li>特朗普Twitter–&gt;影响主观预期</li>
</ul>
<h3 id="风险">风险</h3>
<ul>
<li>是可以计算出概率的一种不确定性，不可以计算出概率的一种不确定性不叫风险</li>
<li>大概率时要加仓，通过IPO模型，提高概率判断，即对风险的把控程度</li>
<li>风险来源
<ul>
<li>客观信息上的不对称（例如有人知道央行降息，有人不知道）</li>
<li>主观信息上的不可知（不能完整知道市场上所有玩家的信息）</li>
</ul>
</li>
<li>利息，就是对未来风险+延迟满足（时间价值）的补偿</li>
</ul>
<h3 id="定价">定价</h3>
<ul>
<li>金融的核心以及目前最顶端的内容</li>
<li>金融定价=成本+时间价值+风险补偿 = 成本+ 机会成本</li>
<li>不同资产拥有不同的定价方法</li>
</ul>
<h3 id="交易">交易</h3>
<ul>
<li>交易的核心是：风险与锚（心理价位）</li>
<li>交易推动价格的产生，发现价值，推进资源配置与社会进步</li>
<li>交易应该先确定当前合理价格（套利），再考虑未来价格（增长）</li>
</ul>
<hr>
<h1 id="我的想法">我的想法</h1>
<p>讲解里面的两点我有一点点不赞同，或者说秦小明没有很严谨的表达好。我的想法和疑问不一定对，欢迎大家指正和讨论。</p>
<h2 id="1-秦小明认为：股票投资股票不同于赌博">1. 秦小明认为：股票投资股票不同于赌博</h2>
<p>股票投资是可以计算出概率的一种不确定性，赌博是不可以计算出概率的一种不确定性。</p>
<h3 id="我的想法：">我的想法：</h3>
<p>排除抽老千、认为操纵等因素，赌博也是概率问题，是可以计算出概率的一种不确定性的。</p>
<p><strong>当然我觉得秦小明这里应该本意是强调:</strong></p>
<ul>
<li>什么都不懂，什么功课都不做，也不计算概率就冒然入场，必定血本无归。</li>
<li>只不过赌博可能不是很恰当的例子，当然赌博可能也有那种傻憨憨，纯靠运气不算牌、不算概率就瞎怼吧。</li>
</ul>
<h2 id="2-秦小明在讲-金融处理的六大对象-交易-的时候认为：交易应该先确定当前合理价格-套利-再考虑未来价格-增长">2. 秦小明在讲“金融处理的六大对象——交易”的时候认为：交易应该先确定当前合理价格（套利），再考虑未来价格（增长）。</h2>
<h3 id="我的想法：-v2">我的想法：</h3>
<p>这点（交易应该先确定当前合理价格）与他刚开始讲解HPR公式和举的例子有点矛盾。<br>
在讲解HPR公式时，秦小明举例说：一家公司是否值得投资？</p>
<ul>
<li>新人漏洞思维：评估这家公司是否是一家好公司？好公司：投资 不好公司：不投资</li>
<li>正确思维：现公司估值是偏高/低？我的P1-P0是否能盈利？ 而非一家好公司就值得投资</li>
</ul>
<p>用第一性原理 First principle thinking 思考的话，我根本目的：赚钱！<br>
那按照公式：</p>
<blockquote>
<p>持有期间收益=P1/P0-1=(P1-P0)/P0=期末价格/期初价格-1。</p>
</blockquote>
<p>我只要P1-P0&gt;0 不就行了，也就是只要我能确定未来价格是增长的，我可以不管当前价格是否合理。</p>
<p><strong>可能秦小明这里应该指的是：</strong></p>
<ul>
<li>首先第一点呢，我们无法100%的来确定未来的价格是增长的，现实中它是一个&lt;100%概率。如果这个概率等于百分之百的话，我们当然可以不管当前价格是否合理，而现实是“未来的价格是增长的”概率&lt;100%。</li>
<li>交易应该先确定当前合理价格会影响风险。当前的价值估值是偏低，那我未来的风险就会越低。<br>
3秦小明-新金融思维训练笔记第03讲-金融的微观基础</li>
</ul>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>7秦小明-新金融思维训练笔记第07讲-金融的财务会计基础II-会计思想及利润</title>
    <url>/7%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC07%E8%AE%B2-%E9%87%91%E8%9E%8D%E7%9A%84%E8%B4%A2%E5%8A%A1%E4%BC%9A%E8%AE%A1%E5%9F%BA%E7%A1%80II-%E4%BC%9A%E8%AE%A1%E6%80%9D%E6%83%B3%E5%8F%8A%E5%88%A9%E6%B6%A6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC07%E8%AE%B2-%E4%BC%9A%E8%AE%A1%E6%80%9D%E6%83%B3%E5%8F%8A%E5%88%A9%E6%B6%A6%E8%A1%A8.png" alt="思维导图"></p>
<h1 id="会计思想及利润表">会计思想及利润表</h1>
<h2 id="会计">会计</h2>
<h3 id="国际标准">国际标准</h3>
<ul>
<li>欧洲 IFRS （International Financial Reporting Standards）</li>
<li>美国 GAAP (generally accepted accounting principles)</li>
</ul>
<h3 id="权责发生制-更合理">权责发生制（更合理）</h3>
<ul>
<li>交易中，权利和责任的转移</li>
<li>公司财务报表用【权责发生制】</li>
</ul>
<h3 id="永续经营的假设-on-going-basis">永续经营的假设 On going basis</h3>
<h3 id="收付实现制">收付实现制</h3>
<ul>
<li>交易中，现金交换</li>
<li>税收用【收付实现制】</li>
</ul>
<h2 id="财务三张表">财务三张表</h2>
<h3 id="资产负债表-资产-所有者权益-负债">资产负债表:资产=所有者权益+负债</h3>
<ul>
<li>50w=25w（自己）+25w（借），这个等式资产负债表的含义，动用的资源就是自己的资产和借来的负债。</li>
</ul>
<h3 id="利润表-利润-收入-成本">利润表: 利润=收入-成本</h3>
<ul>
<li>利润表Income statement = 损益表profit &amp; lost = 运营表 statement Operations</li>
<li>第二年除去各种成本，还赚了10w，就是利润。这利润如果投入再生产，就会进入资产负债表，与【资产负债表】发生关系。</li>
</ul>
<h3 id="现金流量表-现金流量-流入-流出">现金流量表:现金流量=流入-流出</h3>
<ul>
<li>今年年初现金是30w，年底是35w，现金就多了5w。整体多的5w现金就会进入资产负债表，与之发生联系。而卖包子时的流入流出，可以跟利润表的利润（收入、支出）联系起来。</li>
</ul>
<h2 id="利润表解析">利润表解析</h2>
<h3 id="收入部分">收入部分</h3>
<ul>
<li>毛收入Topline</li>
<li>净收入 net income = 毛收入- 收入税</li>
<li>归属母公司净利润：股票估值的基础</li>
</ul>
<h4 id="成本部分">成本部分</h4>
<ul>
<li>主营业务成本（生产直接相关）
<ul>
<li>毛利润 = 毛收入 - 主营业务成本</li>
<li>毛利润率 = 毛利润/毛收入</li>
<li>稳定行业内同类公司间的毛利率不会差太多，比如美的、格力毛利相似（套利应用、检验作假）</li>
</ul>
</li>
<li>运营成本(固定成本)
<ul>
<li>销售与市场营销 S&amp;M Sales &amp; Marketing</li>
<li>研发 R&amp;D Research &amp; Development</li>
<li>一般管理费用 General and Administrative Expense</li>
<li>运营利润 = 毛利润-运营成本
<ul>
<li>运营利润代表公司经营效率</li>
<li>传统行业都在拼运营效率</li>
<li>提升运营效率，就是最小运营成本，来获得最大运营利润。</li>
</ul>
</li>
</ul>
</li>
<li>其他成本</li>
<li>总结
<ul>
<li>毛收入 - 收入税 = 净收入</li>
<li>净收入 - 主营业务成本 = 毛利润</li>
<li>毛利润 - 运营成本 = 运营利润</li>
<li>运营利润 +/- 各种其他收入支出 = 税前利润</li>
<li>税前利润 - 税 = 净利润</li>
<li>合并报表的净利润 - 子公司少数股东权益  = 母公司净利润</li>
</ul>
</li>
</ul>
<h2 id="利润表延伸的经营杠杆">利润表延伸的经营杠杆</h2>
<p>经营效率提到，在同样固定成本同样成本投入下，一个会计（举例某类投入）可以照顾更多收入规模，会计的投入产生作用更大，经营效率就更高，会计撬动收入就更大，这就是经营杠杆。</p>
<h3 id="运营杠杆">运营杠杆</h3>
<p>在租金固定的情况下包子卖越多越好，请一个会计计算规模越大越好。其实就是由于固定成本的存在，利润的变动大于了收入的变动，利润增长率高于了产品销售增长率。</p>
<ul>
<li>运营杠杆系数=息税前利润变动率/收入变动率
<ul>
<li>息税前利润 = 未扣利息和税的利润 约等于 运营利润</li>
<li>其实就是“考虑固定成本之后的利润变动”与“考虑固定成本之前的利润变动”的比较</li>
<li>关注【固定成本】对经营的影响。</li>
</ul>
</li>
</ul>
<h3 id="财务杠杆">财务杠杆</h3>
<p>除了成本之外，还会出现负债。像万科这样高负债地产公司，就要考虑在相同的借款利息下如何收益最大化，同样利息支出带来更多的经营效率。</p>
<ul>
<li>财务杠杆系数=净利润变动率/息税前利润变动率
<ul>
<li>其实就是“扣掉利息之后的利润变动”跟“扣掉利息之前的利润变动”进行比较</li>
<li>关注【利息】对经营的影响。</li>
</ul>
</li>
</ul>
<h3 id="公司总杠杆">公司总杠杆</h3>
<p>两个杠杆同时发生作用就形成了公司总杠杆。收入增长了10%，每股净利润增长了20%，总杠杆就是2倍，这个杠杆越大越好，赚钱的效率就会很高。当然杠杆变大会导致一些脆弱性，这个也会存在一定的度。</p>
<ul>
<li>总杠杆 = 运营杠杆 * 财务杠杆 =（息税前利润变动率/收入变动率）*（净利润变动率/息税前利润变动率） = 净利润变动率 / 收入变动率。</li>
<li>关注【固定资产和利息】对于利润变动的影响。</li>
</ul>
<hr>
<h1 id="完整音频转文字">完整音频转文字</h1>
<h2 id="会计的产生与基础思想">会计的产生与基础思想</h2>
<p>如何判断一个生意是个好生意？一个公司盈利能力如何？<br>
这要回到量化的分析基础上，通过一些数据指标来判别，会计主要就是处理这些量化的问题。因为不同的公司账务需要会计的处理才能对比，因此产生了一套广泛接受的标准来做账，在这个体系下面的经营成果才能被认可。这个标准都是基于两个基础会计思想：</p>
<ol>
<li>权责发生制。比如，小明包子卖出去，客人从店里带走，关于包子的权利和义务就发生了转移。核心是根据商业交易的本质，是权利和义务发生转移的过程，进而确定交易是否构成收入、成本。权责发生制是最核心的基础思想。另一个核心思想是永续经营的假设。</li>
<li>收付实现制。现金的流转来确定交易是否发生。比如，老王买包子是赊账，在收付实现制上就不能计入收入。</li>
</ol>
<blockquote>
<p>在现行的国际做账体系中，有两套标准。非美国国家，特别是欧洲，使用IFRS（International Financial Reporting Standards）。美国用的比较多的GAAP(generally accepted accounting principles)。二者主要思想是一致的，差别只是在科目，交易的处理上。如果不是专门的会计，不考专业证书（CFA考试重点），其实不用理解二者体系的差别。</p>
</blockquote>
<h2 id="会计三张表">会计三张表</h2>
<p>那财务著名的三张表为什么产生？三张表有什么关系？我们可以利用第一性思维原理解读会计三张表。</p>
<blockquote>
<p>用例子理解三张表。小明包子铺的本质目的是盈利，因此就产生了收入、成本（盈利=收入-成本）。产生收入就需要卖包子，那就必须生产包子，需要有原材料、店面、工人、销售等有很多投入（成本）。如果开包子铺需要动用的资源（50w，自己25w，借贷25w）。实现收入后，去除成本还能盈利10w，盈利还能变成下一个过程中用到的资源，第二阶段资源源就变成了60w（赚10w）。在营收的过程中，还会遇到老王等人的赊账行为，所以要进行应收账款的记录。</p>
</blockquote>
<ol>
<li>
<p>资产负债表。50w=25w（自己）+25w（自己），这个等式资产负债表的含义（资产=所有者权益+负债），动用的资源就是自己的资产和借来的负债。</p>
</li>
<li>
<p>利润表。第二年除去各种成本，还赚了10w，就是利润（利润=收入-成本）。这利润如果投入再生产，就会进入资产负债表，与资产负债表发生关系。</p>
</li>
<li>
<p>现金流量表。今年年初现金是30w，年底是35w，现金就多了5w（现金流量=流入-流出）。整体多的5w现金就会进入资产负债表，与之发生联系。而卖包子时的流入流出，可以跟利润表的利润（收入、支出）联系起来。</p>
</li>
</ol>
<h3 id="利润表解析-v2">利润表解析</h3>
<blockquote>
<p>净利润=收入-成本</p>
</blockquote>
<p>一个上市公司的财务报告都会有财务报表，这是分析股票基本面很重要的参考资料，巴菲特等大佬都仔细阅读分析。年报是了解一家公司最快速的资料，比如要从0开始了解白酒行业，去看一下茅台和五粮液的年报（几百页）找出来通读，就会把各方面披露的很清楚；还有就是去看一些刚上市公司的招股说明书，也会做出详尽的披露。利润表有很多叫法，利润表/经营表（Statement of Operations）/损益表（Profits and losts）。下面会分步分解：</p>
<h4 id="收入部分-v2">收入部分</h4>
<p>首先会披露收入。Topline是毛收入，扣收入税之后就成了净收入，收入还会产品线分类披露，分区域市场呈现。还有一个特殊概念，是归属部分股东的净利润。上市公司有大量子公司，要扣除子公司的净利润，得出归属母公司净利润作为股票估值的基础。</p>
<h4 id="成本部分-v2">成本部分</h4>
<p>然后会披露成本，一般包括主营业务成本、运营成本和其他成本。<br>
主营业务成本（生产直接相关），扣除这个成本就会出现毛利润，继而可以算出毛利润率；毛利润代表着行业盈利情况，稳定行业内同类公司间的毛利率不会差太多，比如美的、格力毛利相似（套利应用、检验作假）。<br>
运营成本通常包含三大部分：销售与市场营销、研发、一般管理费用；毛利润-运营成本=运营利润，运营利润代表公司经营效率，传统行业都在拼运营效率。提升运营效率，就是最小运营成本，来获得运营利润。</p>
<blockquote>
<p>其他成本，税务补缴（递延所得税）等。这些很多小知识点可以从本质去理解。<br>
做个总结 ：收入 - &gt;净收入（税收）-&gt;毛利润（主营收入成本）-&gt;运营利润（运营成本）-&gt;税前利润（各种收入支出）-&gt;净利润（所得税）-&gt;母公司净利润（子公司少数股东权益）</p>
</blockquote>
<h2 id="经营杠杆">经营杠杆</h2>
<p>经营效率提到，在同样固定成本同样成本投入下，一个会计（举例某类投入）可以照顾更多收入规模，会计的投入产生作用更大，经营效率就更高，会计撬动收入就更大，这就是经营杠杆。</p>
<h3 id="运营杠杆-v2">运营杠杆</h3>
<p>在租金固定的情况下包子卖越多也好，请一个会计计算规模越大越好。其实就是由于固定成本的存在，利润的变动大于了收入的变动，利润增长率高于了产品销售增长率。</p>
<blockquote>
<p>经营杠杆系数=息税前利润变动率/收入变动率<br>
其实就是“考虑固定成本之后的利润变动”与“考虑固定之前的利润变动”的比较。简单理解一个思想就好，让有限的投入带来更大的回报。</p>
</blockquote>
<h3 id="财务杠杆-v2">财务杠杆</h3>
<p>除了成本之外，还会出现负债。像万科这样高负债地产公司，就要考虑在相同的借款利息下如何收益最大化，同样利息支出带来更多的经营效率。</p>
<blockquote>
<p>财务杠杆系数=净利润变动率/息税前利润变动率<br>
其实就是“扣掉利息之后的利润变动”跟“扣掉利息之前的利润变动”进行比较，查看利息对经营的影响。</p>
</blockquote>
<h3 id="公司总杠杆-v2">公司总杠杆</h3>
<p>两个杠杆同时发生作用就形成了公司中杠杆。收入增长了10%，每股净利润增长了20%，总杠杆就是2倍，这个杠杆越大越好，赚钱的效率就会很高。当然杠杆变大会导致一些脆弱性，这个也会存在一定的度。</p>
<blockquote>
<p>公式上就是：<br>
总杠杆 =运营杠杆<em>财务杠杆 =  （息税前利润变动率/收入变动率）</em>（净利润变动率/息税前利润变动率） = 净利润变动率 / 收入变动率。<br>
其实就是考察“固定资产和利息”对于利润变动的影响。</p>
</blockquote>
<h3 id="杠杆思维">杠杆思维</h3>
<p>杠杆是一个思维，如果自己做老板、创业、工作，让自己更可能多的放大自己的财务、人力投入。</p>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker-Xmind</title>
    <url>/Docker-Xmind.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="docker-command">Docker Command<a href="http://liyuankun.top/Docker.html"></a></h1>
<h2 id="服务">服务</h2>
<h3 id="查看docker系统信息-信息比docker-version更多">查看Docker系统信息（信息比<code>docker version</code>更多）</h3>
<ul>
<li>docker system info</li>
</ul>
<h3 id="查看docker版本信息">查看Docker版本信息</h3>
<ul>
<li>docker version</li>
</ul>
<h3 id="查看docker简要信息">查看docker简要信息</h3>
<ul>
<li>docker -v</li>
</ul>
<h3 id="启动docker">启动Docker</h3>
<ul>
<li>systemctl start docker</li>
</ul>
<h3 id="关闭docker">关闭docker</h3>
<ul>
<li>systemctl stop docker</li>
</ul>
<h3 id="设置开机启动">设置开机启动</h3>
<ul>
<li>systemctl enable docker</li>
</ul>
<h3 id="重启docker服务">重启docker服务</h3>
<ul>
<li>service docker restart</li>
</ul>
<h3 id="关闭docker服务">关闭docker服务</h3>
<ul>
<li>service docker stop</li>
</ul>
<h2 id="镜像">镜像</h2>
<h3 id="镜像仓库">镜像仓库</h3>
<ul>
<li>检索镜像
<ul>
<li><code>docker search 关键字</code></li>
</ul>
</li>
<li>拉取镜像
<ul>
<li><code>docker pull [选项] [Docker Registry 地址[:端口号]/]仓库名[:标签]</code></li>
</ul>
</li>
</ul>
<h3 id="镜像管理">镜像管理</h3>
<ul>
<li>
<p>列出镜像</p>
<ul>
<li><code>docker image ls</code></li>
<li><code>docker images</code></li>
</ul>
</li>
<li>
<p>删除镜像</p>
<ul>
<li>docker image rm &lt;镜像Id&gt;</li>
</ul>
</li>
<li>
<p>导出镜像<br>
将镜像保存为归档文件</p>
<ul>
<li>docker save</li>
</ul>
</li>
<li>
<p>导入镜像</p>
<ul>
<li>docker load</li>
</ul>
</li>
</ul>
<h3 id="dockerfile构建镜像">Dockerfile构建镜像</h3>
<p>Dockerfile 是一个文本格式的配 文件，用户可以使用 Dockerfile 来快速创建自定义的镜像。</p>
<p>Dockerfile 由一行行行命令语句组成，并且支持以＃开头的注释行.</p>
<ul>
<li>
<p>Dockerfile常见指令<br>
下面是Dockerfile中一些常见的指令：</p>
<ul>
<li>
<p>FROM：指定基础镜像</p>
</li>
<li>
<p>RUN：执行命令</p>
</li>
<li>
<p>COPY：复制文件</p>
</li>
<li>
<p>ADD：更高级的复制文件</p>
</li>
<li>
<p>CMD：容器启动命令</p>
</li>
<li>
<p>ENV：设置环境变量</p>
</li>
<li>
<p>EXPOSE：暴露端口</p>
</li>
</ul>
</li>
</ul>
<p>其它的指令还有ENTRYPOINT、ARG、VOLUME、WORKDIR、USER、HEALTHCHECK、ONBUILD、LABEL等等。</p>
<ul>
<li>
<p>镜像构建</p>
<ul>
<li><code>docker build</code></li>
</ul>
</li>
<li>
<p>镜像运行<br>
镜像运行，就是新建并运行一个容器。</p>
<ul>
<li><code>docker run [镜像ID]</code></li>
</ul>
</li>
</ul>
<h2 id="容器">容器</h2>
<h3 id="容器生命周期">容器生命周期</h3>
<ul>
<li>启动：启动容器有两种方式，一种是基于镜像新建一个容器并启动，另外一个是将在终止状态（stopped）的容器重新启动。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 新建并启动</span></span><br><span class="line">docker run [镜像名/镜像ID]</span><br><span class="line"><span class="comment"># 启动已终止容器</span></span><br><span class="line">docker start [容器ID]</span><br></pre></td></tr></table></figure>
<ul>
<li>查看容器</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 列出本机运行的容器</span></span><br><span class="line">$ docker ps</span><br><span class="line"><span class="comment"># 列出本机所有的容器（包括停止和运行）</span></span><br><span class="line">$ docker ps -a</span><br></pre></td></tr></table></figure>
<ul>
<li>停止容器</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 停止运行的容器</span></span><br><span class="line">docker stop [容器ID]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 杀死容器进程</span></span><br><span class="line">docker  <span class="built_in">kill</span> [容器ID]</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>重启容器</p>
<ul>
<li><code>docker restart [容器ID]</code></li>
</ul>
</li>
<li>
<p>删除容器</p>
<ul>
<li><code>docker rm [容器ID]</code></li>
</ul>
</li>
<li>
<p>进入容器<br>
进入容器有两种方式：</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 如果从这个 stdin 中 exit，会导致容器的停止</span></span><br><span class="line">docker attach [容器ID]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 交互式进入容器</span></span><br><span class="line">docker <span class="built_in">exec</span> [容器ID]</span><br></pre></td></tr></table></figure>
<p>进入容器通常使用第二种方式，<code>docker exec</code>后面跟的常见参数如下：</p>
<p><code>－ d, --detach</code> 在容器中后台执行命令；<br>
<code>－ i, --interactive=true I false</code> ：打开标准输入接受用户输入命令</p>
<h3 id="导出和导入">导出和导入</h3>
<ul>
<li>导出容器</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导出一个已经创建的容器到一个文件</span></span><br><span class="line">docker <span class="built_in">export</span> [容器ID]</span><br></pre></td></tr></table></figure>
<ul>
<li>导入容器</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导出的容器快照文件可以再导入为镜像</span></span><br><span class="line">docker import [路径]</span><br></pre></td></tr></table></figure>
<h3 id="其它">其它</h3>
<ul>
<li>查看日志</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导出的容器快照文件可以再导入为镜像</span></span><br><span class="line">docker logs [容器ID]</span><br></pre></td></tr></table></figure>
<p>这个命令有以下常用参数</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> -f : 跟踪日志输出</span><br><span class="line"></span><br><span class="line">--since :显示某个开始时间的所有日志</span><br><span class="line"></span><br><span class="line">-t : 显示时间戳</span><br><span class="line"></span><br><span class="line">--tail :仅列出最新N条容器日志</span><br></pre></td></tr></table></figure>
<ul>
<li>复制文件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 从主机复制到容器</span></span><br><span class="line">sudo docker cp host_path containerID:container_path </span><br><span class="line"><span class="comment"># 从容器复制到主机</span></span><br><span class="line">sudo docker cp containerID:container_path host_path</span><br></pre></td></tr></table></figure>
<h1 id="docker练习">docker练习</h1>
<h2 id="create-two-docker-containers-sharing-the-same-pid-namespace">Create two Docker containers sharing the same PID namespace</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/container-namespaces-docker" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/container-namespaces-docker</a></p>
<p>Run two Docker containers <code>app1</code> and <code>app2</code> with the following attributes:</p>
<ul>
<li>they should run image <code>nginx:alpine</code></li>
<li>they should share the same <code>PID</code> kernel namespace</li>
<li>they should run command <code>sleep infinity</code></li>
<li>they should run in the background (detached)</li>
</ul>
<p>Then check which container sees which processes and make sense of why.</p>
<h3 id="solution">Solution</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1 Run first container</span></span><br><span class="line">docker run --name app1 -d nginx:alpine sleep infinity</span><br><span class="line"></span><br><span class="line"><span class="comment"># We only see the processes of container app1</span></span><br><span class="line">docker <span class="built_in">exec</span> app1 ps aux</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run second container in first containers PID namespace</span></span><br><span class="line">docker run --name app2 --pid=container:app1 -d nginx:alpine sleep infinity</span><br><span class="line"></span><br><span class="line"><span class="comment"># We see processes of both containers in both containers</span></span><br><span class="line">docker <span class="built_in">exec</span> app1 ps aux</span><br><span class="line">docker <span class="built_in">exec</span> app2 ps aux</span><br></pre></td></tr></table></figure>
<h2 id="container-namespaces-podman">Container Namespaces Podman</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/container-namespaces-podman" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/container-namespaces-podman</a></p>
<p>Create two Podman containers sharing the same PID namespace<br>
Run two <code>Podman</code> containers <code>app1</code> and <code>app2</code> with the following attributes:</p>
<ul>
<li>they should run image <code>nginx:alpine</code></li>
<li>they should share the same <code>PID</code> kernel namespace</li>
<li>they should run command <code>sleep infinity</code></li>
<li>they should run in the background (detached)</li>
</ul>
<p>Then check which container sees which processes and make sense of why.</p>
<h3 id="solution-v2">Solution</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Run first container</span></span><br><span class="line">podman run --name app1 -d nginx:alpine sleep infinity</span><br><span class="line"></span><br><span class="line"><span class="comment"># We only see the processes of container app1</span></span><br><span class="line">podman <span class="built_in">exec</span> app1 ps aux</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run second container in first containers PID namespace</span></span><br><span class="line">podman run --name app2 --pid=container:app1 -d nginx:alpine sleep infinity</span><br><span class="line"></span><br><span class="line"><span class="comment"># We see processes of both containers in both containers</span></span><br><span class="line">podman <span class="built_in">exec</span> app1 ps aux</span><br><span class="line">podman <span class="built_in">exec</span> app2 ps aux</span><br></pre></td></tr></table></figure>
<h2 id="static-manual-analysis-docker">Static Manual Analysis Docker</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/static-manual-analysis-docker" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/static-manual-analysis-docker</a></p>
<h3 id="analyse-k8s-pod-yaml">Analyse K8s Pod YAML</h3>
<p>Perform a manual static analysis on files <code>/root/apps/app1-*</code> considering security.<br>
Move the less secure file to <code>/root/insecure</code></p>
<h4 id="tip">Tip</h4>
<p>Using a smaller base image to run the application can be more secure.<br>
<a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices" target="_blank" rel="noopener">Dockerfile Best Practices</a></p>
<h4 id="solution-v3">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root/apps/</span><br><span class="line">ls</span><br><span class="line">  app1-214422c7-Dockerfile  app2-2782517e-Dockerfile  app3-1c8650b1-Dockerfile</span><br><span class="line">  app1-9df32ce3-Dockerfile  app2-5cde5c3d-Dockerfile  app3-4049a117-Dockerfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># File `app1-214422c7-Dockerfile` uses multiple stages, a larger for building and a smaller for running.</span></span><br><span class="line">FROM ubuntu</span><br><span class="line">ARG DEBIAN_FRONTEND=noninteractive</span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y golang-go</span><br><span class="line">COPY app.go .</span><br><span class="line">RUN CGO_ENABLED=0 go build app.go</span><br><span class="line">FROM alpine   <span class="comment"># uses multiple stages</span></span><br><span class="line">COPY --from=0 /app .</span><br><span class="line">CMD [<span class="string">"./app"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># File `app1-9df32ce3-Dockerfile`</span></span><br><span class="line">FROM ubuntu</span><br><span class="line">ARG DEBIAN_FRONTEND=noninteractive</span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y golang-go</span><br><span class="line">COPY app.go .</span><br><span class="line">RUN CGO_ENABLED=0 go build app.go</span><br><span class="line">CMD [<span class="string">"./app"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">mv /root/apps/app1-9df32ce3-Dockerfile /root/insecure</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="analyse-k8s-deployment-yaml">Analyse K8s Deployment YAML</h3>
<p>Perform a manual static analysis on files <code>/root/apps/app2-*</code> considering security.<br>
Move the less secure file to <code>/root/insecure</code></p>
<h4 id="tip-v2">Tip</h4>
<p>Running applications as not root inside a container can be more secure.</p>
<h4 id="solution-v4">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># File app2-2782517e-Dockerfile</span></span><br><span class="line">FROM ubuntu:20.04</span><br><span class="line">ARG DEBIAN_FRONTEND=noninteractive</span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y golang-go=2:1.13~1ubuntu2</span><br><span class="line">COPY app.go .</span><br><span class="line">RUN CGO_ENABLED=0 go build app.go</span><br><span class="line">FROM alpine:3.12.0</span><br><span class="line">RUN addgroup -S appgroup &amp;&amp; adduser -S appuser -G appgroup -h /home/appuser</span><br><span class="line">COPY --from=0 /app /home/appuser/</span><br><span class="line">USER appuser  <span class="comment"># File app2-2782517e-Dockerfile creates a new user and doesn't run the application as root.</span></span><br><span class="line">CMD [<span class="string">"/home/appuser/app"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># File app2-5cde5c3d-Dockerfile</span></span><br><span class="line">FROM ubuntu</span><br><span class="line">ARG DEBIAN_FRONTEND=noninteractive</span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y golang-go</span><br><span class="line">COPY app.go .</span><br><span class="line">RUN CGO_ENABLED=0 go build app.go</span><br><span class="line">FROM alpine:3.11.6</span><br><span class="line">COPY --from=0 /app .</span><br><span class="line">CMD [<span class="string">"./app"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># File app2-2782517e-Dockerfile creates a new user and doesn't run the application as root.</span></span><br><span class="line">mv /root/apps/app2-5cde5c3d-Dockerfile /root/insecure</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="analyse-k8s-statefulset-yaml">Analyse K8s StatefulSet YAML</h3>
<p>Perform a manual static analysis on files <code>/root/apps/app3-*</code> considering security.<br>
Move the less secure file to <code>/root/insecure</code></p>
<h4 id="tip-v3">Tip</h4>
<p>Docker containers work with layers. Every FROM , COPY , RUN and CMD will create one layer.</p>
<h4 id="solution-v5">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># app3-1c8650b1-Dockerfile </span></span><br><span class="line">FROM ubuntu</span><br><span class="line">COPY my.cnf /etc/mysql/conf.d/my.cnf</span><br><span class="line">COPY mysqld_charset.cnf /etc/mysql/conf.d/mysqld_charset.cnf</span><br><span class="line">RUN apt-get update &amp;&amp; \</span><br><span class="line">    apt-get -yq install mysql-server-5.6 &amp;&amp;</span><br><span class="line">COPY import_sql.sh /import_sql.sh</span><br><span class="line">COPY run.sh /run.sh</span><br><span class="line">RUN /etc/register.sh <span class="variable">$SECRET_TOKEN</span>  <span class="comment"># new layer</span></span><br><span class="line">EXPOSE 3306</span><br><span class="line">CMD [<span class="string">"/run.sh"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># app3-4049a117-Dockerfile</span></span><br><span class="line">FROM ubuntu</span><br><span class="line">COPY my.cnf /etc/mysql/conf.d/my.cnf</span><br><span class="line">COPY mysqld_charset.cnf /etc/mysql/conf.d/mysqld_charset.cnf</span><br><span class="line">RUN apt-get update &amp;&amp; \</span><br><span class="line">    apt-get -yq install mysql-server-5.6 &amp;&amp;</span><br><span class="line">COPY import_sql.sh /import_sql.sh</span><br><span class="line">COPY run.sh /run.sh</span><br><span class="line">RUN <span class="built_in">echo</span> <span class="variable">$SECRET_TOKEN</span> &gt; /tmp/token   <span class="comment"># new layer</span></span><br><span class="line">RUN /etc/register.sh /tmp/token       <span class="comment"># new layer</span></span><br><span class="line">RUN rm /tmp/token                     <span class="comment"># new layer</span></span><br><span class="line">EXPOSE 3306</span><br><span class="line">CMD [<span class="string">"/run.sh"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># File app3-4049a117-Dockerfile stores the temporarily used token at /tmp/token .</span></span><br><span class="line"><span class="comment"># This is persisted as layer in the container even though the file is later deleted.</span></span><br><span class="line"><span class="comment"># Therefore:</span></span><br><span class="line">mv /root/apps/app3-4049a117-Dockerfile /root/insecure</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>HTTP CORS</title>
    <url>/HTTP-CORS.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Reference Links里的两篇文章讲述的已经很详细了。简单列一下：</p>
<h1 id="0-cors">0 CORS</h1>
<p>简单说就是从A网址（origin (domain) ）向B网址发送请求，称为跨域。从A网址向A网址发送请求就是，同域。</p>
<ul>
<li><a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#preflight-requests-for-complex-http-calls" target="_blank" rel="noopener">Cross-Origin Resource Sharing (CORS)</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS" target="_blank" rel="noopener">MDN 跨源资源共享（CORS）</a></li>
</ul>
<!-- [Cross-Origin Resource Sharing (CORS)](https://web.dev/i18n/en/cross-origin-resource-sharing/) -->
<h2 id="same-origin">Same-origin</h2>
<p>A 与 B 什么不同？<br>
<a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy?ref=hackernoon.com" target="_blank" rel="noopener">同源策略 Same-origin policy</a></p>
<blockquote>
<p>如果两个 URL 的协议、端口（如果有指定的话）和主机都相同的话，则这两个 URL 是同源的。</p>
</blockquote>
<p><a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/Web_mechanics/What_is_a_URL" target="_blank" rel="noopener">What is a URL?</a></p>
<p>Different origin：</p>
<ul>
<li>协议 protocol</li>
<li>主机/域 host， host可能是 <code>domain name</code>,或者是<code>IP address</code></li>
<li>端口 port</li>
</ul>
<p>例如 <code>https://localhost:8443/test/to/myfile.html</code></p>
<ul>
<li>Protocol/Scheme: <code>https</code></li>
<li>Host: <code>localhost</code></li>
<li>port: <code>8443</code></li>
<li>path: <code>/test/to/myfile.html</code></li>
<li>Origin: <a href="https://localhost:8443" target="_blank" rel="noopener">https://localhost:8443</a></li>
</ul>
<p>违反了同源策略就会出现跨域问题，主要表现为以下三方面：</p>
<ul>
<li>无法读取cookie、localStorage、indexDB</li>
<li>DOM无法获得</li>
<li>ajax请求无法发送</li>
<li>can’t access an <iframe> with different origin using JavaScript, browsers block scripts trying to access a frame with a different origin.</iframe></li>
</ul>
<h2 id="cross-origin">Cross-Origin</h2>
<p><img src="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS/cors_principle.png" alt="CORS"></p>
<h2 id="cors-headers"><a href="https://developer.mozilla.org/en-US/docs/Glossary/CORS#cors_headers" target="_blank" rel="noopener">CORS headers</a></h2>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Origin" target="_blank" rel="noopener">Access-Control-Allow-Origin</a><br>
指示响应的资源是否可以被给定的origin共享。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials" target="_blank" rel="noopener">Access-Control-Allow-Credentials</a><br>
指示当请求的凭证标记为 true 时，是否可以公开对该请求响应。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Headers" target="_blank" rel="noopener">Access-Control-Allow-Headers</a><br>
用在对预检请求的响应中，指示实际的请求中可以使用哪些 HTTP 标头。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Methods" target="_blank" rel="noopener">Access-Control-Allow-Methods</a><br>
指定对预检请求的响应中，哪些 HTTP 方法允许访问请求的资源。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Expose-Headers" target="_blank" rel="noopener">Access-Control-Expose-Headers</a><br>
通过列出标头的名称，指示哪些标头可以作为响应的一部分公开。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Max-Age" target="_blank" rel="noopener">Access-Control-Max-Age</a><br>
指示预检请求的结果能被缓存多久。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Request-Headers" target="_blank" rel="noopener">Access-Control-Request-Headers</a><br>
用于发起一个预检请求，告知服务器正式请求会使用哪些 HTTP 标头。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Request-Method" target="_blank" rel="noopener">Access-Control-Request-Method</a><br>
用于发起一个预检请求，告知服务器正式请求会使用哪一种 HTTP 请求方法。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Origin" target="_blank" rel="noopener">Origin</a><br>
指示获取资源的请求是从什么源发起的。</p>
<h1 id="cors请求流程">CORS请求流程</h1>
<p>来源：<a href="https://github.com/amandakelake/blog/issues/62" target="_blank" rel="noopener">CORS 简单请求+预检请求（彻底理解跨域）</a><br>
<img src="https://user-images.githubusercontent.com/25027560/50205881-c409b080-03a4-11e9-8a57-a2a6d0e1d879.png" alt="CORS请求流程"></p>
<h1 id="disable-cors-limit">Disable CORS limit</h1>
<p>关闭浏览器CORS：<a href="../HTTP-CORS-disable.html">Disable CORS limit</a></p>
<h1 id="访问控制场景">访问控制场景</h1>
<h2 id="1-简单请求-simple-request">1. 简单请求（simple request）</h2>
<blockquote>
<p>（1) 请求方法是以下三种方法之一：</p>
<ul>
<li>HEAD</li>
<li>GET</li>
<li>POST</li>
</ul>
</blockquote>
<blockquote>
<p>（2）HTTP的头信息不超出以下几种字段：</p>
<ul>
<li>Accept</li>
<li>Accept-Language</li>
<li>Content-Language</li>
<li>Last-Event-ID</li>
<li>Content-Type：只限于三个值application/x-www-form-urlencoded、multipart/form-data、text/ plain</li>
<li>DPR</li>
<li>Downlink</li>
<li>Save-Data</li>
<li>Viewport-Width</li>
<li>Width</li>
</ul>
</blockquote>
<blockquote>
<p>（3）请求中的任意XMLHttpRequestUpload 对象均没有注册任何事件监听器；XMLHttpRequestUpload 对象可以使用 XMLHttpRequest.upload 属性访问。<br>
（4）请求中没有使用 ReadableStream 对象。</p>
</blockquote>
<p>假如站点 <a href="http://Server-b.com" target="_blank" rel="noopener">http://Server-b.com</a> 的网页应用想要访问 <a href="http://bar.other" target="_blank" rel="noopener">http://bar.other</a> 的资源。<br>
A向B请求，那么A就是Orign.<br>
<img src="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS/simple-req.png" alt="简单请求（simple request）"></p>
<h2 id="2-非简单请求-not-so-simple-request">2. 非简单请求（not-so-simple request）</h2>
<blockquote>
<p>非简单请求是那种对服务器有特殊要求的请求，比如请求方法是PUT或DELETE，或者Content-Type字段的类型是application/json。</p>
</blockquote>
<blockquote>
<p>（1) 使用了下面任一 HTTP 方法：</p>
<ul>
<li>PUT</li>
<li>DELETE</li>
<li>CONNECT</li>
<li>OPTIONS</li>
<li>TRACE</li>
<li>PATCH</li>
</ul>
</blockquote>
<blockquote>
<p>（2) 人为设置了对 CORS 安全的首部字段集合之外的其他首部字段。该集合为：</p>
<ul>
<li>Accept</li>
<li>Accept-Language</li>
<li>Content-Language</li>
<li>Content-Type (需要注意额外的限制)</li>
<li>DPR</li>
<li>Downlink</li>
<li>Save-Data</li>
<li>Viewport-Width</li>
<li>Width</li>
</ul>
</blockquote>
<blockquote>
<p>（3) Content-Type 的值不属于下列之一:</p>
<ul>
<li>application/x-www-form-urlencoded</li>
<li>multipart/form-data</li>
<li>text/plain</li>
</ul>
</blockquote>
<blockquote>
<p>（4) 请求中的XMLHttpRequestUpload 对象注册了任意多个事件监听器。</p>
</blockquote>
<blockquote>
<p>（5) 请求中使用了ReadableStream对象。</p>
</blockquote>
<p>假如站点 <a href="http://foo.example" target="_blank" rel="noopener">http://foo.example</a> 的网页应用想要访问 <a href="http://bar.other" target="_blank" rel="noopener">http://bar.other</a> 的资源。</p>
<p><img src="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS/preflight_correct.png" alt="预检请求+真实请求"></p>
<h3 id="2-1-预检请求-option">2.1 预检请求 OPTION</h3>
<p>OPTION 由于跨域请求被拦截，返回503：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/HTTP-CORS/OPTION%20503.png" alt="OPTION 503"></p>
<p>Error:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">Access to XMLHttpRequest at <span class="string">'https://B'</span> <span class="keyword">from</span> origin <span class="string">'https://A'</span> </span><br><span class="line">has been blocked by CORS policy: </span><br><span class="line">Response to preflight request doesn<span class="string">'t pass access control check: It does not have HTTP ok status.</span></span><br></pre></td></tr></table></figure>
<h3 id="2-2-真实请求">2.2 真实请求</h3>
<h2 id="3-附带身份凭证的请求">3 附带身份凭证的请求</h2>
<blockquote>
<p>它其实必然是1 简单请求（simple request）2. 非简单请求（not-so-simple request）的其中一种。只是多加了对Cookie和HTTP认证信息的判断。<br>
CORS请求默认不发送Cookie和HTTP认证信息。如果要把Cookie发到服务器，一方面要服务器同意，指定Access-Control-Allow-Credentials字段。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">Access-Control-Allow-Credentials: <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>另一方面，开发者必须在AJAX请求中打开withCredentials属性。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.withCredentials = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<p>否则，即使服务器同意发送Cookie，浏览器也不会发送。或者，服务器要求设置Cookie，浏览器也不会处理。</p>
<p>但是，如果省略withCredentials设置，有的浏览器还是会一起发送Cookie。这时，可以显式关闭withCredentials。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">xhr.withCredentials = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<p>A向B请求。<code>需要注意的是，如果要发送Cookie，Access-Control-Allow-Origin就不能设为星号，必须指定明确的、与请求网页A一致的域名。</code>否则报错：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">Access to XMLHttpRequest at <span class="string">'https://B'</span> <span class="keyword">from</span> origin <span class="string">'https://A'</span> has been blocked by CORS policy: </span><br><span class="line">The value <span class="keyword">of</span> the <span class="string">'Access-Control-Allow-Origin'</span> header <span class="keyword">in</span> the response must not be </span><br><span class="line">the wildcard <span class="string">'*'</span> when the request<span class="string">'s credentials mode is '</span>include<span class="string">'.</span></span><br><span class="line"><span class="string">The credentials mode of requests initiated by the XMLHttpRequest </span></span><br><span class="line"><span class="string">is controlled by the withCredentials attribute.</span></span><br></pre></td></tr></table></figure>
<p>同时，Cookie依然遵循同源政策，只有用服务器域名B设置的Cookie才会上传，其他域名的Cookie并不会上传，且（跨源）原网页A代码中的document.cookie也无法读取服务器域名下的Cookie。</p>
<p><img src="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS/cred-req-updated.png" alt="附带身份凭证的请求"></p>
<h1 id="reference-links">Reference Links</h1>
<ul>
<li><a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#preflight-requests-for-complex-http-calls" target="_blank" rel="noopener">Cross-Origin Resource Sharing (CORS)</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener">MDN HTTP访问控制（CORS）</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">跨域资源共享 CORS 详解</a></li>
<li><a href="https://github.com/amandakelake/blog/issues/62" target="_blank" rel="noopener">CORS 简单请求+预检请求（彻底理解跨域）</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Network</category>
        <category>Servlet/HTTP</category>
      </categories>
      <tags>
        <tag>CORS</tag>
      </tags>
  </entry>
  <entry>
    <title>How to modify UserAgent - JS, IOS and Android</title>
    <url>/How-to-modify-UserAgent-JS-IOS-and-Android.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="useragent"><a href="https://developer.mozilla.org/zh-CN/docs/Glossary/User_agent" target="_blank" rel="noopener">UserAgent</a></h1>
<h2 id="user-agent-header"><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent" target="_blank" rel="noopener"><code>User-agent</code> Header</a></h2>
<h3 id="useragent-headers-chrome-bug">UserAgent Headers Chrome bug</h3>
<blockquote>
<p><a href="https://developer.mozilla.org/en-US/docs/Glossary/Forbidden_header_name" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Glossary/Forbidden_header_name</a><br>
&quot;Note: The User-Agent header is no longer forbidden, as per spec — see forbidden header name list (this was implemented in Firefox 43) — it can now be set in a Fetch Headers object, or with the setRequestHeader() method of XMLHttpRequest. However, Chrome will silently drop the header from Fetch requests (see <a href="https://crbug.com/571722" target="_blank" rel="noopener">Chromium bug 571722</a>).&quot;</p>
</blockquote>
<p>User-Agent header 不再被禁止更改，现在可以设置在 Fetch 的 Headers 对象中，或者通过 XMLHttpRequest 的 setRequestHeader() 方法设置。但是，Chrome 会不做提示地从 Fetch 请求中丢弃这个Header（请参阅 <a href="https://crbug.com/571722" target="_blank" rel="noopener">Chromium bug 571722</a>）<br>
看了下这个bug 从 2015年就有了, 而且仍然是open状态，2023.7月亲自试了下，直接在fetch request里面设置<code>&quot;User-agent&quot;: &quot;Custom User Agent&quot;</code>，发现确实chrome仍然有这个bug, Firefox 和Safari 都可以成功修改User-agent Header。</p>
<p>测试版本：</p>
<ul>
<li>Google Chrome Version 114.0.5735.198 (Official Build) (arm64)</li>
<li>Firefox 113.0.2</li>
<li>Safari Version 16.5 (18615.2.9.11.4)</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">fetch(<span class="string">"https://httpbin.org/user-agent"</span>, (credentials: <span class="string">"include"</span>, <span class="attr">method</span>: <span class="string">"GET', headers: /</span></span><br><span class="line"><span class="string">"</span>User-agent<span class="string">": "</span>Custom User Agent<span class="string">"</span></span><br><span class="line"><span class="string">Promise ([PromiseStatus]]: "</span>pending<span class="string">", ((PromiseValue]]: undefined&#125;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://bugs.chromium.org/p/chromium/issues/attachment?aid=85876&amp;signed_aid=vqq4JDSv_sqKpBUcF8wJ1A==&amp;inline=1" alt="Chromium bug 571722"></p>
<h2 id="useragent-string"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/userAgent" target="_blank" rel="noopener">UserAgent string</a></h2>
<p><code>window.navigator</code>返回一个<code>Navigator</code>对象的引用, 用于请求运行当前代码的应用程序的相关信息.</p>
<p><code>Navigator</code>对象包含了一些关于浏览器的信息, 具体可以查阅<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator" target="_blank" rel="noopener">Navigator MDN</a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 用户代理的字符串可以被 JavaScript 在客户端中使用 navigator.userAgent 获取</span></span><br><span class="line"><span class="keyword">const</span> userAgent = <span class="built_in">window</span>.navigator.userAgent;</span><br><span class="line"><span class="comment">// 例如： Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Mobile Safari/537.36</span></span><br></pre></td></tr></table></figure>
<h2 id="javascript修改useragent-string">JavaScript修改UserAgent string</h2>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/userAgent" target="_blank" rel="noopener">navigator.userAgent属性是只读属性，不建议修改</a>。</p>
<p>但是仍然可以通过override navigator的get方法来修改, 参考代码<a href="https://gist.github.com/thorsten/148812e9cc4fb6a19215ce22afd4e5a8" target="_blank" rel="noopener">Override user agent on all browsers</a>。<br>
需要注意的是这种修改方法：</p>
<ul>
<li>不会修改request里面的<code>User-agent</code> Header</li>
<li>只是修改了navigator.userAgent （navigator的get方法）得到的userAgent string</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setUserAgent</span>(<span class="params">window, customUserAgent</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> newUserAgent = <span class="string">`<span class="subst">$&#123;navigator.userAgent&#125;</span> <span class="subst">$&#123;customUserAgent&#125;</span>`</span>;</span><br><span class="line">    <span class="comment">// Works on Firefox, Chrome, Opera and IE9+</span></span><br><span class="line">    <span class="keyword">if</span> (navigator.__defineGetter__) &#123;</span><br><span class="line">        navigator.__defineGetter__(<span class="string">'userAgent'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> newUserAgent;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">Object</span>.defineProperty) &#123;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(navigator, <span class="string">'userAgent'</span>, &#123;</span><br><span class="line">            <span class="keyword">get</span>: function () &#123;</span><br><span class="line">                <span class="keyword">return</span> newUserAgent;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Works on Safari</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.navigator.userAgent.indexOf(customUserAgent) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> userAgentProp = &#123;</span><br><span class="line">            <span class="keyword">get</span>: function () &#123;</span><br><span class="line">                <span class="keyword">return</span> newUserAgent;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="built_in">Object</span>.defineProperty(<span class="built_in">window</span>.navigator, <span class="string">'userAgent'</span>, userAgentProp);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="built_in">window</span>.navigator = <span class="built_in">Object</span>.create(navigator, &#123;</span><br><span class="line">                userAgent: userAgentProp,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setUserAgent(<span class="built_in">window</span>, <span class="string">'CustomUserAgent/1.0'</span>); <span class="comment">// 在原来的userAgent后面append 'CustomUserAgent/1.0'</span></span><br><span class="line"><span class="comment">// 例如： Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 CustomUserAgent/1.0</span></span><br></pre></td></tr></table></figure>
<p>改进版本，抽取一些函数：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getNewUserAgent</span>(<span class="params">userAgent, customUserAgent</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> userAgent.indexOf(customUserAgent) &lt; <span class="number">0</span> ? <span class="string">`<span class="subst">$&#123;userAgent&#125;</span> <span class="subst">$&#123;customUserAgent&#125;</span>`</span> : userAgent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getNewUserAgentProp</span>(<span class="params">userAgent, customUserAgent</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="keyword">get</span>: function () &#123;</span><br><span class="line">            <span class="keyword">return</span> getNewUserAgent(userAgent, customUserAgent);</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setUserAgent2</span>(<span class="params">window, customUserAgent</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> userAgent = navigator.userAgent;</span><br><span class="line">    <span class="keyword">const</span> winUserAgent = <span class="built_in">window</span>.navigator.userAgent;</span><br><span class="line">    <span class="comment">// Works on Firefox, Chrome, Opera and IE9+</span></span><br><span class="line">    <span class="keyword">if</span> (navigator.__defineGetter__) &#123;</span><br><span class="line">        navigator.__defineGetter__(<span class="string">'userAgent'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> getNewUserAgent(userAgent, customUserAgent);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">Object</span>.defineProperty) &#123;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(navigator, <span class="string">'userAgent'</span>, getNewUserAgentProp(userAgent, customUserAgent));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Works on Safari</span></span><br><span class="line">    <span class="keyword">if</span> (winUserAgent.indexOf(customUserAgent) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="built_in">Object</span>.defineProperty(</span><br><span class="line">                <span class="built_in">window</span>.navigator,</span><br><span class="line">                <span class="string">'userAgent'</span>,</span><br><span class="line">                getNewUserAgentProp(winUserAgent, customUserAgent)</span><br><span class="line">            );</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="built_in">window</span>.navigator = <span class="built_in">Object</span>.create(navigator, &#123;</span><br><span class="line">                userAgent: getNewUserAgentProp(navigator.userAgent, customUserAgent),</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check if the browser supports the userAgentData API</span></span><br><span class="line">    <span class="keyword">if</span> (navigator.userAgentData) &#123;</span><br><span class="line">        <span class="comment">// Get the User-Agent header data</span></span><br><span class="line">        navigator.userAgentData.getHighEntropyValues([<span class="string">'uaFull'</span>]).then(<span class="function"><span class="keyword">function</span> (<span class="params">uaData</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// Append "customUserAgent" to the User-Agent header</span></span><br><span class="line">            uaData.uaFull = getNewUserAgent(uaData.uaFull, customUserAgent);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Override the User-Agent header with the modified value</span></span><br><span class="line">            navigator.userAgentData.setHighEntropyValues(uaData);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setUserAgent2(<span class="built_in">window</span>, <span class="string">'CustomUserAgent/1.0'</span>); <span class="comment">// 在原来的userAgent后面append 'CustomUserAgent/1.0'</span></span><br></pre></td></tr></table></figure>
<h2 id="mobile-client-修改useragent-header">Mobile client 修改UserAgent Header</h2>
<ul>
<li><a href="https://juejin.cn/post/6844903632152821773" target="_blank" rel="noopener">WKWebView 设置自定义UserAgent正确姿势</a></li>
<li><a href="https://juejin.cn/post/6844904030980800519" target="_blank" rel="noopener">iOS修改WebView的UserAgent</a>
<ul>
<li><a href="https://juejin.cn/post/6844903848671199239" target="_blank" rel="noopener">iOS修改UserAgent</a></li>
</ul>
</li>
</ul>
<h2 id="浏览器中修改useragent-header">浏览器中修改UserAgent Header</h2>
<p>Chrome中修改一下userAgent:</p>
<ul>
<li>首先打开开发者工具(F12)</li>
<li>点开关闭箭头左侧更多选项, 选择More tools, 然后选择Network conditions</li>
<li>在开发者工具下方会多出来一个Network conditions菜单栏, 这里有User agent配置, 取消勾选Use browser default, 然后选择一些其他的选项或者自己输入一些内容.</li>
<li>刷新页面后， <code>window.navigator</code>, 和网络请求头中的User Agent都会变成了刚才修改的内容</li>
</ul>
<h2 id="利用useragent检测浏览器">利用userAgent检测浏览器</h2>
<h3 id="useragent-string直接判断">userAgent string直接判断</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> isIE = !!<span class="built_in">document</span>.all,</span><br><span class="line">        docMode = <span class="built_in">document</span>.documentMode, <span class="comment">// available in IE browsers, The documentMode only works in Internet Explorer. All other browsers return undefined. https://www.w3schools.com/jsref/prop_doc_documentmode.asp</span></span><br><span class="line">        ua = navigator.userAgent,</span><br><span class="line">        isIE6 = <span class="literal">false</span>,</span><br><span class="line">        isIE7 = <span class="literal">false</span>,</span><br><span class="line">        isIE8 = <span class="literal">false</span>,</span><br><span class="line">        isIE9 = <span class="literal">false</span>,</span><br><span class="line">        isIE10 = <span class="literal">false</span>,</span><br><span class="line">        isIE11 = !isIE &amp;&amp; <span class="string">'ActiveXObject'</span> <span class="keyword">in</span> <span class="built_in">window</span>, <span class="comment">// IE11 dose not act like IE&lt;=10</span></span><br><span class="line">        isDXIE = <span class="literal">false</span>;</span><br><span class="line">    isIE = isIE || isIE11;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isIE) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isEdgeModeEnabled) &#123;</span><br><span class="line">            isIE6 = !!ua.match(<span class="regexp">/MSIE 6/</span>);</span><br><span class="line">            isIE7 = ((!!ua.match(<span class="regexp">/MSIE 7/</span>) &amp;&amp; !docMode) || docMode === <span class="number">7</span>);  <span class="comment">// IE7 or IE in IE7 Standards Mode</span></span><br><span class="line">            isIE8 = (docMode === <span class="number">8</span>);    <span class="comment">// IE in IE8 Standards Mode</span></span><br><span class="line">            isIE9 = (docMode === <span class="number">9</span>);    <span class="comment">// IE in IE9 Standards Mode</span></span><br><span class="line">            isIE10 = (docMode === <span class="number">10</span>);  <span class="comment">// IE in IE10 Standards Mode</span></span><br><span class="line">            isDXIE = (!docMode || docMode &lt;= <span class="number">9</span>); <span class="comment">// IE9- supports DX filters</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            isIE6 = !!ua.match(<span class="regexp">/MSIE 6/</span>);</span><br><span class="line">            isIE7 = !!ua.match(<span class="regexp">/MSIE 7/</span>);</span><br><span class="line">            isIE8 = !!ua.match(<span class="regexp">/MSIE 8/</span>);</span><br><span class="line">            isIE9 = !!ua.match(<span class="regexp">/MSIE 9/</span>);</span><br><span class="line">            isIE10 = !!ua.match(<span class="regexp">/MSIE 10/</span>);</span><br><span class="line">            isDXIE = !isIE10;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> isFireFox = !isIE &amp;&amp; !!ua.match(<span class="regexp">/Firefox/</span>),</span><br><span class="line">        isAndroid = !!ua.match(<span class="regexp">/Android/</span>),</span><br><span class="line">        isIPad = !!ua.match(<span class="regexp">/iPad/</span>),</span><br><span class="line">        isIPhone = !!ua.match(<span class="regexp">/iPhone/</span>),</span><br><span class="line">        <span class="comment">// iPad will default loading desktop website on iOS 13+</span></span><br><span class="line">        isIOSTouchWithDesktopWebsite = !!ua.match(<span class="regexp">/Macintosh/</span>) &amp;&amp; <span class="string">'ontouchend'</span> <span class="keyword">in</span> <span class="built_in">document</span>,</span><br><span class="line">        tch = !!<span class="built_in">document</span>.createTouch || isAndroid,</span><br><span class="line">        isPlayBook = !!ua.match(<span class="regexp">/PlayBook/</span>),</span><br><span class="line">        isWinPhone = !!ua.match(<span class="regexp">/Windows Phone/</span>),</span><br><span class="line">        isIEW3C = !isIE &amp;&amp; !!ua.match(<span class="regexp">/Trident.*rv/</span>),</span><br><span class="line">        CSS3_PREFIX = isFireFox ? <span class="string">'-moz-'</span> : (isIE || isIEW3C) ? <span class="string">''</span> : <span class="string">'-webkit-'</span>,</span><br><span class="line">        CSS3_TRANSFORM_PREFIX = isFireFox ? <span class="string">'Moz'</span> : (isIE10 || isIEW3C) ? <span class="string">''</span> : isIE ? <span class="string">'ms'</span> : <span class="string">'webkit'</span>,</span><br><span class="line">        CSS3_T_INITIAL = ((isIE10 || isIEW3C) ? <span class="string">'t'</span> : <span class="string">'T'</span>),</span><br><span class="line">        CSS3_TRANSITION = CSS3_TRANSFORM_PREFIX + CSS3_T_INITIAL + <span class="string">'ransition'</span>; <span class="comment">// IE9: N/A, IE10: transition, Chrome: webkitTransition, Moz: transition or MozTransransition</span></span><br></pre></td></tr></table></figure>
<h3 id="第三方库ua-parser-js">第三方库<a href="https://www.npmjs.com/package/ua-parser-js" target="_blank" rel="noopener">ua-parser-js</a></h3>
<p>包装了一些常用方法，使用起来更方便，<a href="https://github.com/faisalman/ua-parser-js" target="_blank" rel="noopener">github</a>。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UAParser <span class="keyword">from</span> <span class="string">'ua-parser-js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> uaParser = <span class="keyword">new</span> UAParser();</span><br><span class="line"><span class="keyword">const</span> osName = uaParser.getOS().name;</span><br><span class="line"><span class="keyword">const</span> deviceType = uaParser.getDevice().type;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getBrowserVersion</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> uaParser.getBrowser().version;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isSafari</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> uaParser.getBrowser().name === <span class="string">'Safari'</span> || uaParser.getBrowser().name === <span class="string">'Mobile Safari'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isFirefox</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> uaParser.getBrowser().name === <span class="string">'Firefox'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isChrome</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> uaParser.getBrowser().name === <span class="string">'Chrome'</span> || uaParser.getBrowser().name === <span class="string">'Chrome WebView'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isIE</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> uaParser.getBrowser().name === <span class="string">'IE'</span> || uaParser.getBrowser().name === <span class="string">'IE Mobile'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isEdge</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> uaParser.getBrowser().name === <span class="string">'Edge'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isDesktop</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((isMacOS() || isWindows()) &amp;&amp; <span class="built_in">window</span>.navigator.maxTouchPoints &lt;= <span class="number">1</span>) || isLinux();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isIpadIOS13AndAbove</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> isMacOS() &amp;&amp; <span class="built_in">window</span>.navigator.maxTouchPoints &gt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isWindowsTablets</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> isWindows() &amp;&amp; <span class="built_in">window</span>.navigator.maxTouchPoints &gt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isLinux</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> osName === <span class="string">'Linux'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isMacOS</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> osName === <span class="string">'Mac OS'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isWindows</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> osName === <span class="string">'Windows'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isIPad</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> osName === <span class="string">'iOS'</span> &amp;&amp; deviceType === <span class="string">'tablet'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isIPhone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> osName === <span class="string">'iOS'</span> &amp;&amp; deviceType === <span class="string">'mobile'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isIOS</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> osName === <span class="string">'iOS'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isAndroid</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> osName === <span class="string">'Android'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isAndroidPhone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> osName === <span class="string">'Android'</span> &amp;&amp; deviceType === <span class="string">'mobile'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isMobile</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> deviceType === <span class="string">'mobile'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isTouchable</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> maxTouchPoints = navigator.maxTouchPoints || navigator.msMaxTouchPoints;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="string">'ontouchstart'</span> <span class="keyword">in</span> <span class="built_in">window</span> ||</span><br><span class="line">        maxTouchPoints &gt; <span class="number">0</span> ||</span><br><span class="line">        <span class="comment">// Surface Laptop Firefox:</span></span><br><span class="line">        <span class="comment">// Touch is enabled and behaving as expect, but window.maxTouchPoints=0, which looks like a bug;</span></span><br><span class="line">        <span class="comment">// Use below method to detect instead.</span></span><br><span class="line">        (<span class="built_in">window</span>.matchMedia &amp;&amp; matchMedia(<span class="string">'(any-pointer: coarse)'</span>).matches)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isSurface</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> osName === <span class="string">'Windows'</span> &amp;&amp; isTouchable();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isTablet</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> deviceType === <span class="string">'tablet'</span> || isSurface();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isMobileOrTabletDevice</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> isTablet() || isMobile();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://juejin.cn/post/7068080777195421709" target="_blank" rel="noopener">userAgent是什么?如何根据它判断浏览器信息?</a></li>
<li><a href="https://juejin.cn/post/6844903632152821773" target="_blank" rel="noopener">WKWebView 设置自定义UserAgent正确姿势</a></li>
<li><a href="https://juejin.cn/post/6844904030980800519" target="_blank" rel="noopener">iOS修改WebView的UserAgent</a>
<ul>
<li><a href="https://juejin.cn/post/6844903848671199239" target="_blank" rel="noopener">iOS修改UserAgent</a></li>
</ul>
</li>
<li><a href="https://stackoverflow.com/questions/23248525/setting-a-custom-useragent-in-html-or-javascript" target="_blank" rel="noopener">Setting a custom userAgent in HTML or JavaScript</a></li>
<li><a href="https://stackoverflow.com/questions/73744290/how-to-change-the-useragent-of-a-window-opened-with-window-open-if-possible" target="_blank" rel="noopener">How to change the UserAgent of a window opened with window.open(), if possible?</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
      </categories>
      <tags>
        <tag>Learning Notes</tag>
      </tags>
  </entry>
  <entry>
    <title>Installing MySQL on Mac</title>
    <url>/Installing-MySQL-on-Mac.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>This short tutorial shows how to install MySQL on a Mac using Homebrew and how to verify it is running using Sequel Pro.</p>
<h1 id="install-homebrew">Install Homebrew</h1>
<p><a href="https://brew.sh/" target="_blank" rel="noopener">Homebrew</a> is a package manager for Mac and serves a similar purpose to apt-get in Linux.</p>
<p>If you already have Homebrew, you can skip this section. If you are not sure, run the following command.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> brew</span><br></pre></td></tr></table></figure>
<p>If you have Homebrew it will print something similar to /usr/local/bin/brew. If you do not have Homebrew it will print nothing.</p>
<p>Run the following command in a terminal window to install Homebrew.</p>
<figure class="highlight zsh"><table><tr><td class="code"><pre><span class="line">/usr/bin/ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure>
<h1 id="install-mysql">Install MySQL</h1>
<p>Update Homebrew to ensure you get the latest packages</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew update</span><br></pre></td></tr></table></figure>
<p>Run this command to install MySQL</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install mysql</span><br><span class="line"></span><br><span class="line">/usr/<span class="built_in">local</span>/Cellar/mysql/8.0.12/bin/mysqld --initialize-insecure --user=liyuankun --based</span><br><span class="line">==&gt; Caveats</span><br><span class="line">We<span class="string">'ve installed your MySQL database without a root password. To secure it run:</span></span><br><span class="line"><span class="string">    mysql_secure_installation</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">MySQL is configured to only allow connections from localhost by default</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To connect run:</span></span><br><span class="line"><span class="string">    mysql -uroot</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To have launchd start mysql now and restart at login:</span></span><br><span class="line"><span class="string">  brew services start mysql</span></span><br><span class="line"><span class="string">Or, if you don'</span>t want/need a background service you can just run:</span><br><span class="line">  mysql.server start</span><br><span class="line">==&gt; Summary</span><br><span class="line">🍺  /usr/<span class="built_in">local</span>/Cellar/mysql/8.0.12: 255 files, 233.0MB</span><br><span class="line">==&gt; Caveats</span><br><span class="line">==&gt; openssl</span><br><span class="line">A CA file has been bootstrapped using certificates from the SystemRoots</span><br><span class="line">keychain. To add additional certificates (e.g. the certificates added <span class="keyword">in</span></span><br><span class="line">the System keychain), place .pem files <span class="keyword">in</span></span><br><span class="line">  /usr/<span class="built_in">local</span>/etc/openssl/certs</span><br><span class="line"></span><br><span class="line">and run</span><br><span class="line">  /usr/<span class="built_in">local</span>/opt/openssl/bin/c_rehash</span><br><span class="line"></span><br><span class="line">openssl is keg-only, <span class="built_in">which</span> means it was not symlinked into /usr/<span class="built_in">local</span>,</span><br><span class="line">because Apple has deprecated use of OpenSSL <span class="keyword">in</span> favor of its own TLS and crypto libraries.</span><br><span class="line"></span><br><span class="line">If you need to have openssl first <span class="keyword">in</span> your PATH run:</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">'export PATH="/usr/local/opt/openssl/bin:$PATH"'</span> &gt;&gt; ~/.zshrc</span><br><span class="line"></span><br><span class="line">For compilers to find openssl you may need to <span class="built_in">set</span>:</span><br><span class="line">  <span class="built_in">export</span> LDFLAGS=<span class="string">"-L/usr/local/opt/openssl/lib"</span></span><br><span class="line">  <span class="built_in">export</span> CPPFLAGS=<span class="string">"-I/usr/local/opt/openssl/include"</span></span><br><span class="line"></span><br><span class="line">For pkg-config to find openssl you may need to <span class="built_in">set</span>:</span><br><span class="line">  <span class="built_in">export</span> PKG_CONFIG_PATH=<span class="string">"/usr/local/opt/openssl/lib/pkgconfig"</span></span><br><span class="line"></span><br><span class="line">==&gt; mysql</span><br><span class="line">We<span class="string">'ve installed your MySQL database without a root password. To secure it run:</span></span><br><span class="line"><span class="string">    mysql_secure_installation</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">MySQL is configured to only allow connections from localhost by default</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To connect run:</span></span><br><span class="line"><span class="string">    mysql -uroot</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To have launchd start mysql now and restart at login:</span></span><br><span class="line"><span class="string">  brew services start mysql</span></span><br><span class="line"><span class="string">Or, if you don'</span>t want/need a background service you can just run:</span><br><span class="line">  mysql.server start</span><br></pre></td></tr></table></figure>
<h1 id="config-mysql">Config MySQL</h1>
<h2 id="command-not-found">command not found</h2>
<p>Type “mysql” command, you will meet the error:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql -V</span><br><span class="line">zsh: <span class="built_in">command</span> not found</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">sudo vim .bash_profile</span><br></pre></td></tr></table></figure>
<p>Insert for .bash_profile</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">export PATH=$&#123;PATH&#125;:/usr/local/Cellar/mysql/<span class="number">8.0</span>.<span class="number">12</span>/bin</span><br></pre></td></tr></table></figure>
<p>Press “esc” and input “:wq” to save and quite.</p>
<p>Then</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>Then config zsh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>接着我执行 vim ~/.zshrc</p>
<p>and insert <em>source ~/.bash_profile</em></p>
<p>并在其中插入 <em>source ~/.bash_profile</em></p>
<p>(纠结，我是一行英文一行中文的写呢？还是中英文分开成两篇呢？)</p>
<h2 id="error-2002-hy000">ERROR 2002 (HY000):</h2>
<p>Type “mysql” command, you will meet the error:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql -V</span><br><span class="line">ERROR 2002 (HY000): Can<span class="string">'t connect to local MySQL server through socket '</span>/tmp/mysql.sock<span class="string">' (2)</span></span><br></pre></td></tr></table></figure>
<p>The reason is that you’ll need to start MySQL before you can use the mysql command on your terminal.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew services start mysql</span><br><span class="line">==&gt; Successfully started `mysql` (label: homebrew.mxcl.mysql)</span><br></pre></td></tr></table></figure>
<p>Then mysql work</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql -V</span><br><span class="line">mysql  Ver 8.0.12 <span class="keyword">for</span> osx10.13 on x86_64 (Homebrew)</span><br></pre></td></tr></table></figure>
<h2 id="set-password">Set password</h2>
<p>Set a rudimentary password for MySQL locally, there is no need to worry about security because it will only be accessible from your machine (I used “administrator”).</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysqladmin -u root password <span class="string">'administrator'</span></span><br></pre></td></tr></table></figure>
<p>Once installed and running, MySQL is accessible to any app running locally on your machine.<br>
Then you can use the password you set previously to login MySQl：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line">  //input the password you <span class="built_in">set</span> previously <span class="string">'administrator'</span></span><br></pre></td></tr></table></figure>
<p>You can use the command to show the databases.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; SHOW DATABASES;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.03 sec)</span><br></pre></td></tr></table></figure>
<h1 id="verify-mysql-is-running-by-sequel-pro">Verify MySQL is running by Sequel Pro</h1>
<p>I use <a href="https://www.sequelpro.com/" target="_blank" rel="noopener">Sequel Pro</a> to manage MySQL because it has a pretty great UI. In case you are wondering, I am not actually affiliated with it in anyway.<br>
<a href="https://sequelpro.com/download#auto-start" target="_blank" rel="noopener">Download and install Sequel Pro</a> and open it. The database to connect to is on localhost so set “host” to “127.0.0.1”. Username is “root” and password the same as chosen in the previous step, for me that’s “administrator”.</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Installing-MySQL-on-Mac/SequelPro-setting.png" alt="Setting"></p>
<p>If the connection does not work, make sure you modified your password correctly in the previous step and that the mysql service is still running.</p>
<h2 id="error-1">Error 1</h2>
<p>If you meet this error:<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Installing-MySQL-on-Mac/SequelPro-connectionerror2.png" alt="connection error"></p>
<p>Find out which port MySQL is running on, run the following in MySql client:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; SHOW GLOBAL VARIABLES LIKE <span class="string">'PORT'</span>;</span><br><span class="line">+---------------+-------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+---------------+-------+</span><br><span class="line">| port          | 3306  |</span><br><span class="line">+---------------+-------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.05 sec)</span><br></pre></td></tr></table></figure>
<p>Make sure that you input the correct port number (3306 or 3307).</p>
<h2 id="error-2">Error 2</h2>
<p>If you meet this error:<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Installing-MySQL-on-Mac/SequelPro-connectionerror.png" alt="connection error"></p>
<h3 id="error-2-set-use-legacy-password">Error 2 - set ‘Use legacy password’</h3>
<p>For MAC OS</p>
<ol>
<li>Open MySQL from System Preferences &gt; MySQL &gt; Initialize Database &gt;</li>
<li>Type your new password.</li>
<li>Choose ‘Use legacy password’</li>
<li>Start the Server again.</li>
<li>Now connect the MySQL Workbench<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Installing-MySQL-on-Mac/SystemPreferences-MySQL.png" alt="System Preferences MySQL"></li>
</ol>
<h3 id="error-2-install-mysql-in-system-preferences">Error 2 - install MySQL in System Preferences</h3>
<p>If you don’t have MySQL in System Preferences,<br>
you can set up MySQL in your System Preferences by following this: <a href="dev.mysql.com/doc/refman/5.7/en/osx-installation-prefpane.html">dev.mysql.com/doc/refman/5.7/en/osx-installation-prefpane.html</a><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Installing-MySQL-on-Mac/install-MySQL-Preference-Pane2.png" alt="install-MySQL-Preference-Pane"></p>
<p>We can not install the MySQL Server again, because we already install it by brew. But you have to config the MySQL Preference Pane.<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Installing-MySQL-on-Mac/install-MySQL-Preference-Pane1.png" alt="install-MySQL-Preference-Pane"></p>
<hr>
<p>If we install the MySQL Server again, the MySQL Preference Pane config:<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Installing-MySQL-on-Mac/installed-mysql.png" alt="installed-mysql config"><br>
modify .bash_profile</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">export PATH=$&#123;PATH&#125;:/usr/local/mysql/bin</span><br></pre></td></tr></table></figure>
<p>Press “esc” and input “:wq” to save and quite.</p>
<p>Then</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure>
<hr>
<p>Remeber to choose ‘Use legacy password’:<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Installing-MySQL-on-Mac/install-MySQL-Preference-Pane1.png" alt="install-MySQL-Preference-Pane"></p>
<p>But i still do not solve it yet.</p>
<p>Connect and you will be presented with an empty MySQL.<br>
At this point, you might want to add your first database. After successfully connecting, click Database &gt; Add Database and name it, I chose the name “node_shoppingcart” (the MySQL naming convention is snake_case).</p>
<p>MySQL is ready to go!<br>
If you are interested in using MySQL with Node.js, check out the setting up Node.js with a mysql tutorial.</p>
<p>Reference links:</p>
<ul>
<li>
<p><a href="https://stackoverflow.com/questions/15450091/for-a-newbie-error-2002-hy000-cant-connect-to-local-mysql-server-through-so" target="_blank" rel="noopener">For a newbie: ERROR 2002 (HY000): Can’t connect to local MySQL server through socket ‘/tmp/mysql.sock’</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/49194719/authentication-plugin-caching-sha2-password-cannot-be-loaded" target="_blank" rel="noopener">Authentication plugin ‘caching_sha2_password’ cannot be loaded</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/26344795/cannot-connect-to-mysql-workbench-on-mac-cant-connect-to-mysql-server-on-127" target="_blank" rel="noopener">Cannot connect to MySQL Workbench on mac. Can’t connect to MySQL server on ‘127.0.0.1’ (61)	Mac Macintosh</a></p>
</li>
<li>
<p><a href="https://hackernoon.com/setting-up-node-js-with-a-database-part-1-3f2461bdd77f" target="_blank" rel="noopener">Tutorial: Setting up Node.js with a database</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Database</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>Java 1001问</title>
    <url>/Java-1001%E9%97%AE.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1-java-版本为何有1-02-1-1-5-6-7-是怎么排序的？">1 Java 版本为何有1.02， 1.1， 5，6，7 是怎么排序的？</h1>
<p><a href="https://zh.wikipedia.org/wiki/Java%E7%89%88%E6%9C%AC%E6%AD%B7%E5%8F%B2" target="_blank" rel="noopener">维基百科：Java版本历史</a></p>
<p>原始版本 | Java名称 | 代号  | 解释<br>
---------|----------|---------<br>
Java 1.02 - 1.1 | Java 1 | | Java 1.02 为最原始的Java版本（真正第一个稳定的版本）<br>
Java 1.2.0, 1.3.0, 1.4.0 | Java 2 | Playground Kestrel Merlin |没有Java 3 和 Java 4<br>
Java 1.5.0 | Java 5 | Tiger |<br>
Java 1.6.0 | Java 6 | Mustang |<br>
| Java 7 | Dolphin | Lambda（Java 对匿名函数的实现）、Jigsaw（Java 对模块化的实现），以及其它一些 Coin 项目中的内容在 Java 7 里被放弃，而转为Java 8一部分（其中 Jigsaw 直至 Java 9 才得到实现）。从2012年4月开始，Java 7 一直是java.com的默认下载版本，直到 Java 8 发布。<br>
| Java 8 |  | Java 8 不再支持 Windows XP[204] ，但JDK 8 第 25 版更新仍然可以在 Windows XP安装和运行。[205] 先前JDK 8的更新版本可以在XP中运行，但必须通过强制解压安装程序来进行安装。2014年10月后，Java 8 成为官方网站上默认的下载版本。<br>
| Java 9 |  | Java 9 的首个发布候选版于2017年8月9日发布，首个稳定版于2017年9月21日发布。<br>
| Java 10 |  | OpenJDK 10 于2018年3月20日发布。<br>
| Java 11 |  | JDK 11 于2018年9月25日发布。<br>
| Java 12 |  | JDK 12 于2019年3月19日发布。<br>
| Java 13 |  | JDK 13 于2019年9月17日发布。<br>
| Java 14 |  | JDK 14 发布于 2020 年 3 月 17 日。</p>
<h1 id="2-java-编译器-jvm">2 Java 编译器 &amp; JVM</h1>
<table>
<thead>
<tr>
<th>类型</th>
<th>JVM</th>
<th>编译器</th>
</tr>
</thead>
<tbody>
<tr>
<td>语法错误</td>
<td>F</td>
<td>T 代码转化为二进制码</td>
</tr>
<tr>
<td>有些数据类型错误会在运行时发生（例如：动态绑定）</td>
<td>T</td>
<td>F</td>
</tr>
<tr>
<td>存取权限</td>
<td>T</td>
<td>T 违反调用private方法的程序由编译器检查</td>
</tr>
</tbody>
</table>
<h1 id="3-其他程序语言可以用整数类型测试-我可以用">3 其他程序语言可以用整数类型测试，我可以用</h1>
<p><code>int x = 1; if (x) {}</code>吗？</p>
<p>不行，Java中的integer与boolean 两种类型不相容。只能：<br>
<code>boolean x = true; if (x) {}</code></p>
<h1 id="4-需要全局-global-变量或方法时怎么办？">4 需要全局（global）变量或方法时怎么办？</h1>
<p>Java中没有全局（global）变量的概念。可以使用<code>public</code>和<code>static</code>修饰符，让方法变成类似<code>global</code>修饰符。<br>
变量 可以用<code>public</code>， <code>static</code>和<code>final</code><br>
方法 可以用<code>public static</code></p>
<h1 id="5-如果能做出全局-global-变量或方法-又怎么算得上是面向对象呢？">5 如果能做出全局（global）变量或方法，又怎么算得上是面向对象呢？</h1>
<p>Java中所有事物都在类中。 <code>pi</code>常数和<code>random()</code>方法在<code>Math</code>类中是特殊情况，不会有多个<code>Math</code>实例或对象。</p>
<h1 id="6-成千上百的类如何提交-是否包装成类似单一应用程序的形式？">6 成千上百的类如何提交，是否包装成类似单一应用程序的形式？</h1>
<p>可以把所有文件包装进依据pkzip格式来存档的<code>Java Archive</code> —— <code>.jar</code>文件。<br>
Jar 文件里可以引入一个简单文字格式的文字文件——<code>manifest</code>，里面定义jar中的哪一个文件带有启动应用程序的<code>main()</code>方法。</p>
<h1 id="7-java的类型及其封装器类">7 Java的类型及其封装器类</h1>
<ul>
<li>
<p>Java基本类型( primitive values )共有八种，基本类型可以分为三类</p>
<ul>
<li>字符类型char</li>
<li>布尔类型boolean</li>
<li>数值类型byte、short、int、long、float、double。</li>
</ul>
</li>
<li>
<p>引用类型：引用到对象的变量。对象只会存在于可回收垃圾堆上。</p>
</li>
</ul>
<p>数值类型又可以分为整数类型byte、short、int、long和浮点数类型float、double。<br>
JAVA中的数值类型不存在无符号的，它们的取值范围是固定的，不会随着机器硬件环境或者操作系统的改变而改变。<br>
实际上，JAVA中还存在另外一种基本类型void，它也有对应的包装类 java.lang.Void，不过我们无法直接对它们进行操作。8 中类型表示范围如下：</p>
<p>byte：8位，最大存储数据量是255，存放的数据范围是-128~127之间。</p>
<p>short：16位，最大数据存储量是65536，数据范围是-32768~32767之间。</p>
<p>int：32位，最大数据存储容量是2的32次方减1，数据范围是负的2的31次方到正的2的31次方减1。</p>
<p>long：64位，最大数据存储容量是2的64次方减1，数据范围为负的2的63次方到正的2的63次方减1。</p>
<p>float：32位，数据范围在3.4e-45~1.4e38，直接赋值时必须在数字后加上f或F。</p>
<p>double：64位，数据范围在4.9e-324~1.8e308，赋值时可以加d或D也可以不加。</p>
<p>boolean：只有true和false两个取值。</p>
<p>char：16位，存储Unicode码，用单引号赋值。</p>
<p>Java决定了每种简单类型的大小。这些大小并不随着机器结构的变化而变化。这种大小的不可更改正是Java程序具有很强移植能力的原因之一。下表列出了Java中定义的简单类型、占用二进制位数及对应的封装器类。</p>
<table>
<thead>
<tr>
<th>简单类型</th>
<th>boolean</th>
<th>byte</th>
<th>char</th>
<th>short</th>
<th>int</th>
<th>long</th>
<th>float</th>
<th>double</th>
<th>void</th>
</tr>
</thead>
<tbody>
<tr>
<td>二进制位数</td>
<td>1</td>
<td>8</td>
<td>16</td>
<td>16</td>
<td>32</td>
<td>64</td>
<td>32</td>
<td>64</td>
<td>–</td>
</tr>
<tr>
<td>封装器类</td>
<td>Boolean</td>
<td>Byte</td>
<td>Character</td>
<td>Short</td>
<td>Integer</td>
<td>Long</td>
<td>Float</td>
<td>Double</td>
<td>Void</td>
</tr>
</tbody>
</table>
<p>对于数值类型的基本类型的取值范围，我们无需强制去记忆，因为它们的值都已经以常量的形式定义在对应的包装类中了。如：</p>
<p>基本类型byte 二进制位数：Byte.SIZE最小值：Byte.MIN_VALUE最大值：Byte.MAX_VALUE</p>
<p>基本类型short二进制位数：Short.SIZE最小值：Short.MIN_VALUE最大值：Short.MAX_VALUE</p>
<p>基本类型char二进制位数：Character.SIZE最小值：Character.MIN_VALUE最大值：Character.MAX_VALUE</p>
<p>基本类型double 二进制位数：Double.SIZE最小值：Double.MIN_VALUE最大值：Double.MAX_VALUE</p>
<p>注意：float、double两种类型的最小值与Float.MIN_VALUE、 Double.MIN_VALUE的值并不相同，实际上Float.MIN_VALUE和Double.MIN_VALUE分别指的是 float和double类型所能表示的最小正数。也就是说存在这样一种情况，0到±Float.MIN_VALUE之间的值float类型无法表示，0 到±Double.MIN_VALUE之间的值double类型无法表示。这并没有什么好奇怪的，因为这些范围内的数值超出了它们的精度范围。</p>
<p>Float和Double的最小值和最大值都是以科学记数法的形式输出的，结尾的&quot;E+数字&quot;表示E之前的数字要乘以10的多少倍。比如3.14E3就是3.14×1000=3140，3.14E-3就是3.14/1000=0.00314。</p>
<p>Java基本类型存储在栈中，因此它们的存取速度要快于存储在堆中的对应包装类的实例对象。从Java5.0（1.5）开始，JAVA虚拟机（Java Virtual Machine）可以完成基本类型和它们对应包装类之间的自动转换。因此我们在赋值、参数传递以及数学运算的时候像使用基本类型一样使用它们的包装类，但这并不意味着你可以通过基本类型调用它们的包装类才具有的方法。另外，所有基本类型（包括void）的包装类都使用了final修饰，因此我们无法继承它们扩展新的类，也无法重写它们的任何方法。</p>
<p>基本类型的优势：数据存储相对简单，运算效率比较高</p>
<p>包装类的优势：有的容易，比如集合的元素必须是对象类型，满足了java一切皆是对象的思想。</p>
<h2 id="javascript-数据类型">JavaScript 数据类型</h2>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Data_structures" target="_blank" rel="noopener">JavaScript一共有9种数据类型</a>:</p>
<ul>
<li>
<p>6 种原始类型( primitive values )：</p>
<ul>
<li>未定义：Undefined <code>typeof instance === &quot;undefined&quot;</code></li>
</ul>
<ul>
<li>
<p>布尔型：Boolean <code>typeof instance === &quot;boolean&quot;</code></p>
</li>
<li>
<p>数值：Number <code>typeof instance === &quot;number&quot;</code></p>
</li>
<li>
<p>字符串：String <code>typeof instance === &quot;string</code></p>
</li>
<li>
<p>BigInt：<code>typeof instance === &quot;bigint&quot;</code></p>
</li>
<li>
<p>Symbol ：<code>typeof instance === &quot;symbol&quot;</code></p>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>空：null <code>typeof instance === &quot;object&quot;</code></p>
</li>
<li>
<p>Object <code>typeof instance === &quot;object&quot;</code> 任何 constructed 对象实例的特殊非数据结构类型，也用做数据结构：new Object，new Array，new Map，new Set，new WeakMap，new WeakSet，new Date，和几乎所有通过 new keyword 创建的东西。</p>
</li>
<li>
<p>Function：非数据结构，尽管 typeof 操作的结果是：typeof instance === “function”。这个结果是为 Function 的一个特殊缩写，尽管每个 Function 构造器都由 Object 构造器派生。</p>
</li>
</ul>
<p>记住 typeof 操作符的唯一目的就是检查数据类型，如果我们希望检查任何从 Object 派生出来的结构类型，使用 typeof 是不起作用的，因为总是会得到 “object”。检查 Object 种类的合适方式是使用 instanceof 关键字。但即使这样也存在误差。</p>
<h1 id="引用变量">引用变量</h1>
<h2 id="引用变量有多大？">引用变量有多大？</h2>
<p>不知道。除非你跟某个Java虚拟机开发团队的人有交情，不然你是不知道引用是如何表示的。其内部有指针，但你也不需要存取。<br>
若是讨论内存分配的问题，最需要关心的应该是需要建立多少个对象和引用，以及对象的实际大小。</p>
<h2 id="所有的对象引用都具有相同的大小-而不管它实际上所引用的对象大小？">所有的对象引用都具有相同的大小， 而不管它实际上所引用的对象大小？</h2>
<p>是的，对于任意一个Java虚拟机，所有引用大小都一样，但不同的Java虚拟机可能会以不同的方式来表示引用， 因此某个Java虚拟机的引用大小可能会大于或小于另一个Java虚拟机的引用。</p>
<h2 id="可以对引用变量进行运算吗-像c语言那样？">可以对引用变量进行运算吗，像C语言那样？</h2>
<p>不可以。</p>
<h2 id="数组">数组</h2>
<p>数组一定是个对象，不管声明的元素是否为primitive主数据类型，并且没有primitive主数据类型的数组，只有装载primitive主数据类型的数组。</p>
<h1 id="实例变量">实例变量</h1>
<h2 id="未初始化时-它的默认值是多少？">未初始化时，它的默认值是多少？</h2>
<p>数值类型的变量默认值都为0（integers 0， floating points 0.0），char类型的默认值也是0。<br>
布尔类型booleans的默认值是false。<br>
引用类型references的默认值是null。</p>
<h2 id="实例变量和局部变量有哪些区别？">实例变量和局部变量有哪些区别？</h2>
<p>实例变量是声明在类中的，可以不初始化，会用默认值自动初始化。<br>
局部变量是声明在方法中的，在被使用之前，必须先初始化，没有默认值。方法的参数，也属于局部变量。</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>声明</th>
<th>初始化</th>
</tr>
</thead>
<tbody>
<tr>
<td>实例变量 Instance variables</td>
<td>类内</td>
<td>有默认值，使用前如果没有初始化，实例变量会用默认值</td>
</tr>
<tr>
<td>局部变量 local</td>
<td>方法中</td>
<td>没有默认值，使用前必须初始化。否则编译器会报错。</td>
</tr>
<tr>
<td>方法参数</td>
<td>方法中（方法的参数列中声明的）</td>
<td>没有默认值，使用前必须初始化。调用方法而没有赋值参数时，编译器会报错。参数一定会被初始化，编译器会确保方法被调用时会有与声明所相符的参数，且参数会自动地被赋值进入。</td>
</tr>
</tbody>
</table>
<h2 id="如何判断两个变量是否相等？">如何判断两个变量是否相等？</h2>
<p>== , 比较两个primitive主数据类型，或者判断两个引用是否引用同一个对象。<br>
equals()，用于判断两个对象是否是在意义上的相等。（例如两个String对象是否带有相同的字节组合。）</p>
<h2 id="什么是形参-parameter-和实参-argument-？">什么是形参(parameter)和实参(argument)？</h2>
<p>我们可以给方法传入参数。实参是传给方法的值。当实参传入方法后就成了形参。<br>
给方法传入实参时，实参的顺序、类型、数量必须与形参的顺序、类型、数量完全一致。<br>
你还可以把变量当作实参传入方法，只要其类型符合要求即可。</p>
<h2 id="方法的参数传递为什么是值传递？什么是值传递？">方法的参数传递为什么是值传递？什么是值传递？</h2>
<p>Java方法的参数传递是值传递形式，即通过拷贝传递。<br>
实参进入方法之后就成了形参，形参的变化不会改变实参（方法无法改变调用方所传入的参数），这就是值传递的好处。<br>
如果传递的是对象，那么传递的是对象引用的拷贝。对象引用不会被方法改变，但是可以改变对象。</p>
<h2 id="什么是方法的返回值？方法可以声明多个返回值？">什么是方法的返回值？方法可以声明多个返回值？</h2>
<p>在Java中，方法可以有返回值，每个方法都必须显示地指明返回值类型。如果方法没有返回值，指明为void类型即可。<br>
不能有多个，只能单一返回值。</p>
<h2 id="一定要返回所声明的类型吗？">一定要返回所声明的类型吗？</h2>
<p>可以返回会被隐式转换成声明类型的其他类型。例如byte当做int类型的返回。<br>
但若声明的类型容器小于想要返回的类型，必须做明确的转换。</p>
<h2 id="传给方法的参数必须符合声明时的数量-顺序和类型吗？">传给方法的参数必须符合声明时的数量、顺序和类型吗？</h2>
<p>是的。但是传入和传出方法的值类型可以隐含的方法或是明确的缩小。</p>
<h2 id="方法必须声明返回类型吗？">方法必须声明返回类型吗？</h2>
<p>是的。不返回任何东西，也得声明返回类型为<code>void</code>。</p>
<h2 id="java-equals-区别">Java ==  equals() 区别</h2>
<p><a href="/Java-and-equals-%E5%8C%BA%E5%88%AB.md">Java ==  equals() 区别</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernates all you should know</title>
    <url>/Kubernates-all-you-should-know.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="k8s基础知识">K8s基础知识</h1>
<ul>
<li><a href="https://kubernetes.io/docs/home/" target="_blank" rel="noopener">K8s 官方文档</a></li>
<li>知乎文章
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/105006577?utm_medium=social&amp;utm_oi=56834706636800&amp;utm_psn=1578874624045264896&amp;utm_source=wechat_session" target="_blank" rel="noopener">一关系图让你理解K8s中的概念，Pod、Service、Job等到底有啥关系</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/500443105?utm_medium=social&amp;utm_oi=56834706636800&amp;utm_psn=1578889599430103040&amp;utm_source=wechat_session" target="_blank" rel="noopener">Kubernets原理的分解讲解</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/56031304?utm_medium=social&amp;utm_oi=56834706636800&amp;utm_psn=1578890535669833728&amp;utm_source=wechat_session" target="_blank" rel="noopener">主流 Kubernetes 发行版梳理，看完就会选了</a></li>
<li><a href="https://www.zhihu.com/question/434475807/answer/2409751479?utm_campaign=shareopn&amp;utm_content=group2_Answer&amp;utm_medium=social&amp;utm_oi=56834706636800&amp;utm_psn=1578891774508052480&amp;utm_source=wechat_session" target="_blank" rel="noopener">想学习云原生/云原生边缘计算相关技术，需要哪些计算机基础知识？</a></li>
</ul>
</li>
<li><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzIxMTE0ODU5NQ==&amp;action=getalbum&amp;album_id=2332884281821462529&amp;scene=173&amp;from_msgid=2650248506&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" target="_blank" rel="noopener">Kubernetes 知识合集（微信公众号）</a>
<ul>
<li><a href="https://mp.weixin.qq.com/s/uTBmNoXuiNyIkxRtPhsvOA" target="_blank" rel="noopener">新手必须知道的 Kubernetes 架构</a></li>
<li><a href="https://mp.weixin.qq.com/s/JpvlPBazyvy41AyX-RPwvQ" target="_blank" rel="noopener">Kubernetes 架构核心点详细总结！</a></li>
<li><a href="https://mp.weixin.qq.com/s/n3QYIGuM1io1ubE3KC1hrw" target="_blank" rel="noopener">【云原生】一文细数kubernetes常见20道问题</a></li>
</ul>
</li>
</ul>
<h2 id="关系图">关系图</h2>
<p><img src="https://img-blog.csdnimg.cn/20210605112824989.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2l0c2FrYQ==,size_16,color_FFFFFF,t_70" alt="关系图"></p>
<h2 id="k8s基本概念">K8s基本概念</h2>
<h3 id="kubectl-context">kubectl context</h3>
<blockquote>
<p>注：所谓 kubectl context，就是用来告诉kubectl 命令“去连接哪个集群”的一系列配置。<br>
A kubectl context contains connection information to a Kubernetes cluster. Different kubectl contexts can connect to different Kubernetes clusters, or to the same cluster but using different users or different default namespaces.</p>
</blockquote>
<h2 id="k8s书籍">K8s书籍</h2>
<ul>
<li>英文名：《Docker Deep Dive》中文名：《深入浅出Docker》（很薄, 深入浅出)</li>
<li>英文名：《The Kubernetes book》中文名：《Kubernetes修炼手册》 （很薄，适合初学者快速了解基本概念）</li>
<li>《Kubernetes in Action》 （厚度合适，比第一本更详细一些）</li>
<li>《CKA/CKAD 应试指南》 （适合考试辅助）</li>
<li>《Kubernetes权威指南》 （这本太厚，不推荐第一次学习看，适合当字典翻阅）</li>
</ul>
<h2 id="k8s课程">K8s课程</h2>
<ul>
<li>初学者： <a href="https://www.udemy.com/course/learn-kubernetes" target="_blank" rel="noopener">Kubernetes for the Absolute Beginners - Hands-on</a> by Mumshad Mannambeth – Udemy</li>
</ul>
<h3 id="certified-kubernetes-administrator-cka">Certified Kubernetes Administrator (CKA)</h3>
<ul>
<li><a href="https://www.techbeatly.com/kk-cka" target="_blank" rel="noopener">Certified Kubernetes Administrator (CKA) – KodeKloud</a> – by Mumshad Mannambeth)</li>
<li><a href="https://www.techbeatly.com/kk-cka-ud" target="_blank" rel="noopener">Certified Kubernetes Administrator (CKA) with Practice Tests – by Mumshad Mannambeth</a> – Udemy</li>
</ul>
<h3 id="certified-kubernetes-application-developer-ckad">Certified Kubernetes Application Developer (CKAD)</h3>
<ul>
<li><a href="https://www.techbeatly.com/kk-ckad" target="_blank" rel="noopener">Certified Kubernetes Application Developer (CKAD)</a> – by Mumshad Mannambeth</li>
<li><a href="https://www.techbeatly.com/kk-ckad-ud" target="_blank" rel="noopener">Kubernetes Certified Application Developer (CKAD) with Tests</a> – by Mumshad Mannambeth – Udemy</li>
</ul>
<h3 id="certified-kubernetes-security-specialist-cks">Certified Kubernetes Security Specialist (CKS)</h3>
<ul>
<li><a href="https://www.techbeatly.com/kk-cks" target="_blank" rel="noopener">Certified Kubernetes Security Specialist (CKS)</a>– by Mumshad Mannambeth</li>
<li><a href="https://www.techbeatly.com/kw-cks" target="_blank" rel="noopener">Kubernetes CKS 2021 Complete Course – Theory – Practice</a> – by Kim Wüstkamp – Udemy</li>
</ul>
<h3 id="oreilly视频课程">Oreilly视频课程</h3>
<ul>
<li><a href="https://learning.oreilly.com/beta-search/?q=ckad%20sander%20van%20vugt&amp;type=*&amp;publishers=Pearson&amp;order_by=relevance" target="_blank" rel="noopener">CKA和CKAD</a>
<ul>
<li><a href="https://learning.oreilly.com/live-events/certified-kubernetes-administrator-cka-crash-course/0636920315766/" target="_blank" rel="noopener">Certified Kubernetes Administrator (CKA) Crash Course</a>
<ul>
<li>附带练习环境Practice: <a href="https://learning.oreilly.com/playlists/d6e3fe86-067c-4dc7-a36d-698802d0bdee/" target="_blank" rel="noopener">Certified Kubernetes - CKA Labs</a></li>
</ul>
</li>
<li><a href="https://learning.oreilly.com/live-events/certified-kubernetes-application-developer-ckad-crash-course/0636920315803/" target="_blank" rel="noopener">Certified Kubernetes Application Developer (CKAD) Crash Course</a>
<ul>
<li>附带练习环境Practice: <a href="https://learning.oreilly.com/playlists/ea6ea0fc-d8e2-422c-94dd-a0a8f608d224/" target="_blank" rel="noopener">Certified Kubernetes - CKAD Labs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>可以配置成Oreilly课程对应的lab环境：</p>
<blockquote>
<p>To work through the labs in this course, you will need to install and configure your own lab environment.</p>
<p>Different lab installation options are possible, but it is recommended to use <code>Minikube</code>, on a virtual machine that runs the latest version of Ubuntu LTS desktop.</p>
</blockquote>
<p>Prepare the <code>Minikube</code> based lab setup before start of the course can follow the instructions that are provided in the <strong>“Setup Guide”</strong> in the course <a href="https://github.com/sandervanvugt/ckad/blob/master/SetupGuide.pdf" target="_blank" rel="noopener">CKAD GitHub repository</a>, <a href="https://github.com/sandervanvugt/cka" target="_blank" rel="noopener">CKA GitHub repository</a></p>
<h1 id="k8s安装部署">k8s安装部署</h1>
<table>
<thead>
<tr>
<th>部署方式</th>
<th>类型</th>
<th>作用</th>
<th>环境需求</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minikube</td>
<td>工具</td>
<td>快速搭建一个<code>单节点</code>的K8s，仅用于尝试Kubernetes或日常开发的用户使用。<a href="https://kubernetes.io/docs/tasks/tools/#minikube" target="_blank" rel="noopener">部署地址</a>. 参考另一篇博客<a href="./Minikube%E5%AE%89%E8%A3%85-MacOS-M1.html">Minikube安装-MacOS M1</a></td>
<td>环境：centos 7.4 +<br>硬件需求：CPU&gt;=2c ,内存&gt;=2G</td>
</tr>
<tr>
<td>kubeadm</td>
<td>工具【官方推荐】</td>
<td>kubeadm init和kubeadm join，用于快速部署K8s集群。<a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/" target="_blank" rel="noopener">部署地址</a>. 参考文章：1<a href="https://zhuanlan.zhihu.com/p/445917469?utm_medium=social&amp;utm_oi=56834706636800&amp;utm_psn=1578882975642624000&amp;utm_source=wechat_session" target="_blank" rel="noopener">使用kubeadm快速部署一套K8S集群</a> 2 <a href="https://zhuanlan.zhihu.com/p/403821493?utm_medium=social&amp;utm_oi=56834706636800&amp;utm_psn=1578893327369469952&amp;utm_source=wechat_session" target="_blank" rel="noopener">Kubernetes集群部署-01</a></td>
<td></td>
</tr>
<tr>
<td>官方下载发行版的二进制包</td>
<td>二进制包【建议生产环境使用】</td>
<td>手动部署每个组件，组成Kubernetes集群。<a href="https://github.com/kubernetes/kubernetes/releases" target="_blank" rel="noopener">下载地址</a></td>
<td></td>
</tr>
<tr>
<td>虚拟机提供商</td>
<td>Google Compute Engine、Amazon EC2、Microsoft Azure等</td>
<td></td>
<td></td>
</tr>
<tr>
<td>kops</td>
<td>是用于在 AWS 上安装 Kubernetes 的一个“武断”（opinionated）的工具，所谓 “武断”，是说在用它安装的时候没有太多可定制的空间。如果需要一个高度可定制化的集群，建议使用 kubeadm。<a href="https://kubernetes.io/docs/setup/production-environment/tools/kops/" target="_blank" rel="noopener">Installing Kubernetes with kOps</a></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="k8s练习环境-非生产环境">k8s练习环境(非生产环境)</h2>
<h3 id="在线环境-killercoda-考试练习推荐">在线环境-killercoda(考试练习推荐)</h3>
<ul>
<li>
<p>k8s 环境： <a href="https://killercoda.com/playgrounds/scenario/kubernetes" target="_blank" rel="noopener">https://killercoda.com/playgrounds/scenario/kubernetes</a></p>
</li>
<li>
<p>CKA在线练习环境：<a href="https://killercoda.com/killer-shell-cka" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cka</a></p>
</li>
<li>
<p>CKAD在线练习环境：<a href="https://killercoda.com/killer-shell-ckad" target="_blank" rel="noopener">https://killercoda.com/killer-shell-ckad</a></p>
</li>
<li>
<p>CKS在线练习环境：<a href="https://killercoda.com/killer-shell-cks" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks</a></p>
</li>
<li>
<p>临时考试模拟环境（1小时有效期）：<a href="https://killercoda.com/kimwuestkamp/scenario/cks-cka-ckad-remote-desktop" target="_blank" rel="noopener">https://killercoda.com/kimwuestkamp/scenario/cks-cka-ckad-remote-desktop</a></p>
</li>
<li>
<p>模拟考试环境： <a href="https://killer.sh/" target="_blank" rel="noopener">https://killer.sh/</a> 包含CKA,CKAD,CKS （需付费，官方考试已包含两次session，每个session 36个小时有效期）</p>
<ul>
<li>模拟考题：<a href="https://killer.sh/attendee/f8c336a9-658e-4342-a59e-13850ff20813/content" target="_blank" rel="noopener">CKA Simulator Kubernetes 1.24</a></li>
<li><a href="https://killer.sh/course/preview/e84d0e31-4fff-4c42-8afd-be1bdbc0d994" target="_blank" rel="noopener">CKA Simulator Preview Kubernetes 1.25</a></li>
<li><a href="https://killer.sh/course/preview/052229bd-1062-44a4-8aae-f50d0770165a" target="_blank" rel="noopener">CKAD Simulator Preview Kubernetes 1.25</a></li>
<li><a href="https://killer.sh/course/preview/bf573045-49c8-44c3-b2e5-8eec7b8eaab3" target="_blank" rel="noopener">CKS Simulator Preview Kubernetes 1.25</a></li>
</ul>
</li>
</ul>
<h3 id="在线环境-play-with-kubernetes-pwk">在线环境-<a href="https://labs.play-with-k8s.com/" target="_blank" rel="noopener">Play with Kubernetes（PWK）</a></h3>
<p>需要使用一个 GitFub 或 Docker Fub 账号完成登录，并完成一些简单的操作来搭建一个持续4h的集群。不太稳定，有时会报错。<br>
<a href="./Kubernetes-Play-with-Kubernetes(PWK).html">PWK部署k8s集群</a></p>
<h3 id="桌面版docker">桌面版Docker</h3>
<p>是一个来自Docker 公司的免费桌面应用，只需要下载并运行安装程序。桌面版 Docker 是在自己的 macos 或 Windows 中部署本地开发环境的最佳方式。只需几个步骤就可以轻松地部署一个用于开发和测试的<strong>单节点</strong>的 Kubernetes 集群。</p>
<p>桌面版Docker通过创建一个虚拟机，然后在虚拟机中启动一个单节点的Kubernehs集群来实现。同时它还会完成 kubectl 容户端的配置，以便连接集群。最后，还有一个简单的图形界面用来执行诸如切换 kubectl context 的基本操作。</p>
<ol>
<li>打开 Docker 主页，选择 Products ＞ 桌面版 Docker。</li>
<li>单击macOs 或 Windows 对应的下载按钮，<br>
可能需要登录 Docker Store，账号和桌面版Docker 软件一样都是免费的。</li>
<li>打开下载的安装程序，并按步骤安装。<br>
安装完成后，会有一个鲸鱼因标出现在 Windows 任务栏或 macos 的菜单栏中，</li>
<li>单击鲸鱼图标（可能需要右击），进人设置界面，然后在 Kubernetes 页签中启用Kubernetes</li>
</ol>
<p>此时可以打开终端查看集群信息。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ kubectl <span class="builtin-name">get</span> nodes</span><br></pre></td></tr></table></figure>
<p>现在已经有一个本地的Kubernetes 集群了。</p>
<h3 id="magic-sandbox">Magic Sandbox</h3>
<p>只需要注册一个账号并登录，即可马上得到一个完整可用的多节点私有集群。其中还有一些内置课程和上手实验。</p>
<h3 id="在线环境-oreilly">在线环境-Oreilly</h3>
<p>需购买课程, 或配置本地环境</p>
<ul>
<li><a href="https://learning.oreilly.com/playlists/d6e3fe86-067c-4dc7-a36d-698802d0bdee/" target="_blank" rel="noopener">Certified Kubernetes - CKA Labs</a></li>
<li><a href="https://learning.oreilly.com/playlists/ea6ea0fc-d8e2-422c-94dd-a0a8f608d224/" target="_blank" rel="noopener">Certified Kubernetes - CKAD Labs</a></li>
</ul>
<h2 id="托管的kubernetes集群">托管的Kubernetes集群</h2>
<ul>
<li>AWS: Elastic Kubernetes Service (EKS).</li>
<li>Microsoft Azure: Azure Kubernetes Service ( AKS).</li>
<li>DigitalOcean: DigitalOcean Kubernetes.</li>
<li>IBM Cloud: IBM Cloud Kubernetes Service.</li>
<li>Google Cloud Platform: Google Kubernetes Engine ( GKE ).</li>
</ul>
<blockquote>
<p>大多数的主流云平台提供托管的 Kubernetes （hosted Kubernetes）服务。采用这种方式，控制平面（control plane， 即master）的相关组件是由云平台管理的。</p>
<p>例如，云服务供应南会确保控制平面的高可用和高性能，并负责使控制平面保持更新。另外，用户失去对版本的部分控制，定制化的能力也会受到限制。</p>
<p>抛开优缺点不谈，托管的Kubernetes 服务是最开箱即用的生产级别的Kubemetes了。事实上，Google Kubernetes 引擎GKE可以让用户在几个简单的单击之后就能完成生产级别的Kubernetes 集群和 Istio 服务网格（ Service Mesh）的部署。其他云厂商也有类似的服务。</p>
<p>在考虑选择以上某项服务来搭建自己的Kubernetes 集群时，尝试问自己：自行搭建和管理 Kubernetes 集群能否实现时问和其他资源的最大化利用？如果答案不是“当然是”，那么我强烈建议考虑托管的服务。</p>
</blockquote>
<h3 id="使用google-kubernetes-engine托管kubernetes集群">使用Google Kubernetes Engine托管Kubernetes集群</h3>
<p>如果你想探索一个完善的多节点Kubernetes集群，可以使用托管的Google Kubernetes Engine（GKE）集群。这样，无须手动设置所有的集群节点和网络，因为这对于刚开始使用Kubernetes的人来说太复杂了。使用例如GKE这样的托管解决方案可以确保不会出现配置错误、不工作或部分工作的集群。</p>
<h4 id="配置一个google-cloud项目并且下载必需的客户端二进制">配置一个Google Cloud项目并且下载必需的客户端二进制</h4>
<p>在设置新的Kubernetes集群之前，需要设置GKE环境。因为这个过程可能会改变，所以不在这里列出具体的说明。阅读https://cloud.google.com/containerengine/docs/before-begin中的说明后就可以开始了。</p>
<p>整个过程大致包括：</p>
<ol>
<li>注册谷歌账户，如果你还没有注册过。</li>
<li>在Google Cloud Platform控制台中创建一个项目。</li>
<li>开启账单。这会需要你的信用卡信息，但是谷歌提供了为期12个月的免费试用。而且在免费试用结束后不会自动续费。</li>
<li>开启Kubernetes Engine API。</li>
<li>下载安装Google Cloud SDK（这包含 gcloud 命令行工具，需要创建一个Kubernetes集群）。</li>
<li>使用 gcloud components install kubectl 安装 kubectl 命令行工具。</li>
</ol>
<p>注意 某些操作（例如步骤2中的操作）可能需要几分钟才能完成。</p>
<h4 id="创建一个三节点kubernetes集群">创建一个三节点Kubernetes集群</h4>
<p>完成安装后，可以使用下面代码清单中的命令创建一个包含三个工作节点的Kubernetes集群。</p>
<h4 id="在gke上创建一个三节点集群">在GKE上创建一个三节点集群</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ gcloud container clusters create kubia --num-nodes 3 --machine-tvpe fl-micro</span><br><span class="line">Creating cluster kubia... <span class="keyword">done</span></span><br><span class="line">Created [https://container.googleapis.com/y1/proiects/kubial-1227/zones/europe-west1<span class="_">-d</span>/clusters/kubia]</span><br><span class="line">kubeconfig entry generated <span class="keyword">for</span> kubia.</span><br><span class="line">NAME ZONE MST VER MASTER IP  TYPE NODE VER NUM NODES STATUSkubia eu-wld 1.5.3 104.155.92.30 fl-micro 1.5.3:  RUNNING</span><br></pre></td></tr></table></figure>
<p>现在已经有一个正在运行的Kubernetes集群，包含了三个工作节点。你在使用三个节点来更好地演示适用于多节点的特性，如果需要的话可以使用较少数量的节点。</p>
<h1 id="k8s-certificate-考试认证">K8s Certificate 考试认证</h1>
<ul>
<li>KCNA（75分及格）
<ul>
<li><a href="https://training.linuxfoundation.org/certification/kubernetes-cloud-native-associate/" target="_blank" rel="noopener">KCNA考试只有选择题</a></li>
</ul>
</li>
<li><a href="./Kubernates-Certified-Kubernetes-Administrator-CKA.html">CKA (Certified Kubernetes Administrator)考试指南</a> （66分及格）
<ul>
<li><a href="https://training.linuxfoundation.org/certification/certified-kubernetes-administrator-cka/" target="_blank" rel="noopener">CKA机试 - 实战</a></li>
<li>CKA is intended for <code>DeVops, Engineers and Cloud Architects</code> and Architects. CKA certification is much more difficult than CKAD.</li>
</ul>
</li>
<li><a href="./Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html">CKAD(Certified Kubernetes Application Developer)考试指南</a>（66分及格）
<ul>
<li><a href="https://training.linuxfoundation.org/certification/certified-kubernetes-application-developer-ckad/" target="_blank" rel="noopener">CKAD机试 - 实战</a></li>
<li>适合开发人员。CKAD is intended for <code>developers</code> who will use Kubernetes as an orchestrator in their development projects and cloud engineers.</li>
</ul>
</li>
<li>CKS (Certified Kubernetes Security Specialist)（67分及格）
<ul>
<li><a href="https://training.linuxfoundation.org/certification/certified-kubernetes-security-specialist/#" target="_blank" rel="noopener">CKS机试 - 实战</a></li>
<li>安全专家。CKS is intended for <code>security</code> experts, DevOps experts, Cloud Architects, Security Architects. CKS is a very difficult certification, and it takes a lot of time to be prepared.</li>
</ul>
</li>
</ul>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://www.linkedin.com/pulse/how-i-got-ckad-certification-2021-3-weeks-abdelahad-satour/" target="_blank" rel="noopener">How I got CKAD Certification (2021) in 3 Weeks</a></li>
<li><a href="https://devopscube.com/kubernetes-certification-coupon/" target="_blank" rel="noopener">2022.12 Kubernetes Certification Coupon + Discount</a></li>
<li><a href="https://www.techbeatly.com/kubernetes/" target="_blank" rel="noopener">2022.11 Kubernetes Certification Promotions</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>Promise Vs setTimeout</title>
    <url>/Promise-Vs-setTimeout.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>了解这个，就得了解JavaScript异步编程，了解任务队列才能知其根本。</p>
<p>一个事件循环（event loop）+多个任务队列（task queue）</p>
<h2 id="事件循环-event-loop">事件循环（event loop）</h2>
<h2 id="task-queue">Task Queue</h2>
<h3 id="macrotask-queue-宏任务队列">Macrotask Queue 宏任务队列:</h3>
<ul>
<li>setTimeout</li>
<li>setInterval</li>
<li>setImmediate</li>
<li>requestAnimationFrame</li>
<li>UI rendeing</li>
<li>NodeJS中的`I/O （fs.readFile）等</li>
</ul>
<h3 id="microtask-queue-微任务队列">Microtask Queue 微任务队列:</h3>
<p>主要包括两类：</p>
<ul>
<li>独立回调microTask：如Promise，其成功／失败回调函数相互独立；</li>
<li>复合回调microTask：如 Object.observe, MutationObserver 和NodeJs中的 process.nextTick ，不同状态回调在同一函数体；</li>
</ul>
<h3 id="macrotask-microtask-两者关系">MacroTask MicroTask 两者关系</h3>
<p>入栈过程：</p>
<blockquote>
<ol>
<li>开始执行JavaScript脚本，将任务JavaScript Run入栈macroTask队列；</li>
<li>同步resolvePromise后；</li>
<li>入栈<code>第一个</code>setTimeout任务进入macroTask队列</li>
<li>入栈Proimse.then任务进入microTask队列；</li>
<li>入栈第二个setTimeout任务进入macroTask队列；<br>
出栈执行过程：</li>
<li>同步执行代码，退出第一个macroTask，即JavaScript Run;</li>
<li>按顺序执行microTask queue 所有microTask；</li>
<li>执行下一个macroTask；</li>
</ol>
</blockquote>
<p>可以参考这个流程图：<br>
<img src="http://www.programmersought.com/images/250/ae6f91d1cb68f1e5d05b95a66a2cba72.png" alt="流程图"></p>
<h2 id="show-me-the-code">Show me the code</h2>
<p>例题1-5 来自<a href="http://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="noopener">ES6 Book </a>：</p>
<h3 id="例题1">例题1</h3>
<p>Promise 新建后就会立即执行。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Promise'</span>);</span><br><span class="line">  resolve();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'resolved.'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Hi!'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise</span></span><br><span class="line"><span class="comment">// Hi!</span></span><br><span class="line"><span class="comment">// resolved</span></span><br></pre></td></tr></table></figure>
<p>上面代码中，Promise 新建后立即执行，所以首先输出的是Promise。然后，then方法指定的回调函数，将在当前脚本所有同步任务执行完才会执行，所以resolved最后输出。</p>
<h3 id="例题2">例题2</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  resolve(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="params">r</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(r);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>上面代码中，调用resolve(1)以后，后面的console.log(2)还是会执行，并且会首先打印出来。这是因为立即 resolved 的 Promise 是在本轮事件循环的末尾执行，总是晚于本轮循环的同步任务。</p>
<p>一般来说，调用resolve或reject以后，Promise 的使命就完成了，后继操作应该放到then方法里面，而不应该直接写在resolve或reject的后面。所以，最好在它们前面加上return语句，这样就不会有意外。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> resolve(<span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 后面的语句不会执行</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="例题3">例题3</h3>
<p>需要注意的是，立即resolve()的 Promise 对象，是在本轮“事件循环”（event loop）的结束时执行，而不是在下一轮“事件循环”的开始时。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'three'</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'two'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'one'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// one</span></span><br><span class="line"><span class="comment">// two</span></span><br><span class="line"><span class="comment">// three</span></span><br></pre></td></tr></table></figure>
<p>上面代码中，setTimeout(fn, 0)在下一轮“事件循环”开始时执行，Promise.resolve()在本轮“事件循环”结束时执行，console.log(‘one’)则是立即执行，因此最先输出。</p>
<h3 id="例题4-promise-try">例题4 Promise.try</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(f);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</span><br><span class="line"><span class="comment">// next</span></span><br><span class="line"><span class="comment">// now</span></span><br></pre></td></tr></table></figure>
<p>上面代码中，函数f是同步的，但是用 Promise 包装了以后，就变成异步执行了。</p>
<p>那么有没有一种方法，让同步函数同步执行，异步函数异步执行，并且让它们具有统一的 API 呢？回答是可以的，并且还有两种写法。第一种写法是用async函数来写。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</span><br><span class="line">(<span class="keyword">async</span> () =&gt; f())();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</span><br><span class="line"><span class="comment">// now</span></span><br><span class="line"><span class="comment">// next</span></span><br></pre></td></tr></table></figure>
<p>上面代码中，第二行是一个立即执行的匿名函数，会立即执行里面的async函数，因此如果f是同步的，就会得到同步的结果；如果f是异步的，就可以用then指定下一步，就像下面的写法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; f())()</span><br><span class="line">.then(...)</span><br></pre></td></tr></table></figure>
<p>需要注意的是，async () =&gt; f()会吃掉f()抛出的错误。所以，如果想捕获错误，要使用promise.catch方法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; f())()</span><br><span class="line">.then(...)</span><br><span class="line">.catch(...)</span><br></pre></td></tr></table></figure>
<p>第二种写法是使用new Promise()。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</span><br><span class="line">(</span><br><span class="line">  () =&gt; <span class="keyword">new</span> <span class="built_in">Promise</span>(</span><br><span class="line">    resolve =&gt; resolve(f())</span><br><span class="line">  )</span><br><span class="line">)();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</span><br><span class="line"><span class="comment">// now</span></span><br><span class="line"><span class="comment">// next</span></span><br></pre></td></tr></table></figure>
<p>上面代码也是使用立即执行的匿名函数，执行new Promise()。这种情况下，同步函数也是同步执行的。</p>
<p>鉴于这是一个很常见的需求，所以现在有一个提案，提供Promise.try方法替代上面的写法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</span><br><span class="line"><span class="built_in">Promise</span>.try(f);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</span><br><span class="line"><span class="comment">// now</span></span><br><span class="line"><span class="comment">// next</span></span><br></pre></td></tr></table></figure>
<p>例题5, 6 来自<a href="https://juejin.im/post/5b7057b251882561381e69bf" target="_blank" rel="noopener">浅析setTimeout与Promise</a>：</p>
<h3 id="例题5">例题5</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Before resolve"</span>);</span><br><span class="line">    resolve(<span class="number">1</span>);</span><br><span class="line">&#125;)</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"will be executed at the top of the next Event Loop"</span>);</span><br><span class="line">&#125;,<span class="number">0</span>)</span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"p1 fulfilled"</span>);</span><br><span class="line">&#125;)</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"will be executed at the bottom of the next Event Loop"</span>);</span><br><span class="line">&#125;,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">Before resolve</span><br><span class="line">p1 fulfilled</span><br><span class="line">will be executed at the top of the next Event Loop</span><br><span class="line">will be executed at the bottom of the next Event Loop</span><br></pre></td></tr></table></figure>
<blockquote>
<ol>
<li>开始执行JavaScript脚本，将任务JavaScript Run入栈macroTask队列；</li>
<li>同步resolvePromise后；</li>
<li>入栈第一个setTimeout任务进入macroTask队列</li>
<li>入栈Proimse.then任务进入microTask队列；</li>
<li>入栈第二个setTimeout任务进入macroTask队列；</li>
<li>同步执行代码完毕，退出第一个macroTask，即JavaScript Run;  输出 Before resolve</li>
<li>执行清空microTask；输出 p1 fulfilled</li>
<li>执行下一个macroTask；输出 will be executed at the top of the next Event Loop<br>
will be executed at the bottom of the next Event Loop</li>
</ol>
</blockquote>
<h3 id="例题6">例题6</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"will be executed at the top of the next Event Loop"</span>)</span><br><span class="line">&#125;,<span class="number">0</span>)</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123; resolve(<span class="number">1</span>); &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;);</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"will be executed at the bottom of the next Event Loop"</span>)</span><br><span class="line">&#125;,<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params">j</span>)</span>&#123;</span><br><span class="line">        p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">           <span class="built_in">console</span>.log(<span class="string">"promise then - "</span> + j)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)(i)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// will be executed at the top of the next Event Loop</span></span><br><span class="line"><span class="comment">// promise then - 0</span></span><br><span class="line"><span class="comment">// promise then - 1</span></span><br><span class="line"><span class="comment">// promise then - 2</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// promise then - 99</span></span><br><span class="line"><span class="comment">// will be executed at the bottom of the next Event Loop</span></span><br></pre></td></tr></table></figure>
<h3 id="例题7">例题7</h3>
<p>来源： <a href="https://www.zhihu.com/question/36972010" target="_blank" rel="noopener">Promise的队列与setTimeout的队列有何关联？</a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="number">4</span>)&#125;,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> i=<span class="number">0</span> ; i&lt;<span class="number">10000</span> ; i++ )&#123;</span><br><span class="line">        i==<span class="number">9999</span> &amp;&amp; resolve()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">5</span>)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//1,2,3,5,4</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol>
<li>首先同步执行完所有代码，其间注册了三个setTimeout异步任务，100个Promise异步任务；</li>
<li>然后检查MacroTask队列，取第一个到期的MacroTask，执行输出will be executed at the top of the next Event Loop;</li>
<li>然后检查MicroTask队列，发现没有到期的MicroTask，进入第4步；</li>
<li>再次检查MacroTask，执行第二个setTimeout处理函数，resolve Promise；</li>
<li>然后检查MicroTask队列，发现Promise已解决，其异步处理函数均可执行，依次执行，输出promise then - 0 至promise then - 99；</li>
<li>最后再次检查MacroTask队列，执行输出will be executed at the bottom of the next Event Loop</li>
<li>交替往复检查两个异步任务队列，直至执行完毕；</li>
</ol>
<h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://juejin.im/post/5b7057b251882561381e69bf" target="_blank" rel="noopener">浅析setTimeout与Promise</a></li>
<li><a href="https://juejin.im/post/5b7057b251882561381e69bf" target="_blank" rel="noopener">What is the relationship between event loop and Promise [stackoverflow]</a></li>
<li><a href="http://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="noopener">ES6 Book </a></li>
<li><a href="https://www.zhihu.com/question/36972010" target="_blank" rel="noopener">Promise的队列与setTimeout的队列有何关联？[知乎]</a></li>
<li><a href="https://blog.risingstack.com/writing-a-javascript-framework-execution-timing-beyond-settimeout" target="_blank" rel="noopener">Writing a JavaScript framework - Execution timing, beyond setTimeout</a></li>
<li><a href="https://github.com/deenjohn/NodeRevision/blob/master/6-Concurrency%20model%20and%20event%20loop%20-part%20B.md" target="_blank" rel="noopener">6-Concurrency model and event loop -part B</a></li>
<li><a href="https://stackoverflow.com/questions/34753342/microtasks-vs-events-and-how-to-define-what-as-which" target="_blank" rel="noopener">Microtasks vs Events and how to define what as which?</a></li>
<li><a href="https://medium.com/@jitubutwal144/javascript-how-is-callback-execution-strategy-for-promises-different-than-dom-events-callback-73c0e9e203b1" target="_blank" rel="noopener">JavaScript: How is callback execution strategy for promises different than DOM events callback?</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>Promise</tag>
        <tag>TODO</tag>
      </tags>
  </entry>
  <entry>
    <title>Monorepos Vs MultiRepo/Polyrepo</title>
    <url>/Monorepos-Vs-MultiRepo-Polyrepo.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="what-is-a-monorepo">What is a Monorepo?</h1>
<p><a href="https://monorepo.tools/#what-is-a-monorepo" target="_blank" rel="noopener">What is a Monorepo?</a></p>
<h1 id="why-monorepo">Why Monorepo</h1>
<p><a href="https://monorepo.tools/#why-a-monorepo" target="_blank" rel="noopener">Why Monorepo</a></p>
<p>Monorepo是指将所有项目模块都存放在一个代码库中的做法。通常，我们会为每个项目模块建立一个独立的代码库，但是在一些特殊情况下，将所有项目模块放在一个代码库中会更加方便。通常情况下，Monorepo都会配合一些特殊的工具使用，比如Lerna、Yarn Workspaces、Bazel等。</p>
<h2 id="multirepo-vs-monorepo">MultiRepo Vs MonoRepo</h2>
<h1 id="monorepo的优缺点">Monorepo的优缺点</h1>
<h2 id="优点">优点</h2>
<ul>
<li>模块复用性更高：在Monorepo中，所有的模块都在同一个代码库中，这意味着所有的模块可以互相依赖，相互调用，模块复用性更高，避免了重复开发。</li>
<li>代码可维护性更高：Monorepo可以使得所有项目模块在一个仓库中，开发人员可以更加方便的进行代码的维护和修改，同时也可以提高开发效率。</li>
<li>更容易进行代码重构：Monorepo使得整个项目的代码都在一个仓库中，因此进行代码重构时，更加方便。</li>
</ul>
<h2 id="缺点">缺点</h2>
<ul>
<li>代码库体积变大：将所有的项目模块都放在一个代码库中，会导致代码库体积变大，同时代码库的构建时间和编译时间也会相应变长。</li>
<li>部署复杂度增加：在Monorepo中，所有的模块都在同一个代码库中，一旦有代码发生变动，所有的模块都需要重新构建和部署，因此部署复杂度增加。</li>
</ul>
<h1 id="monorepo的应用场景">Monorepo的应用场景</h1>
<ul>
<li>多个项目共用同一组件：如果不使用Monorepo，那么每个项目都需要维护一份组件库，不仅工作量大，而且还容易出现版本管理问题。使用Monorepo可以将所有的组件都放在一个代码库中，避免了重复维护和版本管理问题。</li>
<li>多个项目依赖同一份代码：如果有多个项目依赖同一份代码，那么如果不使用Monorepo，这些项目都需要去维护自己的一份代码库，使用Monorepo可以避免重复维护的问题。</li>
<li>代码拆分成多个模块：如果一个项目的代码越来越复杂，代码行数越来越多，那么可以考虑将代码拆分成多个模块，使用Monorepo可以更加方便的进行代码拆分和管理。</li>
<li>提高代码共享和复用：使用Monorepo可以将代码库中的模块复用在</li>
</ul>
<details>
  <summary>对比表格 (点击展开)</summary>
  <p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">|                     | MultiRepo | MonoRepo   |</span><br><span class="line">| ------------------- | -------------------- | --------------- |</span><br><span class="line">| Pros  |  <span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Enables better tracking of changes and version control.- Allows for independent release cycles for different projects.- Can lead to faster build times as only the necessary code needs to be built.- Reduces the risk of a single point of failure.     |  <span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Easier <span class="strong">**dependency management**</span> as all code is in one repository.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - <span class="strong">**One version of everything**</span> No need to worry about incompatibilities because of projects depending on conflicting versions of third party libraries.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Allows for <span class="strong">**sharing**</span> <span class="strong">**of code**</span> and resources between projects.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Atomic commits across projects Everything works together at every commit. There's no such thing as a breaking change when you fix everything in the same commit.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - <span class="strong">**Simplifies build and release**</span> processes.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Developer mobility Get a consistent way of building and testing applications written using different tools and technologies. Developers can confidently contribute to other teams’ applications and verify that their changes are safe.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Can lead to better <span class="strong">**code consistency**</span> and easier maintenance.- Enables better <span class="strong">**code reuse and refactoring**</span>. Allows for better <span class="strong">**collaboration**</span> between teams.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - <span class="strong">**No overhead to create new projects**</span> Use the existing CI setup, and no need to publish versioned packages if all consumers are in the same repo.    <span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - <span class="strong">**Hard-to-see-affected applications:**</span> Once a developer made an update to a component library, it was hard to see all affected applications company-wide, which usually resulted in breaking features.    <span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - <span class="strong">**Hard mode onboarding:**</span> Newcomers struggled to find related components in these multiple codebases. |</span><br><span class="line">| Cons |  <span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Can be more complex to <span class="strong">**manage dependencies**</span> between different repositories.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - <span class="strong">**Costly cross-repo changes to shared libraries and consumers**</span>       Consider a critical bug or breaking change in a shared library: the developer needs to set up their environment to apply the changes across multiple repositories with disconnected revision histories. Not to speak about the coordination effort of versioning and releasing the packages.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Can make it harder to <span class="strong">**share code and resources**</span> between projects.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - <span class="strong">**Cumbersome code sharing**</span> To share code across repositories, you'd likely create a repository for the shared code. Now you have to set up the tooling and CI environment, add committers to the repo, and set up package publishing so other repos can depend on it. And let's not get started on reconciling incompatible versions of third party libraries across repositories...<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Can lead to <span class="strong">**inconsistencies**</span> in code and maintenance issues.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - <span class="strong">**Inconsistent tooling**</span>       Each project uses its own set of commands for running tests, building, serving, linting, deploying, and so forth. Inconsistency creates mental overhead of remembering which commands to use from project to project.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Can create <span class="strong">**silos**</span> between different <span class="strong">**teams**</span> working on different repositories.<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - <span class="strong">**Significant code duplication**</span> - No one wants to go through the hassle of setting up a shared repo, so teams just write their own implementations of common services and components in each repo. This wastes up-front time, but also increases the burden of maintenance, security, and quality control as the components and services change. |  <span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Can be difficult to set up and maintain.- Can lead to slower build times as the entire repository needs to be rebuilt.- Can make it harder to track changes and version control.- Can create a single point of failure.               |</span><br><span class="line">| Use Cases  |  <span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Large-scale projects with <span class="strong">**multiple independent**</span> projects.- Projects with <span class="strong">**complex dependencies or different release**</span> cycles.- Teams with independent developers working on different codebases.                |  <span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span> - Large-scale enterprise projects with <span class="strong">**multiple interdependent**</span> projects.- Projects with <span class="strong">**shared dependencies**</span> or code.- Teams with multiple developers working on the same codebase.      |</span><br></pre></td></tr></table></figure>
  </p>
</details>
<h2 id="monnorepo-解决了什么问题">MonnoRepo 解决了什么问题</h2>
<h2 id="monnorepo-又引入了什么问题">MonnoRepo 又引入了什么问题</h2>
<h2 id="monnorepo-工具解决了哪些问题">MonnoRepo 工具解决了哪些问题</h2>
<h1 id="monorepo-features">Monorepo features</h1>
<ul>
<li><a href="https://monorepo.tools/#monorepo-features" target="_blank" rel="noopener">Monorepo features</a></li>
</ul>
<h1 id="monorepos-tool-comparison">Monorepos tool comparison</h1>
<p>Compare <a href="https://monorepo.tools/#tools-review" target="_blank" rel="noopener">Bazel (by Google),  Gradle Build Tool (by Gradle, Inc),  Lage (by Microsoft),  Lerna, Nx (by Nrwl), Pants (by the Pants Build community), Rush (by Microsoft), and Turborepo (by Vercel)</a>.</p>
<p>There are so many awesome Monorepo tools, software and architectures.</p>
<p>Some enterprise-level solutions, such as Google’s Bazel and Gradle, have little to do with the front end, and the cost of getting started is relatively high, so we will not discuss them here.</p>
<table>
<thead>
<tr>
<th>Monorepo Solution</th>
<th>Introduction</th>
<th>*<em>company</em> <br> -</th>
<th>URL</th>
<th>Pros</th>
<th>Cons</th>
<th>Pricing</th>
<th>Ease of Use</th>
<th>Scalability</th>
<th>Compatibility</th>
<th>Dependency Management</th>
<th>Task Runner</th>
<th>Version Management</th>
</tr>
</thead>
<tbody>
<tr>
<td>Yarn Workspaces</td>
<td>A package manager for JavaScript that allows you to manage multiple packages within a single monorepo.</td>
<td>Opensource</td>
<td><a href="https://yarnpkg.com/features/workspaces" target="_blank" rel="noopener"><img src="https://yarnpkg.com/favicon-32x32.png?v=775b53071ebde4f6d738805a2d9fcb72" alt>Workspaces</a></td>
<td>Easy to set up and use, with clear documentation and a simple CLI.</td>
<td>Can become slow and unwieldy with a highly complex or deeply nested dependency graph.</td>
<td>Free and open source.</td>
<td>Easy</td>
<td>Medium to Large</td>
<td>Fully compatible with React, TypeScript, and other popular JavaScript frameworks and libraries. Can be used with npm packages as well.</td>
<td>Yes</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td>pnpm</td>
<td><a href="https://pnpm.js.org/en/" title="https://pnpm.js.org/en/" target="_blank" rel="noopener">pnpm</a> is a JavaScript dependency management tool that supports monorepos through a set of dedicated commands called <code>pnpm multi</code>.</td>
<td>Opensource</td>
<td>[<img src="https://pnpm.io/img/favicon.png" alt>Fast, disk space efficient package manager</td>
<td>pnpm](<a href="https://pnpm.io/" target="_blank" rel="noopener">https://pnpm.io/</a>)</td>
<td>Offers fast and efficient package management, with support for multiple registries and package sources.</td>
<td>May not provide the same level of customization or tooling as some other solutions.</td>
<td>Free and open source.</td>
<td>Easy</td>
<td>Medium to Large</td>
<td>Fully compatible with React, TypeScript, and other popular JavaScript frameworks and libraries.</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Lerna</td>
<td><a href="https://lerna.js.org/" title="https://lerna.js.org/" target="_blank" rel="noopener">Lerna</a> is a tool for managing JavaScript projects with multiple packages, built on Yarn.</td>
<td>Opensource <a href="https://github.com/lerna/lerna/issues/3121" title="https://github.com/lerna/lerna/issues/3121" target="_blank" rel="noopener"><strong>recently changed stewardship to Nrwl</strong></a><strong>!</strong></td>
<td><a href="https://github.com/lerna/lerna" target="_blank" rel="noopener"><img src="https://github.com/fluidicon.png" alt>GitHub - lerna/lerna: Lerna is a fast, modern build system for managing and publishing multiple JavaScript/TypeScript packages from the same repository.</a></td>
<td>Offers a wide range of features and customization options. Supports large-scale projects with a highly complex or deeply nested dependency graph.</td>
<td>Can be complex to set up and configure, with a steeper learning curve than some other solutions.</td>
<td>Free and open source.</td>
<td>Medium</td>
<td>Large</td>
<td>Fully compatible with React, TypeScript, and other popular JavaScript frameworks and libraries. Can be used with npm packages as well.</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>Nx</td>
<td><a href="https://nx.dev/" title="https://nx.dev/" target="_blank" rel="noopener">Nx</a> is a build system for TypeScript monorepos and a set of monorepo management tools.</td>
<td>Nrwl</td>
<td><a href="https://nx.dev/" target="_blank" rel="noopener"><img src="https://nx.dev/favicon/favicon-16x16.png" alt>Nx: Smart, Fast and Extensible Build System</a></td>
<td>Offers a comprehensive set of tools and features for managing monorepos, including testing, linting, and deployment. Can be used with a wide range of languages and frameworks.</td>
<td>May require some additional configuration and setup for certain workflows.</td>
<td>Free and open source.</td>
<td>Easy to Medium</td>
<td>Large</td>
<td>Fully compatible with React, TypeScript, and other popular JavaScript frameworks and libraries. Integrates with popular development tools like VS Code, Git, and Docker.</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Turborepo</td>
<td><a href="https://turborepo.org/" title="https://turborepo.org/" target="_blank" rel="noopener">Turborepo</a> is a high-performance build system for JavaScript and TypeScript codebases.</td>
<td>Vercel</td>
<td>[<img src="https://cdn0.dan.com/assets/icons/favicon-8f8be32076803305bd39913d14e9f28567adc474d60a95af6e0d21282302ce6a.ico" alt>turborepo.dev - Domain Name For Sale</td>
<td><a href="http://Dan.com" target="_blank" rel="noopener">Dan.com</a>](<a href="https://turborepo.dev/" target="_blank" rel="noopener">https://turborepo.dev/</a>)</td>
<td>Offers fast and scalable builds, with automatic caching and parallelization. Supports multiple languages and frameworks.</td>
<td>Relatively new and may have some limitations or issues not yet discovered.</td>
<td>Free and open source.</td>
<td>Easy</td>
<td>Large</td>
<td>Fully compatible with React, TypeScript, and other popular JavaScript frameworks and libraries.</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Rush</td>
<td><a href="https://rushstack.io/" title="https://rushstack.io/" target="_blank" rel="noopener">Rush Stack</a> is a family of tools geared towards large scale TypeScript monorepos, and based around the <a href="https://rushjs.io/" title="https://rushjs.io/" target="_blank" rel="noopener">Rush</a> build orchestrator</td>
<td>Microsoft</td>
<td><a href="https://rushjs.io/" target="_blank" rel="noopener"><img src="https://rushjs.io/images/site/favicon.ico" alt>Rush</a></td>
<td>Offers advanced features like incremental builds and parallel testing, with support for multiple package managers and deployment targets.</td>
<td>Can be complex to set up and configure, with a steeper learning curve than some other solutions.</td>
<td>Free and open source.</td>
<td>Medium</td>
<td>Large to Very Large</td>
<td>Fully compatible with React, TypeScript, and other popular JavaScript frameworks and libraries. Can be used with npm packages as well.</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<h1 id="monorepo-技术框架迭代">Monorepo 技术框架迭代</h1>
<p><a href="https://zhuanlan.zhihu.com/p/504554070" target="_blank" rel="noopener">Monorepo 的过去、现在、和未来</a></p>
<h2 id="lerna-yarn-workspace-most-used-before">Lerna + Yarn Workspace (Most used before)</h2>
<h2 id="pnpm-workspace-new-package-management">PNPM Workspace (New package management)</h2>
<h2 id="nx-vs-turborepo-vs-rush-new-monorepo-solution">Nx Vs Turborepo Vs Rush (New monorepo solution)</h2>
<h3 id="what-s-the-problem-with-the-previous-solution">What’s the problem with the previous solution?</h3>
<h3 id="monorepo-framework">Monorepo Framework</h3>
<h3 id="nx-and-turborepo">Nx and Turborepo</h3>
<h1 id="resources">Resources</h1>
<h2 id="monorepo-视频和播客"><a href="https://monorepo.tools/#monorepo-videos-podcasts" target="_blank" rel="noopener">Monorepo 视频和播客</a></h2>
<p>这里收集了一些有关 Monorepo 的视频和播客。</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=6pCBU6QSfEQ" target="_blank" rel="noopener">Using Yarn Workspaces and Lerna with TypeScript Mono-repos</a> - TypeScript 作者之一, Ryan Cavanaugh 在 React Europe 2018 上的演讲，介绍了如何使用 Yarn Workspaces 和 Lerna 来构建 TypeScript monorepo。</li>
<li><a href="https://www.youtube.com/watch?v=SSNrW8EXvR0" target="_blank" rel="noopener">Monorepos: Simplify Your Development Life!</a> - 由 Kent C. Dodds 主持的视频，介绍了使用 Yarn Workspaces 和 Lerna 创建 monorepo 的基础知识。</li>
<li><a href="https://www.youtube.com/watch?v=Ys3hZNJwHzk" target="_blank" rel="noopener">The Benefits of Monorepos for React Native and Web Projects</a> - 由 Callstack 公司的 Eric Vicenti 主持的演讲，讨论了如何使用 monorepo 来改进 React Native 和 Web 项目的开发流程。</li>
<li><a href="https://www.youtube.com/watch?v=7IkUgCLr5oA" target="_blank" rel="noopener">Scaling your Codebase with Nx and Monorepos</a> - Nrwl 公司的 Jeff Cross 主持的演讲，介绍了如何使用 Nx 来扩展 monorepo 项目，并讨论了如何处理大型代码库的挑战。</li>
<li><a href="https://www.youtube.com/watch?v=d0E2KWD4YxE" target="_blank" rel="noopener">Monorepo Patterns for Node.js and TypeScript Applications</a> - Node.js 开发人员 Wes Todd 主持的视频，讲解了如何使用 monorepo 来组织和构建 Node.js 和 TypeScript 应用程序。</li>
<li><a href="https://www.youtube.com/watch?v=1Y-PqBH-htk" target="_blank" rel="noopener">Monorepo Architecture for Frontend Projects</a> - 前端工程师 Karol Wrótniak 主持的演讲，介绍了如何使用 monorepo 构建现代 Web 应用程序，以及如何处理不同项目之间的共享代码和依赖关系。</li>
</ul>
<h2 id="monorepo-articles">Monorepo articles</h2>
<p>Here is a curated list of articles about monorepos that we think will greatly support what you just learned.</p>
<ul>
<li><a href="https://opensource.google/docs/thirdparty/oneversion?utm_source=monorepo.tools" target="_blank" rel="noopener">The One Version Rule – opensource.google</a></li>
<li><a href="https://dev.to/swyx/why-turborepo-will-be-the-first-big-trend-of-2022-4gfj?utm_source=monorepo.tools" target="_blank" rel="noopener">Why TurboRepo Will Be The First Big Trend of 2022</a></li>
<li><a href="https://dev.to/agentender/build-monorepos-not-monoliths-4gbc?utm_source=monorepo.tools" target="_blank" rel="noopener">Build Monorepos, Not Monoliths – dev.to</a></li>
</ul>
<h2 id="monorepos-books"><a href="https://monorepo.tools/#monorepo-books" target="_blank" rel="noopener">Monorepos Books</a></h2>
<ul>
<li><a href="https://f.hubspotusercontent20.net/hubfs/2757427/effective-react-with-nx-2022.pdf" target="_blank" rel="noopener">Effective React Development with Nx</a></li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>React 16 - Error Handling</title>
    <url>/React-16-Error-Handling.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="react-15：">React 15：</h2>
<p>渲染过程中有出错，直接crash整个页面，并且错误信息不明确，可读性差.<br>
一旦某个组件发生错误，整个组件树将会从根节点被unmount下来。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuggyCounter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'I am crash'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(<span class="function">(<span class="params">&#123;counter&#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">      counter: counter + <span class="number">1</span></span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.counter === <span class="number">5</span>) &#123;</span><br><span class="line">      <span class="comment">// Simulate a JS error</span></span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'I crashed!'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>&#123;this.state.counter&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        &lt;b&gt;</span><br><span class="line">          This is an example <span class="keyword">of</span> error boundaries <span class="keyword">in</span> React <span class="number">16.</span></span><br><span class="line">          &lt;br /&gt;<span class="xml"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></span><br><span class="line">          Click on the numbers to increase the counters.</span><br><span class="line">          &lt;br /&gt;</span><br><span class="line">          The counter is programmed to <span class="keyword">throw</span> when it reaches <span class="number">5.</span> This simulates a JavaScript error <span class="keyword">in</span> a component.</span><br><span class="line">        &lt;<span class="regexp">/b&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>p&gt;</span><br><span class="line">      &lt;hr /&gt;</span><br><span class="line">        &lt;p&gt;These two counters are inside the same error boundary. If one crashes, the error boundary will replace both <span class="keyword">of</span> them.&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">        &lt;BuggyCounter /</span>&gt;</span><br><span class="line">      &lt;hr /&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;App /</span>&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="demo地址"><a href="https://codepen.io/anon/pen/ErBjZM?editors=0010" target="_blank" rel="noopener">demo地址</a></h3>
<p>比如上面这个App，可以看到子组件BuggyCounter出了点问题，在没有Error Boundary的时候，整个App都会crash掉，所以显示白屏。</p>
<h2 id="react-16：">React 16：</h2>
<p>React之前没有提供一种合适的处理组件错误的方法，而React16.0中通过Error Boundaries来处理组件内部的错误，从而可以修正错误组件。<br>
用于捕获子组件树的组件异常（即错误边界只可以捕获组件在树中比他低的组件错误。），记录错误并展示一个用Error Boundary提供的内容替代错误组件。</p>
<h3 id="捕获范围：">捕获范围：</h3>
<p>渲染期间<br>
生命周期内<br>
整个组件树构造函数内</p>
<h3 id="如何使用：">如何使用：</h3>
<p>最佳实践：</p>
<ul>
<li>如果一个 class 组件中定义了 static getDerivedStateFromError() 或 componentDidCatch() 这两个生命周期方法中的任意一个（或两个）时，那么它就变成一个错误边界。当抛出错误后，请使用 static getDerivedStateFromError() 渲染备用 UI ，使用 componentDidCatch() 打印错误信息。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> getDerivedStateFromError(error) &#123;</span><br><span class="line">    <span class="comment">// 更新 state 使下一次渲染能够显示降级后的 UI</span></span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidCatch(error, info) &#123;</span><br><span class="line">    <span class="comment">// 你同样可以将错误日志上报给服务器</span></span><br><span class="line">    logErrorToMyService(error, info);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.hasError) &#123;</span><br><span class="line">      <span class="comment">// 你可以自定义降级后的 UI 并渲染</span></span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Something went wrong.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.props.children; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>将ErrorBoundary抽象为一个公用的组件类， 我们可以在容易出错的组件外使用ErrorBoundary将它包裹起来。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;ErrorBoundary&gt;</span><br><span class="line">  &lt;MyWidget /&gt;</span><br><span class="line">&lt;<span class="regexp">/ErrorBoundary&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="componentdidcatch-生命周期函数">componentDidCatch（）生命周期函数</h3>
<p>componentDidCatch是一个新的生命周期函数，当组件有了这个生命周期函数，就成为了一个Error Boundaries。下面我们来看componnetDidCatch()中的参数：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">componentDidCatch(error, info) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>error参数，表示的是被抛出的错误的信息，而info是一个对象包含了组件堆栈中的信息（也就是在发生错误的子组件中层层传递错误信息，到顶层的Error Boundaries，每一层中的组件名）。</p>
<h3 id="component-stack-traces">Component Stack Traces</h3>
<p>下面我们来看组件堆栈轨迹，我们假设这样一个结构：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;App&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">      &lt;ErrorBoundary&gt;</span><br><span class="line">        &lt;Child&gt;&lt;<span class="regexp">/Child&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>ErrorBoundary&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>App&gt;</span><br></pre></td></tr></table></figure>
<p>如果在Child组件中发生了js错误，那么堆栈的报错信息应该如下：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">the error is located at :</span><br><span class="line">     <span class="keyword">in</span> Child  (created by App)</span><br><span class="line">     <span class="keyword">in</span> ErrorBoundary(created by App)</span><br><span class="line">     <span class="keyword">in</span> div (created by App)</span><br><span class="line">     <span class="keyword">in</span> App</span><br></pre></td></tr></table></figure>
<p>如果需要报错信息显示错误组件所在的具体的行数和位置，可以使用babel-plugin-transform-react-jsx-source插件。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 先定一个组件ErrorBoundary</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">error</span>: <span class="literal">null</span>, <span class="attr">errorInfo</span>: <span class="literal">null</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  componentDidCatch(error, errorInfo) &#123;</span><br><span class="line">    <span class="comment">// Catch errors in any components below and re-render with error message</span></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      error: error,</span><br><span class="line">      errorInfo: errorInfo</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// You can also log error messages to an error reporting service here</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// 有错误的时候展示回退</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.errorInfo) &#123;</span><br><span class="line">      <span class="comment">// Error path</span></span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;h2&gt;Something went wrong.&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">          &lt;details style=&#123;&#123; whiteSpace: 'pre-wrap' &#125;&#125;&gt;</span></span><br><span class="line"><span class="regexp">            &#123;this.state.error &amp;&amp; this.state.error.toString()&#125;</span></span><br><span class="line"><span class="regexp">            &lt;br /</span>&gt;</span><br><span class="line">            &#123;<span class="keyword">this</span>.state.errorInfo.componentStack&#125;</span><br><span class="line">          &lt;<span class="regexp">/details&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 正常的话，直接展示组件</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.props.children;</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuggyCounter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'I am crash'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(<span class="function">(<span class="params">&#123;counter&#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">      counter: counter + <span class="number">1</span></span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.counter === <span class="number">5</span>) &#123;</span><br><span class="line">      <span class="comment">// Simulate a JS error</span></span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'I crashed!'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>&#123;this.state.counter&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        &lt;b&gt;</span><br><span class="line">          This is an example <span class="keyword">of</span> error boundaries <span class="keyword">in</span> React <span class="number">16.</span></span><br><span class="line">          &lt;br /&gt;<span class="xml"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></span><br><span class="line">          Click on the numbers to increase the counters.</span><br><span class="line">          &lt;br /&gt;</span><br><span class="line">          The counter is programmed to <span class="keyword">throw</span> when it reaches <span class="number">5.</span> This simulates a JavaScript error <span class="keyword">in</span> a component.</span><br><span class="line">        &lt;<span class="regexp">/b&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>p&gt;</span><br><span class="line">      &lt;hr /&gt;</span><br><span class="line">        &lt;ErrorBoundary&gt;</span><br><span class="line">        &lt;p&gt;These two counters are inside the same error boundary. If one crashes, the error boundary will replace both <span class="keyword">of</span> them.&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">        &lt;BuggyCounter /</span>&gt;</span><br><span class="line">        &lt;<span class="regexp">/ErrorBoundary&gt;</span></span><br><span class="line"><span class="regexp">      &lt;hr /</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;App /</span>&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="demo地址-v2"><a href="https://codepen.io/gaearon/pen/wqvxGa?editors=0010" target="_blank" rel="noopener">demo地址</a></h3>
<p>可以看到加上Error Boundary之后，除了出错的组件，其他的地方都不受影响。</p>
<p>而且它很清晰的告诉我们是哪个组件发生了错误。</p>
<h3 id="注意事项：">注意事项：</h3>
<p>Error Boundary无法捕获下面的错误：</p>
<ol>
<li>事件函数里的错误</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">error</span>: <span class="literal">null</span> &#125;;</span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// Do something that could throw</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123; error &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.error) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Caught an error.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>Click Me<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的例子中，handleClick方法里面发生的错误，Error Boundary是捕获不到的。因为它不发生在渲染阶段，所以采用try/catch来捕获。</p>
<ol start="2">
<li>异步代码（例如setTimeout 或 requestAnimationFrame 回调函数）</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">     render() &#123;</span><br><span class="line">        <span class="comment">// 此错误无法被捕获，渲染时组件正常返回 `&lt;div&gt;&lt;/div&gt;`</span></span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'error'</span>)</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>服务端渲染</li>
</ol>
<p>因为服务器渲染不支持Error Boundary</p>
<ol start="4">
<li>Error Boundary自身抛出来的错误 （而不是其子组件）</li>
</ol>
<h3 id="错误边界放在哪里">错误边界放在哪里?</h3>
<p>一般来说，有两个地方：</p>
<ol>
<li>
<p>可以放在顶层，告诉用户有东西出错。但是我个人不建议这样，这感觉失去了错误边界的意义。因为有一个组件出错了，其他正常的也没办法正常显示了</p>
</li>
<li>
<p>包在子组件外面，保护其他应用不崩溃。</p>
</li>
</ol>
<h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://react.docschina.org/docs/error-boundaries.html" target="_blank" rel="noopener">官网文档中文版</a></li>
<li><a href="https://reactjs.org/blog/2017/07/26/error-handling-in-react-16.html" target="_blank" rel="noopener">React Error Handling in React 16</a></li>
<li><a href="https://my.oschina.net/u/2332658/blog/3019283" target="_blank" rel="noopener">React16新特性</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/57544233" target="_blank" rel="noopener">React 16 新特性全解（上）</a></li>
<li><a href="https://blog.csdn.net/liwusen/article/details/78521006" target="_blank" rel="noopener">React 16.0中的新特性——Error Boundaries及其注意点</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>React</category>
      </categories>
      <tags>
        <tag>React 16</tag>
      </tags>
  </entry>
  <entry>
    <title>React 16 - Portal</title>
    <url>/React-16-Portal.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>转<a href="https://zhuanlan.zhihu.com/p/29880992" target="_blank" rel="noopener">传送门：React Portal</a>， 在这个基础上做了小的修改。</p>
<p>似乎所有说React Portal都直接用Portal这个单词，没听过这词的朋友可能觉得不知所云，其实，Portal可以有一个很形象的翻译——“传送门”。</p>
<h2 id="什么是传送门？">什么是传送门？</h2>
<p>曾经有一款游戏就叫做Portal，玩家手上一杆很厉害很科幻的枪，朝墙上开一枪，就可以开出两个“传送门”，人钻进这个传送门，可以从另一个传送门里走出来，也就是说，两个不同位置的传送门之间形成了对接。</p>
<p><img src="https://pic4.zhimg.com/80/v2-a650d2d42e0ed880c4413340ec961a27_hd.jpg" alt="传送门"></p>
<p>如果还不明白Portal是啥，那就拿范冰冰在《X战警：逆转未来》所演角色的GIF动图来看吧。<br>
<img src="https://pic1.zhimg.com/v2-89a003124def7b845832f3789ba8c4e8_b.jpg" alt="《X战警：逆转未来》"></p>
<p>你看一个哨兵机器人扑过来攻击一个X战警，范冰冰从一个传送门里神速穿越而来，顺手又甩出两个传送门，让哨兵机器人扑进了一个传送门，从另一个传送门一个踉跄掉了出来，从而救了那个X战警。</p>
<p>现在明白Portal是怎么回事了吧。</p>
<h2 id="为什么react需要传送门？">为什么React需要传送门？</h2>
<p>React Portal之所以叫Portal，因为做的就是和“传送门”一样的事情：<strong>render到一个组件里面去，实际改变的是网页上另一处的DOM结构</strong>。</p>
<p>在React的世界中，一切都是组件，用组件可以表示一切界面中发生的逻辑，不过，有些特例处理起来还比较麻烦，比如，某个组件在渲染时，在某种条件下需要显示一个对话框(Dialog)，这该怎么做呢？</p>
<p>最直观的做法，就是直接在JSX中把Dialog画出来，像下面代码的样子。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"foo"</span>&gt;</span><br><span class="line">   &lt;div&gt; ... &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">   &#123; needDialog ? &lt;Dialog /</span>&gt; : <span class="literal">null</span> &#125;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<p>问题是，我们写一个Dialog组件，就这么渲染的话，Dialog最终渲染产生的HTML就存在于上面JSX产生的HTML一起了，类似下面这样。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"foo"</span>&gt;</span><br><span class="line">   &lt;div&gt; ... &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">   &lt;div class="dialog"&gt;Dialog Content&lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<p>可是问题来了，对于对话框，从用户感知角度，应该是一个独立的组件，通常应该显示在屏幕的最中间，现在Dialog被包在其他组件中，要用CSS的position属性控制Dialog位置，就要求从Dialog往上一直到body没有其他postion是relative的元素干扰，这……有点难为作为通用组件的Dialog，毕竟，谁管得住所有组件不用position呢。</p>
<p>还有一点，Dialog的样式，因为包在其他元素中，各种样式纠缠，CSS样式太容易搞成一坨浆糊了。</p>
<h3 id="when-to-use-react传送门？-liyuankun-增加">When to use React传送门？【liyuankun 增加】</h3>
<p>当父组件样式有 overflow: hidden 或者 z-index，但是你需要子组件看起来“break out”它所在的container. 例如dialogs, hover cards 和 tool-tips.</p>
<h3 id="react-16-之前怎么实现传送门？">React 16 之前怎么实现传送门？</h3>
<p>看样子这样搞局限很多啊，行不通，有没有其他办法？</p>
<h4 id="通过redux或者其他通讯方式">通过Redux或者其他通讯方式</h4>
<p>有一个其他办法，就是在React组件树的最顶层留一个元素专属于Dialog，然后通过Redux或者其他什么通讯方式给这个Dialog发送信号，让Dialog显示或者不显示。<br>
<img src="https://pic1.zhimg.com/80/v2-4022e89a8d7a22461e426cf6c653e18c_hd.jpg" alt="Dialog"><br>
这种方法看起来还凑合着，但是，就这点事还要动用Redux有点高射炮打蚊子，而且，要控制两个不用位置的组件，好麻烦。</p>
<p>而且，如果我们把Dialog做成一个通用组件，希望里面的内容完全定制，这招就更加麻烦了。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"foo"</span>&gt;</span><br><span class="line">  &lt;div&gt; ... &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  &#123; needDialog ? </span></span><br><span class="line"><span class="regexp">    &lt;Dialog&gt; </span></span><br><span class="line"><span class="regexp">       &lt;header&gt;Any Header&lt;/</span>header&gt;</span><br><span class="line">       &lt;section&gt;Any content&lt;<span class="regexp">/section&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>Dialog&gt;</span><br><span class="line">    : <span class="literal">null</span> &#125;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<p>像上面那样，我们既希望在组件的JSX中选择使用Dialog，把Dialog用得像一个普通组件一样，但是又希望Dialog内容显示在另一个地方，就需要Portal上场了。</p>
<p>Portal就是建立一个“传送门”，让Dialog这样的组件在表示层和其他组件没有任何差异，但是渲染的东西却像经过传送门一样出现在另一个地方。</p>
<h4 id="react-15-api">React 15 API</h4>
<p>React在v16之前的传送门实现方法<br>
在v16之前，实现“传送门”，要用到两个秘而不宣的React API</p>
<ul>
<li>unstable_renderSubtreeIntoContainer</li>
<li>unmountComponentAtNode</li>
</ul>
<p>第一个unstable_renderSubtreeIntoContainer，都带上前缀unstable了，就知道并不鼓励使用，但是没办法啊，不用也得用，还好React一直没有deprecate这个API，一直挺到v16直接支持portal。这个API的作用就是建立“传送门”，可以把JSX代表的组件结构塞到传送门里面去，让他们在传送门的另一端渲染出来。</p>
<p>第二个unmountComponentAtNode用来清理第一个API的副作用，通常在unmount的时候调用，不调用的话会造成资源泄露的。</p>
<p>一个通用的Dialog组件的实现差不多是这样，注意看renderPortal中的注释。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;unstable_renderSubtreeIntoContainer, unmountComponentAtNode&#125; </span><br><span class="line">  <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dialog</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">const</span> doc = <span class="built_in">window</span>.document;</span><br><span class="line">    <span class="keyword">this</span>.node = doc.createElement(<span class="string">'div'</span>);</span><br><span class="line">    doc.body.appendChild(<span class="keyword">this</span>.node);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.renderPortal(<span class="keyword">this</span>.props);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    <span class="keyword">this</span>.renderPortal(<span class="keyword">this</span>.props);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    unmountComponentAtNode(<span class="keyword">this</span>.node);</span><br><span class="line">    <span class="built_in">window</span>.document.body.removeChild(<span class="keyword">this</span>.node);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  renderPortal(props) &#123;</span><br><span class="line">    unstable_renderSubtreeIntoContainer(</span><br><span class="line">      <span class="keyword">this</span>, <span class="comment">//代表当前组件</span></span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"dialog"</span>&gt;</span><br><span class="line">        &#123;props.children&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;, /</span><span class="regexp">/ 塞进传送门的JSX</span></span><br><span class="line"><span class="regexp">      this.node /</span><span class="regexp">/ 传送门另一端的DOM node</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>首先，render函数不要返回有意义的JSX，也就说说这个组件通过正常生命周期什么都不画，要是画了，那画出来的HTML/DOM就直接出现在使用Dialog的位置了，这不是我们想要的。</p>
<p>在componentDidMount里面，利用原生API来在body上创建一个div，这个div的样式绝对不会被其他元素的样式干扰。</p>
<p>然后，无论componentDidMount还是componentDidUpdate，都调用一个renderPortal来往“传送门”里塞东西。</p>
<p>总结，这个Dialog组件做得事情是这样：</p>
<ol>
<li>它什么都不给自己画，render返回一个null就够了；</li>
<li>它做得事情是通过调用renderPortal把要画的东西画在DOM树上另一个角落。</li>
</ol>
<p>在renderPortal中，利用unstable_renderSubtreeIntoContainer函数往直前创建的div里塞JSX，这里我们用的JSX是这样。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"dialog"</span>&gt;</span><br><span class="line">     &#123;props.children&#125;</span><br><span class="line"> &lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<p>因为是吧children画出来，所以使用Dialog可以加上任意的子组件。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;Dialog&gt;</span><br><span class="line">     What ever shit</span><br><span class="line">     &lt;div&gt;Hello&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">     &lt;p&gt;World&lt;/</span>p&gt;</span><br><span class="line"> &lt;<span class="regexp">/Dialog&gt;</span></span><br></pre></td></tr></table></figure>
<p>你看，所谓React Portal，就是能够表面上渲染在一个地方，实际上渲染到了另一个地方。<br>
<img src="https://pic4.zhimg.com/80/v2-60771cc0b94e780ca29bdd72f2761d57_hd.jpg" alt="Portal"></p>
<p>是不是感觉好厉害，不光好厉害，而且像Dialog这样的场景Portal简直就是必不可少。</p>
<p>到了v16，React干脆直接支持Portal，当然，v15还将被使用一段时间，所以大家看了上面的内容也不算浪费时间:-)</p>
<h2 id="react-v16的portal支持">React v16的Portal支持</h2>
<p>在v16中，使用Portal创建Dialog组件简单多了，不需要牵扯到componentDidMount、componentDidUpdate，也不用调用API清理Portal，关键代码在render中，像下面这样就行。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;createPortal&#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dialog</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">super</span>(...arguments);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> doc = <span class="built_in">window</span>.document;</span><br><span class="line">    <span class="keyword">this</span>.node = doc.createElement(<span class="string">'div'</span>);</span><br><span class="line">    doc.body.appendChild(<span class="keyword">this</span>.node);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> createPortal(</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"dialog"</span>&gt;</span><br><span class="line">        &#123;<span class="keyword">this</span>.props.children&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;, /</span><span class="regexp">/塞进传送门的JSX</span></span><br><span class="line"><span class="regexp">      this.node /</span><span class="regexp">/传送门的另一端DOM node</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  componentWillUnmount() &#123;</span></span><br><span class="line"><span class="regexp">    window.document.body.removeChild(this.node);</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>v16提供createPortal函数来创建“传送门”，我个人觉得这个函数应该叫renderPortal好一些，因为组件的render函数除了mount时会被调用，update时也会被调用，update时还叫createPortal有点不大合适。</p>
<h2 id="穿越portal的事件冒泡">穿越Portal的事件冒泡</h2>
<p>v16之前的React Portal实现方法，有一个小小的缺陷，就是Portal是单向的，内容通过Portal传到另一个出口，在那个出口DOM上发生的事件是不会冒泡传送回进入那一端的。</p>
<p>也就是说，这样的代码。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;div onClick=&#123;onDialogClick&#125;&gt;   </span><br><span class="line">   &lt;Dialog&gt;</span><br><span class="line">     What ever shit</span><br><span class="line">   &lt;<span class="regexp">/Dialog&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<p>在Dialog画出的内容上点击，onDialogClick是不会被触发的。</p>
<p>当然，这只是一个小小的缺陷，大部分场景下事件不传过来也没什么大问题。</p>
<p>在v16中，通过Portal渲染出去的DOM，事件是会冒泡从传送门的入口端冒出来的，上面的onDialogClick也就会被调用到了。</p>
<h3 id="why事件冒泡可以到react-parent-liyuankun-增加">why事件冒泡可以到react parent 【liyuankun 增加】</h3>
<p>可以看这个例子：<a href="https://codepen.io/catherineliyuankun/pen/oNvpxKv" target="_blank" rel="noopener">Dialog 嵌套 Dialog demo</a></p>
<p>从真实的DOM结构上来看，Dialog组件中的onClick事件不应该被</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span>Here contain Dialog:<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>组件捕获。<br>
但从虚拟DOM的结构上来看，Dialog却是&quot;container&quot;组件的子节点，事件冒泡是遵循虚拟DOM的.</p>
<p>真实的DOM结构:<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/React-16-Portal/Real%20Dom%201.png" alt="真实的DOM结构1"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/React-16-Portal/Real%20Dom%202.png" alt="真实的DOM结构2"></p>
<p>虚拟DOM的结构:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;div onClick=&#123;onDialogClick&#125;&gt;</span><br><span class="line">  &lt;div className=<span class="string">"container"</span>&gt;</span><br><span class="line">    Here contain Dialog:</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  &lt;Dialog onClick=&#123;onDialog1Click&#125;&gt;</span></span><br><span class="line"><span class="regexp">     &lt;div&gt;Dialog 1&lt;/</span>div&gt;</span><br><span class="line">      &lt;Dialog onClick=&#123;onDialog2Click&#125;&gt;</span><br><span class="line">        &lt;div&gt;Dialog <span class="number">2</span> Inside Dialog <span class="number">1</span> &lt;<span class="regexp">/div&gt;    </span></span><br><span class="line"><span class="regexp">      &lt;/</span>Dialog&gt;</span><br><span class="line">  &lt;<span class="regexp">/Dialog&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<h2 id="总结">总结</h2>
<p>React v16直接支持Portal，是因为Portal这个功能真的是必不可少，不然对话框这样的场景都没法应付。</p>
<h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://react.docschina.org/docs/portals.html" target="_blank" rel="noopener">官网文档中文版</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/29880992" target="_blank" rel="noopener">传送门：React Portal</a></li>
<li><a href="https://www.beautifulcode.co/blog/46-understanding-portals-in-react" target="_blank" rel="noopener">Understanding Portals in React</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>React</category>
      </categories>
      <tags>
        <tag>React 16</tag>
      </tags>
  </entry>
  <entry>
    <title>React 对比函数组件和类组件</title>
    <url>/React-%E5%AF%B9%E6%AF%94%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6%E5%92%8C%E7%B1%BB%E7%BB%84%E4%BB%B6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="rendering-jsx">Rendering JSX</h2>
<p>首先，它们的明显区别在于语法。正如它们的名字一样，功能组件只是一个返回 JSX 的普通 JavaScript 函数。类组件是一个扩展了 React.Component 的 JavaScript 类，它有一个 render 方法。有点困惑？让我们来看一个简单的例子。<br>
功能组件是一个返回 JSX 的函数。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> FunctionalComponent = <span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// arrow functions</span></span><br><span class="line"> <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FunctionalComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在定义类组件时，必须创建一个扩展了 <code>React.Component</code> 的类。要渲染的 JSX 将在 render 方法中返回。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line"> render() &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="passing-props">Passing props</h2>
<p>传递props可能会让人感到困惑，让我们来看看类和功能组件中是如何编写props的。假设我们像下面这样传递名称为 &quot;propsA &quot;的props。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;Component name=<span class="string">"propsA"</span> /&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> FunctionalComponent = <span class="function">(<span class="params">&#123; name &#125;</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>在功能组件中，我们将props作为函数的参数传递。请注意，我们在这里使用了destructuring。或者，我们也可以不使用destructuring。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> FunctionalComponent = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>既然它是一个类，就需要用它来引用props。当然，在使用基于类的组件时，我们可以使用destructuring来获取props内部的名称。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; name &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123; name &#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="handling-state">Handling state</h2>
<h3 id="counter-using-class-components">Counter using Class Components</h3>
<p>这是用 ReactJS 构建的大多数现代网络应用的基础。这些组件是简单的类（由为应用程序添加功能的多个函数组成）。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">"react"</span>; </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123; </span><br><span class="line">    <span class="keyword">constructor</span>() &#123; </span><br><span class="line">        <span class="keyword">super</span>(); </span><br><span class="line">        <span class="keyword">this</span>.state = &#123; </span><br><span class="line">            count: <span class="number">0</span> </span><br><span class="line">        &#125;; </span><br><span class="line">        <span class="keyword">this</span>.increase = <span class="keyword">this</span>.increase.bind(<span class="keyword">this</span>); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    increase() &#123; </span><br><span class="line">        <span class="keyword">this</span>.setState(&#123; <span class="attr">count</span>: <span class="keyword">this</span>.state.count + <span class="number">1</span> &#125;); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    render() &#123; </span><br><span class="line">        <span class="keyword">return</span> ( </span><br><span class="line">            &lt;div style=&#123;&#123; <span class="attr">margin</span>: <span class="string">'50px'</span> &#125;&#125;&gt; </span><br><span class="line">                &lt;h1&gt;Welcome to Geeks <span class="keyword">for</span> Geeks &lt;<span class="regexp">/h1&gt; </span></span><br><span class="line"><span class="regexp">                &lt;h3&gt;Counter App using Class Component : &lt;/</span>h3&gt; </span><br><span class="line">                &lt;h2&gt; &#123;<span class="keyword">this</span>.state.count&#125;&lt;<span class="regexp">/h2&gt; </span></span><br><span class="line"><span class="regexp">                &lt;button onClick=&#123;this.increase&#125;&gt; Add&lt;/</span>button&gt; </span><br><span class="line">            &lt;<span class="regexp">/div&gt; </span></span><br><span class="line"><span class="regexp">        ) </span></span><br><span class="line"><span class="regexp">    &#125; </span></span><br><span class="line"><span class="regexp">&#125; </span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default ClassComponent;</span></span><br></pre></td></tr></table></figure>
<h3 id="counter-using-functional-components">Counter using Functional Components</h3>
<p>功能组件是在 React 中工作时会遇到的一些更常见的组件。它们只是 JavaScript 函数。我们可以通过编写 JavaScript 函数为 React 创建一个功能组件。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">"react"</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> FunctionalComponent = <span class="function"><span class="params">()</span> =&gt;</span> &#123; </span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>); </span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> increase = <span class="function"><span class="params">()</span> =&gt;</span> &#123; </span><br><span class="line">        setCount(count + <span class="number">1</span>); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ( </span><br><span class="line">        &lt;div style=&#123;&#123; <span class="attr">margin</span>: <span class="string">'50px'</span> &#125;&#125;&gt; </span><br><span class="line">            &lt;h1&gt;Welcome to Geeks <span class="keyword">for</span> Geeks &lt;<span class="regexp">/h1&gt; </span></span><br><span class="line"><span class="regexp">            &lt;h3&gt;Counter App using Functional Component : &lt;/</span>h3&gt; </span><br><span class="line">            &lt;h2&gt;&#123;count&#125;&lt;<span class="regexp">/h2&gt; </span></span><br><span class="line"><span class="regexp">            &lt;button onClick=&#123;increase&#125;&gt;Add&lt;/</span>button&gt; </span><br><span class="line">        &lt;<span class="regexp">/div&gt; </span></span><br><span class="line"><span class="regexp">    ) </span></span><br><span class="line"><span class="regexp">&#125; </span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default FunctionalComponent;</span></span><br></pre></td></tr></table></figure>
<p>对于功能组件，我们使用hooks（useState）来管理状态。如果编写了一个功能组件，并意识到需要为其添加一些状态，以前必须将其转换为类组件。现在，可以在现有的函数组件中使用hooks来管理状态，而无需将其转换为类组件。hooks是 React 16.8 新增的功能。它们让无需编写类即可使用状态和其他 React 功能。我们可以在功能组件中使用hooks来代替类，因为这是一种更简单的状态管理方式。</p>
<ul>
<li>hooks只能用于功能组件，不能用于类内组件!</li>
<li>hooks 详细介绍可以看之前的文章： <a href="./React-16-Hooks.html">hooks</a></li>
</ul>
<h2 id="lifecycle-methods">Lifecycle Methods</h2>
<p>最后，让我们来谈谈生命周期。生命周期在渲染的时间安排上起着重要作用。对于那些从类组件迁移到功能组件的人来说，一定很想知道有什么可以替代类组件中的 <code>componentDidMount()</code> 等生命周期方法。没错，有一个hook可以完美地实现这一目的，让我们一起来看看吧！</p>
<h3 id="on-mounting-componentdidmount">On Mounting (componentDidMount)</h3>
<p>生命周期方法 <code>componentDidMount</code> 会在第一次render完成后立即调用。以前有一个 componentWillMount 会在第一次render之前调用，但它被认为是传统方法，不建议在较新版本的 React 中使用。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> FunctionalComponent = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"> React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"Hello"</span>);</span><br><span class="line"> &#125;, []); <span class="comment">// [] 作为依赖数组，与componentDidMount等效，会在第一次render完成后立即调用</span></span><br><span class="line"> <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>取代 <code>componentDidMount</code>，我们使用第二个参数为 <code>[]</code> 的 <code>useEffect</code> hook。 <code>useState</code> hook的第二个参数通常是一个包含变化状态的数组，而 <code>useEffect</code> 只会在这些选定的变化中被调用。但如果是像本例这样的空数组，则会在挂载时调用一次。这可以完美替代 <code>componentDidMount</code>。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"> componentDidMount() &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"Hello"</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> render() &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里发生的事情基本上是一样的：<code>componentDidMount</code> 是一个生命周期方法，在第一次render后会被调用一次。</p>
<h3 id="on-unmounting-componentwillunmount">On Unmounting (componentWillUnmount)</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"> componentWillUnmount() &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"Bye"</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> render() &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Bye, World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> FunctionalComponent = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"> React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;       <span class="comment">// 返回一个函数</span></span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">"Bye"</span>);</span><br><span class="line">   &#125;;</span><br><span class="line"> &#125;, []);</span><br><span class="line"> <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Bye, World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>好消息是，我们也可以使用 <code>useState</code> 钩子来卸载。但要注意，语法有些不同。你需要做的是在 <code>useEffect</code> 函数中返回一个在卸载时运行的<code>函数</code>。这在需要清理订阅（如 <code>clearInterval</code> 函数）时尤其有用，否则会在较大的项目中造成严重的内存泄漏。使用 useEffect 的一个好处是，我们可以在同一个地方编写挂载和卸载函数。例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Function to be called when the component mounts</span></span><br><span class="line">  <span class="keyword">const</span> handleEvent = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Event occurred:'</span>, event);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 挂载 Add event listener when the component mounts</span></span><br><span class="line">  <span class="built_in">window</span>.addEventListener(<span class="string">'yourEventType'</span>, handleEvent);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 卸载 Clean up the event listener when the component unmounts</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">'yourEventType'</span>, handleEvent);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, []); <span class="comment">// Empty dependency array means this effect runs only once (on mount)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// custom hook</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useDelayedRender = <span class="function">(<span class="params">delayTime: number</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [shouldRender, setShouldRender] = useState(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> timeoutId = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 挂载 </span></span><br><span class="line">      setShouldRender(<span class="literal">true</span>)</span><br><span class="line">    &#125;, delayTime)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearTimeout(timeoutId) <span class="comment">// 卸载</span></span><br><span class="line">  &#125;, [delayTime])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> shouldRender</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Function to be called at intervals</span></span><br><span class="line">  <span class="keyword">const</span> updateValue = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    setValue(<span class="function">(<span class="params">prevValue</span>) =&gt;</span> prevValue + <span class="number">1</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 挂载 Set an interval when the component mounts</span></span><br><span class="line">  <span class="keyword">const</span> intervalId = setInterval(updateValue, <span class="number">1000</span>); <span class="comment">// Replace 1000 with your desired interval in milliseconds</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Clean up the interval when the component unmounts</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    clearInterval(intervalId); <span class="comment">// 卸载</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, []); <span class="comment">// Empty dependency array means this effect runs only once (on mount)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="对比函数组件和类组件总结">对比函数组件和类组件总结</h2>
<table>
<thead>
<tr>
<th><a href="https://www.geeksforgeeks.org/reactjs-functional-components/" target="_blank" rel="noopener"><strong>Functional Components</strong></a></th>
<th><a href="https://www.geeksforgeeks.org/reactjs-class-based-components/" target="_blank" rel="noopener"><strong>Class Components</strong></a></th>
</tr>
</thead>
<tbody>
<tr>
<td>功能组件只是一个纯 JavaScript pure函数，它接受props作为参数，并返回一个 React 元素（JSX）。</td>
<td>类组件要求您从 React.Component 扩展（extend），并创建返回 React 元素的render函数。并创建一个返回 React 元素的render函数。</td>
</tr>
<tr>
<td>no <code>render</code> method</td>
<td>必须有<code>render()</code> method 返回 JSX (语法上类似于HTML)</td>
</tr>
<tr>
<td>功能组件从上到下依次运行，一旦功能返回，它就无法继续存活。Functional components run from top to bottom and once the function is returned it can’t be kept alive.</td>
<td>类组件被实例化后，不同的生命周期方法会保持活力，并根据类组件所处的阶段运行和调用。 The class component is instantiated and different life cycle method is kept alive and is run and invoked depending on the phase of the class component.</td>
</tr>
<tr>
<td>也被称为无状态组件，因为它们只是接受数据并以某种形式显示出来，主要负责渲染用户界面。Also known as Stateless components as they simply accept data and display them in some form, they are mainly responsible for rendering UI.</td>
<td>也被称为有状态组件，因为它们实现了逻辑和状态。Also known as Stateful components because they implement logic and state.</td>
</tr>
<tr>
<td>功能组件中不能使用 React 生命周期方法（例如 componentDidMount）。React lifecycle methods (for example, componentDidMount) cannot be used in functional components.</td>
<td>React 生命周期方法可用于类组件内部（例如 componentDidMount）。React lifecycle methods can be used inside class components (for example, componentDidMount).</td>
</tr>
<tr>
<td>Hooks可以很容易地用于功能组件，使其成为有状态的组件。Hooks can be easily used in functional components to make them Stateful. <br>Example:<br><code>const [name,SetName]= React.useState(' ')</code></td>
<td>在类组件中实现hook需要不同的语法。It requires different syntax inside a class component to implement hooks.<br>Example:<br><code>constructor(props) {  super(props);  this.state = {name: ' '}</code></td>
</tr>
<tr>
<td>不使用构造函数。Constructors are not used.</td>
<td>使用构造函数，因为它需要存储状态。Constructor is used as it needs to store state.</td>
</tr>
</tbody>
</table>
<h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://www.geeksforgeeks.org/differences-between-functional-components-and-class-components/" target="_blank" rel="noopener">Differences between Functional Components and Class Components</a></li>
<li><a href="https://www.twilio.com/blog/react-choose-functional-components" target="_blank" rel="noopener">Understanding Functional Components vs. Class Components in React</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>React</category>
      </categories>
      <tags>
        <tag>React 16</tag>
      </tags>
  </entry>
  <entry>
    <title>VSCode-快捷键</title>
    <url>/VSCode-%E5%BF%AB%E6%8D%B7%E9%94%AE.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="1-工作区快捷键">1、工作区快捷键</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Mac 快捷键</th>
<th style="text-align:left">Win 快捷键</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Cmd + Shift + P</strong></td>
<td style="text-align:left"><strong>Ctrl + Shift + P</strong>，F1</td>
<td style="text-align:left">显示命令面板</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><strong>Cmd + B</strong></td>
<td style="text-align:left"><strong>Ctrl + B</strong></td>
<td style="text-align:left">显示/隐藏侧边栏</td>
<td style="text-align:left">很实用</td>
</tr>
<tr>
<td style="text-align:left"><code>Cmd + \</code> | <code>Ctrl + \</code></td>
<td style="text-align:left"><strong>拆分为多个编辑器</strong></td>
<td style="text-align:left">【重要】抄代码利器</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><strong>Cmd + 1、2</strong></td>
<td style="text-align:left"><strong>Ctrl + 1、2</strong></td>
<td style="text-align:left">聚焦到第 1、第 2 个编辑器</td>
<td style="text-align:left">同上重要</td>
</tr>
<tr>
<td style="text-align:left"><strong>Cmd + +、Cmd + -</strong></td>
<td style="text-align:left"><strong>ctrl + +、ctrl + -</strong></td>
<td style="text-align:left">将工作区放大/缩小（包括代码字体、左侧导航栏）</td>
<td style="text-align:left">在投影仪场景经常用到</td>
</tr>
<tr>
<td style="text-align:left">Cmd + J</td>
<td style="text-align:left">Ctrl + J</td>
<td style="text-align:left">显示/隐藏控制台</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><strong>Cmd + Shift + N</strong></td>
<td style="text-align:left"><strong>Ctrl + Shift + N</strong></td>
<td style="text-align:left">重新开一个软件的窗口</td>
<td style="text-align:left">很常用</td>
</tr>
<tr>
<td style="text-align:left">Cmd + Shift + W</td>
<td style="text-align:left">Ctrl + Shift + W</td>
<td style="text-align:left">关闭软件的当前窗口</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Cmd + N</td>
<td style="text-align:left">Ctrl + N</td>
<td style="text-align:left">新建文件</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Cmd + W</td>
<td style="text-align:left">Ctrl + W</td>
<td style="text-align:left">关闭当前文件</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<h3 id="2-跳转操作">2、跳转操作</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Mac 快捷键</th>
<th style="text-align:left">Win 快捷键</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Cmd + `</td>
<td style="text-align:left">没有</td>
<td style="text-align:left">在同一个软件的<strong>多个工作区</strong>之间切换</td>
<td style="text-align:left">使用很频繁</td>
</tr>
<tr>
<td style="text-align:left"><strong>Cmd + Option + 左右方向键</strong></td>
<td style="text-align:left">Ctrl + Pagedown/Pageup</td>
<td style="text-align:left">在已经打开的<strong>多个文件</strong>之间进行切换</td>
<td style="text-align:left">非常实用</td>
</tr>
<tr>
<td style="text-align:left">Ctrl + Tab</td>
<td style="text-align:left">Ctrl + Tab</td>
<td style="text-align:left">在已经打开的多个文件之间进行跳转</td>
<td style="text-align:left">不如上面的快捷键快</td>
</tr>
<tr>
<td style="text-align:left">Cmd + Shift + O</td>
<td style="text-align:left">Ctrl + shift + O</td>
<td style="text-align:left">在当前文件的各种<strong>方法之间</strong>（符号：Symbol）进行跳转</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Cmd + T</td>
<td style="text-align:left">Ctrl + T</td>
<td style="text-align:left">在当前<strong>工作区</strong>的各种方法之间（符号：Symbol）进行跳转</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Ctrl + G</td>
<td style="text-align:left">Ctrl + G</td>
<td style="text-align:left">跳转到指定行</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><code>Cmd+Shift+\</code> | <code>Ctrl+Shift+\</code></td>
<td style="text-align:left">跳转到匹配的括号</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<h3 id="3-移动光标">3、移动光标</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Mac 快捷键</th>
<th style="text-align:left">Win 快捷键</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">方向键</td>
<td style="text-align:left">方向键</td>
<td style="text-align:left">在<strong>单个字符</strong>之间移动光标</td>
<td style="text-align:left">大家都知道</td>
</tr>
<tr>
<td style="text-align:left"><strong>option + 左右方向键</strong></td>
<td style="text-align:left"><strong>Ctrl + 左右方向键</strong></td>
<td style="text-align:left">在<strong>单词</strong>之间移动光标</td>
<td style="text-align:left">很常用</td>
</tr>
<tr>
<td style="text-align:left"><strong>Cmd + 左右方向键</strong></td>
<td style="text-align:left"><strong>Fn + 左右方向键</strong>（或 Win + 左右方向键）</td>
<td style="text-align:left">将光标定位到当前行的最左侧、最右侧（在<strong>整行</strong>之间移动光标）</td>
<td style="text-align:left">很常用</td>
</tr>
<tr>
<td style="text-align:left"><strong>Option + Alt + 左右方向键</strong></td>
<td style="text-align:left"><strong>Alt + Shift + 左右方向键</strong></td>
<td style="text-align:left">左右扩大/缩小选中的范围</td>
<td style="text-align:left">很酷，极为高效</td>
</tr>
<tr>
<td style="text-align:left">Cmd + ↑</td>
<td style="text-align:left">Ctrl + Home</td>
<td style="text-align:left">将光标定位到文件的第一行</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Cmd + ↓</td>
<td style="text-align:left">Ctrl + End</td>
<td style="text-align:left">将光标定位到文件的最后一行</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Cmd + Shift + \</td>
<td style="text-align:left"></td>
<td style="text-align:left">在<strong>代码块</strong>之间移动光标</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<h3 id="4-编辑操作">4、编辑操作</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Mac 快捷键</th>
<th style="text-align:left">Win 快捷键</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Cmd + C</td>
<td style="text-align:left">Ctrl + C</td>
<td style="text-align:left">复制</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Cmd + X</td>
<td style="text-align:left">Ctrl + X</td>
<td style="text-align:left">剪切</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Cmd + V</td>
<td style="text-align:left">Ctrl + V</td>
<td style="text-align:left">粘贴</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><strong>Cmd + Enter</strong></td>
<td style="text-align:left"><strong>Ctrl + Enter</strong></td>
<td style="text-align:left">在当前行的下方新增一行，然后跳至该行</td>
<td style="text-align:left">即使光标不在行尾，也能快速向下插入一行</td>
</tr>
<tr>
<td style="text-align:left">Cmd+Shift+Enter</td>
<td style="text-align:left">Ctrl+Shift+Enter</td>
<td style="text-align:left">在当前行的上方新增一行，然后跳至该行</td>
<td style="text-align:left">即使光标不在行尾，也能快速向上插入一行</td>
</tr>
<tr>
<td style="text-align:left"><strong>Option + ↑</strong></td>
<td style="text-align:left"><strong>Alt + ↑</strong></td>
<td style="text-align:left">将代码向上移动</td>
<td style="text-align:left">很常用</td>
</tr>
<tr>
<td style="text-align:left"><strong>Option + ↓</strong></td>
<td style="text-align:left"><strong>Alt + ↓</strong></td>
<td style="text-align:left">将代码向下移动</td>
<td style="text-align:left">很常用</td>
</tr>
<tr>
<td style="text-align:left">Option + Shift + ↑</td>
<td style="text-align:left">Alt + Shift + ↑</td>
<td style="text-align:left">将代码向上复制一行</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><strong>Option + Shift + ↓</strong></td>
<td style="text-align:left"><strong>Alt + Shift + ↓</strong></td>
<td style="text-align:left">将代码向下复制一行</td>
<td style="text-align:left">写重复代码的利器</td>
</tr>
</tbody>
</table>
<p>另外再补充一点：将光标点击到某一行的任意位置时，默认就已经是<strong>选中全行</strong>了，此时可以直接<strong>复制</strong>或<strong>剪切</strong>，无需点击鼠标。这个非常实用，是所有的编辑操作中，使用得最频繁的。它可以有以下使用场景：</p>
<ul>
<li>场景1：假设光标现在处于第5行的<strong>任意位置</strong>，那么，直接依次按下 <code>Cmd + C</code> 和 <code>Cmd + V</code>，就会把这行代码复制到第6行。继续按 <code>Cmd + C</code> 和 <code>Cmd + V</code>，就会把这行代码复制到第7行。copy代码so easy。</li>
<li>场景2：假设光标现在处于第5行，那么，先按下 <code>Cmd + C</code>，然后按两下<code>↑</code> 方向键，此时光标处于第3行；紧接着，继续按下<code>Cmd + V</code>，就会把刚刚那行代码复制到第3行，原本处于第3行的代码会整体<strong>下移</strong>。</li>
</ul>
<p>你看到了没？上面的两个场景，我全程没有使用鼠标，只通过简单的复制粘贴和方向键，就做到了如此迅速的copy代码。你说是不是很高效？</p>
<h3 id="5-删除操作">5、删除操作</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Mac 快捷键</th>
<th style="text-align:left">Win 快捷键</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Cmd + shift + K</td>
<td style="text-align:left">Ctrl + Shift + K</td>
<td style="text-align:left">删除整行</td>
<td style="text-align:left">「Cmd + X」的作用是剪切，但也可以删除整行</td>
</tr>
<tr>
<td style="text-align:left"><strong>option + Backspace</strong></td>
<td style="text-align:left"><strong>Ctrl + Backspace</strong></td>
<td style="text-align:left">删除光标之前的一个单词</td>
<td style="text-align:left">英文有效，很常用</td>
</tr>
<tr>
<td style="text-align:left">option + delete</td>
<td style="text-align:left">Ctrl + delete</td>
<td style="text-align:left">删除光标之后的一个单词</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><strong>Cmd + Backspace</strong></td>
<td style="text-align:left"></td>
<td style="text-align:left">删除光标之前的整行内容</td>
<td style="text-align:left">很常用</td>
</tr>
<tr>
<td style="text-align:left">Cmd + delete</td>
<td style="text-align:left"></td>
<td style="text-align:left">删除光标之后的整行内容</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<p>备注：上面所讲到的移动光标、编辑操作、删除操作的快捷键，在其他编辑器里，大部分都适用。</p>
<h3 id="6-多光标选择-多光标编辑">6、多光标选择/多光标编辑</h3>
<p>多光标选择在编程的<strong>提效</strong>方面可谓立下了汗马功劳。因为比较难记住，所以你要时不时回来复习这一段。</p>
<table>
<thead>
<tr>
<th>Mac 快捷键</th>
<th>Win 快捷键</th>
<th>作用</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Option + 鼠标连续点击任意位置</strong></td>
<td><strong>Alt + 鼠标连续点击任意位置</strong></td>
<td>在任意位置，同时出现多个光标</td>
<td>很容易记住</td>
</tr>
<tr>
<td>Cmd + D</td>
<td>Ctrl + D</td>
<td>将光标放在某个单词的位置（或者先选中某个单词），然后反复按下「 <strong>Cmd + D</strong> 」键， 即可将下一个相同的词逐一加入选择。</td>
<td>较常用</td>
</tr>
<tr>
<td><strong>Cmd + Shift + L</strong></td>
<td><strong>Ctrl + Shift + L</strong></td>
<td>将光标放在某个单词的位置（或者先选中某个单词），然后按下快捷键，则所有的相同内容处，都会出现光标。</td>
<td>很常用。比如变量重命名的时候，就经常用到</td>
</tr>
</tbody>
</table>
<h3 id="7-多列选择-多列编辑">7、多列选择/多列编辑</h3>
<p>多列选择是更高效的多光标选择，所以单独列成一小段。</p>
<table>
<thead>
<tr>
<th>Mac 快捷键</th>
<th>Win 快捷键</th>
<th>作用</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cmd + Option + 上下键</td>
<td>Ctrl + Alt + 上下键</td>
<td>在连续的多列上，同时出现多个光标</td>
<td>较常用</td>
</tr>
<tr>
<td>Option + Shift + 鼠标拖动</td>
<td>Alt + Shift + 鼠标拖动</td>
<td>按住快捷键，然后把鼠标从区域的左上角拖至右下角，即可在选中区域的每一行末尾，出现光标。</td>
<td>很神奇的操作，较常用</td>
</tr>
<tr>
<td><strong>Option + Shift + i</strong></td>
<td><strong>Alt + Shift + I</strong></td>
<td>选中一堆文本后，按下快捷键，既可在<strong>每一行的末尾</strong>都出现一个光标。</td>
<td>很常用</td>
</tr>
</tbody>
</table>
<h3 id="8-编程语言相关">8、编程语言相关</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Mac 快捷键</th>
<th style="text-align:left">Win 快捷键</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Cmd + /</td>
<td style="text-align:left">Ctrl + /</td>
<td style="text-align:left">添加单行注释</td>
<td style="text-align:left">很常用</td>
</tr>
<tr>
<td style="text-align:left"><strong>Option + Shift + F</strong></td>
<td style="text-align:left">Alt + shift + F</td>
<td style="text-align:left">代码格式化</td>
<td style="text-align:left">很常用</td>
</tr>
<tr>
<td style="text-align:left">F2</td>
<td style="text-align:left">F2</td>
<td style="text-align:left">以重构的方式进行<strong>重命名</strong></td>
<td style="text-align:left">改代码备</td>
</tr>
<tr>
<td style="text-align:left">Ctrl + J</td>
<td style="text-align:left"></td>
<td style="text-align:left">将多行代码合并为一行</td>
<td style="text-align:left">Win 用户可在命令面板搜索”合并行“</td>
</tr>
<tr>
<td style="text-align:left">Cmd +</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Cmd + U</td>
<td style="text-align:left">Ctrl + U</td>
<td style="text-align:left">将光标的移动回退到上一个位置</td>
<td style="text-align:left">撤销光标的移动和选择</td>
</tr>
</tbody>
</table>
<h3 id="9-搜索相关">9、搜索相关</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Mac 快捷键</th>
<th style="text-align:left">Win 快捷键</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Cmd + Shift + F</strong></td>
<td style="text-align:left"><strong>Ctrl + Shift +F</strong></td>
<td style="text-align:left">全局搜索代码</td>
<td style="text-align:left">很常用</td>
</tr>
<tr>
<td style="text-align:left"><strong>Cmd + P</strong></td>
<td style="text-align:left"><strong>Ctrl + P</strong></td>
<td style="text-align:left">在当前的项目工程里，<strong>全局</strong>搜索文件名</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Cmd + F</td>
<td style="text-align:left">Ctrl + F</td>
<td style="text-align:left">在当前文件中搜索代码，光标在搜索框里</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><strong>Cmd + G</strong></td>
<td style="text-align:left"><strong>F3</strong></td>
<td style="text-align:left">在当前文件中搜索代码，光标仍停留在编辑器里</td>
<td style="text-align:left">很巧妙</td>
</tr>
</tbody>
</table>
<h3 id="10-自定义快捷键">10、自定义快捷键</h3>
<p>按住快捷键「Cmd + Shift + P」，弹出命令面板，在命令面板中输入“快捷键”，可以进入快捷键的设置。</p>
<p>当然，你也可以选择菜单栏「偏好设置 -&gt; 键盘快捷方式」，进入快捷键的设置：</p>
<p><img src="http://img.smyhvae.com/20190329_2120.png" alt></p>
<h3 id="11-快捷键列表">11、快捷键列表</h3>
<p>你可以点击 VS Code 左下角的齿轮按钮，效果如下：</p>
<p><img src="http://img.smyhvae.com/20190418_1738.png" alt></p>
<p>上图中，在展开的菜单中选择「键盘快捷方式」，就可以查看和修改所有的快捷键列表了：</p>
<p><img src="http://img.smyhvae.com/20190418_1739_2.png" alt></p>
<h3 id="快捷键参考表-官方">快捷键参考表（官方）</h3>
<p>VS Code官网提供了 PDF版本的键盘快捷键参考表，转需：</p>
<ul>
<li>Windows版本：<a href="https://code.visualstudio.com/shortcuts/keyboard-shortcuts-windows.pdf" target="_blank" rel="noopener">https://code.visualstudio.com/shortcuts/keyboard-shortcuts-windows.pdf</a></li>
<li>Mac 版本：<a href="https://code.visualstudio.com/shortcuts/keyboard-shortcuts-macos.pdf" target="_blank" rel="noopener">https://code.visualstudio.com/shortcuts/keyboard-shortcuts-macos.pdf</a></li>
<li>Linux版本：<a href="https://code.visualstudio.com/shortcuts/keyboard-shortcuts-linux.pdf" target="_blank" rel="noopener">https://code.visualstudio.com/shortcuts/keyboard-shortcuts-linux.pdf</a></li>
</ul>
<p>我们在 VS  Code软件里通过菜单栏「帮助-&gt;键盘快捷方式参考」也可以打开相应平台的快捷键大全（PDF版本）。</p>
<h1 id="参考文章">参考文章</h1>
<ul>
<li><a href="https://github.com/qianguyihao/Web/blob/master/00-%E5%89%8D%E7%AB%AF%E5%B7%A5%E5%85%B7/01-VS%20Code%E7%9A%84%E4%BD%BF%E7%94%A8.md#%E4%BA%8C%E5%B4%AD%E9%9C%B2%E9%94%8B%E8%8A%92vs-code-%E5%BF%AB%E6%8D%B7%E9%94%AE" target="_blank" rel="noopener">崭露锋芒：VS Code 快捷键</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/44044896" target="_blank" rel="noopener">VSCode的常用快捷键</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>VSCode</tag>
      </tags>
  </entry>
  <entry>
    <title>Vim操作&amp;配置</title>
    <url>/Vim%E6%93%8D%E4%BD%9C-%E9%85%8D%E7%BD%AE.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="vim基本操作">Vim基本操作</h1>
<p>参考文章：</p>
<ul>
<li><a href="https://killercoda.com/vim" target="_blank" rel="noopener">https://killercoda.com/vim</a> 在线课程，直接操作，互动好，强推！</li>
<li><a href="https://www.runoob.com/w3cnote/all-vim-cheatsheat.html" target="_blank" rel="noopener">史上最全Vim快捷键键位图（入门到进阶）</a></li>
</ul>
<h2 id="最常用的操作">最常用的操作</h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>功能</th>
<th>Mode</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:u0</code></td>
<td>reset first to undo all changes</td>
<td></td>
</tr>
<tr>
<td><code>u</code></td>
<td>undo</td>
<td>normal mode</td>
</tr>
<tr>
<td>w</td>
<td>move forward one word (next alphanumeric word)</td>
<td></td>
</tr>
<tr>
<td>5w</td>
<td>move forward five words</td>
<td></td>
</tr>
<tr>
<td>b</td>
<td>move backward one word (previous alphanumeric word)</td>
<td></td>
</tr>
<tr>
<td>5b</td>
<td>move backward five</td>
<td></td>
</tr>
<tr>
<td><code>shift+6 (^)</code></td>
<td>移动到行头</td>
<td>C2</td>
</tr>
<tr>
<td><code>shift+4 ($)</code></td>
<td>移动到行尾</td>
<td>C3</td>
</tr>
<tr>
<td><code>数字+shift+g</code></td>
<td>移动到目标行，数字为行号</td>
<td></td>
</tr>
<tr>
<td><code>:30</code></td>
<td>normal mode</td>
<td>Type <code>:30</code> to jump to line 30</td>
</tr>
<tr>
<td>gg</td>
<td>到文件头部</td>
<td></td>
</tr>
<tr>
<td>G</td>
<td>到文件尾部</td>
<td></td>
</tr>
<tr>
<td>dd</td>
<td>删除当前行</td>
<td></td>
</tr>
<tr>
<td><code>[n]d</code> + <code>Enter</code></td>
<td>删除n+1行，<code>2d</code>然后<code>Enter</code>, 删除当前行在内之后的3行。</td>
<td></td>
</tr>
<tr>
<td><code>[n]dd</code> + <code>Enter</code></td>
<td>Cut n行，<code>2d</code>然后<code>Enter</code>, 删除当前行在内之后的2行。</td>
<td></td>
</tr>
<tr>
<td>yy or Y</td>
<td>复制整行文本。</td>
<td></td>
</tr>
<tr>
<td>3yy</td>
<td>复制3整行文本。</td>
<td></td>
</tr>
<tr>
<td><code>yw</code></td>
<td>Copy to the start of next word</td>
<td></td>
</tr>
<tr>
<td>p</td>
<td>在光标之后粘贴。</td>
<td></td>
</tr>
<tr>
<td>P</td>
<td>在光标之前粘贴。</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="mode">Mode</h2>
<table>
<thead>
<tr>
<th>Mode</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Normal</td>
<td>Default mode for navigation and manipulation of text and it can always be activated by pressing <code>Esc</code></td>
</tr>
<tr>
<td>Insert</td>
<td>Used for inserting/manipulating the text by using all keyboard keys. Not any Normal mode commands is active in this mode</td>
</tr>
<tr>
<td>Visual</td>
<td>Used for navigation and manipulation of text selections. Allows the use of most Normal mode commands on selected text</td>
</tr>
</tbody>
</table>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b386e6926dad4a8aa52e77ee9bd98ebb~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt="mode transfer"></p>
<h2 id="insert-mode">Insert mode</h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
<th>Mode</th>
</tr>
</thead>
<tbody>
<tr>
<td>i</td>
<td>进入insert-mode</td>
<td></td>
</tr>
<tr>
<td><code>o</code></td>
<td>Insert new line <strong>below</strong> the current line</td>
<td>进入insert-mode</td>
</tr>
<tr>
<td><code>O</code></td>
<td>Insert new line <strong>above</strong> the current line</td>
<td>进入insert-mode</td>
</tr>
<tr>
<td><code>a</code></td>
<td>Append <strong>after cursor</strong></td>
<td>进入insert-mode</td>
</tr>
<tr>
<td><code>A</code></td>
<td>Append at <strong>end of line</strong></td>
<td>进入insert-mode</td>
</tr>
<tr>
<td><code>s</code></td>
<td>Delete the character cursor is <strong>currently on</strong></td>
<td>进入insert-mode</td>
</tr>
<tr>
<td><code>C</code></td>
<td>Delete all <strong>after cursor position</strong></td>
<td>进入insert-mode</td>
</tr>
</tbody>
</table>
<h2 id="普通模式">普通模式</h2>
<table>
<thead>
<tr>
<th>Press Keyboard</th>
<th>Mode</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Esc</td>
<td>返回normal mode</td>
<td>normal mode is default mode</td>
</tr>
<tr>
<td><code>:x</code></td>
<td>command-mode</td>
<td>save and quit</td>
</tr>
<tr>
<td><code>:wq</code></td>
<td>command-mode</td>
<td>same as <code>:x</code></td>
</tr>
<tr>
<td><code>:q</code></td>
<td>command-mode</td>
<td>quit</td>
</tr>
<tr>
<td><code>:q!</code></td>
<td>command-mode</td>
<td>force quit</td>
</tr>
<tr>
<td><code>:set number</code></td>
<td>command-mode</td>
<td>to show the line numbers</td>
</tr>
<tr>
<td><code>:30</code></td>
<td>normal mode</td>
<td>Type <code>:30</code> to jump to line 30 You can move to a line by just entering the line number in normal mode</td>
</tr>
<tr>
<td><code>:goto 700</code></td>
<td>normal mode</td>
<td>jump directly to a character in a file. Type <code>:goto</code> 700 to jump to 第700个character</td>
</tr>
</tbody>
</table>
<h3 id="search">search</h3>
<table>
<thead>
<tr>
<th>Press Keyboard</th>
<th>Mode</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/</code></td>
<td>search forward</td>
<td>type <code>/search string</code> and press <code>enter</code>. Press <code>n</code> to jump to the next occurrence or <code>N</code> to jump to the previous occurrence</td>
</tr>
<tr>
<td><code>/\&lt;searchword\&gt;</code></td>
<td>search forward</td>
<td>search the whole word，here is “is”. 例如文件里&quot;list is&quot;的<code>list</code>不会match，只有<code>is</code>会被搜索到。</td>
</tr>
<tr>
<td><code>/searchword</code></td>
<td></td>
<td>Vim allows us to start a search for the current word that the cursor is pointing. 搜索光标所在的单词。Type <code>/li</code> and press <code>Enter</code> Now, press <code>*</code> (asterisk) to search the entire word which is line in our case. You can also press <code>#</code> (hash) to search backwards</td>
</tr>
<tr>
<td><code>?</code></td>
<td>search backward</td>
<td></td>
</tr>
<tr>
<td><code>:s/old/new</code></td>
<td>用new替换当前行第一个old。</td>
<td></td>
</tr>
<tr>
<td><code>:s/old/new/i</code></td>
<td>忽略大小写，Ignore Case。用new替换当前行第一个old。</td>
<td></td>
</tr>
<tr>
<td><code>:s/old/new/g</code></td>
<td>用new替换当前行所有的old。</td>
<td></td>
</tr>
<tr>
<td><code>:%s/old/new/g</code></td>
<td>用new替换文件中所有的old。</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="search-ignore-case">Search Ignore Case</h4>
<p>By default search is case-insensitive. It is possible to ignore case in a search by adding \c to the end of your search string</p>
<p>Type <code>/</code> to enable search mode and type <code>this</code></p>
<p>It won’t return any results</p>
<p>Type <code>/</code> again and type <code>this\c</code> this time and notice that search finds string <code>This</code> which has a capital letter</p>
<p>You can also ignore case indefinitely for the current session</p>
<p>Type <code>:set ignorecase</code> or <code>:set ic</code></p>
<p>To revert it back, Type <code>:set noignorecase</code> or <code>:set noic</code></p>
<p>To make it default for vim, you need to add it to <code>~/.vimrc</code> file</p>
<p>Press <code>Esc</code> and type <code>:q!</code> to quit without saving</p>
<h3 id="navigate">navigate</h3>
<table>
<thead>
<tr>
<th>navigate in a file Shortcut Key</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>enter <code>]]</code> or <code>G</code></td>
<td>To get to the last line</td>
</tr>
<tr>
<td>enter <code>[[</code> or <code>gg</code></td>
<td>To get to the first line</td>
</tr>
<tr>
<td>$</td>
<td>moves the cursor to the end of the line</td>
</tr>
<tr>
<td>^</td>
<td>moves the cursor to the first non-empty character of the line</td>
</tr>
<tr>
<td>w</td>
<td>move forward one word (next alphanumeric word)</td>
</tr>
<tr>
<td>W</td>
<td>move forward one word (delimited by a white space)</td>
</tr>
<tr>
<td>5w</td>
<td>move forward five words</td>
</tr>
<tr>
<td>b</td>
<td>move backward one word (previous alphanumeric word)</td>
</tr>
<tr>
<td>B</td>
<td>move backward one word (delimited by a white space)</td>
</tr>
<tr>
<td>5b</td>
<td>move backward five words</td>
</tr>
<tr>
<td>Ctrl + f</td>
<td>moves the cursor one page down</td>
</tr>
<tr>
<td>Ctrl + b</td>
<td>moves the cursor one page up</td>
</tr>
<tr>
<td>h</td>
<td>moves the cursor one character to the left</td>
</tr>
<tr>
<td>j or Ctrl + J</td>
<td>moves the cursor down one line</td>
</tr>
<tr>
<td>k or Ctrl + P</td>
<td>moves the cursor up one line</td>
</tr>
<tr>
<td>l</td>
<td>moves the cursor one character to the right</td>
</tr>
<tr>
<td>0</td>
<td>moves the cursor to the beginning of the line</td>
</tr>
</tbody>
</table>
<h3 id="delete">Delete</h3>
<p>Type 3d and press Enter to delete the first 4 lines. Notice that deleting is a 0 indexed operation with d command so try with 1d and notice that it will remove 2 lines below</p>
<p>Type D to remove the content of the line but not the line itself</p>
<h4 id="delete-all-lines-in-vim">Delete all lines in Vim</h4>
<p>Type <code>gg</code> to get to first line<br>
Type <code>dG</code> to clear the file completely</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dd</td>
<td>删除当前行</td>
</tr>
<tr>
<td><code>[n]d</code> + <code>Enter</code></td>
<td>删除n+1行，<code>2d</code>然后<code>Enter</code>, 删除当前行在内之后的3行。deleting is a 0 indexed operation with d command so try with 1d and notice that it will remove 2 lines below</td>
</tr>
<tr>
<td><code>d&lt;left-arrow&gt;</code></td>
<td>Delete current and left character</td>
</tr>
<tr>
<td><code>d&lt;right-arrow&gt;</code></td>
<td>Delete current and right character</td>
</tr>
<tr>
<td><code>d&lt;up-arrow&gt;</code></td>
<td>Delete current and upper line</td>
</tr>
<tr>
<td><code>d&lt;down-arrow&gt;</code></td>
<td>Delete current and bottom line</td>
</tr>
<tr>
<td><code>d$</code></td>
<td>Delete from current position to end of line</td>
</tr>
<tr>
<td><code>d^</code></td>
<td>Delete from current backward to first character</td>
</tr>
<tr>
<td><code>dO</code></td>
<td>Delete from current backward to beginning of line</td>
</tr>
<tr>
<td><code>dw</code></td>
<td>Delete current to end of current word</td>
</tr>
<tr>
<td><code>db</code></td>
<td>Delete current to beginning of current word</td>
</tr>
</tbody>
</table>
<h3 id="copy-cut-paste">Copy, Cut &amp; Paste</h3>
<p>ress Esc and type yy to copy the line (y is short for yank)</p>
<p>Type :2 to jump to line 2 and type p to paste the content to line 3</p>
<p>Repeat the operation by pressing dd to cut a line and p to paste the content</p>
<p>Type :u0 to undo all changes since opening to reset</p>
<p>Type :4 and get to line 4 and type 3yy to copy the current and next 2 lines</p>
<p>Type gg to get to the top and type P to paste these 3 lines before the cursor</p>
<p>Replace 3yy with 3dd to cut instead of copy and reply the operation if you wish</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>y$</code></td>
<td>Copy all from current to end of line</td>
</tr>
<tr>
<td><code>y^</code></td>
<td>Copy all from current to start of line</td>
</tr>
<tr>
<td><code>yw</code></td>
<td>Copy to the start of next word</td>
</tr>
<tr>
<td><code>yiw</code></td>
<td>Copy the current word</td>
</tr>
</tbody>
</table>
<h2 id="advanced">Advanced</h2>
<h3 id="多行缩进">多行缩进</h3>
<p>To indent multiple lines using <code>vim</code> you should set the shiftwidth using <code>:set shiftwidth=2</code>.<br>
Then mark multiple lines using <code>Shift v</code> and the <code>up/down</code> keys.<br>
To then indent the marked lines press <code>Shift</code> + <code>&gt;</code> or <code>&lt;</code> and to repeat the action press <code>.</code></p>
<h3 id="comment-out-multiple-lines">Comment out multiple lines</h3>
<p>You’ll often need to comment/uncomment multiple lines in a config file. You can perform this operation conveniently in Visual mode<br>
Type <code>gg</code> to get to top and press <code>Shift + V</code> to activate Visual mode in block mode and notice that all text in the current line is selected</p>
<p>Type <code>2j</code> or use <code>down-arrow</code> key to select the first 3 lines</p>
<p>Type <code>:s/^/#</code> to replace the first character with <code>#</code></p>
<h3 id="sorting">Sorting</h3>
<p>Make a reset first to undo all changes by typing <code>:u0</code></p>
<p>Make sure you are on top or type <code>gg</code> to get to the beginning of file</p>
<p>Press <code>Shift + V</code> to activate Visual mode in block mode</p>
<p>Press <code>G</code> to select all text</p>
<p>Type <code>:sort ui</code> and notice that the text is sorted</p>
<h2 id="other">other</h2>
<p>光标移动：<br>
+或Enter: 把光标移至下一行第一个非空白字符。<br>
-: 把光标移至上一行第一个非空白字符。<br>
w: 前移一个单词，光标停在下一个单词开头；<br>
W: 移动下一个单词开头，但忽略一些标点；<br>
e: 前移一个单词，光标停在下一个单词末尾；<br>
E: 移动到下一个单词末尾，如果词尾有标点，则移动到标点；<br>
b: 后移一个单词，光标停在上一个单词开头；<br>
B: 移动到上一个单词开头，忽略一些标点；</p>
<p>剪切和复制</p>
<p>[n]x: 剪切光标右边n个字符，相当于d[n]l。<br>
[n]X: 剪切光标左边n个字符，相当于d[n]h。<br>
y: 复制在可视模式下选中的文本。<br>
yy or Y: 复制整行文本。<br>
y[n]w: 复制一(n)个词。<br>
y[n]l: 复制光标右边1(n)个字符。<br>
y[n]h: 复制光标左边1(n)个字符。<br>
y$: 从光标当前位置复制到行尾。<br>
y0: 从光标当前位置复制到行首。<br>
:m,ny<cr> 复制m行到n行的内容。<br>
y1G或ygg: 复制光标以上的所有行。<br>
yG: 复制光标以下的所有行。<br>
d: 删除（剪切）在可视模式下选中的文本。<br>
d$ or D: 删除（剪切）当前位置到行尾的内容。<br>
d[n]w: 删除（剪切）1(n)个单词<br>
d[n]l: 删除（剪切）光标右边1(n)个字符。<br>
d[n]h: 删除（剪切）光标左边1(n)个字符。<br>
d0: 删除（剪切）当前位置到行首的内容<br>
p: 在光标之后粘贴。<br>
P: 在光标之前粘贴。</cr></p>
<p>查找和替换</p>
<p>/something: 在后面的文本中查找something。<br>
?something: 在前面的文本中查找something。<br>
n: 向后查找下一个。<br>
N: 向前查找下一个。<br>
<code>:s/old/new</code> - 用new替换当前行第一个old。<br>
<code>:s/old/new/g</code> - 用new替换当前行所有的old。<br>
<code>:%s/old/new/g</code> - 用new替换文件中所有的old。</p>
<h2 id="vim配置入门"><a href="https://www.ruanyifeng.com/blog/2018/09/vimrc.html" target="_blank" rel="noopener">Vim配置入门</a></h2>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://www.ruanyifeng.com/blog/2018/09/vimrc.html" target="_blank" rel="noopener">Vim 配置入门 - 阮一峰</a></li>
<li><a href="https://juejin.cn/post/7155688792093884423" target="_blank" rel="noopener">Linux 基础篇-VIM编辑器</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Linux/bash</category>
      </categories>
      <tags>
        <tag>Command line</tag>
      </tags>
  </entry>
  <entry>
    <title>[中国人在波兰疫情日记5]欧洲歪果同事work from home一周吐槽-张文宏教你身处欧洲应怎样防护-波兰确诊536/5例</title>
    <url>/%5B%E4%B8%AD%E5%9B%BD%E4%BA%BA%E5%9C%A8%E6%B3%A2%E5%85%B0%E7%96%AB%E6%83%85%E6%97%A5%E8%AE%B05%5D%E6%AC%A7%E6%B4%B2%E6%AD%AA%E6%9E%9C%E5%90%8C%E4%BA%8Bwork-from-home%E4%B8%80%E5%91%A8%E5%90%90%E6%A7%BD-%E6%B3%A2%E5%85%B0%E7%A1%AE%E8%AF%8A536%E6%AD%BB%E4%BA%A15%E4%BE%8B.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>这篇我开始出视频版的啦！还不太会剪辑视频，所以很粗糙，大家凑合喽。</p>
<p>B站也投稿了：“岚坤爷”。</p>
<p>发现我不经意间说了好多次“下面”和“然后”。</p>
<p>哎，你们忍忍吧</p>
<p>毕竟第一次配音做视频。</p>
<hr>
<h1 id="开篇">开篇</h1>
<p>中国疫情稍有好转，但新型冠状病毒感染的肺炎疫情开始全球开花，韩国、日本、伊朗。欧洲区域，意大利，西班牙，法国, 德国。。。颇有星星之火可以燎原之势。</p>
<p>我现在都懒得看</p>
<p>各国确诊排名了，</p>
<p>我直接看从上海入境中国</p>
<p>疫情重点国家和地区名单：</p>
<p>3月17日</p>
<p>韩国、意大利、伊朗、日本、法国、西班牙、德国、美国、英国、瑞士、瑞典、比利时、挪威、荷兰、丹麦、奥地利等16个国家。</p>
<p>3月20日</p>
<p>上海在原有16个重点国家基础上，新增澳大利亚、马来西亚、希腊、捷克、芬兰、卡塔尔、加拿大、沙特阿拉伯等8国作为疫情防控的重点国家。</p>
<p>恰巧我去年9月底从国内来波兰华沙出差半年，就顺便记录下这这个特殊时期在波兰我身边大家的观点和反应。本篇是这个系列的第5篇。</p>
<p>正好所在公司在中国，波兰和美国都有研发中心，三个地区我也都有认识的同事可以了解情况。</p>
<p>波兰这边技术组的同事，来自欧洲各国。我认识的有<strong>波兰人，土耳其人，乌克兰人，意大利人，墨西哥人，西班牙人，立陶宛人，塔吉克斯坦人，美国人，中国人</strong>，也方便了解欧洲疫情形势。（写出来才发现，组里的国籍好多啊。）</p>
<p>也可以横向对比下同一家公司在三个不同区域<strong>亚洲，欧洲和北美洲</strong>，根据当地政府政策所采取的不同措施。</p>
<p>本文既不全面也不专业，既不严肃也不造谣，仅仅是记录下身边的人和事，记录在这个特殊时段的感受。</p>
<h1 id="公司三地措施对比">公司三地措施对比</h1>
<p>继公司大佬CFO和CTO在3月12日 duangduangduang 发了邮件后。</p>
<p>CEO在3月16日和18日也发了对于COVID-19的相关邮件，（过程是曲折的，结果还不错，这里不便讨论，你懂得…）。18日的邮件确认了work-from-home 的政策，鼓励员工远程办公（办公室仍然开放，自愿原则），这项政策持续到4月3日，之后政策会再次更新。并且给了2天可以自由支配的假期。</p>
<p>中国的研发中心在杭州，完全按照当地政府政策要求。措施很全面，同上篇文章，没有明显变化。不过因为国内已经度过疫情严重期并全面复工，中国研发中心的员工仍需办公室办公。至于能不能享有那2天假期，我还不太清楚。</p>
<p>美国研发中心和波兰的政策基本一致，可在家办公，可享有2日假期。</p>
<p>波兰的研发中心，HR已经发邮件确认，可以享有那2天假期，并且这2天假期是带薪假期。从这周一（3月16日）开始大多数人开始“在家办公”。我们组全员work from home。极少数人去办公室办公，大概一层最多7、8个（我自己从周一还一步都没出过门，哈哈，听同事说的办公室情况）。听同事说的另一个比较好的消息是，超市现在补货很快，货架都是满的（起码早上的时候还是），所以不用担心物资食物短缺的问题。</p>
<p>空荡的办公室</p>
<p>来谈谈这第一周work from home自己的感受，以及歪果同事的感受。</p>
<p>我们小组里包括波兰人，土耳其人，乌克兰人，墨西哥人，西班牙人，塔吉克斯坦人，中国人-我。其实我们小组才十几个人，却包含了这么多国籍。</p>
<p>技术大组还包括立陶宛人，塔吉克斯坦人，美国人，德国人…</p>
<p>以前是每天早上有一个站会（Daily Scrum meeting），现在在每日下午4点又加了一个短会，来汇报当日进展。并且Scrum master会收集每个人当日进展的文字版（每个人几句话简单总结当日进展，相当于“日报”）。</p>
<p>我首先的感受是，租的公寓里没有额外的显示屏幕，只能依赖笔记本的屏幕。作为程序员，不能多屏是稍微影响点工作效率。偶然用IPad屏幕帮忙下。</p>
<p>和别人交流的话，是没有在办公室面对面方便，更难直观的说明一件事。</p>
<p>但也有很多好处，比如可以中午在家吃饭，不过增加了做饭的时间成本。</p>
<p>有些同事可以照顾孩子。</p>
<p>回顾会议（Retrospective meeting）上，哈哈，有些同事已经开始不想work-from-home了。可以看大家贴的卡片（工作相关的我已经抹去了），除了工作相关的，work-from-home和疫情感受是两大主题：</p>
<p>对于有孩纸的同事，可能画风是这样的（同事发的图）。而且欧洲这边生育政策很好，所以通常有不只一个孩子，甚至是4、5个孩纸：</p>
<p>哈哈，</p>
<p>容我笑一会儿</p>
<p>其实除了刚开始几天不太适应</p>
<p>我还挺喜欢在家办公</p>
<p>因为我可以多睡一会啊</p>
<p>然后各种疫情趣图：</p>
<h1 id="张文宏教你身处欧洲应怎样防护">张文宏教你身处欧洲应怎样防护</h1>
<p>近期以来，新冠肺炎疫情在德国呈现多点暴发和扩散态势。为帮助领区同胞更加科学有效地防控新冠肺炎病毒的传播，更好地同当地民众同舟共济、共克时艰，中国驻杜塞尔多夫总领馆在上海市外办协助下，特别邀请到上海复旦大学附属华山医院感染科主任、上海市新冠肺炎医疗救治专家组组长、中华医学会感染病学分会常委张文宏教授于3月17日以视频连线方式举办专题讲座。</p>
<p>公众号：中国驻杜塞尔多夫总领馆特讯丨张文宏教授为海外同胞防范新冠病毒来支招</p>
<p>全文请看文章：特讯丨张文宏教授为海外同胞防范新冠病毒来支招</p>
<blockquote>
<p>2020.3.17上海-杜塞，复旦张文宏教授视频会议谈话的要点概括：</p>
<p>1，德国呼吸机对应病人的人数量级：10w</p>
<p>2，德国在欧洲国家中，成绩最好。</p>
<p>3，全球范围内，corona在4-6月出现高峰。2020夏天到低谷，但冬天可能会抬头。2021春天可能再次高峰，尤其南半球，持续一两年很正常。</p>
<p>4，在德留学的回国了，需要做好思想准备，可能长期拖延德国的学业与工作。</p>
<p>5，在德留下的，要避免不必要社交，包括聚集性场合。小范围接触可以，范围要小，要分餐，要戴口罩，毫无接触人会疯掉。</p>
<p>6，（张）接触的年轻人重症率很低，90%很轻，10%吸氧，能缓解。</p>
<p>7，有没有呼吸困难，是重症的标准。爬两层楼梯后如果呼吸没问题，去医院毫无意义。</p>
<p>8，不可能全世界都采用中国模式。</p>
</blockquote>
<blockquote>
<p>9，NRW州疫情分析：目前速度上升较快。关键是隔离措施要到位，不然日子会难过。14天后，若上升速度下来了，有戏；没下来，不好。14天后速度没下来，德国措施等级需要升级。</p>
<p>10，英国总床位3k，德国3w，但冗余度都较大。意大利和西班牙日子相对难过。</p>
<p>11，上海只针对疑似病人进行检测，对来自重点地区的进行检测。</p>
<p>12，德国的策略是正确的，我（张）也会做出同样决策。</p>
<p>谭天伟校长 发表在虎扑步行街·步行街主干道 <a href="https://bbs.hupu.com/bxj" target="_blank" rel="noopener">https://bbs.hupu.com/bxj</a></p>
<p>13，杜塞尔多夫的感染率约为万分之1-2。共用厨房卫生间没有关系，保持好个人卫生，经常洗手，错时使用共用设施，烘干衣物，减少接触。多花点钱自己住（如果不放心万分之1-2的感染率）。</p>
<p>14，疫苗诞生需要时间：1-3年。</p>
<p>15，特效药的上市：需要临床检测。</p>
<p>16，口罩的作用被高估：病毒高密度地区效率高，低密度地区效率低。不要强迫外国人戴口罩，中国人聚会时要戴口罩。首先改变自己，而不是强迫改变别人。</p>
</blockquote>
<p>谭天伟校长 发表在虎扑步行街·步行街主干道 <a href="https://bbs.hupu.com/bxj" target="_blank" rel="noopener">https://bbs.hupu.com/bxj</a></p>
<hr>
<h1 id="波兰疫情现状">波兰疫情现状</h1>
<p>维基百科数据-波兰地图</p>
<p>其实3月11日对于波兰来说</p>
<p>是一个非常重要的分水岭</p>
<p>因为这一天波兰宣布学校停课</p>
<p>这项举措</p>
<p>让波兰所有人</p>
<p>真正感受到事态严重</p>
<p>也是这一天</p>
<p>大家开始涌向超市</p>
<p>3月16日</p>
<p>很多公司开始在家办公</p>
<p>波兰政府防疫措施？</p>
<p>除了上次介绍的波兰措施：</p>
<p>波兰确诊125例！死亡3例！封国？停课？超市抢购？ 【中国人在波兰疫情日记4】</p>
<p>对于需要在家居家隔离14日的人员，警察会定期联系，确保没有随意外出过，</p>
<p>如果违反，会被处以5000PLN的罚款（大概9300人民币）。</p>
<p>医院开始征集献血了：</p>
<h1 id="波兰民众带口罩吗？">波兰民众带口罩吗？</h1>
<p>普通民众不带口罩。</p>
<p>大街上目之所及没看到有人带口罩，包括超市、商场、地铁公交、景点等。</p>
<p>跟上两篇文章记录的没有明显变化。</p>
<p>波兰卫生部官网网址上对佩戴口罩的建议，也没有改变：</p>
<blockquote>
<p>不建议健康人士戴口罩，以防止SARS-Cov-2传播</p>
<p>戴上覆盖口鼻的口罩可能有助于减少某些呼吸道疾病的传播。但是，单独使用口罩并不能保证会阻止感染，应结合使用其他预防措施，包括手卫生，咳嗽和打喷嚏的保护规则（请参见上文），并避免与他人的近距离接触（至少1米的距离） 。世界卫生组织建议合理使用口罩。</p>
<p>仅当您有呼吸道症状（咳嗽或打喷嚏），怀疑具有轻度症状的SARS-Cov-2感染或正在照顾疑似SARS-Cov-2感染的人时，才使用口罩。</p>
<p>呼吸防护设备应带有CE标记，以证明它是用正确的材料正确设计，构造和制造的。</p>
</blockquote>
<p><a href="https://www.gov.pl/web/zdrowie/coronavirus" target="_blank" rel="noopener">https://www.gov.pl/web/zdrowie/coronavirus</a></p>
<p>有536例确诊例死亡了，</p>
<p>大众行为最近变化：</p>
<p>超市补货加强，</p>
<p>部分公司大多数员工开始在家办公，</p>
<p>极少数人带口罩，</p>
<p>公共交通开始空旷，</p>
<p>还是没有停用中央空调</p>
<p>。。。</p>
<p>华沙公交</p>
<p>不再抱怨了</p>
<p>欧洲游，再见</p>
<p>博物馆，再见</p>
<p>因为波兰封国，</p>
<p>我什么时候能回国回家✈️就不错了</p>
<p>哪还能奢望其他呢？</p>
<p>哈哈</p>
<p>我最需要的是一架包机</p>
<p>最后</p>
<p>希望大家都健康平安！</p>
<p>END</p>
<hr>
<h1 id="参考">参考</h1>
<p><a href="https://en.wikipedia.org/wiki/2020_coronavirus_outbreak_in_Poland" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/2020_coronavirus_outbreak_in_Poland</a></p>
<p>波兰卫生部Twitter</p>
<p>地图来源：<a href="https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6" target="_blank" rel="noopener">https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6</a></p>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>中国人在波兰</category>
      </categories>
      <tags>
        <tag>疫情日记</tag>
      </tags>
  </entry>
  <entry>
    <title>[中国人在波兰疫情日记8]波兰确诊6934死亡245例！限行后首次超市购物，强制戴手套</title>
    <url>/%5B%E4%B8%AD%E5%9B%BD%E4%BA%BA%E5%9C%A8%E6%B3%A2%E5%85%B0%E7%96%AB%E6%83%85%E6%97%A5%E8%AE%B08%5D%E6%B3%A2%E5%85%B0%E7%A1%AE%E8%AF%8A6934%E6%AD%BB%E4%BA%A1245%E4%BE%8B%EF%BC%81%E9%99%90%E8%A1%8C%E5%90%8E%E9%A6%96%E6%AC%A1%E8%B6%85%E5%B8%82%E8%B4%AD%E7%89%A9%EF%BC%8C%E5%BC%BA%E5%88%B6%E6%88%B4%E6%89%8B%E5%A5%97.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><hr>
<h1 id="开篇">开篇</h1>
<p>从3月16日开始在家办公已经四周了，前三周我一步都没出家门！<br>
直到弹尽粮绝.</p>
<p>第四周周一<br>
4月6日早上6点多，</p>
<p>全副武装，</p>
<p>提着行李箱，<br>
去了一次利多超市！</p>
<p>对，<br>
你没看错，<br>
现在去超市是得提<br>
行李箱了！</p>
<p>我把超市整个过程录下来<br>
剪辑成视频了！<br>
B站“岚坤爷”同步更新<br>
来看看现在波兰超市<br>
是怎样的状况？</p>
<p>缺卫生纸吗？<br>
缺吃的吗？<br>
有人戴口罩吗？</p>
<hr>
<p>恰巧我去年9月底从国内来波兰华沙出差半年，就顺便记录下这这个特殊时期在波兰我身边大家的观点和反应。本篇是这个系列的第5篇。</p>
<p>正好所在公司在中国，波兰和美国都有研发中心，三个地区我也都有认识的同事可以了解情况。</p>
<p>波兰这边技术组的同事，来自欧洲各国。我认识的有<strong>波兰人，土耳其人，乌克兰人，意大利人，墨西哥人，西班牙人，立陶宛人，塔吉克斯坦人，美国人，中国人</strong>，也方便了解欧洲疫情形势。（写出来才发现，组里的国籍好多啊。）</p>
<p>也可以横向对比下同一家公司在三个不同区域<strong>亚洲，欧洲和北美洲</strong>，根据当地政府政策所采取的不同措施。</p>
<p>本文既不全面也不专业，既不严肃也不造谣，仅仅是记录下身边的人和事，记录在这个特殊时段的感受。</p>
<h1 id="波兰疫情现状">波兰疫情现状</h1>
<p>维基百科数据-波兰地图</p>
<p>其实3月11日对于波兰来说</p>
<p>是一个非常重要的分水岭</p>
<p>因为这一天波兰宣布学校停课</p>
<p>这项举措</p>
<p>让波兰所有人</p>
<p>真正感受到事态严重</p>
<p>也是这一天</p>
<p>大家开始涌向超市</p>
<p>3月16日</p>
<p>很多公司开始在家办公</p>
<h1 id="波兰政府防疫措施？">波兰政府防疫措施？</h1>
<p>真心感觉比起其他欧洲国家的骚操作，波兰政府做的还是不错的。我们来捋一捋波兰政府疫情期间的新冠政策，并附上当日颁布政策时的&quot;确诊人数/死亡人数&quot;。</p>
<h2 id="3月11日-停课-确诊31-0">3月11日 停课（确诊31/0）</h2>
<p>从2020年3月12日起，教育系统单位的功能暂时受到限制。<br>
这意味着在此期间，公立和非公立幼儿园，学校和教育机构都将不开设教学和教育班。<br>
托儿所和儿童俱乐部也暂停上课。</p>
<h2 id="3月12日-进入流行病紧急状态-确诊51-1">3月12日 进入流行病紧急状态（确诊51/1）</h2>
<p>这将引发流行性紧急情况，而十九家医院将变成传染性医院-这是卫生部限制冠状病毒传播的下一步行动。</p>
<h2 id="3月13日-美食-娱乐和购物中心运营限制-确诊68-2">3月13日 美食，娱乐和购物中心运营限制（确诊68/2）</h2>
<ul>
<li>限制购物中心和画廊的运作，关闭体育馆，游泳池，舞蹈俱乐部，健身俱乐部，博物馆，图书馆，电影院。</li>
<li>杂货店，药房，药店和洗衣店仍然开放-波兰人将能够购买食品，药品和清洁产品。</li>
<li>银行和金融机构运作正常</li>
<li>餐馆，咖啡馆和酒吧的工作方式将有所不同——下订单以外卖或送货。</li>
<li>禁止具有公共、国家和宗教性质的聚会超过50人（适用于室内和室外会议）。</li>
</ul>
<h2 id="3月13日-封国-确诊68-2">3月13日 封国（确诊68/2）</h2>
<p>自3月15日星期日起，关闭外国人进入波兰的边界。现在边界之外的所有波兰公民都可以返回波兰。他们还必须接受14天的强制性家庭隔离。<br>
暂停国际客运航空和铁路运输15日，但货物将不受干扰地出入波兰。</p>
<h2 id="3月18日-anti-crisis-shield政策-确诊287-5">3月18日 Anti-Crisis Shield政策（确诊287/5）</h2>
<p>反危机盾牌旨在保护公司和员工免受冠状病毒流行的影响。最重要的是资金流动性和员工安全-这将由价值2120亿兹罗提的抗危机盾牌提供服务，政府已将其制成与冠状病毒流行有关的药物。该计划包含以下解决方案：员工，微型，小型，中型和大型公司。每个企业家都将能够例如推迟缴纳会费或税款，而无需支付额外的费用。</p>
<h2 id="3月23日-延长停课-确诊749-8">3月23日 延长停课（确诊749/8）</h2>
<p>引入隔离检疫新规定，将不遵守检疫规定的罚款从5,000兹罗提提高至30,000兹罗提(大约55000人民币)。<br>
延长停课直至2020年4月10日。<br>
将19家医院转变为传染病医院。</p>
<h2 id="3月24日-限制出行-确诊900-10">3月24日 限制出行（确诊900/10）</h2>
<p>在4月11日（含）之前，限制出行，除上班、COVID-19相关活动、必要的日常活动（购物食物、药品，看医生，照顾亲戚和遛狗狗）。<br>
公共交通公共交通继续运行。但是，公共汽车，电车或地铁只能坐一半座位。<br>
全面禁止5人以上聚会。<br>
鼓励您通过电视，广播或互联网参加宗教活动。</p>
<h2 id="3月31日-加强限制出行-确诊2311-33">3月31日 加强限制出行（确诊2311/33）</h2>
<p>4月1日起，任何未满18岁的人只有在成人监护人的监护下才能离开房屋，并且公园，林荫大道和海滩将关闭。<br>
2米-行人之间的最小距离。<br>
每个商业场所最多可以容纳收银台*3的客人。从4月2日（星期四）开始，所有客户都需戴一次性手套，<br>
从10:00到12:00，只有65岁以上的人才能接收和使用商店和服务。在其他时候，每个人都可以使用商店和商业场所（包括65岁以上的人）。<br>
所有理发店，化妆品，纹身和穿孔沙龙都将关闭。<br>
等等限制。</p>
<h2 id="4月8日-1000亿兹罗提企业补助-确诊5205-158">4月8日 1000亿兹罗提企业补助（确诊5205/158）</h2>
<p>该计划的目标是在危机期间保护劳动力市场并为公司提供财务流动性。 金融盾包括三个基本组成部分，总价值达1000亿兹罗提（占GDP的4.5％），其中：</p>
<ul>
<li>250亿兹罗提将用于微型企业（雇用至少一名员工），</li>
<li>中小企业-500亿兹罗提，</li>
<li>大型企业-250亿兹罗提。</li>
</ul>
<h2 id="4月9日-要求掩盖口鼻-确诊5575-174">4月9日 要求掩盖口鼻（确诊5575/174）</h2>
<p>从4月16日（星期四）开始，在公共场所的每个人都必须戴上覆盖口鼻的口罩，围巾或手帕。<br>
该义务适用于在大街上，办公室，商店或提供服务的场所以及工作场所中的每个人。</p>
<p>2020年4月19日前，以下规定仍然适用：</p>
<ul>
<li>行动限制；</li>
<li>禁止在未成年人监护下走上未成年人的街道；</li>
<li>宗教活动的限制-最多可以有5人住在教堂。该规则也适用于复活节之夜！</li>
<li>限制购物中心和大型建筑商店的运营；</li>
<li>使用公共交通工具和9辆以上汽车的规则；</li>
<li>暂停美发，化妆品，纹身等；</li>
<li>禁止使用公园，森林，海滩，林荫大道，长廊和城市自行车；</li>
<li>餐厅关闭；</li>
<li>限制商店，市场和邮局的人数；</li>
<li>限制文化机构的活动（在电影院，剧院等）。</li>
</ul>
<p>在4月26日星期日之前，以下规定仍然适用：</p>
<ul>
<li>关闭学校和大学；</li>
<li>幼儿园和托儿所；</li>
<li>关闭旅客空中交通；</li>
<li>国际铁路交通的封闭。</li>
</ul>
<p>在5月3日星期日之前，以下规定仍然适用：</p>
<ul>
<li>关闭边境（波兰公民，波兰公民的配偶或子女的外国人，拥有在波兰永久或临时居留权或工作许可的人仍然享有越过波兰边境的权利）;</li>
<li>对与波兰边境过境的人进行强制隔离。</li>
</ul>
<p>另行通知：</p>
<ul>
<li>限制群众活动和聚会的组织。</li>
</ul>
<p>从目前政策来看，4月26日星期日之前国际铁路机场交通仍然封闭。</p>
<p>也就是我4月26日星期日之前，无法回家。</p>
<p>最早的政策是3月15日-3月25日国际铁路机场交通封闭，现在延期到4月26日。希望不会继续延期。因为我买有4月28日的机票。</p>
<h1 id="波兰民众带口罩吗？">波兰民众带口罩吗？</h1>
<p>普通民众开始戴口罩啦！</p>
<p>看过我之前的文章的小伙伴应该知道，之前大街上目之所及没看到有人带口罩，包括超市、商场、地铁公交、景点等。<br>
这点现在跟之前篇文章记录的有明显变化。路上、超市都有人戴口罩了，华人戴口罩现在一点都不奇怪了。</p>
<p>喜大普奔，大家可以不用担心因戴口罩而被歧视啦。</p>
<p>波兰卫生部对佩戴口罩的建议也从最初的：</p>
<blockquote>
<p>不建议健康人士戴口罩，以防止SARS-Cov-2传播</p>
<p>戴上覆盖口鼻的口罩可能有助于减少某些呼吸道疾病的传播。但是，单独使用口罩并不能保证会阻止感染，应结合使用其他预防措施，包括手卫生，咳嗽和打喷嚏的保护规则（请参见上文），并避免与他人的近距离接触（至少1米的距离） 。世界卫生组织建议合理使用口罩。</p>
<p>仅当您有呼吸道症状（咳嗽或打喷嚏），怀疑具有轻度症状的SARS-Cov-2感染或正在照顾疑似SARS-Cov-2感染的人时，才使用口罩。</p>
<p>呼吸防护设备应带有CE标记，以证明它是用正确的材料正确设计，构造和制造的。</p>
</blockquote>
<p><a href="https://www.gov.pl/web/zdrowie/coronavirus" target="_blank" rel="noopener">https://www.gov.pl/web/zdrowie/coronavirus</a></p>
<p>到现在的：</p>
<p>从4月16日（星期四）开始，在公共场所的每个人都必须戴上覆盖口鼻的口罩，围巾或手帕。该义务适用于在大街上，办公室，商店或提供服务的场所以及工作场所中的每个人。</p>
<h1 id="感受">感受</h1>
<p>大众行为终于开始变化了，</p>
<p>超市现在供货很足，</p>
<p>大部分员工在家办公，</p>
<p>少数人戴口罩，</p>
<p>戴手套，<br>
排队保持距离。</p>
<p>。。。</p>
<p>我4月6日又去了LiDL超市，<br>
所有备货充足，</p>
<p>米面区和鲜肉区完全齐全，<br>
洗手液也不少了，<br>
意面是最受欢迎的主食，</p>
<p>香肠和罐头也有，<br>
蔬菜和油也有，</p>
<p>而且我还不太理解，<br>
也不缺卫生纸</p>
<p>具体情况大家看我文章开始的视频哦。</p>
<p>最后，还是那句话，<br>
希望大家都健康平安！</p>
<p>END</p>
<hr>
<h1 id="参考">参考</h1>
<p><a href="https://en.wikipedia.org/wiki/2020_coronavirus_outbreak_in_Poland" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/2020_coronavirus_outbreak_in_Poland</a></p>
<p>波兰卫生部Twitter</p>
<p>地图来源：<a href="https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6" target="_blank" rel="noopener">https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6</a></p>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>中国人在波兰</category>
      </categories>
      <tags>
        <tag>疫情日记</tag>
      </tags>
  </entry>
  <entry>
    <title>text-overflow: ellipsis;什么时候可能不生效？</title>
    <url>/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ⅰ-text-overflow-ellipsis-什么时候可能不生效？">Ⅰ text-overflow: ellipsis;什么时候可能不生效？</h1>
<hr>
<ol>
<li>
<p>设置在width有效的元素上，并且设置必要的width。</p>
<ul>
<li>块级元素（block level element） width、height 属性默认有效.[example 1]</li>
<li>内联元素（inline element 有的人也叫它行内元素）width、height 属性无效。[example 2]<br>
可以通过改变display，使得width、height属性有效。</li>
</ul>
 <figure class="highlight"><table><tr><td class="code"><pre><span class="line">display: block; //inline-block;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>要想这两个属性起真正的作用，需要配合：</p>
 <figure class="highlight"><table><tr><td class="code"><pre><span class="line">overflow: hidden; // 超出文本的部分不显示</span><br><span class="line">white-space: nowrap; // 强制文本在一行显示</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>在table内td除了满足前两个条件之外。要在table的样式里定义一个属性 <code>table-layout:fixed</code><br>
[example 3]</p>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- example 1 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"divTitle"</span>&gt;</span>div text-overflow: ellipsis;什么时候可能不生效？<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- example 2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"spanTitle"</span>&gt;</span>span text-overflow: ellipsis;什么时候可能不生效？<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- example 3 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>  <span class="attr">class</span>=<span class="string">"box  ellipsis"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>Here is some long content that doesn't fit.Here is some long content that doesn't fit<span class="tag">&lt;/<span class="name">span</span>&gt;</span>A</span><br><span class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
<pre><code><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// example 1</span><br><span class="line"><span class="selector-class">.divTitle</span> &#123;</span><br><span class="line">    width: 10px; // or other value</span><br><span class="line">    <span class="selector-tag">text-overflow</span>: <span class="selector-tag">ellipsis</span>;</span><br><span class="line">    <span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span>;</span><br><span class="line">    <span class="selector-tag">white-space</span>: <span class="selector-tag">nowrap</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// example 2</span><br><span class="line"><span class="selector-class">.spanTitle</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// example 3</span><br><span class="line"><span class="selector-tag">table</span> &#123; </span><br><span class="line">    <span class="attribute">table-layout</span>:fixed; </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">td</span> &#123; </span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis; </span><br><span class="line">    <span class="attribute">white-space</span>: nowrap; </span><br><span class="line">    <span class="attribute">overflow</span>: hidden; </span><br><span class="line">    <span class="attribute">width</span>: <span class="number">10px</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre>
<hr>
<h1 id="ⅱ-text-overflow的不同样式">Ⅱ text-overflow的不同样式</h1>
<hr>
<ul>
<li>clip<br>
这个关键字的意思是&quot;在内容区域的极限处截断文本&quot;，因此在字符的中间可能会发生截断。为了能在两个字符过渡处截断，你必须使用一个空字符串值 (’’)(To truncate at the transition between two characters, the empty string value (’’) must be used.)。此为默认值。</li>
<li>ellipsis<br>
这个关键字的意思是“用一个省略号 (’…’, U+2026 HORIZONTAL ELLIPSIS)来表示被截断的文本”。这个省略号被添加在内容区域中，因此会减少显示的文本。如果空间太小到连省略号都容纳不下，那么这个省略号也会被截断。</li>
<li>string 自定义字符串<br>
string用来表示被截断的文本。字符串内容将被添加在内容区域中，所以会减少显示出的文本。如果空间太小到连省略号都容纳不下，那么这个字符串也会被截断。但是这个属性在很多浏览器中都不支持，要谨慎使用。</li>
</ul>
<p>最有意思的是，如果结合使用</p>
<figure class="highlight avrasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">direction:</span> rtl</span><br></pre></td></tr></table></figure>
<p>可以指定截断文本是在文末还是在开头。</p>
<p>CodePen <a href="https://codepen.io/catherineliyuankun/pen/gjzLav" target="_blank" rel="noopener">text-overflow例子链接</a><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F/text-overflow%E7%9A%84%E4%B8%8D%E5%90%8C%E6%A0%B7%E5%BC%8F.png" alt="text-overflow的不同样式例子图片"></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"overflow-visible"</span>&gt;</span>overflow-visible Lorem ipsum dolor sit amet, consectetur adipisicing elit.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"overflow-clip"</span>&gt;</span>overflow-clip Lorem ipsum dolor sit amet, consectetur adipisicing elit.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"overflow-ellipsis"</span>&gt;</span>overflow-ellipsis Lorem ipsum dolor sit amet, consectetur adipisicing elit.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"overflow-ellipsis first"</span>&gt;</span>overflow-ellipsis first Lorem ipsum dolor sit amet, consectetur adipisicing elit.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"overflow-string"</span>&gt;</span>overflow-string Lorem ipsum dolor sit amet, consectetur adipisicing elit.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<pre><code><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">5px</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* BOTH of the following are required for text-overflow */</span></span><br><span class="line"><span class="attribute">white-space</span>: nowrap;</span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.overflow-visible</span> &#123;</span><br><span class="line"><span class="attribute">white-space</span>: initial;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.overflow-clip</span> &#123;</span><br><span class="line"><span class="attribute">text-overflow</span>: clip;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.overflow-ellipsis</span> &#123;</span><br><span class="line"><span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.overflow-ellipsis</span><span class="selector-class">.first</span> &#123;</span><br><span class="line"><span class="attribute">direction</span>: rtl;</span><br><span class="line"><span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.overflow-string</span> &#123;</span><br><span class="line"><span class="comment">/* Not supported in most browsers, </span></span><br><span class="line"><span class="comment">    see the 'Browser compatibility' section below */</span></span><br><span class="line"><span class="attribute">text-overflow</span>: <span class="string">" [..]"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre>
<hr>
<h1 id="ⅲ-文首截断？">Ⅲ …文首截断？</h1>
<hr>
<p>我们一般都会在文末截断…<br>
如果我确实有文首截断的需求呢？怎么实现？</p>
<h2 id="方法一">方法一</h2>
<p>结合使用direction可以指定截断文本是在文末还是在开头。</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">direction: rtl; // <span class="built_in">at</span> <span class="built_in">right</span> <span class="keyword">end</span> 文末</span><br></pre></td></tr></table></figure>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">direction: ltr // <span class="built_in">at</span> <span class="built_in">left</span> <span class="keyword">end</span> 开头</span><br></pre></td></tr></table></figure>
<p>例子：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F/reverse%20ellipsis%201.png" alt="文首截断例子图片"></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"overflow-ellipsis"</span>&gt;</span>overflow-ellipsis Lorem ipsum dolor sit amet, consectetur adipisicing elit.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"overflow-ellipsis first"</span>&gt;</span>overflow-ellipsis first Lorem ipsum dolor sit</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">5px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* BOTH of the following are required for text-overflow */</span></span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.overflow-ellipsis</span> &#123;</span><br><span class="line">  <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.overflow-ellipsis</span><span class="selector-class">.first</span> &#123;</span><br><span class="line">  <span class="attribute">direction</span>: rtl;</span><br><span class="line">  <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="方法二">方法二</h2>
<p>如果方法一在有些浏览器中不支持的话，可以使用：before添加content来实现。</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F/reverse%20ellipsis%202.png" alt="文首截断2例子图片"></p>
<p>CodePen <a href="https://codepen.io/catherineliyuankun/pen/ajGpvV" target="_blank" rel="noopener">reverse ellipsis例子链接</a></p>
<hr>
<h1 id="ⅳ-多行显示并在最后一行截断文字？">Ⅳ 多行显示并在最后一行截断文字？</h1>
<hr>
<p>多行截断的其他方法，可以参考下一篇文章：<a href="http://liyuankun.top/text-overflow-ellipsis%E5%A4%9A%E8%A1%8C%E6%96%87%E6%9C%AC%E6%BA%A2%E5%87%BA-css-js%E6%96%B9%E6%B3%95%E5%85%A8%E6%80%BB%E7%BB%93.html">text-overflow: ellipsis多行文本溢出…css/js方法全总结</a></p>
<p>上面我们为了能够截断文字，使用了</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">white-space: nowrap; // 强制文本在一行显示</span><br></pre></td></tr></table></figure>
<p>如果我确实有多行显示的需求呢？怎么实现？</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F/multiline%20ellipsis.png" alt="multiline例子图片"></p>
<p>CodePen <a href="https://codepen.io/catherineliyuankun/pen/poJzLKx" target="_blank" rel="noopener">multiline例子链接</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"block-with-text"</span>&gt;</span>The Hitch Hiker's Guide to the Galaxy has a few things to say on the subject of towels. A towel, it says, is about the most massivelyuseful thing an interstellar hitch hiker can have. Partly it has great practical value - you can wrap it around you for warmth as you bound across the cold moons of  Jaglan Beta.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"block-with-text"</span>&gt;</span>Small text, less then one row. Without dottes.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"block-with-text"</span> <span class="attr">style</span>=<span class="string">"width: 250px;"</span>&gt;</span>2.5 lines example: A towel is about the most massively useful thing an interstellar hitch hiker can have<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">font</span>: <span class="number">400</span> <span class="number">14px</span>/<span class="number">1.2em</span> sans-serif; </span><br><span class="line">  <span class="attribute">background</span>: white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* mixin for multiline */</span></span><br><span class="line"><span class="keyword">@mixin</span> multiLineEllipsis($<span class="attribute">lineHeight:</span> <span class="number">1.2em</span>, $<span class="attribute">lineCount:</span> <span class="number">1</span>, $<span class="attribute">bgColor:</span> white)&#123;</span><br><span class="line">  <span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span>;</span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">relative</span>;</span><br><span class="line">  line-height: $lineHeight;</span><br><span class="line">  max-height: $lineHeight * $lineCount; </span><br><span class="line">  <span class="selector-tag">text-align</span>: <span class="selector-tag">justify</span>;</span><br><span class="line">  <span class="selector-tag">margin-right</span>: <span class="selector-tag">-1em</span>;</span><br><span class="line">  <span class="selector-tag">padding-right</span>: 1<span class="selector-tag">em</span>;</span><br><span class="line">  &amp;<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">'...'</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1em</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1em</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">0.2em</span>;</span><br><span class="line">    <span class="attribute">background</span>: $bgColor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.block-with-text</span> &#123;</span><br><span class="line">  @include multiLineEllipsis($lineHeight: 1.2em, $lineCount: 2, $bgColor: white);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="the-reference-link">The reference link</h1>
<p><a href="http://hackingui.com/front-end/a-pure-css-solution-for-multiline-text-truncation/" target="_blank" rel="noopener">Pure CSS for multiline truncation with ellipsis</a><br>
<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/text-overflow" target="_blank" rel="noopener">MDN text-overflow</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>text-overflow</tag>
      </tags>
  </entry>
  <entry>
    <title>text-overflow: ellipsis多行文本溢出...css/js方法全总结</title>
    <url>/text-overflow-ellipsis%E5%A4%9A%E8%A1%8C%E6%96%87%E6%9C%AC%E6%BA%A2%E5%87%BA-css-js%E6%96%B9%E6%B3%95%E5%85%A8%E6%80%BB%E7%BB%93.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="多行显示并在最后一行截断文字？">多行显示并在最后一行截断文字？</h1>
<hr>
<p>text-overflow基本知识请看上篇文章：<br>
<a href="http://liyuankun.top/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F">text-overflow: ellipsis;什么时候可能不生效？</a></p>
<p>单行文字我们为了能够截断文字，使用了</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">white-space: nowrap; // 强制文本在一行显示</span><br></pre></td></tr></table></figure>
<p>如果我确实有多行并在最后一行截断文字显示的需求呢？怎么实现？<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F/multiline%20ellipsis.png" alt="multiline例子图片"></p>
<h1 id="方法1-webkit-line-clamp-property">方法1 -Webkit-line-clamp property</h1>
<p><strong>优点</strong>: 最简单的方法<br>
<strong>缺点</strong>: 但是很遗憾，它不支持跨浏览器（在Firefox和Internet Explorer中不起作用）。</p>
<blockquote>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/-webkit-line-clamp" target="_blank" rel="noopener">-webkit-line-clamp</a> CSS 属性 可以把 块容器 中的内容限制为指定的行数.</p>
</blockquote>
<blockquote>
<p>它只有在 display 属性设置成 -webkit-box 或者 -webkit-inline-box 并且 -webkit-box-orient 属性设置成 vertical时才有效果</p>
</blockquote>
<blockquote>
<p>在大部分情况下,也需要设置 overflow 属性为 hidden, 否则,里面的内容不会被裁减,并且在内容显示为指定行数后还会显示省略号(ellipsis ).</p>
</blockquote>
<blockquote>
<p>当他应用于锚(anchor)元素时,截取动作可以发生在文本中间,而不必在末尾.</p>
</blockquote>
<p>使用方法：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.block-with-text</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">    <span class="attribute">-webkit-line-clamp</span>: <span class="number">3</span>;</span><br><span class="line">    <span class="attribute">-webkit-box-orient</span>: vertical;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@mixin</span> allowWrappingTwoRows &#123;</span><br><span class="line">  <span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span>;</span><br><span class="line">  <span class="selector-tag">display</span>: <span class="selector-tag">-webkit-box</span>;</span><br><span class="line">  <span class="selector-tag">-webkit-line-clamp</span>: 2;</span><br><span class="line">  <span class="selector-tag">-webkit-box-orient</span>: <span class="selector-tag">vertical</span>;</span><br><span class="line">  <span class="selector-tag">text-overflow</span>: <span class="selector-tag">ellipsis</span>;</span><br><span class="line">  <span class="selector-tag">white-space</span>: <span class="selector-tag">normal</span>;</span><br><span class="line">  <span class="selector-tag">word-break</span>: <span class="selector-tag">break-word</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2022-9-update">2022.9 Update</h2>
<p>Chrome, Firefox, Safari, Edge 都可以work， IE支不支持我已经不关心了。<br>
可以在<a href="https://caniuse.com/?search=-webkit-line-clamp" target="_blank" rel="noopener">CanIUse查询</a></p>
<h2 id="被postcss-autoprefixer自动移除">被<a href="https://github.com/postcss/autoprefixer" target="_blank" rel="noopener">postcss/autoprefixer</a>自动移除</h2>
<ul>
<li>问题：发现<code>-webkit-box-orient: vertical;</code>因为会被<a href="https://github.com/postcss/autoprefixer" target="_blank" rel="noopener">postcss/autoprefixer</a>自动移除</li>
<li>解决方法： 加<code>/* autoprefixer: off */</code>注释</li>
</ul>
<h3 id="方法1-windows上可能报错">方法1 <a href="https://blog.csdn.net/weixin_34403976/article/details/102708645" target="_blank" rel="noopener">windows上可能报错</a></h3>
<blockquote>
<p>为什么用/*!..*/这种方式书写？<br>
和autoprefixer的github上的readme中demo不一致，多了’!’。<br>
原因：在postcss-loader在处理css时会把非’!'开头的comment(注释)删除掉了。</p>
</blockquote>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> allowWrappingTwoRows &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">  -webkit-line-clamp: <span class="number">2</span>;</span><br><span class="line">  <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">  <span class="attribute">white-space</span>: normal;</span><br><span class="line">  <span class="attribute">word-break</span>: break-word;</span><br><span class="line">  <span class="comment">/*! autoprefixer: off */</span></span><br><span class="line">  -webkit-box-orient: vertical</span><br><span class="line">  /*! autoprefixer: on */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="方法2">方法2</h3>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> allowWrappingTwoRows &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">  -webkit-line-clamp: <span class="number">2</span>;</span><br><span class="line">  <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">  <span class="attribute">white-space</span>: normal;</span><br><span class="line">  <span class="attribute">word-break</span>: break-word;</span><br><span class="line">  <span class="comment">/*! autoprefixer: ignore next */</span></span><br><span class="line">  -webkit-box-orient: vertical;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="方法3">方法3</h3>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> allowWrappingTwoRows &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">  -webkit-line-clamp: <span class="number">2</span>;</span><br><span class="line">  -webkit-box-orient: vertical;</span><br><span class="line">  <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">  <span class="attribute">white-space</span>: normal;</span><br><span class="line">  <span class="attribute">word-break</span>: break-word;</span><br><span class="line">  <span class="comment">// Avoid remove "-webkit-box-orient: vertical;" by autoprefixer</span></span><br><span class="line">  <span class="comment">/* autoprefixer: off */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="方法2-text-overflow-o-ellipsis-lastline">方法2 Text-overflow: -o-ellipsis-lastline</h1>
<p>从10.60版开始，Opera增加了在多行块上剪切文本的功能。 老实说，我从未尝试过，理论上只在Opera 10.6以后可以使用，不建议使用。</p>
<h1 id="方法3-javascript">方法3 JavaScript</h1>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#block-with-text</span> &#123; </span><br><span class="line">    <span class="attribute">height</span>: <span class="number">3.6em</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ellipsizeMultiLineText</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">    <span class="keyword">var</span> words = element.innerHTML.split(<span class="string">' '</span>);</span><br><span class="line">    <span class="keyword">while</span>(element.scrollHeight &gt; element.offsetHeight) &#123;</span><br><span class="line">        words.pop();</span><br><span class="line">        element.innerHTML = words.join(<span class="string">' '</span>) + <span class="string">'...'</span>;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line">ellipsizeMultiLineText(<span class="string">'block-with-text'</span>);</span><br></pre></td></tr></table></figure>
<h1 id="方法4-纯css解决-跨浏览器">方法4 纯CSS解决 &amp; 跨浏览器</h1>
<h2 id="优点">优点</h2>
<ol>
<li>纯CSS</li>
<li>自适应 Responsive</li>
<li>改变大小后或者 字体加载事件后 不需要重新计算</li>
<li>跨浏览器</li>
</ol>
<h2 id="缺点">缺点</h2>
<ol>
<li>文字小于指定行数的时候，我们需要一个背景色来掩盖‘…’</li>
<li>我们需要空间来放‘…’, 而且如果父节点<code>overflow: hidden</code> 或者 <code>overflow: auto</code> 我们需要去掉style <code>margin-right: -1em;</code>.</li>
</ol>
<h2 id="实现方法">实现方法</h2>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* styles for '...' */</span> </span><br><span class="line"><span class="selector-class">.block-with-text</span> &#123;</span><br><span class="line">  <span class="comment">/* hide text if it more than N lines  */</span></span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="comment">/* for set '...' in absolute position */</span></span><br><span class="line">  <span class="attribute">position</span>: relative; </span><br><span class="line">  <span class="comment">/* use this value to count block height */</span></span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.2em</span>;</span><br><span class="line">  <span class="comment">/* max-height = line-height (1.2) * lines max number (3) */</span></span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">3.6em</span>; </span><br><span class="line">  <span class="comment">/* fix problem when last visible word doesn't adjoin right side  */</span></span><br><span class="line">  <span class="attribute">text-align</span>: justify;  </span><br><span class="line">  <span class="comment">/* place for '...' */</span></span><br><span class="line">  <span class="attribute">margin-right</span>: -<span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">padding-right</span>: <span class="number">1em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* create the ... */</span></span><br><span class="line"><span class="selector-class">.block-with-text</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="comment">/* points in the end */</span></span><br><span class="line">  <span class="attribute">content</span>: <span class="string">'...'</span>;</span><br><span class="line">  <span class="comment">/* absolute position */</span></span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="comment">/* set position to right bottom corner of block */</span></span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* hide ... if we have text, which is less than or equal to max lines */</span></span><br><span class="line"><span class="selector-class">.block-with-text</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="comment">/* points in the end */</span></span><br><span class="line">  <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">  <span class="comment">/* absolute position */</span></span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="comment">/* set position to right bottom corner of text */</span></span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="comment">/* set width and height */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">0.2em</span>;</span><br><span class="line">  <span class="comment">/* bg color = bg color under block */</span></span><br><span class="line">  <span class="attribute">background</span>: white;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="实现原理">实现原理</h2>
<ol>
<li>大于3行时<br>
:before 的内容&quot;…&quot; 在右下角, 因为文字被justify （text-align: justify;）不会看到文字与&quot;…&quot;之间有空隙:</li>
</ol>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F/more-3-lines.png" alt="大于3行时1"></p>
<p>去除CSS <code>text-align: justify;</code>会看到文字与&quot;…&quot;之间有空隙:<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F/more-3-lines-nonjustified.png" alt="大于3行时2"></p>
<ol start="2">
<li>
<p>小于3行时<br>
看不到&quot;…&quot;<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F/less-3-lines.png" alt="小于3行时"></p>
</li>
<li>
<p>等于3行时<br>
看不到&quot;…&quot;<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/text-overflow-ellipsis-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%9F/equal-3-lines.png" alt="等于3行时"></p>
</li>
</ol>
<h1 id="方法5-纯scss解决-跨浏览器">方法5 纯SCSS解决 &amp; 跨浏览器</h1>
<p>因为方法4中的缺点，所以写了个SCSS mixin。这样的话使用起来也更方便，也有复用性。</p>
<p><strong>CodePen</strong> <a href="https://codepen.io/catherineliyuankun/pen/poJzLKx" target="_blank" rel="noopener">multiline例子链接</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"block-with-text"</span>&gt;</span>1.大于三行例子：最简单的方法，但是很遗憾，它不支持跨浏览器,在Firefox和Internet Explorer中不起作用. CSS属性可以把块容器中的内容限制为指定的行数.它只有在 display属性设置成-webkit-box或者-webkit-inline-box并且-webkit-box-orient属性设置成vertical时才有效果在大部分情况下,也需要设置overflow属性为hidden, 否则,里面的内容不会被裁减,并且在内容显示为指定行数后还会显示省略号(ellipsis )<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"block-with-text"</span>&gt;</span>2.小于一行的例子，不会出现“...”在文末<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"block-with-text"</span> <span class="attr">style</span>=<span class="string">"width: 250px;"</span>&gt;</span>3. 2.5 行的例子: 最简单的方法，但是很遗憾，它不支持跨浏览器,在Firefox和Internet Explorer中不起作用.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">font</span>: <span class="number">400</span> <span class="number">14px</span>/<span class="number">1.2em</span> sans-serif; </span><br><span class="line">  <span class="attribute">background</span>: white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* mixin for multiline */</span></span><br><span class="line"><span class="keyword">@mixin</span> multiLineEllipsis($<span class="attribute">lineHeight:</span> <span class="number">1.2em</span>, $<span class="attribute">lineCount:</span> <span class="number">1</span>, $<span class="attribute">bgColor:</span> white)&#123;</span><br><span class="line">  <span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span>;</span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">relative</span>;</span><br><span class="line">  line-height: $lineHeight;</span><br><span class="line">  max-height: $lineHeight * $lineCount; </span><br><span class="line">  <span class="selector-tag">text-align</span>: <span class="selector-tag">justify</span>;</span><br><span class="line">  <span class="selector-tag">margin-right</span>: <span class="selector-tag">-1em</span>;</span><br><span class="line">  <span class="selector-tag">padding-right</span>: 1<span class="selector-tag">em</span>;</span><br><span class="line">  &amp;<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">'...'</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1em</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1em</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">0.2em</span>;</span><br><span class="line">    <span class="attribute">background</span>: $bgColor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.block-with-text</span> &#123;</span><br><span class="line">  @include multiLineEllipsis($lineHeight: 1.2em, $lineCount: 2, $bgColor: white);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="the-reference-link">The reference link</h1>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/text-overflow" target="_blank" rel="noopener">MDN text-overflow</a></li>
<li><a href="https://blog.csdn.net/weixin_34403976/article/details/102708645" target="_blank" rel="noopener">CSS 设置 /*! autoprefixer: off */ 后控制台报错问题</a></li>
<li><a href="https://juejin.cn/post/6844903848599896072" target="_blank" rel="noopener">怎样使用autoprefixer时保留-webkit-box-orient等样式规则</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>text-overflow</tag>
      </tags>
  </entry>
  <entry>
    <title>囤货灵感</title>
    <url>/%E5%9B%A4%E8%B4%A7%E7%81%B5%E6%84%9F.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="原则">原则</h2>
<p>以下这些，各位要记得有个原则：应该专门有一个区域，“抗疫物资”放在一起。不到万不得已，就不要去动它们，而是趁能买到新鲜的先吃新鲜的。比如速冻箱里有一箱全部是战备肉，先吃菜场里能买到的、叮咚能叫到的其他肉。</p>
<p>食用顺序：新鲜的需冷藏的&gt;常温短期鲜水果蔬菜&gt;冷冻食品&gt;常温可长期保存的干活、罐头</p>
<h2 id="其他装备">其他装备</h2>
<ul>
<li>准备几千块钱现金</li>
</ul>
<h3 id="电器">电器</h3>
<ul>
<li>电
<ul>
<li>汽车电池那么大的充电宝，如果停电了，就可以用它来给手机充电，给热水器烧水，给笔记本充电</li>
<li>手摇发电收音机，兼做电筒还能给手机充电</li>
<li>如果家里用燃气，一定要备好电池，小心打不着火。还有其他各类电池🔋。</li>
<li>太阳能发电设备</li>
<li>蜡烛</li>
</ul>
</li>
<li>冰箱</li>
<li>冰柜！！！
<ul>
<li>是储备冷冻食品的基础，家里冰箱冷冻室有限，一个冰柜可就大多了。</li>
</ul>
</li>
<li>Switch + 健身环，瑜伽垫</li>
<li>扩音器喇叭！
<ul>
<li>关键时期可以喊话、求救，而且可以用来对付不作为的物业，百试不爽。【来源评论区】</li>
</ul>
</li>
</ul>
<h3 id="厨具">厨具</h3>
<p>如果没有锅，拿到的物资很可能是生的米面，蔬菜，那就凉了。。。</p>
<ul>
<li>锅碗瓢盆
<ul>
<li>电饭煲、电磁炉</li>
<li>空气炸锅：因为心情真的很抑郁，想吃甜食、想吃炸物、也想炸个薯条</li>
<li>豆芽机（在蔬菜供应不上的时候就是新鲜蔬菜的来源了）</li>
</ul>
</li>
</ul>
<h3 id="其他">其他</h3>
<ul>
<li>便携工兵铲
<ul>
<li>酒精可以做燃烧瓶，84加洁厕灵可以产氯气，加上便携工兵铲，够你自保。。。【来源评论区】</li>
</ul>
</li>
<li>一次性打火机</li>
<li>净水片，净水壶，大块的塑料布
<ul>
<li>有自来水最好，没有的话找活水用净水片和净水壶过滤，实在不行用洗净的沙石自制多层过滤，还可以配合塑料布收集蒸发水。</li>
</ul>
</li>
</ul>
<h2 id="饮食类">饮食类</h2>
<p>因为冰箱空间有限，也容易坏。所以能够在常温下长期储存的食物是非常宝贵的，也很适合作为战备应急物资来存储。</p>
<h3 id="常温保存">常温保存</h3>
<ul>
<li>
<p>各种饮品：日子很苦，你真的会想要喝杯可乐的。</p>
<ul>
<li>几大桶纯净水，瓶装水，净水装置</li>
<li>常温奶，奶粉</li>
<li>新疆天润奶啤，新疆西域春奶啤</li>
<li>新疆神内胡萝卜汁，石榴汁，番茄汁，黑加仑汁，番石榴汁（补充维生素）</li>
<li>即食麦片、即食谷物粉：当早餐，因为速冻早餐很占面积，一放冰箱就满了，这种一大包油牛奶可以吃很久</li>
<li>咖啡、茶叶：胶囊或者挂耳、又或者三合，不嫌多。</li>
</ul>
</li>
<li>
<p>主食</p>
<ul>
<li>面条（挂面，意面：保质期2-5年）</li>
<li>大米，豆类：买<strong>真空</strong>包装，保存更久</li>
<li>面粉：精粉，杂粮容易潮和变陈。夏天不易保存，可放在密封性好的容器里。</li>
<li>压缩饼干</li>
<li>方便面、自嗨锅、拉面说、螺蛳粉、山姆卖的各种速食面
<ul>
<li>这些食物不占冰箱，很能存储，然后又很有“味道”，清汤寡水吃几天之后来一顿，简直要开心得跳起来。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>肉类</p>
<ul>
<li>腊肉，腊肠等</li>
</ul>
</li>
<li>
<p>调味料、盐、醋、糖、油、花椒、干辣椒：每天自己烧三顿的日子，这些-定要囤。尤其是一些速成调味料，比如红烧汁、照烧汁、寿喜烧汁、糟卤汁…没有餐厅和外卖的日子过久了，这些味道都是莫大的安慰。</p>
</li>
<li>
<p>罐头：不！含！防！腐！剂！，长久储存的原理是隔绝空气，并且便携、保质期长</p>
<ul>
<li>上海【梅林】、厦门【古龙】、昆明【德和】、秦皇岛【北戴河】的肉罐头
<ul>
<li>午餐肉</li>
<li>牛肉罐头：【梅林】红烧牛肉（2年保质期）</li>
<li>秦皇岛【北戴河】牛肉罐头</li>
<li>鹌鹑蛋罐头</li>
<li>鱼罐头
<ul>
<li>【甘竹牌】豆豉鲮鱼（3年保质期）</li>
<li>【梅林】茄汁沙丁鱼（3年保质期）</li>
</ul>
</li>
</ul>
</li>
<li>水果罐头
<ul>
<li>【双象】红毛丹罐头</li>
<li>黄桃罐头
<ul>
<li>大连【真心】</li>
<li>大连/江苏徐州【林家铺子】（2年保质期）</li>
</ul>
</li>
</ul>
</li>
<li>蔬菜罐头
<ul>
<li>新疆【半球红】番茄酱罐头， 新疆【冠农】番茄丁罐头（2年保质期），跟新鲜口感几乎没区别，而且不占冰箱</li>
<li>【梅林】油焖笋罐头（2年保质期）</li>
<li>玉米，青豆，鹰嘴豆</li>
<li>【古龙】花生汤罐头</li>
<li>绿豆汤</li>
<li>雪菜</li>
</ul>
</li>
</ul>
</li>
<li>
<p>常温方便菜（预制菜）</p>
<ul>
<li>【古龙】系列方便菜，（1年保质期）</li>
<li>【双汇】米多面，有不同辣度选择。10-15元之间。（10个月保质期）【锡箔纸包装】可以带袋热水加热或者开袋微波加热食用
<ul>
<li>香菇红烧肉、土豆牛肉、梅菜扣肉、咖喱鸡肉、鱼香肉丝、黑胡椒鸡肉、土豆牛肉7款菜可以选择。</li>
</ul>
</li>
<li>【新美香】方便菜（10个月保质期）亮点：菜品选择多，价格便宜（10个月保质期）【锡箔纸包装】
<ul>
<li>新美香和吉野家、李先生、华莱士等很多快餐企业都有合作，旗下的常温方便菜总共有8款，包括辣子鸡、土豆牛肉、香菇卤肉、鱼香肉丝、辣味三珍、啤酒鸭、咖喱鸡肉、香菇鸡块。</li>
<li>菜量比双汇和古龙稍稍小一点，在170g-200g，不过这个菜量够一小盘了。关键是价格非常便宜，每款菜在6-8元之间，鱼香肉丝3袋才16.9元，已经很接近自己做菜的价格了。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>零食：</p>
<ul>
<li>薯片、饼干：就算时间久了，放空气炸锅烤一烤可以恢复口感</li>
<li>巧克力、干果</li>
<li>牛肉干，鸭舌。</li>
</ul>
</li>
<li>
<p>腌制类食品(酸黄瓜 酸豆角 以及各类酱菜）</p>
</li>
<li>
<p>干货类蔬菜、豆制品：这些新鲜的都放不久，可以囤一些干货，比如菌菇可以烧出菌菇汤，比如裙带菜，发一发无论凉拌还是汤都好喝</p>
<ul>
<li>脱水蔬菜：万年青，干豆角，梅干菜，黄花菜，香菇，海带，紫菜，裙带菜，莴笋片
<ul>
<li>笋干</li>
</ul>
</li>
<li>豆制品：腐竹</li>
<li>粉丝</li>
</ul>
</li>
<li>
<p>常温新鲜蔬菜类</p>
<ul>
<li>蔬菜种子，菌菇包（自己种菜）</li>
<li>蔬菜：洋葱，蒜，生姜，胡萝卜，红薯，土豆，紫薯，芋头，山药
<ul>
<li>马铃薯可以种植，城市内的单元房够自保</li>
</ul>
</li>
<li>黄豆，绿豆， 可发豆芽，煮粥打豆浆</li>
</ul>
</li>
<li>
<p>成瘾品：包含烟、酒、咖啡、可乐、茶</p>
<ul>
<li>注意，哪怕你没有这些嗜好，也可以准备一点，万一被封，成瘾品短期会很稀缺，以物易物的价值很高。 玩过生存类游戏的都知道，特殊情况下烟和酒是硬通货，比黄金还厉害。</li>
</ul>
</li>
</ul>
<h3 id="冷冻冷藏">冷冻冷藏</h3>
<p>放冰箱的东西可以去掉包装省空间。</p>
<h4 id="冷藏">冷藏</h4>
<ul>
<li>鸡蛋：以一家四口来说，冰箱存60个鸡蛋绝对不多，也就够15天。</li>
<li>黄油：烘焙</li>
<li>蔬菜：花菜，西兰花，青豆，玉米，白萝卜，蘑菇，大白菜</li>
</ul>
<h4 id="冷冻">冷冻</h4>
<ul>
<li>肉类和海鲜：牛排、猪肉、海鲜、鸡胸鸡腿鸡翅这种冻品就把速冻箱塞满为界</li>
<li>切片面包，冷冻起来，每次吃微波炉、锅子热下就好。</li>
<li>水果：蓝莓，莓果，芒果，香蕉</li>
<li>肉类海鲜：可以生的冷冻 也可以腌制好了冷冻 冷冻海鲜尽量挑选真空包装的 而不是食材本身包了厚厚一层冰占用额外空间</li>
<li>根茎类：胡萝卜，红薯，土豆，紫薯，芋头，山药 含水量少冷冻不会影响口感
<ul>
<li>笋（大块仅去皮，都是烫过后连水一起打包。）</li>
<li>成品冷冻蔬菜</li>
</ul>
</li>
</ul>
<h2 id="药品类">药品类</h2>
<p>有些药可以通过放冷藏来更好的保存。</p>
<ul>
<li>抗生素：头孢，阿司匹林肠溶片，红霉素类广谱抗菌等</li>
<li>感冒药 连花清瘟，白加黑，美林、泰诺林、</li>
<li>缓解痛经的药：优思明，止痛药</li>
<li>止痛药：布洛芬、割伤、烧伤（百多邦、京万红）</li>
<li>酒精</li>
<li>碘伏，云南白药</li>
<li>外用的绷带，医用纱布，胶带、棉签、创可贴</li>
<li>肠胃： 东北盐酸小檗碱片（黄莲素片）瓶装100粒，泻立停，蒙脱石散，肠炎宁</li>
<li>维生素，防止缺乏蔬菜得什么奇怪病。</li>
<li>眼药水</li>
<li>褪黑素</li>
</ul>
<p>每家根据自己情况来。有孩子的请提前去医生那里开好常备药：比如容易过敏的开仙特敏，容易喘的可能要万托林….都趁医院没有封控前去开好。<br>
如果家里有老人和小孩，请确保你加上常看的医生的微信，紧急情况下可以求助。</p>
<h2 id="生活日用品">生活日用品</h2>
<ul>
<li>厕所纸、卫生巾、湿纸巾、卷筒纸、厨房用纸、避孕套</li>
<li>洗发水、沐浴露、洗衣液、厨房清洁剂、垃圾袋。</li>
<li>面霜、护肤水、眼霜</li>
</ul>
<h3 id="消杀类">消杀类</h3>
<ul>
<li>医用酒精，84消毒液，消毒洗手液，洁厕灵</li>
<li>喷壶，一次性雨衣、鞋套多个</li>
</ul>
<p>每个单元可以固定把一楼分割开，用来做消杀，出门戴头盔穿雨衣，过了一楼消杀区换鞋套回家，外出用的头盔雨衣和鞋子不要进居住区，基本够外出购物收集物资的</p>
<h3 id="有孩子的话">有孩子的话</h3>
<ul>
<li>尿布、奶粉、湿纸巾。</li>
<li>婴儿奶粉</li>
<li>家有大孩子，请多买点新书、新桌游、新乐高。</li>
</ul>
<h3 id="有宠物的话">有宠物的话</h3>
<ul>
<li>猫粮、狗粮、罐头、冻干</li>
<li>驱虫，肠胃，皮肤等常备药</li>
<li>猫砂</li>
</ul>
<h1 id="参考文章">参考文章</h1>
<ul>
<li><a href>iKids 微信公众号：万一你也要经历这一切，请先囤好这一些</a> （原文已被删除，所以此处无链接）</li>
<li><a href="https://mp.weixin.qq.com/s/eqax1yGOwlS1crAeR9lGQA" target="_blank" rel="noopener">小声比比 微信公众号：分享下我这两天囤的东西（无广告，有广告我阳痿60年）</a></li>
<li><a href="https://mp.weixin.qq.com/s/NGfh2vIU34TG2B-bUOfN9w" target="_blank" rel="noopener">九边 微信公众号：如果疫情继续，普通人应该如何生活</a></li>
<li>各种评论讨论</li>
</ul>
]]></content>
      <categories>
        <category>LIFE</category>
      </categories>
      <tags>
        <tag>疫情日记</tag>
      </tags>
  </entry>
  <entry>
    <title>各编程语言对比总结-Java, JavaScript, Python, C, C++</title>
    <url>/%E5%90%84%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%AF%B9%E6%AF%94%E6%80%BB%E7%BB%93-Java-JavaScript-Python-C-C.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="基础数据类型">基础数据类型</h2>
<table>
<thead>
<tr>
<th>​<strong>类型/语言</strong></th>
<th>JavaScript</th>
<th>Java</th>
<th>Python</th>
<th>C</th>
<th>C++</th>
</tr>
</thead>
<tbody>
<tr>
<td>​<strong>整数类型</strong></td>
<td><code>number</code>（64位双精度浮点数，统一整数和浮点）<a href="@ref">1</a></td>
<td><code>byte</code>（8位，-128~127）、<code>short</code>（16位）、<code>int</code>（32位）、<code>long</code>（64位）</td>
<td><code>int</code>（动态精度，理论无限大）</td>
<td><code>short</code>（16位）、<code>int</code>（32位）、<code>long</code>（32/64位）、<code>long long</code>（64位）</td>
<td>同 C，新增固定宽度类型（如 <code>int32_t</code>、<code>int64_t</code>）<a href="@ref">1,3</a></td>
</tr>
<tr>
<td>​<strong>浮点数类型</strong></td>
<td><code>number</code>（64位双精度）<a href="@ref">1</a></td>
<td><code>float</code>（32位）、<code>double</code>（64位）</td>
<td><code>float</code>（64位双精度）</td>
<td><code>float</code>（32位）、<code>double</code>（64位）、<code>long double</code>（80/128位）</td>
<td>同 C，支持 <code>long double</code>（更高精度，80/128位）<a href="@ref">3,5</a></td>
</tr>
<tr>
<td>​<strong>字符类型</strong></td>
<td>无独立类型，用 <code>string</code> 表示</td>
<td><code>char</code>（16位 Unicode）</td>
<td>无独立类型，用长度为1的 <code>str</code> 表示</td>
<td><code>char</code>（8位，-128~127）</td>
<td><code>char</code>（同 C），新增 <code>wchar_t</code>（宽字符，16/32位）<a href="@ref">1,3</a></td>
</tr>
<tr>
<td>​<strong>布尔类型</strong></td>
<td><code>boolean</code>（<code>true</code>/<code>false</code>）</td>
<td><code>boolean</code>（逻辑值，JVM 依赖）</td>
<td><code>Bpytool</code>（继承自 <code>int</code>，True=1，False=0）</td>
<td><code>_Bool</code>（C99+，0/1）<a href="@ref">4</a></td>
<td><code>bool</code>（<code>true</code>/<code>false</code>，1字节）<a href="@ref">1,2</a></td>
</tr>
<tr>
<td>​<strong>空值表示</strong></td>
<td><code>null</code>、<code>undefined</code></td>
<td>原始类型无空值（引用类型默认 <code>null</code>， null 不能直接赋值给基本类型（如 int、boolean），否则会导致编译错误）</td>
<td><code>None</code>（NoneType 数据类型的唯一值）</td>
<td><code>NULL</code>（空指针宏）<a href="@ref">2</a></td>
<td><code>nullptr</code>（类型安全空指针，C++11+）<a href="@ref">2,5</a></td>
</tr>
<tr>
<td>大整数支持</td>
<td>BigInt（ES2020+，后缀 n，支持任意精度整数）</td>
<td>无原生支持，需通过 BigInteger 类</td>
<td>原生 int 支持任意精度，无需特殊类型</td>
<td></td>
<td></td>
</tr>
<tr>
<td>​<strong>特殊类型</strong></td>
<td><code>Symbol</code>（唯一标识符）</td>
<td>无</td>
<td>无</td>
<td>指针（<code>*</code>）、联合体（<code>union</code>）、枚举（<code>enum</code>）<a href="@ref">4</a></td>
<td>引用（<code>&amp;</code>）、类（<code>class</code>）、模板（泛型）<a href="@ref">2,5</a></td>
</tr>
<tr>
<td>​<strong>类型转换规则</strong></td>
<td>隐式转换频繁（如 <code>&quot;5&quot; + 2 = &quot;52&quot;</code>）</td>
<td>严格类型检查，窄化需显式强制转换</td>
<td>隐式转换仅限数字，其他需显式转换</td>
<td>隐式转换宽松（如 <code>int</code> 转 <code>float</code>），强制转换用 <code>(type)</code><a href="@ref">4</a></td>
<td>支持显式转换（<code>static_cast</code>、<code>reinterpret_cast</code> 等）<a href="@ref">5</a></td>
</tr>
<tr>
<td>​<strong>内存管理</strong></td>
<td>自动垃圾回收</td>
<td>自动垃圾回收（对象堆分配）</td>
<td>自动垃圾回收</td>
<td><code>malloc</code>/<code>free</code>（手动）<a href="@ref">4</a></td>
<td><code>new</code>/<code>delete</code>（面向对象），兼容 C 风格<a href="@ref">5</a></td>
</tr>
<tr>
<td>​<strong>类型系统特性</strong></td>
<td>动态弱类型</td>
<td>静态强类型</td>
<td>动态强类型</td>
<td>弱类型（无编译时检查）<a href="@ref">4</a></td>
<td>强类型（支持编译时检查，引入 <code>const</code> 和类型转换操作符）<a href="@ref">1,5</a></td>
</tr>
</tbody>
</table>
<h3 id="关键差异总结">关键差异总结</h3>
<ol>
<li>​整数与浮点数</li>
</ol>
<ul>
<li>​C/C++：明确区分位宽（如 short、long），C++扩展 long long58。</li>
<li>​Java：严格固定位宽（如 int=32位）。</li>
<li>​Python/JS：动态类型，无固定位宽限制。</li>
</ul>
<ol start="2">
<li>
<p>​布尔类型<br>
​C：依赖C99的 _Bool，本质是整数0/19。<br>
​C++：原生 bool，逻辑更清晰6。<br>
​Python：bool 是 int 的子类，兼容1/0。</p>
</li>
<li>
<p>​空值与指针<br>
​C：NULL 是宏定义的 (void*)0，易引发类型问题。<br>
​C++：nullptr 类型安全，避免歧义。<br>
​Java：原始类型无空值，引用类型默认 null。Java 的 null 是引用类型变量的“无值”状态，需通过判空和规范使用避免 NullPointerException。理解其特性（如类型限制、默认值规则）是编写健壮代码的基础，而与其他语言的对比则体现了 Java 在类型安全上的设计取舍。<br>
JavaScript 有 null 和 undefined<br>
Python 用 None</p>
<table>
<thead>
<tr>
<th>语言</th>
<th>​空值表示</th>
<th>​特性</th>
</tr>
</thead>
<tbody>
<tr>
<td>​Java</td>
<td>null</td>
<td>仅用于引用类型，强制类型安全，需显式判空。</td>
</tr>
<tr>
<td>​Python</td>
<td>None</td>
<td>类似 null，但所有变量均为对象，无基本类型限制。</td>
</tr>
<tr>
<td>​C++</td>
<td>NULL</td>
<td>宏定义为 0 或 nullptr（C++11+），用于指针类型。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>类型安全与转换<br>
​C/C++：C允许隐式危险转换，C++引入显式转换操作符增强安全性。<br>
​Java：编译时严格检查，避免隐式窄化转换。</p>
</li>
<li>
<p>​内存管理<br>
​C/C++：手动管理（malloc/new），C++支持RAII和智能指针。<br>
​其他语言：自动垃圾回收，减少内存泄漏风险。</p>
</li>
<li>
<p>​类型系统：<br>
​JavaScript：动态弱类型，仅 number 统一表示数字78。<br>
​Java：静态强类型，8种原始类型均有固定位数和范围1011。<br>
​Python：动态强类型，基本类型为对象，但 int 支持无限精度1213。</p>
</li>
<li>
<p>​数值精度：<br>
JavaScript 和 Python 的浮点数均为64位双精度，但 Java 提供单/双精度选项71012。<br>
大整数支持：JavaScript 需 BigInt，Java 依赖类库，Python 原生支持81012。</p>
</li>
<li>
<p>​字符处理：<br>
仅 Java 有独立 char 类型，JavaScript 和 Python 用字符串表示字符71012。</p>
</li>
<li>
<p>​类型安全：<br>
Java 最严格（编译时类型检查），JavaScript 和 Python 更灵活但易产生隐式错误。<br>
此表格综合了三者在设计哲学和应用场景上的差异：JavaScript 强调灵活性，Java 注重性能与类型安全，Python 以简洁和动态性见长。</p>
</li>
</ol>
<h3 id="补充说明">​补充说明</h3>
<p>​C++特有类型：引用（变量别名）、类对象、模板（泛型）、智能指针（如 std::unique_ptr）。<br>
​C语言局限：无原生面向对象支持，需通过结构体和函数指针模拟。<br>
​跨语言对比：C/C++注重底层控制，Java/Python/JS侧重开发效率与安全性。</p>
<h2 id="操作符">操作符</h2>
<table>
<thead>
<tr>
<th>操作符类别</th>
<th>JavaScript</th>
<th>Java</th>
<th>Python</th>
<th>C/C++</th>
<th>异同说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>算术运算符</strong></td>
<td><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>**</code> (ES6)</td>
<td><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>Math.pow()</code></td>
<td><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>**</code> (幂)</td>
<td><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>pow()</code></td>
<td>- <code>/</code>：Python和JS中整数除法结果为浮点，Java/C/C++中整数除法取整<a href="@ref">1,5</a><br>- <code>**</code>：Python和JS支持幂运算，C/C++/Java需调用函数<a href="@ref">10</a></td>
</tr>
<tr>
<td><strong>赋值运算符</strong></td>
<td><code>=</code>, <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code></td>
<td><code>=</code>, <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code></td>
<td><code>=</code>, <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code></td>
<td><code>=</code>, <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code></td>
<td>- <code>++</code>/<code>--</code>：C/C++/Java/JS支持自增自减，Python不支持<a href="@ref">1,10</a></td>
</tr>
<tr>
<td><strong>比较运算符</strong></td>
<td><code>==</code>, <code>===</code>, <code>!=</code>, <code>!==</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code></td>
<td><code>==</code>, <code>!=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code></td>
<td><code>==</code>, <code>!=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>is</code></td>
<td><code>==</code>, <code>!=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code></td>
<td>- <code>===</code>：JS严格比较值和类型，其他语言无此符<a href="@ref">8</a><br>- <code>is</code>：Python比较对象身份（内存地址）<a href="@ref">8</a></td>
</tr>
<tr>
<td><strong>逻辑运算符</strong></td>
<td><code>&amp;&amp;</code>, <code>\|\|</code>, <code>!</code></td>
<td><code>&amp;&amp;</code>, <code>\|\|</code>, <code>!</code></td>
<td><code>and</code>, <code>or</code>, <code>not</code></td>
<td><code>&amp;&amp;</code>, <code>\|\|</code>, <code>!</code></td>
<td>- Python用关键字，其他语言用符号<a href="@ref">10</a></td>
</tr>
<tr>
<td><strong>位运算符</strong></td>
<td><code>&amp;</code>, <code>\|</code>, <code>^</code>, <code>~</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>&gt;&gt;&gt;</code></td>
<td><code>&amp;</code>, <code>\|</code>, <code>^</code>, <code>~</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>&gt;&gt;&gt;</code></td>
<td><code>&amp;</code>, <code>\|</code>, <code>^</code>, <code>~</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code></td>
<td><code>&amp;</code>, <code>\|</code>, <code>^</code>, <code>~</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code></td>
<td>- <code>&gt;&gt;&gt;</code>：JS/Java无符号右移，Python/C/C++无此操作符<a href="@ref">6,10</a></td>
</tr>
<tr>
<td><strong>成员/类型检查</strong></td>
<td><code>in</code>, <code>instanceof</code></td>
<td><code>instanceof</code></td>
<td><code>in</code>, <code>isinstance()</code></td>
<td>无</td>
<td>- <code>in</code>：JS检查对象属性，Python检查可迭代对象成员<a href="@ref">8,11</a><br>- C/C++无内置操作符</td>
</tr>
<tr>
<td><strong>其他操作符</strong></td>
<td><code>typeof</code>, <code>?.</code> (可选链)</td>
<td><code>instanceof</code>, <code>?:</code> (三元)</td>
<td><code>**</code> (幂), <code>//</code> (整除)</td>
<td><code>-&gt;</code> (指针), <code>::</code> (作用域)</td>
<td>- <code>?.</code>：JS可选链避免空值错误，其他语言无<a href="@ref">11</a><br>- <code>-&gt;</code>：C/C++指针成员访问<a href="@ref">8</a></td>
</tr>
</tbody>
</table>
<h3 id="关键差异说明">关键差异说明</h3>
<ol>
<li>
<p><strong>类型松散性</strong></p>
<ul>
<li>JavaScript和Python：动态类型，操作符可能隐式转换类型（如<code>&quot;5&quot; + 2</code>在JS中为<code>&quot;52&quot;</code>）<a href="@ref">8,9</a>。</li>
<li>Java/C/C++：静态类型，操作符两侧需类型严格匹配（如<code>int + String</code>会报错）<a href="@ref">1,8</a>。</li>
</ul>
</li>
<li>
<p><strong>字符串比较</strong></p>
<ul>
<li>JS用<code>==</code>比较值，<code>===</code>比较值和类型；Java用<code>.equals()</code>比较内容，<code>==</code>比较引用<a href="@ref">1,7</a>。</li>
<li>Python用<code>==</code>比较值，<code>is</code>比较对象身份（类似Java的<code>==</code>）<a href="@ref">8,9</a>。</li>
</ul>
</li>
<li>
<p><strong>运算符重载</strong></p>
<ul>
<li>C++：支持操作符重载（如自定义<code>+</code>行为）<a href="@ref">2,5</a>。</li>
<li>Java/JavaScript：不支持操作符重载（除<code>+</code>用于字符串拼接）<a href="@ref">7,10</a>。</li>
</ul>
</li>
</ol>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Language</category>
      </categories>
      <tags>
        <tag>TODO</tag>
      </tags>
  </entry>
  <entry>
    <title>相对路径Vs绝对路径 &amp; sendRedict</title>
    <url>/%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84Vs%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84-sendRedict.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- ## 相对路径Vs绝对路径 -->
<h2 id="相对url-vs-绝对url">相对URL Vs 绝对URL</h2>
<h3 id="uri">URI</h3>
<ul>
<li><code>URI</code> (<code>Uniform Resource Identifier</code>)：<a href="https://developer.mozilla.org/en-US/docs/Glossary/URI" target="_blank" rel="noopener">统一资源标志符</a>。 A <code>URI</code>  is a string that refers to a resource.
<ul>
<li>
<p><code>URL</code> (<code>Univeral Resource Locator</code>): <a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_URL" target="_blank" rel="noopener">统一资源定位符</a></p>
<blockquote>
<p>The most common are URLs, which identify the resource by giving its location on the Web.</p>
</blockquote>
</li>
<li>
<p><code>URN</code>(<code>Univeral Resource Name</code>) <a href="https://developer.mozilla.org/en-US/docs/Glossary/URN" target="_blank" rel="noopener">统一资源定名称</a></p>
<blockquote>
<p>by contrast, refer to a resource by a name, in a given namespace, such as the <code>ISBN</code> of a book. URN (Uniform Resource Name) is a URI in a standard format, referring to a resource without specifying its location or whether it exists. This example comes from RFC3986: urn:oasis:names:specification:docbook:dtd:xml:4.1.2</p>
</blockquote>
<p><code>URN</code>只命名资源而不指定如何定位资源，例如：urn:isbn:0451450523 指定了一本书的<code>ISBN</code>，可以唯一标识这本书，但没有指定到哪里定位这本书。</p>
</li>
</ul>
</li>
</ul>
<p><code>URL</code>和<code>URN</code>都是<code>URI</code>的子集。</p>
<h3 id="url结构">URL结构</h3>
<p><img src="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/Web_mechanics/What_is_a_URL/mdn-url-all.png" alt="URL结构"></p>
<p><code>Scheme</code>(Protocol), <code>Domain name</code>(Host), <code>Port</code>, <code>Path</code>, <code>Parameters</code>(queryString) and <code>Anchor</code>(#, also known as the <code>fragment identifier</code>).</p>
<h3 id="valid-相对url-vs-绝对url">Valid 相对URL Vs 绝对URL</h3>
<p>The <a href="https://url.spec.whatwg.org/#absolute-url-string" target="_blank" rel="noopener">URL standard</a> defines</p>
<ul>
<li><a href="https://url.spec.whatwg.org/#absolute-url-string" target="_blank" rel="noopener">absolute URL string</a>: A URI is absolute if, and only if, it has a <code>scheme</code> component.</li>
<li><a href="https://url.spec.whatwg.org/#relative-url-string" target="_blank" rel="noopener">relative URL string</a>, to distinguish them from <a href="https://url.spec.whatwg.org/#url" target="_blank" rel="noopener">URL objects</a> (which are in-memory representations of URLs).</li>
</ul>
<blockquote>
<p>A URL specifies the location of a target stored on a local or networked computer. The target can be a file, directory, HTML page, image, program, and so on.</p>
</blockquote>
<blockquote>
<p>An <code>absolute URL</code> contains all the information necessary to locate a resource.</p>
</blockquote>
<blockquote>
<p>A <code>relative URL</code> locates a resource using an absolute URL as a starting point. In effect, the “complete URL” of the target is specified by concatenating the absolute and relative URLs.</p>
</blockquote>
<blockquote>
<p>An absolute URL uses the following format: scheme://server/path/resource</p>
</blockquote>
<blockquote>
<p>A relative URL typically consists only of the path, and optionally, the resource, but no scheme or server. The following tables define the individual parts of the complete URL format.</p>
</blockquote>
<h3 id="判断相对路径or绝对路径">判断相对路径Or绝对路径</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// java/net/URI.java</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Tells whether or not this URI is absolute.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt; A URI is absolute if, and only if, it has a scheme component. &lt;/p&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>  &#123;<span class="doctag">@code</span> true&#125; if, and only if, this URI is absolute</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAbsolute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scheme != <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="url参考文章">URL参考文章</h3>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_URL" target="_blank" rel="noopener">What is a URL?</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Learn/Common_questions/What_is_a_URL" target="_blank" rel="noopener">What is a URL? 中文版</a></li>
<li><a href="https://stackoverflow.com/questions/15641694/are-uris-case-insensitive" target="_blank" rel="noopener">Are URIs case-insensitive?</a></li>
<li><a href="https://url.spec.whatwg.org/#urls" target="_blank" rel="noopener">URL, valid URL string, URL parser, and URL serializer</a></li>
<li><a href="https://stackoverflow.com/questions/15291307/relative-url-containing-just-the-querystring" target="_blank" rel="noopener">Relative URL containing just the querystring</a></li>
<li><a href="https://stackoverflow.com/questions/10687099/how-to-test-if-a-url-string-is-absolute-or-relative" target="_blank" rel="noopener">How to test if a URL string is absolute or relative in javascript?</a></li>
<li><a href="https://stackoverflow.com/questions/4390800/determine-if-a-string-is-absolute-url-or-relative-url-in-java" target="_blank" rel="noopener">determine if a string is absolute URL or relative URL in java</a></li>
</ul>
<h2 id="html-file-paths">HTML File Paths</h2>
<p>当前页面如果是<code>https://www.w3schools.com/html/tryit.asp?filename=tryhtml_files_absoulute</code> 和 <code>http://localhost:8080/webapp/servlet/web</code></p>
<table>
<thead>
<tr>
<th>分类</th>
<th>Relative Path</th>
<th>Absolute Path</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1 相对当前路径 <code>.</code>表示当前路径，在通道情况下可以省略，只有在特殊的情况下不能省略</td>
<td><code>&lt;img src=&quot;picture.jpg&quot;&gt;</code></td>
<td><code>https://www.w3schools.com/html/picture.jpg</code> <code>http://localhost:8080/webapp/servlet/picture.jpg</code></td>
<td>The “picture.jpg” file is located in <strong>the same folder as the current page</strong></td>
</tr>
<tr>
<td>.</td>
<td><code>&lt;img src=&quot;./picture.jpg&quot;&gt;</code></td>
<td><code>https://www.w3schools.com/html/picture.jpg</code> <code>http://localhost:8080/webapp/servlet/picture.jpg</code></td>
<td>The “picture.jpg” file is located in <strong>the same folder as the current page</strong></td>
</tr>
<tr>
<td><code>././</code>同<code>./</code></td>
<td><code>&lt;img src=&quot;././picture.jpg&quot;&gt;</code></td>
<td><code>https://www.w3schools.com/html/picture.jpg</code> <code>http://localhost:8080/webapp/servlet/picture.jpg</code></td>
<td>The “picture.jpg” file is located in <strong>the same folder as the current page</strong></td>
</tr>
<tr>
<td>.</td>
<td><code>&lt;img src=&quot;images/picture.jpg&quot;&gt;</code></td>
<td><code>https://www.w3schools.com/html/images/picture.jpg</code> <code>http://localhost:8080/webapp/servlet/images/picture.jpg</code></td>
<td>The “picture.jpg” file is located in the images folder in the <strong>current folder</strong></td>
</tr>
<tr>
<td>queryString</td>
<td><code>&lt;a href=&quot;?filename=tryhtml_files_relative&quot;&gt;Next&lt;/a&gt;</code></td>
<td><code>https://www.w3schools.com/html/tryit.asp?filename=tryhtml_files_relative</code></td>
<td>The “picture.jpg” file is located <strong>the same folder as the current page</strong></td>
</tr>
<tr>
<td>2 相对根路径</td>
<td><code>&lt;img src=&quot;/images/picture.jpg&quot;&gt;</code></td>
<td><code>https://www.w3schools.com/images/picture.jpg</code> <code>http://localhost:8080/images/picture.jpg</code></td>
<td>The “picture.jpg” file is located in the images folder at the <strong>root of the current web</strong></td>
</tr>
<tr>
<td>3 相对上一层路径</td>
<td><code>&lt;img src=&quot;../picture.jpg&quot;&gt;</code></td>
<td><code>https://www.w3schools.com/picture.jpg</code> <code>http://localhost:8080/webapp/picture.jpg</code></td>
<td>The “picture.jpg” file is located in the folder <strong>one level up</strong> from the current folder</td>
</tr>
<tr>
<td>上两层，有几个<code>../</code>，就向上跳几级</td>
<td><code>&lt;img src=&quot;../../picture.jpg&quot;&gt;</code></td>
<td>因为…/已经到根目录，…/…/无法再向上一层目录<code>https://www.w3schools.com/picture.jpg</code> <code>http://localhost:8080/picture.jpg</code></td>
<td>The “picture.jpg” file is located in the folder <strong>two level up</strong> from the current folder</td>
</tr>
<tr>
<td>上一层</td>
<td><code>&lt;img src=&quot;.././picture.jpg&quot;&gt;</code></td>
<td><code>https://www.w3schools.com/picture.jpg</code> <code>http://localhost:8080/webapp/picture.jpg</code></td>
<td>The “picture.jpg” file is located in the folder <strong>one level up</strong> from the current folder</td>
</tr>
<tr>
<td><code>./</code> 和<code>../</code>可结合多个一起使用</td>
<td><code>&lt;img src=&quot;../images/.././picture.jpg&quot;&gt;</code></td>
<td><code>https://www.w3schools.com/picture.jpg</code> <code>http://localhost:8080/webapp/picture.jpg</code></td>
<td>The “picture.jpg” file is located in the folder <strong>one level up</strong> from the current folder</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRealPath</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="keyword">var</span> curPath = <span class="built_in">window</span>.document.location.href; <span class="comment">// 'https://www.w3schools.com/html/tryit.asp?filename=tryhtml_files_absoulute'</span></span><br><span class="line">   <span class="keyword">var</span> pathName = <span class="built_in">window</span>.document.location.pathname; <span class="comment">// '/html/tryit.asp'</span></span><br><span class="line">   <span class="keyword">var</span> localhostPath=curPath.substring(<span class="number">0</span>, curPath.indexOf(pathName)); <span class="comment">// 'https://www.w3schools.com'</span></span><br><span class="line">   <span class="keyword">var</span> projectName = pathName.substring(<span class="number">0</span>,pathName.substr(<span class="number">1</span>).indexOf(<span class="string">'/'</span>)+<span class="number">1</span>); <span class="comment">// '/html'</span></span><br><span class="line">   <span class="keyword">return</span> localhostPath + projectName; <span class="comment">// 'https://www.w3schools.com/html'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="html-file-paths参考文章">HTML File Paths参考文章</h3>
<ul>
<li><a href="https://www.w3schools.com/html/html_filepaths.asp" target="_blank" rel="noopener">HTML File Paths</a></li>
</ul>
<h2 id="web-servlet-sendredict-使用相对路径">Web Servlet <code>sendRedict()</code> 使用相对路径</h2>
<p>可以使用相对URL作为sendRedirect的参数，而不是指定完整的&quot;http:/www…”.<br>
<code>相对URL</code>有两种类型：</p>
<ul>
<li>前面有斜线(“/”): 相对于web容器的根目录（relative to the root of this web Container）。</li>
<li>没有斜线： 相对于当前路径。</li>
</ul>
<blockquote>
<p>You can use a relative URL as the argument to sendRedirect(), instead of specifying the whole “<a href="http://www" target="_blank" rel="noopener">http://www</a>…” thing. Relative URLs come in two flavors: with or without a starting forward slash (“/”).</p>
</blockquote>
<p><code>sendRedirect</code>能够处理相对URL，自动把它们转换成绝对URL，如果地址是相对的，没有一个‘/’，那么Web container就认为它是相对于当前的请求URI的。</p>
<ul>
<li>如果为<code>response.sendRedirect(&quot;login.jsp&quot;)</code>，则会从当前servlet 的URL路径下找login.jsp： <code>http://10.1.18.8:8081/dms/servlet/Servlet</code> 重定向的URL: <code>http://10.1.18.8:8081/dms/servlet/login.jsp</code></li>
<li>如果为<code>response.sendRedirect(&quot;/login.jsp&quot;)</code>则会从当前应用路径下查找url: <code>http://10.1.18.8:8081/login.jsp</code>。而forward不能这样处理相对路径。</li>
</ul>
<h3 id="相对url-without">相对URL without “/”</h3>
<p>假设客户原来所在页面是：</p>
<!-- > Imagine the client originally typed in: -->
<p><code>http://www.wickedlysmart.com/myApp/cool/bar.do</code></p>
<p>相对URL没有用斜线开头：</p>
<p><img src="https://www.oreilly.com/library/view/head-first-servlets/9780596516680/httpatomoreillycomsourceoreillyimages2242605.png.jpg" alt></p>
<p>容器会相对于原先的请求URL建立完整的URL（需要把它放在HTTP响应<br>
的“Location”首部中）<br>
<code>http://www.wickedlysmart.com/myApp/cool/foo/stuff.html</code></p>
<h3 id="相对url-with">相对URL with “/”</h3>
<blockquote>
<p>But if the argument to sendRedirect() DOES start with a forward slash: <code>sendRedirect(&quot;/foo/stuff.html')</code><br>
The Container builds the complete URL relative to the web Container itself, instead of relative to the original URL of the request. So the new URL will be:</p>
</blockquote>
<p>但是如果sendRedirecto的参数确实以一个斜线开头：</p>
<p><img src="https://www.oreilly.com/library/view/head-first-servlets/9780596516680/httpatomoreillycomsourceoreillyimages2242607.png.jpg" alt></p>
<p>容器就会相对于Web应用本身建立完整的URL，而不是相对于请求原来的URL。 所以新的URL是：</p>
<p><img src="https://www.oreilly.com/library/view/head-first-servlets/9780596516680/httpatomoreillycomsourceoreillyimages2242609.png.jpg" alt></p>
<blockquote>
<p><strong>WATCH IT!</strong><br>
<strong>You can’t do a sendRedirect() after writing to the response!</strong><br>
That’s probably obvious, but it’s the LAW so we’re just making sure.<br>
If you look up sendRedirect() in the API, you’ll see that it throws an IllegalStateException if you try to invoke it after “the response has already been committed.”<br>
By “committed”, they mean that the response has been sent. That just means the data has been flushed to the stream.<br>
For practical purposes, it means <strong>you can’t write to the response and then call sendRedirect()!</strong><br>
But some picky professor will tell you that technically, you could write to the stream without flushing, and then sendRedirect() wouldn’t cause an exception. But it would be a completely stupid thing to do, so we won’t talk about it. (Except that we just did… talk about it…)<br>
In your servlet, for gosh sakes make a decision! Either handle the request or do a sendRedirect() to have someone ELSE handle the request.<br>
(By the way, this idea that “once it’s committed it’s too late” also applies to setting headers, cookies, status codes, the content-type, and so on…)</p>
</blockquote>
<blockquote>
<p><strong>NOTE</strong><br>
<strong>sendRedirect() takes a String, NOT a URL object!</strong><br>
Well, it takes a String that IS a URL. The point is, sendRedirect() does NOT take an object of type URL. You pass it a String that’s either a complete URL or a relative one. If the Container can’t build a relative URL into a full one, it’ll throw an IllegalStateException. The tricky part is to remember that THIS is wrong: sendRedirect(new URL(“<a href="http://www.oreilly.com" target="_blank" rel="noopener">www.oreilly.com</a>”));</p>
</blockquote>
<h3 id="servlet参考文章">Servlet参考文章</h3>
<ul>
<li><a href="https://www.codejava.net/java-ee/servlet/how-to-send-redirect-from-java-servlet" target="_blank" rel="noopener">How to send redirect from Java Servlet</a></li>
<li><a href="https://learning.oreilly.com/library/view/head-first-servlets/9780596516680/ch04s27.html" target="_blank" rel="noopener">Using relative URLs in sendRedirect()</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>程序员-MAC 重新装机必备2命令行+环境配置</title>
    <url>/%E7%A8%8B%E5%BA%8F%E5%91%98-MAC-%E9%87%8D%E6%96%B0%E8%A3%85%E6%9C%BA%E5%BF%85%E5%A4%872%E5%91%BD%E4%BB%A4%E8%A1%8C-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="terminal-设置">Terminal 设置</h1>
<ul>
<li>
<p>[x] <a href="https://www.warp.dev/" target="_blank" rel="noopener">Warp</a> <a href="https://github.com/warpdotdev/Warp" target="_blank" rel="noopener">Git开源</a> The terminal for the 21st century。</p>
<ul>
<li>Warp解决第一个痛点，是通过减少配置、方便输入，优化输出，增加常用命令行自动提示(通过fig)，方便查看历史记录，可定义流程，等等。</li>
<li>解决第二个痛点，则是增加协作功能。例如可以共享自己的命令行、设置项、历史记录。</li>
<li><a href="https://www.warp.dev/blog/introducing-warp-ai" target="_blank" rel="noopener">Warp AI</a>： 可以直接问Warp AI怎样write script 来实现特定功能。</li>
</ul>
</li>
<li>
<p>[x] Terminal 用 <a href="https://www.iterm2.com/" target="_blank" rel="noopener"><strong>iTerm2</strong></a> + <a href="https://en.wikipedia.org/wiki/Z_shell" target="_blank" rel="noopener"><strong>zsh</strong></a> + <a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener"><strong>oh-my-zsh</strong></a> 的组合，主题是 <a href="https://github.com/robbyrussell/oh-my-zsh/blob/master/themes/robbyrussell.zsh-theme" target="_blank" rel="noopener">robbyrussell</a>.<br>
配置方法参考文章： <a href="../oh-my-zsh%E7%BB%84%E5%90%88%E4%BD%A0%E7%9A%84terminal.html">iterm2+oh-my-zsh组合你的terminal</a>.</p>
</li>
<li>
<p>[x] zsh 的插件开了 git、autojump、brew、git、git-extra、git-flow、git-prompt、git-remote-branch、github、gitignore、history、history-substring-search、iterm2、node、npm、npx、nvm、tig、vscode、yarn、<a href="https://github.com/zsh-users/zsh-autosuggestions" target="_blank" rel="noopener">zsh-autosuggestions</a>、<a href="https://wakatime.com/terminal" target="_blank" rel="noopener">命令行安装WakaTime</a></p>
</li>
<li>
<p><a href="http://liyuankun.top/%E5%A5%A5%E5%88%A9%E7%BB%99%E4%BD%A0%E7%9A%84iTerm2-%E5%BF%AB%E9%80%9F%E7%94%A8IDE%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6.html#mac-%E9%85%8D%E7%BD%AEfinder%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%89%93%E5%BC%80iterm2">Mac 配置在Finder里用iTerm2打开当前目录</a></p>
<ul>
<li><a href="https://apps.apple.com/cn/app/qmenu/id1567442612?l=en&amp;mt=12" target="_blank" rel="noopener"><strong>Qmenu</strong></a> 【免费, App strore】访达扩展，拥有QSpace【付费, App strore】的部分功能。 【推荐】现在用Qmenu，功能比OpenInTerminal 更多。</li>
</ul>
</li>
<li>
<p>[x] 配置<a href="https://liyuankun.top/%E5%A5%A5%E5%88%A9%E7%BB%99%E4%BD%A0%E7%9A%84iTerm2-%E5%BF%AB%E9%80%9F%E7%94%A8IDE%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6.html#mac%E7%BB%88%E7%AB%AF%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8B%E7%94%A8sublime-vscode-atom%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E6%88%96%E7%9B%AE%E5%BD%95">MAC终端命令行下用sublime、vscode、atom打开文件或目录</a></p>
<ul>
<li>[x] open .  用finder打开当前文件</li>
<li>[x] vsc .  用vscode打开当前文件</li>
<li>[x] subl .  用Sublime打开当前文件</li>
<li>[x] atom .  用Atom打开当前文件</li>
<li>[x] command + &lt;-  / -&gt;     切换tab</li>
<li>[x] control + w 回退一部分命令</li>
</ul>
</li>
<li>
<p><a href="https://tldr.sh/" target="_blank" rel="noopener">tldr</a> Simplified and community-driven <code>man</code> pages. Quick install: <code>npm install -g tldr</code>.</p>
<ul>
<li>Take <code>git</code> for example, while <code>man</code> <code>git</code> outputs more than 100 lines. <code>&gt; tldr git</code></li>
</ul>
</li>
<li>
<p><a href="http://liyuankun.top/Git-Push-%E9%81%BF%E5%85%8D%E9%87%8D%E5%A4%8D%E8%BE%93%E5%85%A5%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81%E6%96%B9%E6%B3%95-%E5%A4%9A%E8%B4%A6%E6%88%B7%E9%85%8D%E7%BD%AE.html">Git 多用户配置</a></p>
</li>
<li>
<p><a href="https://tomcat.apache.org/download-10.cgi" target="_blank" rel="noopener">Tomcat 10.x</a></p>
</li>
</ul>
<h1 id="命令行开发环境设置">命令行开发环境设置</h1>
<h2 id="安装command-line-tools">安装Command line tools</h2>
<p>苹果的 Command line tools 是专为开发者使用的，包括 gcc 等常用的基本工具。<br>
推荐登陆 <a href="http://connect.apple.com" target="_blank" rel="noopener"><a href="http://connect.apple.com" target="_blank" rel="noopener">http://connect.apple.com</a></a> ，然后搜索 <code>command line tools</code> 选择对应版本进行安装。<br>
也可以通过Xcode进行安装，如果已经安装Xcode则已经包含了<code>command line tools</code>。</p>
<p>Mac 自带ruby，可以检查版本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ruby -v</span><br></pre></td></tr></table></figure>
<h2 id="检查shell版本-bash-or-zsh-or">检查shell版本 bash or zsh or?</h2>
<p>MAC 自带并默认使用zsh。</p>
<p>参考： <a href="https://unix.stackexchange.com/questions/9501/how-to-test-what-shell-i-am-using-in-a-terminal" target="_blank" rel="noopener">How to check what shell I am using in a terminal?</a></p>
<h3 id="1-常用且好记">1 常用且好记</h3>
<p>The following works on zsh, bash, and dash, but not on csh:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$0</span></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$BASH_VERSION</span></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$ZSH_VERSION</span></span><br></pre></td></tr></table></figure>
<h3 id="2-作用范围广">2 作用范围广</h3>
<p>Works in the four shells (bash, dash, zsh, csh):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ps -p $$</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ps -p$$ -ocmd= </span><br><span class="line"></span><br><span class="line"><span class="comment"># On Solaris, this may need to be</span></span><br><span class="line">ps -p$$ -ofname=</span><br><span class="line"></span><br><span class="line"><span class="comment"># On macOS and on BSD should be</span></span><br><span class="line">ps -p$$ -ocommand=</span><br></pre></td></tr></table></figure>
<h2 id="设置zsh-作为默认shell">设置Zsh 作为默认shell</h2>
<p>打开一个新的terminal来确认，设置Zsh 作为默认shell：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br><span class="line"><span class="comment"># 期望结果: /usr/bin/zsh or similar</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果shell列表中没有zsh或者你没有使用chsh权限的时候，不起作用</span></span><br><span class="line"><span class="comment"># 使用下面命令设置Zsh 作为默认shell</span></span><br><span class="line">[sudo] chsh -s $(<span class="built_in">which</span> zsh)  <span class="comment">#或 chsh -s /bin/zsh</span></span><br></pre></td></tr></table></figure>
<h2 id="安装homebrew">安装homebrew</h2>
<p><a href="https://brew.sh/" target="_blank" rel="noopener">Homebrew 官网</a>。<br>
homebrew是Mac下目前最常用的包管理工具，相当于debain下的 apt , Red hat系列的 yum ，帮你安装、升级、移除软件工具包。<br>
软件安装完成后homebrew有时会给出进一步设置的提示，强烈建议仔细阅读。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/bin/bash -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>"</span></span><br></pre></td></tr></table></figure>
<h3 id="报错解决方法">报错解决方法</h3>
<p><a href="https://zhuanlan.zhihu.com/p/346726110" target="_blank" rel="noopener">Mac 怎么安装Homebrew (2021)</a></p>
<h3 id="安装路径">安装路径</h3>
<p>The <code>/usr/local/Cellar</code> directory is the default location on OS X. You’ll see sub-directories in there for all your installed formulae.<br>
MAC 系统上默认路径为<code>/usr/local/Cellar</code>, 下面的子目录就是用brew安装的其他包。<br>
homebrew默认会把可执行文件装在目录 /usr/local/bin 下面，建议修改 path 路径，让你通过 homebrew安装的工具可以覆盖掉Mac默认的（例如git, Big sur Mac自带2.30.1版本的git）。使用管理员权限修改文件/etc/paths 将 /usr/local/bin 移动到第一行。</p>
<p>MAC Monterey 系统上新版本Homebrew， 例如 3.3.12，默认路径变为<code>/opt/homebrew/Cellar</code>, 下面的子目录就是用brew安装的其他包。</p>
<h3 id="通过-homebrew-安装">通过 <a href="https://brew.sh/" target="_blank" rel="noopener">homebrew</a> 安装</h3>
<ul>
<li>[x] <a href="https://github.com/wting/autojump" target="_blank" rel="noopener"><strong>autojump</strong></a>，目录跳转。 <code>brew install autojump</code>。</li>
</ul>
<!-- - [ ] [**the\_silver\_searcher**](https://github.com/ggreer/the_silver_searcher)，文件搜索，命令行是 ag
- [ ] [**hub**](https://hub.github.com/) - git 扩展
- [ ] [**tig**](https://github.com/jonas/tig) - git 扩展
- [ ] [**bat**](https://github.com/sharkdp/bat)，带行号的 cat，可以配 `alias cat="bat"`
- [ ] [**fd**](https://github.com/sharkdp/fd)，比系统自带的 find 友好 -->
<h2 id="多个java版本切换和安装">多个Java版本切换和安装</h2>
<p><a href="../Install-Multiple-Java-Versions-on-Mac-by-Homebrew-Cask.html">Install Multiple Java Versions on Mac by Homebrew Cask</a></p>
<h2 id="install-node-js-and-nvm"><a href="../Install-node-js-and-nvm.html">Install node.js and nvm</a></h2>
<h3 id="install-grunt-globally">Install Grunt globally</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g grunt-cli</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">grunt -v</span><br></pre></td></tr></table></figure>
<h3 id="install-yarn-globally">Install yarn globally</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g yarn</span><br></pre></td></tr></table></figure>
<h4 id="通过-yarn-global-add-安装">通过 <code>yarn global add</code> 安装</h4>
<ul>
<li>[ ] <a href="https://github.com/popomore/projj" target="_blank" rel="noopener"><strong>projj</strong></a>，github/gitlab 项目管理</li>
<li>[ ] <a href="https://github.com/zeit/serve" target="_blank" rel="noopener"><strong>serve</strong></a>，本地静态服务器</li>
<li>[ ] <a href="https://github.com/sindresorhus/fkill" target="_blank" rel="noopener"><strong>fkill</strong></a>，比 kill 好用的进程 killer</li>
<li>[ ] <a href="https://github.com/gtanner/qrcode-terminal" target="_blank" rel="noopener"><strong>qrcode-terminal</strong></a>，二维码生成</li>
</ul>
<h2 id="安装bash-complete">安装bash-complete</h2>
<p>bash 自动完成功能在 linux 发行版里一般都会自带，不过通过 homebrew 安装也很简单</p>
<p>brew install bash-completion<br>
安装完成后需要根据提示在你的 <code>.profile</code> 文件中添加几行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ -f $(brew --prefix)/etc/bash_completion ]; <span class="keyword">then</span></span><br><span class="line">  . $(brew --prefix)/etc/bash_completion</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h2 id="install-maven">Install <code>Maven</code></h2>
<h3 id="install-maven-macos">Install <code>Maven</code> - MacOS</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install maven</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mvn -v</span><br><span class="line">Apache Maven 3.9.11 (3e54c93a704957b63ee3494413a2b544fd3d825b)</span><br><span class="line">Maven home: /opt/homebrew/Cellar/maven/3.9.11/libexec</span><br><span class="line">Java version: 24.0.2, vendor: Homebrew, runtime: /opt/homebrew/Cellar/openjdk/24.0.2/libexec/openjdk.jdk/Contents/Home</span><br><span class="line"></span><br><span class="line"><span class="comment"># vi ~/.bash_profile or</span></span><br><span class="line">vim ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>add its bin folder to the PATH environment variable</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Maven</span></span><br><span class="line"><span class="built_in">export</span> M2_HOME=<span class="string">"/opt/homebrew/Cellar/maven/3.9.11/libexec"</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">"<span class="variable">$&#123;M2_HOME&#125;</span>/bin:<span class="variable">$&#123;PATH&#125;</span>"</span></span><br></pre></td></tr></table></figure>
<p><code>echo $M2_HOME</code> 或者 <code>mvn --version</code>验证</p>
<h3 id="install-maven-windows">Install <code>Maven</code> - Windows</h3>
<ul>
<li>Maven 3.3 要求 JDK 1.7 或以上</li>
<li>Maven 3.2 要求 JDK 1.6 或以上</li>
<li>Maven 3.0/3.1 要求 JDK 1.5 或以上</li>
</ul>
<h4 id="下载-maven-文件">下载 Maven 文件</h4>
<ul>
<li><a href="http://maven.apache.org/download.html" target="_blank" rel="noopener">下载 Maven</a></li>
<li>解压 Maven 文件
<ul>
<li>解压文件到你想要的位置来安装 Maven 3.2.5，你会得到 apache-maven-3.2.5 子目录。<code>C:\Tools\apache-maven-3.3.9</code></li>
</ul>
</li>
<li>设置 Maven 环境变量
<ul>
<li>添加 <code>M2_HOME</code>、<code>MAVEN_OPTS</code> 环境变量。
<ul>
<li>右键单击“我的电脑”，然后单击“属性” --&gt; 单击“高级”选项卡 --&gt; 单击“环境变量” --&gt; 单击“新建”添加一个新变量名和值。
<ul>
<li><code>M2_HOME= C:\Tools\apache-maven-3.3.9</code> 或者通过<code>where maven</code>查找已经安装的路径</li>
<li><code>MAVEN_OPTS=-Xms256m -Xmx512m</code></li>
</ul>
</li>
</ul>
</li>
<li>编辑环境变量<code>path</code>
<ul>
<li>尾部添加<code>%M2_HOME%\bin</code></li>
</ul>
</li>
</ul>
</li>
<li>验证 Maven 安装
<ul>
<li>现在打开控制台，执行以下命令。</li>
<li><code>c:\&gt; mvn --version</code></li>
<li>或者<code>echo $M2_HOME</code></li>
</ul>
</li>
</ul>
<h2 id="install-the-ant-build-tool">Install the <code>Ant</code> build tool</h2>
<h3 id="install-the-ant-macos">Install the <code>Ant</code> - MacOS</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install ant</span><br></pre></td></tr></table></figure>
<p>Add the environment variable <code>ANT_HOME</code> in your system.<br>
Add its bin folder to the <code>PATH</code> environment variable.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">where</span> ant</span><br><span class="line">/opt/homebrew/bin/ant</span><br><span class="line"></span><br><span class="line"><span class="comment"># vi ~/.bash_profile or</span></span><br><span class="line">vim ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>添加：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ant</span></span><br><span class="line"><span class="comment"># BIN folder should include both ant and antRun</span></span><br><span class="line"><span class="comment"># If installed with brew, it should be "/usr/local/Cellar/ant@1.9/1.9.x/libexec/bin"</span></span><br><span class="line"><span class="comment"># export ANT_HOME=/usr/local/Cellar/1.10.10/libexec</span></span><br><span class="line"><span class="built_in">export</span> ANT_HOME=/opt/homebrew/Cellar/ant/1.10.15_1/libexec</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ANT_HOME</span>/bin</span><br></pre></td></tr></table></figure>
<p><code>echo $ANT_HOME</code> 或者 <code>ant -version</code> 验证</p>
<h3 id="install-the-ant-windows">Install the <code>Ant</code> - Windows</h3>
<ul>
<li>设置 Ant 环境变量
<ul>
<li>添加 <code>ANT_HOME</code>环境变量。
<ul>
<li>右键单击“我的电脑”，然后单击“属性” --&gt; 单击“高级”选项卡 --&gt; 单击“环境变量” --&gt; 单击“新建”添加一个新变量名和值。
<ul>
<li><code>ANT_HOME= C:\Tools\ant</code> 或者通过<code>where ant</code>查找已经安装的路径</li>
</ul>
</li>
</ul>
</li>
<li>编辑环境变量<code>path</code>
<ul>
<li>尾部添加<code>%ANT_HOME%\bin</code></li>
</ul>
</li>
</ul>
</li>
<li>验证 Maven 安装
<ul>
<li>现在打开控制台，执行以下命令。</li>
<li><code>c:\&gt; ant --version</code></li>
<li>或者<code>echo $ANT_HOME</code></li>
</ul>
</li>
</ul>
<h2 id="install-gradle">Install gradle</h2>
<h3 id="方法1：通过homebrew安装">方法1：通过Homebrew安装</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install gradle</span><br><span class="line"><span class="comment"># brew install gradle@6</span></span><br><span class="line">brew upgrade gradle</span><br></pre></td></tr></table></figure>
<h3 id="方法2：通过sdkman安装-gradle多版本管理-推荐">方法2：通过SDKman安装，gradle多版本管理【推荐】</h3>
<p><a href="https://juejin.cn/post/6844903481942212621" target="_blank" rel="noopener">不同版本 Gradle ，怎么和平共处</a></p>
<p><a href="https://github.com/sdkman/sdkman-cli" target="_blank" rel="noopener">安装SDKman</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -s https://get.sdkman.io | bash</span><br></pre></td></tr></table></figure>
<p>查看安装版本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sdk version</span><br></pre></td></tr></table></figure>
<p>安装指定版本的 Gradle</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sdk install gradle 6.7</span><br></pre></td></tr></table></figure>
<p>卸载指定版本的 Gradle</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sdk uninstall gradle 6.7</span><br></pre></td></tr></table></figure>
<p>查看当前安装的 Gradle 版本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sdk current gradle</span><br></pre></td></tr></table></figure>
<p>查看安装的 Gradle 版本和所有版本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sdk list gradle</span><br></pre></td></tr></table></figure>
<p>设置默认的 Gradle 版本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sdk default gradle 6.7</span><br></pre></td></tr></table></figure>
<p>使用临时的 Gradle 版本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sdk use gradle 6.7</span><br></pre></td></tr></table></figure>
<h2 id="安装python">安装Python</h2>
<h3 id="安装python-v2">安装Python</h3>
<p>如果你正在使用Mac，系统是OS X&gt;=10.9，那么系统自带的Python版本是2.7。要安装最新的Python 3.9，有两个方法：</p>
<p>方法一：<a href="https://www.python.org/downloads/" target="_blank" rel="noopener">从Python官网下载Python 3.9的安装程序</a>，下载后双击运行并安装；</p>
<p>安装目录：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">which python3</span><br><span class="line">/Library/Frameworks/Python.framework/Versions/<span class="number">3.9</span>/bin/python3</span><br></pre></td></tr></table></figure>
<p>方法二：如果安装了Homebrew，直接通过命令<code>brew install python3</code>安装即可。</p>
<p>安装目录：<code>/usr/local/Cellar/python@3.9</code><br>
可执行文件目录：<code>/usr/local/bin/python3.9</code></p>
<p>MAC Monterey 系统上新版本Homebrew， 例如 3.3.12，默认路径变为<code>/opt/homebrew/Cellar/python@3.10</code>, 下面的子目录就是用brew安装的其他包。</p>
<h3 id="mac上python2和python3的版本切换设置"><a href="../Mac%E4%B8%8Apython2%E5%92%8Cpython3%E7%9A%84%E7%89%88%E6%9C%AC%E5%88%87%E6%8D%A2%E8%AE%BE%E7%BD%AE.html">Mac上python2和python3的版本切换设置</a></h3>
<h3 id="apktool">APKTOOL</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install apktool</span><br></pre></td></tr></table></figure>
<h3 id="jadx">JADX</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install jadx</span><br></pre></td></tr></table></figure>
<!-- ## 安装Bash

Mac 虽然默认也是使用 GNU Bash，不过使用命令 `/bin/bash --version` 可看到版本只有 3.2，该版本不支持 4.0 版本后添加的关联数组等功能，为了脚本的通用，建议升级到最新版本。

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install bash</span><br></pre></td></tr></table></figure>
<p>安装完要设置新安装的 bash 为默认 bash ，用超级用户编辑文件：<code>/etc/shells</code>，加入<br>
<code>/usr/local/bin/bash</code>到第一行 --&gt;</p>
<!-- ## 安装coreutils

Mac底层是基于freeBSD的，所以常用工具例如 `ls` 、`grep` 也都是freeBSD版本的，为了让我们的脚本可以更容易的跨平台，我们可以安装coreutils

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install coreutils</span><br></pre></td></tr></table></figure>
<p>装完需要根据提示进行设置，在<code>.profile</code>文件中加入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="string">"/usr/local/opt/coreutils/libexec/gnubin:<span class="variable">$PATH</span>"</span></span><br><span class="line"><span class="built_in">export</span> MANPATH=<span class="string">"/usr/local/opt/coreutils/libexec/gnuman:<span class="variable">$MANPATH</span>"</span></span><br></pre></td></tr></table></figure>
<p>让GNU的工具覆盖freeBSD的，并且使用man时显示的是GNU工具的文档。 --&gt;</p>
<!-- ## 安装dircolors-solarized

因为默认的 ls 配色实在很土，所以我用solarized配色方案：

mkdir ~/lib
cd ~/lib
git clone git@github.com:seebi/dircolors-solarized.git
echo 'eval `dircolors ~/lib/dircolors-solarized/dircolors.256dark`' >> ~/.profile -->
<h1 id="其他设置">其他设置</h1>
<h2 id="hexo-博客">Hexo 博客</h2>
<p>安装 Hexo（参考：<a href="../Git-Pages-Jekyll-Hexo-Build-your-own-blog.html#step1-%E5%AE%89%E8%A3%85-hexo">Git Pages + Jekyll/Hexo Build your own blog</a>）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
<h1 id="参考链接">参考链接</h1>
<ul>
<li><a href="https://segmentfault.com/a/1190000037592655" target="_blank" rel="noopener">当你拿到一台崭新的Mac电脑时，我们应该如何快速高效配置开发环境?</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>Environment setup</category>
      </categories>
      <tags>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机英语-virus,worm,Spyware,Ransomware,Trojan horse</title>
    <url>/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%8B%B1%E8%AF%AD-virus-worm-Spyware-Ransomware-Trojan-horse.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="virus-worm-spyware-ransomware-trojan-horse">virus,worm,Spyware,Ransomware,Trojan horse</h2>
<p>​​Computer virus（计算机病毒）​​：一种编制或者在计算机程序中插入的破坏计算机功能或者数据的计算机程序。它具有自我复制能力，能够通过各种途径（如网络、存储设备等）从一个程序或系统传播到另一个程序或系统，就像生物病毒传播一样，会对计算机系统造成损害，如删除文件、破坏数据、占用系统资源等。<br>
​​Computer worm（计算机蠕虫）​​：也是一种能够自我复制的恶意程序，但它与病毒不同，蠕虫不需要附着在正常的程序上，它可以利用网络协议和系统漏洞，独立地在网络中传播。蠕虫通常会占用大量的网络带宽，导致网络拥堵，还可能利用受感染计算机作为跳板进一步攻击其他系统。<br>
​​Trojan horse（特洛伊木马）​​：表面上看起来是有用的软件或程序，但实际上隐藏着恶意代码。当用户运行这个看似正常的程序时，木马就会激活，可能会窃取用户的敏感信息（如账号密码、银行卡信息等）、控制用户计算机、打开后门允许攻击者远程访问等。<br>
​​Spyware（间谍软件）​​：一种在用户不知情或未授权的情况下，收集用户信息的恶意软件。它可能会监控用户的浏览习惯、记录键盘输入、获取系统信息等，并将这些信息发送给攻击者，用于广告投放、身份盗窃等恶意目的。<br>
​​Botnets（僵尸网络）​​：由被黑客控制的众多计算机（称为“僵尸主机”）组成的网络。黑客通过控制这些僵尸主机，可以发起大规模的网络攻击，如分布式拒绝服务攻击（DDoS）、发送垃圾邮件、进行点击欺诈等。僵尸主机通常是在用户不知情的情况下被植入恶意软件而感染的。<br>
​​Ransomware（勒索软件）​​：一种恶意软件，它会加密用户的重要数据（如文件、数据库等），使用户无法正常访问这些数据，然后向用户索要赎金（通常是数字货币），以换取解密数据的密钥。如果用户不支付赎金，数据可能永远无法恢复。</p>
<table>
<thead>
<tr>
<th>恶意软件类型（英文）</th>
<th>恶意软件类型（中文）</th>
<th>传播方式</th>
<th>主要危害</th>
<th>是否具有自我复制能力</th>
<th>英文解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>Computer virus</td>
<td>计算机病毒</td>
<td>可附着于正常程序，通过存储设备、网络等传播</td>
<td>破坏计算机功能、数据，占用系统资源</td>
<td>是</td>
<td>A program capable of attaching itself to a document or to a genuine program. It usually has the ability make copies of itself over and over again, in order to infect and corrupt additional files without a user’s knowledge.</td>
</tr>
<tr>
<td>Computer worm</td>
<td>计算机蠕虫</td>
<td>利用网络协议和系统漏洞独立在网络中传播</td>
<td>占用大量网络带宽，导致网络拥堵，可能进一步攻击其他系统</td>
<td>是</td>
<td>A self - replicating program that mainly uses networks to spread itself. Its primary purpose is not to infect files, but to use resources, such as computer memory or network bandwidth.</td>
</tr>
<tr>
<td>Trojan horse</td>
<td>特洛伊木马</td>
<td>伪装成有用软件欺骗用户运行</td>
<td>窃取敏感信息、控制计算机、打开后门</td>
<td>否</td>
<td>A malicious program disguised as a legitimate one. The malicious code is usually hidden (or embedded) in an email attachment or in a useful or interesting program, such as a computer game, in order to trick users into installing it.</td>
</tr>
<tr>
<td>Spyware</td>
<td>间谍软件</td>
<td>常通过恶意网站、捆绑软件等方式潜入用户系统</td>
<td>收集用户信息并发送给攻击者</td>
<td>否</td>
<td>A malicious program that is usually secretly installed on a computer. Once activated, it gathers and transmits users’ information or actions, such as passwords, credit card numbers or web browsing habits, without their knowledge.</td>
</tr>
<tr>
<td>Botnets</td>
<td>僵尸网络</td>
<td>由僵尸主机组成，僵尸主机通过感染恶意软件加入网络</td>
<td>发起大规模网络攻击（如DDoS、垃圾邮件发送等）</td>
<td>单个僵尸主机可能通过病毒或蠕虫方式感染，但僵尸网络整体概念侧重于受控集合</td>
<td>A collection of compromised computers connected in a coordinated fashion for malicious purposes. The compromised machines are often turned into “robots” or “zombies” and used to send out spam, spread malware or launch cyber - attacks.</td>
</tr>
<tr>
<td>Ransomware</td>
<td>勒索软件</td>
<td>常通过恶意邮件附件、漏洞利用等方式传播</td>
<td>加密用户数据，索要赎金</td>
<td>否</td>
<td>A type of malware that uses encryption technology to prevent victims from using their computer or accessing their files until a fee is paid. This type of malware is often referred to as a cryptolocker. Once it has infected the computer, a message informs the victim that a given amount must be paid in order to lift the restriction to use the computer.</td>
</tr>
</tbody>
</table>
<h2 id="trademark-vs-copyright-vs-patent">Trademark Vs Copyright Vs Patent</h2>
<table>
<thead>
<tr>
<th>英文术语</th>
<th>中文解释</th>
<th>英文原文说明</th>
<th>核心要点对比</th>
</tr>
</thead>
<tbody>
<tr>
<td>Trademark ™</td>
<td>商标</td>
<td>A trademark identifies the goods or services of a person or organization, differentiating them from those of others. It may take the form of a word, sound, symbol or phrase, or a combination of these. It is often used to protect a company’s brand name and logo.<br><br>（商标可识别个人或组织的商品或服务，使其与他人区分开来。其形式可以是单词、声音、符号、短语或这些的组合，常用于保护公司的品牌名称和标志。）</td>
<td>1. 定义：用于区分商品或服务来源的标志（文字、声音、符号、短语或组合）。<br>2. 作用：保护品牌名称和标识，防止混淆。<br>3. 示例：苹果公司的“Apple”Logo。</td>
</tr>
<tr>
<td>Copyright (©)</td>
<td>版权</td>
<td>A copyright is the exclusive legal right to produce, reproduce, publish or perform intellectual creations, such as literary, artistic, dramatic or musical works. The creator is usually the copyright owner. An employer may hold a copyright on works created by employees, unless otherwise agreed upon.<br><br>（版权是创作者对其原创作品（如文学、艺术、戏剧或音乐作品）享有的独占性法律权利。创作者通常是版权所有者，但雇佣作品通常归雇主所有，除非另有约定。）</td>
<td>1. 定义：创作者对其原创作品（文学、艺术、戏剧、音乐等）享有的独占性权利。<br>2. 归属：默认归创作者所有，但雇佣作品通常归雇主。<br>3. 权利范围：包括复制、出版、表演等。</td>
</tr>
<tr>
<td>Patent</td>
<td>专利</td>
<td>A patent provides a legally protected and exclusive right to an invention. It excludes others from making, using or selling an invention. Once a patent is granted, it can be sold, licensed or used as an asset to negotiate funding.<br><br>（专利为发明提供受法律保护且排他性的权利，禁止他人制造、使用或销售该发明。专利授予后可出售、许可或作为资产用于融资谈判。）</td>
<td>1. 定义：对发明提供的法律保护和排他性权利。<br>2. 权利范围：禁止他人未经许可制造、使用或销售该发明。<br>3. 附加权益：可转让、许可或作为融资资产。</td>
</tr>
</tbody>
</table>
<hr>
<p>补充说明：<br>
权利核心差异：<br>
• 商标：保护品牌标识（名称/Logo），防止市场混淆。</p>
<p>• 版权：保护原创作品（文学/艺术等），默认归属创作者（雇主例外）。</p>
<p>• 专利：保护技术发明，赋予排他性权利并可交易（出售/授权）。</p>
<p>强调“common international mechanisms”，说明这些权利受全球知识产权体系认可（如《巴黎公约》《伯尔尼公约》等）。</p>
]]></content>
      <categories>
        <category>English Learning</category>
        <category>计算机英语</category>
      </categories>
      <tags>
        <tag>Security</tag>
      </tags>
  </entry>
  <entry>
    <title>15秦小明-新金融思维训练笔记第15讲-交易实务、金融衍生品初步与交易心理</title>
    <url>/15%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC15%E8%AE%B2-%E4%BA%A4%E6%98%93%E5%AE%9E%E5%8A%A1%E3%80%81%E9%87%91%E8%9E%8D%E8%A1%8D%E7%94%9F%E5%93%81%E5%88%9D%E6%AD%A5%E4%B8%8E%E4%BA%A4%E6%98%93%E5%BF%83%E7%90%86.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC15%E8%AE%B2-%E4%BA%A4%E6%98%93%E5%AE%9E%E5%8A%A1%E3%80%81%E9%87%91%E8%9E%8D%E8%A1%8D%E7%94%9F%E5%93%81%E5%88%9D%E6%AD%A5%E4%B8%8E%E4%BA%A4%E6%98%93%E5%BF%83%E7%90%86.png" alt="思维导图"></p>
<h1 id="第15讲-交易实务-金融衍生品初步与交易心理">第15讲-交易实务、金融衍生品初步与交易心理</h1>
<h2 id="交易实务">交易实务</h2>
<h3 id="股票-正规证券公司开户">股票 - 正规证券公司开户</h3>
<ul>
<li>一手 100股</li>
</ul>
<h3 id="期货-期货公司开户"><a href="https://wiki.mbalib.com/wiki/%E6%9C%9F%E8%B4%A7" target="_blank" rel="noopener">期货</a> - 期货公司开户</h3>
<ul>
<li>
<p><a href="https://wiki.mbalib.com/wiki/%E9%87%91%E8%9E%8D%E6%9C%9F%E8%B4%A7" target="_blank" rel="noopener">金融期货</a></p>
<ul>
<li>1<a href="https://wiki.mbalib.com/wiki/%E5%A4%96%E6%B1%87%E6%9C%9F%E8%B4%A7" target="_blank" rel="noopener">外汇（汇率）期货(foreign exchange futures)</a></li>
<li>2<a href="https://wiki.mbalib.com/wiki/%E5%88%A9%E7%8E%87%E6%9C%9F%E8%B4%A7" target="_blank" rel="noopener">利率期货</a>
<ul>
<li>长期国库券、政府住宅抵押证券、中期国债、短期国债等</li>
</ul>
</li>
<li>3<a href="https://wiki.mbalib.com/wiki/%E8%82%A1%E6%8C%87%E6%9C%9F%E8%B4%A7" target="_blank" rel="noopener">股指期货(Stock Index Futures)</a></li>
<li>门槛高</li>
</ul>
</li>
<li>
<p><a href="https://wiki.mbalib.com/wiki/%E5%95%86%E5%93%81%E6%9C%9F%E8%B4%A7" target="_blank" rel="noopener">商品期货(commodity futures)</a></p>
<ul>
<li>1<a href="https://wiki.mbalib.com/wiki/%E8%83%BD%E6%BA%90%E6%9C%9F%E8%B4%A7" target="_blank" rel="noopener">能源期货（Energy Futures）</a>
<ul>
<li>如原油、汽油、燃料油。新兴品种包括气温、二氧化碳排放配额。</li>
<li>门槛高</li>
</ul>
</li>
<li>2<a href="https://wiki.mbalib.com/wiki/%E5%86%9C%E4%BA%A7%E5%93%81%E6%9C%9F%E8%B4%A7" target="_blank" rel="noopener">农产品期货</a>
<ul>
<li>如棉花、大豆、小麦、玉米、白糖、咖啡、猪腩、菜籽油、天然橡胶、棕榈油。</li>
</ul>
</li>
<li>3<a href="https://wiki.mbalib.com/wiki/%E6%9C%89%E8%89%B2%E9%87%91%E5%B1%9E%E6%9C%9F%E8%B4%A7" target="_blank" rel="noopener">金属期货(Metal Futures)</a>
<ul>
<li>如铜、铝、锡、锌、镍、黄金、白银。</li>
</ul>
</li>
<li>4 <a href="https://wiki.mbalib.com/w/index.php?title=%E5%8C%96%E5%B7%A5%E6%9C%9F%E8%B4%A7&amp;action=edit" target="_blank" rel="noopener">化工期货</a>
<ul>
<li>如LLDPE、PTA、MEG、甲醇、PP等</li>
</ul>
</li>
</ul>
</li>
<li>
<p>多空交易的非对称性</p>
<ul>
<li>做多收益空间 &gt; 做空</li>
</ul>
</li>
<li>
<p>杠杆交易</p>
<ul>
<li>保证金比率 10% 一手铁矿石期货为8w，交8k保证金</li>
<li>最低交易单位 根据不同商品不同， 公斤，吨，克</li>
<li>名义杠杆 = 1/保证金比率 = 10倍</li>
<li>维持保证金 当风险高于资金使用率警戒线，开始减仓，强制平仓</li>
<li>实际杠杆 = 名义杠杆 * 仓位
<ul>
<li>投入了8w元来交易期货，买了一手铁矿石期货为8w，交8k保证金，仓位为8k/8W = 10%, 实际杠杆 = 10 * 10% = 1</li>
<li>投入了8w元来交易期货，买了10手铁矿石期货为80w，交8w保证金，仓位为8w/8w = 100%, 实际杠杆 = 10 * 100% = 10，如果铁矿石跌了1% 8k，我就会亏8k 就是保证金8w的10%，当风险高于资金使用率警戒线，平台会自动强制开始减仓，直到强制平仓。</li>
<li>控制风险，实际杠杆不要超过5倍，最好2-3倍</li>
</ul>
</li>
</ul>
</li>
<li>
<p>挂单</p>
<ul>
<li>时间优先，价格优先</li>
</ul>
</li>
<li>
<p><a href="https://wiki.mbalib.com/wiki/%E5%A5%97%E6%9C%9F%E4%BF%9D%E5%80%BC" target="_blank" rel="noopener">套期保值</a></p>
</li>
<li>
<p><a href="https://wiki.mbalib.com/wiki/%E5%A4%B4%E5%AF%B8" target="_blank" rel="noopener">头寸（position）</a></p>
<ul>
<li>比如在期货交易中建仓时,买入期货合约后所持有的头寸叫多头头寸,简称<a href="https://wiki.mbalib.com/wiki/%E5%A4%9A%E5%A4%B4" target="_blank" rel="noopener">多头（Bull position）</a>;</li>
<li>卖出期货合约后所持有的头寸叫空头头寸,简称空头。</li>
<li>商品未平仓多头合约与未平仓空头合约之间的差额就叫做<strong>净头寸</strong>。只是在期货交易中有这种做法，在现货交易中还没有这种做法。</li>
</ul>
</li>
<li>
<p><a href="https://wiki.mbalib.com/wiki/%E9%80%BC%E4%BB%93" target="_blank" rel="noopener">逼仓(Market Corner)</a></p>
</li>
<li>
<p><a href="https://wiki.mbalib.com/wiki/%E4%BA%A4%E5%89%B2" target="_blank" rel="noopener">交割</a></p>
</li>
</ul>
<h2 id="金融衍生品-derivative-初步"><a href="https://wiki.mbalib.com/wiki/%E9%87%91%E8%9E%8D%E8%A1%8D%E7%94%9F%E5%93%81" target="_blank" rel="noopener">金融衍生品（Derivative）</a>初步</h2>
<p>金融衍生产品的共同特征是保证金交易，即只要支付一定比例的保证金就可进行全额交易<br>
产品形态分类</p>
<h3 id="1远期-forwards">1<a href="https://wiki.mbalib.com/wiki/%E8%BF%9C%E6%9C%9F%E5%90%88%E7%BA%A6" target="_blank" rel="noopener">远期（Forwards）</a></h3>
<ul>
<li>保值工具，它是一种交易双方约定在未来的某一确定时间，以<strong>确定的价格</strong>买卖<strong>一定数量</strong>的某种实物商品或者金融资产的合约。合约中要规定交易的标的物、<strong>有效期</strong>和交割时的执行价格等项内容。</li>
</ul>
<h3 id="2期货-futures">2<a href="https://wiki.mbalib.com/wiki/%E6%9C%9F%E8%B4%A7" target="_blank" rel="noopener">期货(Futures)</a></h3>
<h3 id="3期权-option">3<a href="https://wiki.mbalib.com/wiki/%E6%9C%9F%E6%9D%83" target="_blank" rel="noopener">期权(Option)</a></h3>
<ul>
<li>一种能在未来某特定<strong>时间</strong>以特定<strong>价格</strong>买入或卖出一定<strong>数量</strong>的某种特定商品的权利。期权的持有者可以在该项期权规定的时间内选择买或不买、卖或不卖的权利，他可以实施该权利，也可以放弃该权利，而期权的出卖者则只负有期权合约规定的义务。
<ul>
<li>杠杆</li>
<li>上证50ETF</li>
</ul>
</li>
<li>看涨期权call option和看跌期权put option</li>
<li>期权的价格 (Market Price of Option)
<ul>
<li>1内涵价Intrinsic Value
<table>
<thead>
<tr>
<th>-</th>
<th>看涨期权</th>
<th>看跌期权</th>
<th>内涵价值</th>
</tr>
</thead>
<tbody>
<tr>
<td>实值期权</td>
<td>期权执行价格&lt;实际价格</td>
<td>期权执行价格&gt;实际价格</td>
<td></td>
</tr>
<tr>
<td>虚值期权</td>
<td>期权执行价格&gt;实际价格</td>
<td>期权执行价格&lt;实际价格</td>
<td>0</td>
</tr>
<tr>
<td>两平期权</td>
<td>期权执行价格=实际价格</td>
<td>期权执行价格=实际价格</td>
<td>0</td>
</tr>
</tbody>
</table>
</li>
<li>2时间价值</li>
</ul>
</li>
</ul>
<h3 id="4互换-swaps">4<a href="https://wiki.mbalib.com/wiki/%E4%BA%92%E6%8D%A2" target="_blank" rel="noopener">互换（Swaps）</a></h3>
<h2 id="交易心理">交易心理</h2>
<h3 id="控制资金量">控制资金量</h3>
<h3 id="及时止损-不要着急加仓">及时止损，不要着急加仓</h3>
<h1 id="其他非秦小明课程">其他非秦小明课程</h1>
<p><a href="https://www.jianshu.com/p/8b5337e36487" target="_blank" rel="noopener">关于副业</a></p>
<blockquote>
<ol>
<li>最好的时代，最焦虑的职场人</li>
</ol>
<p>前几天和一甲方朋友聊天，他因为最近工作调整，刚负责一个新的部门，再加上今年互金行业整体都不太景气，特别有危机感。</p>
<p>尽管他们公司在行业内也算是头部的，但还是觉得朝不保夕。正好最近有朋友找他一起做个项目，这让他既心动又纠结。</p>
<p>一直以来就想发展个副业，但是这种合作投资做项目风险还是挺大，前期真金白银投入是一方面，另外本身资源也是个问题。</p>
<p>这点他看的很透彻，现有的一些关系和人脉大多都是公司这个平台赋予的，一旦自己弄可能就完全是另外一回事了。</p>
<p>他跟我说：之所以想搞点副业，不仅仅是为了多赚点钱，也是想给自己留个后手，或者是有另外的可能性，但就是不知道做什么。</p>
<p>的确，随着移动互联网的发展，各种副业赚钱的新闻充斥在各大媒体平台，之前是写作，现在是网红短视频，反正是割了一波又一波的韭菜。</p>
<p>但是随着经济下行，大家钱包越来越扁，还是乐此不疲。越来越多的职场人希望在本职工作之外，发展一些副业。</p>
<p>但大多数人只是有这个想法，却不知道做什么，反正就是一边焦虑着，一边跟着一些大V摇摆，成为他们的副业或者是主业。</p>
<p>也从来没静下心来好好想一想，究竟自己是否适合发展副业。</p>
<p>而且一提到副业，很多人就觉得自己只是缺少机会，从没想过可能是缺少能力，那些看似别人赚钱的事并不是你做了就能赚钱。</p>
<p>实际上，很多人对副业存在误解，认为学个课程或者投资点小钱，就可以开始收钱。</p>
<p>其实副业要想取得一点成绩，付出的时间精力一点都不比主业少，只不过大多数时候是兴趣和爱好驱动，乐在其中而已。</p>
<ol start="2">
<li>靠谱的副业大多数时候其实是主业的延伸</li>
</ol>
<p>对于搞副业，其实没有对错标准，因人而异，有的人适合，有的人不适合。有的人做的风生水起，副业变成主业，有的人因为副业丢了主业，两边都没做好，最后得不偿失。</p>
<p>大多数时候，真正靠谱的副业其实都是主业的延伸。</p>
<p>我有个资深的HR朋友，平常主要负责招聘工作，对业务也非常熟悉。</p>
<p>今年年初的时候跟我说准备搞个副业，了解了才知道是和某招聘网站合作，做求职面试咨询和简历优化服务。</p>
<p>对这方面，之前也有过了解，的确市场需求还挺大，建议他可以试试，而且正好也是他擅长做的，对主业不但没什么影响，专业技能还得到锻炼提升，还能有点收入何乐而不为。</p>
<p>之后一直也没怎么联系，直到最近碰到聊起这事才知道做得还真不赖，一方面通过半年专业的服务，成为平台金牌简历教练。</p>
<p>另外因为面试咨询接的比较多，口碑不错，还在在行平台上也开通了付费咨询，每周也能有几单线下咨询。</p>
<p>最有意思的是因为他几乎只做他主业金融圈的咨询和简历优化，积累了大量的人才资源，在自己公司招聘的时候，有合适的就直接推荐过去，本职工作的效率也提升了一大截。</p>
<p>他跟我说：现在最大的感受就是自己底气更足了，倒不是因为副业给他带来收入上的增加，而是他在这个圈子有了一定的个人品牌和影响力，如果主业出现变动的话，他很快能找到新的机会。</p>
<p>的确，像他这样的副业和主业相得益彰的其实并不多，最关键的还是主业技能是否足以支撑副业的开展。</p>
<p>这年头谁都不是傻子，你没有点真本事，哪有那么容易让人心甘情愿掏钱。</p>
<p>所以要想用自己的副业，去挑战别人的主业，唯有在某些主业技能上做到优秀甚至极致，才能将它复制和跨界，并且不断精进。</p>
<p>很多人看到别人搞副业赚钱就羡慕，却不知道人背后付出了多少，更不知道他之前在主业上已经打磨许久。</p>
<p>其实，很大程度上，副业能不能赚到钱，跟主业能不能赚到钱，没多大区别。</p>
<ol start="3">
<li>长久的副业一般都是始于兴趣，终于坚持</li>
</ol>
<p>除了主业延伸的副业之外，还有一些成功靠副业转正的，一开始根本就没有副业的概念，只不过是因为兴趣爱好，也没想着赚钱。</p>
<p>但往往人生就是这么奇妙，你天天想赚钱，就容易被割韭菜，收智商税。反倒是纯粹的兴趣爱好坚持做下去，收益却会主动找上你。</p>
<p>最近去小区的健身房认识一做直播的哥们，一开始我看他身材以为是健身房的教练，后来休息的时候聊了聊才知道他也是过来锻炼的。</p>
<p>只不过还同时做个直播，但时间不会太长，找个角落的位置做半个小时左右示范讲解，剩下时间就自己锻炼。</p>
<p>他前几年在一家互联网公司上班，虽然经常加班，但还是每天还是会挤时间去健身，平常没事就研究健身相关的技巧。</p>
<p>直播和短视频兴起后他也弄了号上传一些自己的健身干货视频，一直健身带来完美的身材再加上颜值也不错，逐渐积累越来越多的粉丝。</p>
<p>今年上半年索性直接把工作辞了，专职搞这些平台的运营，现在不但成为圈子里小名气的运动博主，还跟人合伙成立了自己的运动品牌，除了带货之外还有一些广告收入，至少目前看来比上班是要强一些。</p>
<p>他还跟我说：一开始真没想到能把这个做成主业，就想着除了自己健身，还能通过分享和交流影响到一些有共同爱好的朋友，是一件特别有成就感的事。</p>
<p>的确，总有些事情，即便不赚钱，也会有抑制不住的冲动和渴望去做，那就是兴趣所在。</p>
<p>其实可以去尝试一下，花点时间，去坚持做一些一直想做又没有行动的事，反正空闲的时间也没干别的，无非也是在刷微博、抖音、朋友圈、玩游戏而已。</p>
<ol start="4">
<li>大多数副业赚钱的，依然是幸存者偏差而已</li>
</ol>
<p>前面说了几个身边的例子，再加上大家平常在各大媒体平台看到的，似乎那些做副业的都搞得风生水起。</p>
<p>实际上，至少有50%的职场人不适合做副业，其中一部分是自身能力问题，另外一部分是时间顾不上，更有的是压根就看不上。</p>
<p>就拿一些刚踏入职场的新人来说，本身业务技能并不成熟，职业发展的路径也不明确，在最应该夯实行业圈子和专业能力的阶段，去选择发展副业，结果可想而知，不会太好。</p>
<p>当然，也不是说就一定不行，也有的大学里就把兴趣爱好变成副业的牛人，不过这种毕竟还是少数，对大多数人而言，从主业中萃取核心能力，用在其他领域，或许才是比较靠谱的方式。</p>
<p>除了刚入职的新人外，那些追求快速收益回报的人也不适合做副业。还有一些生活压力大，主业收入低的也不建议做副业。</p>
<p>如果真有能够快速收益回报的副业，你觉得那些所谓的导师还会通过培训课程传授给你？其实赚的就是你这样的人的钱。要知道，我们每个人都只能赚自己能力范围内的钱。</p>
<p>现在这时代，无论哪个行业，都是专业的赚不专业的钱，你不能看到别人副业赚钱了，就认为副业一定赚钱，这是最大的误区。</p>
<p>之所以叫副业，主要是因为副业有很多不确定性，如果因为未来不确定的副业，而影响了自己的主业，那就真的得不偿失了。</p>
<p>另外，还有一部分人，本职工作就非常饱和，有的收入还很可观，那些月入几万的也根本理解不他们动辄上百万奖金的感受。</p>
<p>在他们这类人看来，高质量的人脉资源和不断精进的专业能力才是职业生涯最大的底气。</p>
<p>实际上，那些真正有时间搞副业而且还能做的比较好的，一般都是主业比较闲，而且没什么上升机会，大把时间没事情做。像之前有的公职在身的底层职员，当年写《三体》时候的大刘就是如此。</p>
<p>还有的是的确有“一技之长”且没有做到管理岗位上的人。比如UI设计师、培训师、视频剪辑人员、程序员、咨询师、编辑、新媒体人员等等。</p>
<p>所以，无论如何，我们还是要根据自身的实际情况来决定是否做副业，或者做什么。</p>
<p>危机意识和焦虑是眼下这个时代最不缺的东西，但不能因为着急就无脑跟随，那些能通过副业能够倒逼自己去快速学习，让自己成为稀缺的人才，形成独有的业内影响力和个人品牌的，才是我们应该追求的方向。</p>
<ol start="5">
<li>
<p>有的副业只会消耗你，有的却在不断给你赋能和升值</p>
</li>
<li>
<p>低收益且零积累的副业只会消耗你</p>
</li>
</ol>
<p>如果你不是实在缺钱到生活拮据的地步，跑滴滴、送外卖、发传单、刷单之类的副业不要去做，之所以这么说并不是对这些职业的不尊重，而是作为副业而言，绝对属于低收益且零积累的，同时还会消耗大量的精力。</p>
<p>对于这类的浪费大量的时间，赚的都是幸苦钱，对职业技能和个人成长没有半点积累，更别说口碑和人脉，妄图通过拉几个乘客就结识一些行业大佬或者事业贵人，那你还不如去买彩票可能概率更大一些。</p>
<p>更糟糕的是这类的副业，会消耗太多的精力，就拿跑滴滴来说，下了班晚上再去跑滴滴，到凌晨回家第二天上班精神状态能好哪去，这种情况下说不影响主业那都是骗人的。</p>
<p>所以说，真心不建议做这类的副业，当然，有的人纯粹是为了体验生活的另当别论了。</p>
<ol start="2">
<li>网红大咖不是一般人能当的</li>
</ol>
<p>之前去哈尔滨出差，经常会看到一群人在中央大街上搞直播，要么穿的奇装异服，要么行为举止另类。但是随着各类直播短视频平台愈发的成熟和完善，那些能够脱颖而出的越来越需要一些“真本事”。</p>
<p>再看看自己，你是长得特别漂亮，还是特别有才能讲段子，又或者是养了特别蠢萌乖巧听话的猫狗主子；你是美妆达人、还是健身狂魔、又或者是旅行爱好者…想想看，你还有没有什么其他隐藏技能？没个一技之长想要“红”，几乎是没机会的。</p>
<p>想通过网红这个途径来作为副业开展的，如果真有点特长或者创意，倒也是个风口机会。</p>
<p>给个建议就是：通过新榜之类的平台花一些时间，深入研究各大平台短视频每天排名情况，分析头部的那些玩家是怎么个玩法，再结合自己的特点，可以先模仿再创新，也不是没有套路，无非就是多花心思辛苦一点，刚开始就当个兴趣爱好也行。</p>
<ol start="3">
<li>能产生睡后收入是最理想的状态</li>
</ol>
<p>所谓的睡后收入，举个最简单的例子：房租。你要每个月都有十几套房子等着收租金，那你完全不会焦虑，但这种毕竟也是少数，用秦小明同学的话来说：不是每个人都能当包租婆，但人人都要有“租金”的思维和认知。</p>
<p>我有个朋友最近跟人合伙做了项目，商场里的自动盲盒售卖机和扭蛋机的运营，找人拿下了一个省代理，前期投了几十万，差不多半年能回本，之后分下来每个月能有个大几千块的利润。虽然钱不算多，但好在比较稳定，也算一个能产生睡后收入的副业。</p>
<p>当然， 他本身也是一直做这个行业，资源渠道都比较熟，合伙人在当地专门负责运营维护，所以也不算是纯投资。</p>
<p>这和有的副业让你纯投钱，保证零风险高收益，而你自己又对项目一窍不通完全不一样，那种坑太多了，一不留神就被骗的团团转。</p>
<p>奶茶店加盟这种就是个能坑到你怀疑人生，之前有篇刷屏的文章《再坚持一下，你的奶茶店马上破产》写的非常透彻，感兴趣的可以找出来看看。</p>
<p>对于想在开店方面找副业的，其实有一点原则：不懂的东西尽量少碰，可能这会错过一些机会，但眼下这个环境，保住本金有时候才是王道。</p>
<ol start="4">
<li>副业有很多种，但真不仅限于写作</li>
</ol>
<p>可能大多数人这几年接触的最多的副业广告文案就是写作了，类似“写作是这个时代最好的投资”“人人都能学的写作技巧”“零门槛写作训练营”等等。</p>
<p>再结合那些大V们炮制出来的各种写作课培训班，收割了一波又一波的韭菜，实际上除了写作之外，还有很多技能可以带来收益。</p>
<p>比如说主业从事会计工作，业余时间兼职代账；还有主业是艺术学校的美术老师，副业是瑜伽教练；</p>
<p>有的本职工作是公务员，业余时间靠把自己当初考公务员的经验心得做成培训课，不断能赚点钱，还拓展了资源人脉。</p>
<p>有时候，我们需要换位置思考一下，自己需要的也是其他人需要的，从需求出发寻找副业机会也是一个思路。</p>
<p>也不是鼓励大家都去发展副业，更重要的可能是培养一门兴趣，并持续去经营，任何事情先做出点成绩再去谈赚钱的事。</p>
<ol start="6">
<li>搞副业无可厚非，前提是要拎得清主次</li>
</ol>
<p>据统计，上半年8.2％的职场人士拥有斜杠收入。随着平台经济的发展，工作越来越不受限于时间和空间，主业之余，利用兴趣特长赚点零花钱，已逐渐成为职场人向往的生活方式。</p>
<p>但如何平衡主业和副业的关系，也愈发的成为身陷“副业围城”内外的职场人，需要深思的问题。</p>
<p>其实，如果时间精力允许，搞点副业也未尝不可，但所选择的副业最好是跟自己的职业目标相关或相近，这才有价值。</p>
<p>正如前面说的，副业发展比较好的人，其实大多数都是本职工作上同样比较优秀的人，他们拥有专业的技能，在此基础上想要得到更好的提升空间，秉着主次分明的态度为自己挖掘出更多的机会。</p>
<p>毕竟，真正聪明的职场人，会将自己大部分精力以一种“创业”的心态去对待自己的本职工作，那才是立身之本，不能荒废，剩余的时间通过发展副业来提高自己的主业技能，主次分明去实现最有效的自我增值。</p>
<p>在这种前提下想搞点副业，时刻保持危机意识和持续学习，以应对这个瞬息万变的时代和职场环境变化，也不是什么坏事。</p>
<p>但千万不要为了一时的快钱，消耗自己个人品牌价值或浪费自己未来的价值，这样，得不偿失。</p>
<p>对于副业，还是希望大家能多一点理性和判断力，不要用幸存者偏差当普世价值去信奉。有些事可以去尝试，但切记不忘初心，才能不畏将来。</p>
<p>最后，还有个忠告：</p>
<p>除非你的副业光芒万丈到众所周知，否则千万不要主动跟同事提你的副业！千万不要主动跟同事提你的副业！千万不要主动跟同事提你的副业！原因你懂的。</p>
</blockquote>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>2023 most popular and useful AI tools</title>
    <url>/2023-most-popular-and-useful-AI-tools.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="code生成">Code生成</h2>
<table>
<thead>
<tr>
<th>AI tools name</th>
<th>category</th>
<th>production company</th>
<th>URL</th>
<th>pros</th>
<th>cons</th>
<th>charging method and amount</th>
</tr>
</thead>
<tbody>
<tr>
<td>Copilot <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8a/GitHub_Copilot_logo.svg/440px-GitHub_Copilot_logo.svg.png" alt="Copilot"></td>
<td>code generation</td>
<td>GitHub + OpenAI</td>
<td><a href="https://copilot.github.com/" target="_blank" rel="noopener">https://copilot.github.com/</a></td>
<td>- 最流行的 AI 编码工具。基于尖端人工智能系统Open AI Codex ，分析当前文件和其他相关文件中的上下文，并直接在文本编辑器中给出有用的建议。此外，GitHub Copilot 已经接受过公共存储库中出现的所有语言的培训。- AI-powered code completion tool that uses machine learning algorithms to provide code suggestions as you type in your preferred code editor. <br> - Supports multiple programming languages, including Python, JavaScript, HTML/CSS, Java, and more.</td>
<td>- None found.</td>
<td>Free免费用到2022年8月22日，之后Copilot for Individuals <a href="https://github.com/features/copilot/#pricing" target="_blank" rel="noopener"><code>$10 per month / $100 per year</code></a>。申请student pack （免费两年，之后可重新验证）或者 热门开源项目维护者免费</td>
</tr>
<tr>
<td>Kite</td>
<td>code generation</td>
<td>Kite</td>
<td><a href="https://www.kite.com/" target="_blank" rel="noopener">https://www.kite.com/</a></td>
<td>- AI-powered code completion tool that uses machine learning algorithms to provide code suggestions as you type in your preferred code editor. <br> - Supports multiple programming languages, including Python, JavaScript, HTML/CSS, Java, and more.</td>
<td>- None found.</td>
<td>Free</td>
</tr>
<tr>
<td>TabNine</td>
<td>code generation</td>
<td>TabNine</td>
<td><a href="https://www.tabnine.com/" target="_blank" rel="noopener">https://www.tabnine.com/</a></td>
<td>- AI-powered code completion tool that uses machine learning algorithms to provide code suggestions as you type in your preferred code editor. <br> - Supports multiple programming languages, including Python, JavaScript, HTML/CSS, Java, and more.</td>
<td>- Github Copilot 的主要竞争对手。它是一个基于 AI 的代码完成助手，可直接在 Visual Studio Code 或 IntelliJ Idea IDE 中为开发人员提供扩展片段建议和目标行代码完成。Tabnine 可以根据上下文和语法预测并建议您的下一行代码，提供全面的行代码补全和自然语言编码。</td>
<td>基础版免费，功能比较弱，只能补全较为短的简单的代码。功能完整的专业版要12美元/月。 开发工具插件市场里搜索tabnine即可安装</td>
</tr>
<tr>
<td>Deep TabNine</td>
<td>code generation</td>
<td>Deep TabNine</td>
<td><a href="https://www.deep-tabnine.com/" target="_blank" rel="noopener">https://www.deep-tabnine.com/</a></td>
<td>- AI-powered code completion tool that uses machine learning algorithms to provide code suggestions as you type in your preferred code editor. <br> - Supports multiple programming languages, including Python, JavaScript, HTML/CSS, Java, and more.</td>
<td>- None found.</td>
<td>Free</td>
</tr>
</tbody>
</table>
<p>对比Tabnine收费版和GitHub Copilot收费版，更推荐使用GitHub Copilot</p>
<h3 id="cursor"><a href="https://www.cursor.so/" target="_blank" rel="noopener"><code>Cursor</code></a></h3>
<p>一款集成Gpt-4机器人的编辑器。</p>
<h3 id="gpt-code-clippy-gpt-cc"><a href="https://github.com/CodedotAl/gpt-code-clippy" target="_blank" rel="noopener">GPT-Code-Clippy (GPT-CC)</a></h3>
<p>GPT-Code-Clippy (GPT-CC) 是 GitHub Copilot 的开源版本，构建于 OpenAI 的 GPT-3 之上。它可以作为 VS 代码扩展使用，但不能通过 VS 代码市场获得。</p>
<blockquote>
<p>GPT-Code-Clippy (GPT-CC) is an open source version of GitHub Copilot, a language model – based on GPT-3, called GPT-Codex – that is fine-tuned on publicly available code from GitHub.</p>
</blockquote>
<p><a href="https://github.com/CodedotAl/code-clippy-vscode" target="_blank" rel="noopener">code-clippy-vscode</a><br>
GPT-Code-Clippy的VSCode 插件版本</p>
<!-- 实测用起来有点慢 -->
<h3 id="阿里云智能编码插件-alibaba-cloud-ai-coding-assistant">阿里云智能编码插件（Alibaba Cloud AI Coding Assistant）</h3>
<p>只支持IntelliJ IDEA<br>
<a href="https://alibaba-cloud-toolkit.github.io/" target="_blank" rel="noopener">https://alibaba-cloud-toolkit.github.io/</a></p>
<h3 id="copilot-申请github学生包">Copilot-申请GitHub学生包</h3>
<ul>
<li>
<p><a href="https://blog.csdn.net/qq_41017902/article/details/128212858?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-128212858-blog-126512251.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-128212858-blog-126512251.pc_relevant_default&amp;utm_relevant_index=2" target="_blank" rel="noopener">GitHub学生包最新申请教程</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/qq_41145669/article/details/127987622?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-127987622-blog-128212858.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-127987622-blog-128212858.pc_relevant_default&amp;utm_relevant_index=1" target="_blank" rel="noopener">关于GitHub Education（GitHub教育认证）认证</a></p>
<ul>
<li>申请网址：<a href="https://education.github.com/discount_requests/application" target="_blank" rel="noopener">https://education.github.com/discount_requests/application</a> （登录GitHub账号））</li>
<li>What e-mail address do you use for school?
<ul>
<li>选择一个邮箱,不一定必须是edu教育邮箱。如果你有教育邮箱且选择了,那后面的资料一定要和教育邮箱匹配 （学校名称自动会填写）.</li>
</ul>
</li>
<li>What is the name of your school?
<ul>
<li>输入学校名称, 这里建议在输入框输入学校前几个字,然后选择跳出的选项,如果你的学校不在选择范围内,大概率也不行.</li>
</ul>
</li>
<li>How do you plan to use GitHub?
<ul>
<li>写一下,你准备用它干什么,用英文写一点就行， 例如“Code version control and learn and contribute to open source project”</li>
</ul>
</li>
<li>Continue （要求开启定位）
<ul>
<li>最好在学校里，因为申请它会看location，因为location被机验就不通过</li>
</ul>
</li>
<li>学籍认证界面
<ul>
<li>要用摄像头拍。如果上传的话他会拒绝，说上传的操作空间大，拍照比较可靠。如果电脑不方便可以用手机拍。</li>
<li>ProofType 证明类型: student ID是可以的。
<ul>
<li>或者按F12进入控制台，找到student ID这一标签，更改为Dated school ID即可。</li>
</ul>
</li>
<li>学籍证明。打开学信网中国高等教育学生信息网（学信网） (<a href="chsi.com.cn">chsi.com.cn</a>)，找到学信档案，没有的话，就申请一下，过期了的续约一下，这里要注意要英文的，所以用浏览器翻译一下就好了，电脑上打开，手机对着拍张照就可以。
<ul>
<li>选择Other， 填写 Ministry of Education student status online verification report</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href="https://githubedu.top/" target="_blank" rel="noopener">https://githubedu.top/</a> taobao购买，直接自助认证，收费29元</p>
<ul>
<li>非正常途径的学生包不要绑定自己的大号，不然容易被 ban</li>
</ul>
</li>
</ul>
<p>学生包里的内容</p>
<ul>
<li><a href="http://name.xn--com-s18dohk2p1of3ge932a72jga5178ghv4c76d" target="_blank" rel="noopener">http://name.com域名商可免费申请一个域名</a>（没有注明免费期限），包括SSL证书等。</li>
<li>namecheap域名商为期一年的.me域名和1年的SSL证书。</li>
<li>亚马逊云服务器100美元的代币。</li>
<li>DigitalOcean的50美元的代笔，仅限新用户。</li>
<li>一年的JetBrains家全家桶订阅，在校生一年后需要可以再认证一次，直到你毕业。</li>
<li>微软Azure云100美元代币。</li>
<li>静态网站托管服务pageclip的基本套餐。</li>
<li>educative网课免费6个月。</li>
<li>Bootstrap Studio的免费许可证。</li>
<li>termius终端的高级套餐。</li>
<li>atom编辑器免费（滑稽）使用。</li>
<li>GitHub无限制数量的私密仓库。</li>
<li>私密仓库免费使用Travis CI。</li>
<li>crowdin社区翻译的铜套餐。</li>
<li>还有众多服务等待白嫖。</li>
</ul>
<blockquote>
<p>注意事项<br>
每两年需要重新验证一次学生身份，特殊服务如JB全家桶需要每年使用GitHub账号续期。而且注意大多数是学生认证，用于商业目的的话需要注意阅读授权许可防止侵权。（但是基本秒批且不用重新验证学生身份）<br>
学生包内含的代币（比如DigitalOcean、AWS之类的现金折扣卷）等一般都是有时效的，例如仅限第一个月抵扣之类的，要认真阅读使用说明防止被坑。</p>
</blockquote>
<h3 id="codegeex"><a href="https://github.com/THUDM/CodeGeeX" target="_blank" rel="noopener">CodeGeeX</a></h3>
<p>CodeGeeX 是一个免费的、基于 AI 的编码助手，它可以在当前行或后续行中建议代码。它由具有 130 亿个参数的大规模多语言代码生成模型提供支持，并在包含 20 多种编程语言的大型代码语料库上进行了预训练。适用于 Jetbrains IDE 和 VS Code。Github Copilot 或 Tabnine 的绝佳替代品。</p>
<p>Github页面：<a href="https://github.com/THUDM/CodeGeeX" target="_blank" rel="noopener">CodeGeeX</a></p>
<h3 id="sourcery">Sourcery</h3>
<p>一种建议改进 Python 代码的工具。它对于重构现有代码和学习新的、更简洁的做事方式特别有用。它可作为 VS Code、PyCharm、Vim、Sublime 的扩展使用。您还可以将其用作命令行和预提交挂钩。它有一个免费版本和两个付费计划，每月费用分别为 12 美元和 24 美元。</p>
<p>网站：<a href="https://sourcery.ai/" target="_blank" rel="noopener">Sourcery</a></p>
<h3 id="codewp">CodeWP</h3>
<p>CodeWP 是专门为 WordPress Creators 构建和训练的 AI 代码生成器。涵盖 PHP、JS、WooCommerce 和几个流行的插件。它有一个代码片段和解决方案库，由 CodeWP 团队验证可以工作，还有几十个教程。有一个免费版本，但它的功能有限。付费版本的费用为 12 美元/月或 36 美元/月，具体取决于计划。</p>
<p>网站：<a href="https://codewp.ai/" target="_blank" rel="noopener">CodeWP</a></p>
<h3 id="intellicode">IntelliCode</h3>
<p>Microsoft 的引入是为了改进 Intellisense 的代码完成和自动完成功能。Intellicode 旨在通过将您最可能需要的代码放在完成列表的顶部来节省您的时间。这些建议基于 GitHub 上数千个开源项目，每个项目都拥有超过 100 颗星。通过将其与您的代码上下文相结合，IntelliCode 将定制完成列表以促进常见的编码实践。为 VS 代码开发。</p>
<p>扩展页面：<a href="https://marketplace.visualstudio.com/items?itemName=VisualStudioExptTeam.vscodeintellicode" target="_blank" rel="noopener">IntelliCode</a></p>
<h3 id="amazon-codewhisperer">Amazon CodeWhisperer</h3>
<p>Amazon CodeWhisperer 是一种基于机器学习的服务，可根据开发人员在其 IDE 中编写的注释和代码建议代码片段，从而帮助开发人员更高效地编写代码。它旨在与 PyCharm、VS Code 和 AWS Cloud9 等流行的 IDE 配合使用，并支持 Java、JavaScript 和 Python 等编程语言。不如此列表中的其他工具受欢迎，但值得一提。<br>
<a href="https://developer.aliyun.com/article/1023767" target="_blank" rel="noopener">继GitHub的Copilot收费后，亚马逊推出了 CodeWhisperer</a><br>
网站：<a href="https://aws.amazon.com/codewhisperer/" target="_blank" rel="noopener">CodeWhisperer</a></p>
<h3 id="aixcoder-code-completer">AiXcoder Code Completer</h3>
<p>AiXcoder 由 JetBrains 创建，是一个基于深度学习技术的代码完成器和代码搜索引擎。它有可能向您推荐整行代码。它在开发人员的计算机上本地运行，确保了他们代码的安全性。这是因为所有计算都在本地执行，代码不会通过互联网传输，这有助于保护代码免受潜在的网络威胁。</p>
<p>扩展页面：<a href="https://plugins.jetbrains.com/plugin/13574-aixcoder-code-completer" target="_blank" rel="noopener">AiXcoder</a></p>
<h3 id="blackbox-ai">Blackbox AI</h3>
<p>使开发人员的生活更轻松的通用工具。除了代码完成，它还提供了从图像和视频中复制代码的可能性。它还可以帮助您在不离开 IDE 的情况下找到通常在 Google 中查找的问题的答案。它可作为 VS 代码扩展使用。</p>
<p>网站：<a href="https://www.useblackbox.io/" target="_blank" rel="noopener">Blackbox AI</a></p>
<h2 id="chatgpt">ChatGPT</h2>
<table>
<thead>
<tr>
<th>AI tools name</th>
<th>category</th>
<th>production company</th>
<th>URL</th>
<th>pros</th>
<th>cons</th>
<th>charging method and amount</th>
</tr>
</thead>
<tbody>
<tr>
<td>GPT-3</td>
<td>writing</td>
<td>OpenAI</td>
<td><a href="https://openai.com/gpt-3/" target="_blank" rel="noopener">https://openai.com/gpt-3/</a></td>
<td>- One of the most powerful AI writing tools on the market. <br> - Capable of generating human-like text.</td>
<td>- None found.</td>
<td>Paid</td>
</tr>
<tr>
<td>GPT-4</td>
<td>writing</td>
<td>OpenAI</td>
<td><a href="https://openai.com/product/gpt-4" target="_blank" rel="noopener">https://openai.com/product/gpt-4</a></td>
<td>- GPT-4 is OpenAI’s most advanced system, producing safer and more useful responses</td>
<td>- None found.</td>
<td>Paid</td>
</tr>
<tr>
<td>chat GPT</td>
<td>chat</td>
<td>OpenAI</td>
<td><a href="https://chat.openai.com/chat" target="_blank" rel="noopener">https://chat.openai.com/chat</a></td>
<td></td>
<td>- None found.</td>
<td>Paid</td>
</tr>
</tbody>
</table>
<h2 id="其他-ai-工具推荐">其他 AI 工具推荐</h2>
<p>参考<a href="https://www.odaily.news/post/5185781" target="_blank" rel="noopener">GPT-4上线，这10个AI工具你必须收藏</a>，整理成表格</p>
<blockquote>
<p>以下为近 1 个月时间里，团队小伙伴试用 86 种 AI 工具后，按照好用程度筛选出的 17 种 AI 工具<br>
重点介绍好用 Top🔟 的工具，包括推荐理由、收费标准、工具链接、和使用场景等</p>
</blockquote>
<p>以下是一些 AI 工具的推荐，供参考：</p>
<table>
<thead>
<tr>
<th>序号</th>
<th>工具名称</th>
<th>推荐理由</th>
<th>付费/免费</th>
<th>链接</th>
</tr>
</thead>
<tbody>
<tr>
<td>No.1</td>
<td>@NotionHQ 「NotionAI」</td>
<td>可结合Web clipper插件，将网页内容剪藏，然后用AI进行总结、摘要，提升阅读效率</td>
<td>$10/月-plus版 2000AI积分「基本够用」</td>
<td><a href="https://www.notion.so/product/ai" target="_blank" rel="noopener">Notion Ai介绍</a> / <a href="https://chrome.google.com/webstore/detail/notion-web-clipper/knheggckgoiihginacbkhaalnibhilkk" target="_blank" rel="noopener">Web clipper插件</a></td>
</tr>
<tr>
<td>No.2</td>
<td>@bing「New bing」</td>
<td>GPT-4底层，可基于链接进行信息提取，也可生成表格</td>
<td>免费</td>
<td><a href="https://twitter.com/jianshubiji/status/1635832682474250240?s=20" target="_blank" rel="noopener">申请方法</a></td>
</tr>
<tr>
<td>No.3</td>
<td><a href="http://chathub.gg" target="_blank" rel="noopener">chathub.gg</a> by @wong2_x</td>
<td>将ChatGpt和Newbing聚合，对比结果，更容易筛选信息</td>
<td>需要填写个人API</td>
<td><a href="https://chrome.google.com/webstore/detail/chathub-all-in-one-chatbo/iaakpnchhognanibcahlpcplchdfmgma" target="_blank" rel="noopener">插件</a></td>
</tr>
<tr>
<td>No.4</td>
<td>ChatGpt-4</td>
<td>可输入2.5W字、逻辑性大幅提升、支持图片输入并对其解释「暂未开放」</td>
<td>plus-$20/月</td>
<td><a href="https://chat.openai.com/chat" target="_blank" rel="noopener">网站</a> / <a href="https://twitter.com/jianshubiji/status/1628368868820373505?s=20" target="_blank" rel="noopener">币安 VISA 卡注册教程</a> / <a href="https://www.notion.so/ChatGPT-Shortcut-2e22853f52484ed698b7a846c33a26d8" target="_blank" rel="noopener">好用的提示词聚合网站 ChatGPT Shortcut</a></td>
</tr>
<tr>
<td>No.5</td>
<td>Phind</td>
<td>提供相关链接、信息库更新较快可根据信息的时间筛选</td>
<td>需要填写个人API</td>
<td><a href="https://www.phind.com/" target="_blank" rel="noopener">网站</a></td>
</tr>
<tr>
<td>No.6</td>
<td>ChatPDF</td>
<td>可基于上传的PDF进行内容汇总、信息摘取</td>
<td>免费/plus-$5/月</td>
<td><a href="https://www.chatpdf.com/" target="_blank" rel="noopener">网站</a></td>
</tr>
<tr>
<td>No.7</td>
<td>Freegpt</td>
<td>免费版本的 ChatGPT、性能稳定</td>
<td>免费</td>
<td><a href="https://freegpt.one/" target="_blank" rel="noopener">网站</a></td>
</tr>
<tr>
<td>No.8</td>
<td>OpenAI Translator</td>
<td>不仅能翻译15种语言，还能总结、基于单个词汇扩展解释</td>
<td>需要填写个人API</td>
<td><a href="https://chrome.google.com/webstore/detail/openai-translator/ogjibjphoadhljaoicdnjnmgokohngcc" target="_blank" rel="noopener">插件</a></td>
</tr>
<tr>
<td>No.9</td>
<td>Language reactor</td>
<td>这个不算AI工具，但对于Web3想学英语的小伙伴非常适用，会根据 YouTube 逐行翻译还可以分等级学习</td>
<td>免费,也有专业版 $8.35/月，带储存单词</td>
<td><a href="https://www.languagereactor.com/saved-items" target="_blank" rel="noopener">🔗网站</a>  / <a href="https://chrome.google.com/webstore/detail/language-reactor/hoombieeljmmljlkjmnheibnpciblicm" target="_blank" rel="noopener">🔗插件</a></td>
</tr>
<tr>
<td>No.10</td>
<td>Glarity</td>
<td>基于谷歌页面内容总结、YouTube 视频内容总结「仅限带英文字幕」</td>
<td>需接入自己的 API</td>
<td><a href="https://chrome.google.com/webstore/detail/glarity-summary-for-googl/cmnlolelipjlhfkhpohphpedmkfbobjc/related" target="_blank" rel="noopener">🔗插件</a></td>
</tr>
</tbody>
</table>
<h3 id="chatgpt-详细介绍：chatgpt-解答">ChatGPT 详细介绍：<a href="./ChatGPT-All-you-should-know.html">ChatGPT 解答</a></h3>
<h3 id="gpt-相关项目">GPT 相关项目</h3>
<h4 id="docsgpt"><a href="https://github.com/arc53/DocsGPT" target="_blank" rel="noopener">DocsGPT</a></h4>
<p>With its integration of the powerful GPT models, developers can easily ask questions about a project and receive accurate answers.</p>
<h4 id="chatgpt-中文调用版">ChatGPT 中文调用版</h4>
<ul>
<li><a href="https://chat.jorto.net/" target="_blank" rel="noopener">https://chat.jorto.net/</a></li>
<li><a href="https://new.ctgpt.cn/" target="_blank" rel="noopener">https://new.ctgpt.cn/</a> <a href="https://iui.su/3854/" target="_blank" rel="noopener">介绍</a></li>
</ul>
<h2 id="ai出图">AI出图</h2>
<table>
<thead>
<tr>
<th>AI tools name</th>
<th>category</th>
<th>production company</th>
<th>URL</th>
<th>pros</th>
<th>cons</th>
<th>charging method and amount</th>
</tr>
</thead>
<tbody>
<tr>
<td>Midjourney <img src="https://cdn.document360.io/logo/3040c2b6-fead-4744-a3a9-d56d621c6c7e/778d06e9a335497ba965629e3b83a31f-MJ_Boat.png" alt="Midjourney"></td>
<td>painting</td>
<td>Midjourney</td>
<td><a href="https://midjourney.com/" target="_blank" rel="noopener">https://midjourney.com/</a></td>
<td>- Capable of generating incredibly sophisticated art. <br> - Produces the best and most advanced results out of all the other AI art generators.</td>
<td>- None found.</td>
<td>Free</td>
</tr>
<tr>
<td>DALL-E 2 <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAAAAABWESUoAAABQElEQVR4Ac3PIYyDMBiG4VefPDtxEj0xM39qZl40mcPhMzONOjWNrqxA4UgmqklweBQKVfFdGhbSZZvfY5qmb35++DAbO4XQF7xjpN42s1oyXtlr2gN4SRpynnTaANtesy1tkOOR8aoAJ12J6ngmGkknCqn5gv0y8Jv03eYy+PEAu07jCQ66sDqqpohBCVb2PMtvSbeoxRJcLlIFVFKVBuOwBDdNxkzjEbKbVDwHvgZw8j+Qq2fVhhjkxB2g7JwqKJMRhUqo5Lol8OTxMbSsehXw45e9ao+J92EkGaFbBscxLqnbPRhYOVXr/53L+wTVaUDmNZ+tLNyDWgdWl3gxo7otHMYY5DYdwLc6gB18tVLBSVJD6qr6fsoBVt7wyCm4PxfiRyBTx5N8kCQP8DtrzysZrebG9ZLhnaILYbIbPss/4c/row+G/FAAAAAASUVORK5CYII=" alt="DALL-E 2"></td>
<td>painting</td>
<td>OpenAI</td>
<td><a href="https://openai.com/product/dall-e-2" target="_blank" rel="noopener">https://openai.com/product/dall-e-2</a></td>
<td>- Most popular AI art generator on the market. <br> - Capable of generating realistic images with AI.</td>
<td>- None found.</td>
<td>Free</td>
</tr>
<tr>
<td>Stable Diffusion <img src="https://stablediffusionweb.com/logo.png" alt="Stable Diffusion"></td>
<td>Painting</td>
<td>Open-source</td>
<td><a href="https://stablediffusionweb.com/" target="_blank" rel="noopener">https://stablediffusionweb.com/</a></td>
<td>Can generate photo-realistic images given any text input, with the extra capability of inpainting the pictures by using a mask. Can be used to create a mask that delineates the damaged regions of an image, which is used often to repair or remove undesirable objects. Can also be used to paint an image using a mask.</td>
<td>N/A</td>
<td>Free and open-source.</td>
</tr>
<tr>
<td>Deep Dream Generator</td>
<td>painting</td>
<td>Aifnet</td>
<td><a href="https://deepdreamgenerator.com/" target="_blank" rel="noopener">https://deepdreamgenerator.com/</a></td>
<td>- Enables you to create realistic images with AI. <br> - Relies on a neural network that was trained with millions of images.</td>
<td>- None found.</td>
<td>Free</td>
</tr>
</tbody>
</table>
<p><a href="https://www.bilibili.com/video/BV14G4y1n7U8/?spm_id_from=333.880.my_history.page.click" target="_blank" rel="noopener">Midjourney 教程</a></p>
<h2 id="其他内容生成-content-speech-and-video-generation">其他内容生成 content, speech and video generation</h2>
<table>
<thead>
<tr>
<th>AI tools name</th>
<th>category</th>
<th>production company</th>
<th>URL</th>
<th>pros</th>
<th>cons</th>
<th>charging method and amount</th>
</tr>
</thead>
<tbody>
<tr>
<td>Jasper</td>
<td>writing</td>
<td>Jasper</td>
<td><a href="https://jasper.ai/" target="_blank" rel="noopener">https://jasper.ai/</a></td>
<td>- One of the most powerful AI writing tools on the market.</td>
<td>- None found.</td>
<td>Paid</td>
</tr>
<tr>
<td>Hugging Face</td>
<td>writing</td>
<td>Hugging Face</td>
<td><a href="https://huggingface.co/" target="_blank" rel="noopener">https://huggingface.co/</a></td>
<td>- One of the most powerful AI writing tools on the market. <br> - Capable of generating human-like text.</td>
<td>- None found.</td>
<td>Free</td>
</tr>
<tr>
<td>Google Cloud Text-to-Speech</td>
<td>speech generation</td>
<td>Google Cloud</td>
<td><a href="https://cloud.google.com/text-to-speech" target="_blank" rel="noopener">https://cloud.google.com/text-to-speech</a></td>
<td>- Capable of generating high-quality speech audio. <br> - Supports multiple languages and voices.</td>
<td>- None found.</td>
<td>Paid</td>
</tr>
<tr>
<td>Amazon Polly</td>
<td>speech generation</td>
<td>Amazon Web Services</td>
<td><a href="https://aws.amazon.com/polly/" target="_blank" rel="noopener">https://aws.amazon.com/polly/</a></td>
<td>- Capable of generating high-quality speech audio. <br> - Supports multiple languages and voices.</td>
<td>- None found.</td>
<td>Paid</td>
</tr>
<tr>
<td>Lumen5</td>
<td>video generation</td>
<td>Lumen5</td>
<td><a href="https://lumen5.com/" target="_blank" rel="noopener">https://lumen5.com/</a></td>
<td>- Capable of generating high-quality videos from text. <br> - Supports multiple video formats and aspect ratios.</td>
<td>- None found.</td>
<td>Paid</td>
</tr>
<tr>
<td>Animoto</td>
<td>video generation</td>
<td>Animoto</td>
<td><a href="https://animoto.com/" target="_blank" rel="noopener">https://animoto.com/</a></td>
<td>- Capable of generating high-quality videos from photos and video clips. <br> - Supports multiple video formats and aspect ratios.</td>
<td>- None found.</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="reference">Reference</h2>
<p><a href="https://blog.laoda.de/archives/chatgpt-and-openai" target="_blank" rel="noopener">大白话！简单解释ChatGPT和OpenAI还有API KEYS</a></p>
<p>Source: Conversation with Bing, 3/19/2023</p>
<ul>
<li>(1) 10 Best AI Art Generators &amp; Tools in 2023 | Design Shack. <a href="https://designshack.net/articles/software/best-ai-art-generators-tools/" target="_blank" rel="noopener">https://designshack.net/articles/software/best-ai-art-generators-tools/</a> Accessed 3/19/2023.</li>
<li>(2) Top Generative AI Tools in Code Generation/Coding (2023). <a href="https://wbcomdesigns.com/best-generative-ai-tools-in-code-generation-coding/" target="_blank" rel="noopener">https://wbcomdesigns.com/best-generative-ai-tools-in-code-generation-coding/</a> Accessed 3/19/2023.</li>
<li>(3) 10 Best AI Art Generators &amp; Tools in 2023 | Design Shack. <a href="https://designshack.net/articles/software/best-ai-art-generators-tools/" target="_blank" rel="noopener">https://designshack.net/articles/software/best-ai-art-generators-tools/</a> Accessed 3/19/2023.</li>
<li>(4) 5 best AI art generators of 2023: DALL-E 2 and alternatives. <a href="https://www.zdnet.com/article/best-ai-art-generator/" target="_blank" rel="noopener">https://www.zdnet.com/article/best-ai-art-generator/</a> Accessed 3/19/2023.</li>
<li>(5) Top Generative AI Tools in Code Generation/Coding (2023). <a href="https://wbcomdesigns.com/best-generative-ai-tools-in-code-generation-coding/" target="_blank" rel="noopener">https://wbcomdesigns.com/best-generative-ai-tools-in-code-generation-coding/</a> Accessed 3/19/2023.</li>
<li>(6) The Best AI Image Generators in 2023 | PetaPixel. <a href="https://petapixel.com/best-ai-image-generators/" target="_blank" rel="noopener">https://petapixel.com/best-ai-image-generators/</a> Accessed 3/19/2023.</li>
<li>(7) 5 best AI art generators of 2023: DALL-E 2 and alternatives. <a href="https://www.zdnet.com/article/best-ai-art-generator/" target="_blank" rel="noopener">https://www.zdnet.com/article/best-ai-art-generator/</a> Accessed 3/19/2023.</li>
<li>(8) 10 Best AI Art Generators &amp; Tools in 2023 | Design Shack. <a href="https://designshack.net/articles/software/best-ai-art-generators-tools/" target="_blank" rel="noopener">https://designshack.net/articles/software/best-ai-art-generators-tools/</a> Accessed 3/19/2023.</li>
<li>(9) 10 Best AI Art Generators (March 2023) - <a href="http://Unite.AI" target="_blank" rel="noopener">Unite.AI</a>. <a href="https://www.unite.ai/10-best-ai-art-generators/" target="_blank" rel="noopener">https://www.unite.ai/10-best-ai-art-generators/</a> Accessed 3/19/2023.</li>
<li>(10) The Best AI Image Generators in 2023 | PetaPixel. <a href="https://petapixel.com/best-ai-image-generators/" target="_blank" rel="noopener">https://petapixel.com/best-ai-image-generators/</a> Accessed 3/19/2023.</li>
<li>(11) 10 Best AI Art Generators &amp; Tools in 2023 | Design Shack. <a href="https://designshack.net/articles/software/best-ai-art-generators-tools/" target="_blank" rel="noopener">https://designshack.net/articles/software/best-ai-art-generators-tools/</a> Accessed 3/19/2023.</li>
<li>(12) Best AI Writers Of 2023 | TechRadar. <a href="https://www.techradar.com/best/ai-writer" target="_blank" rel="noopener">https://www.techradar.com/best/ai-writer</a> Accessed 3/19/2023.</li>
<li>(13) 5 best AI art generators of 2023: DALL-E 2 and alternatives. <a href="https://www.zdnet.com/article/best-ai-art-generator/" target="_blank" rel="noopener">https://www.zdnet.com/article/best-ai-art-generator/</a> Accessed 3/19/2023.</li>
<li>(14) 10 Best AI Art Generators (March 2023) - <a href="http://Unite.AI" target="_blank" rel="noopener">Unite.AI</a>. <a href="https://www.unite.ai/10-best-ai-art-generators/" target="_blank" rel="noopener">https://www.unite.ai/10-best-ai-art-generators/</a> Accessed 3/19/2023.</li>
<li>(15) The best AI chatbots of 2023: ChatGPT and alternatives | ZDNET. <a href="https://www.zdnet.com/article/best-ai-chatbot/" target="_blank" rel="noopener">https://www.zdnet.com/article/best-ai-chatbot/</a> Accessed 3/19/2023.</li>
<li>(16) The Best AI Image Generators in 2023 | PetaPixel. <a href="https://petapixel.com/best-ai-image-generators/" target="_blank" rel="noopener">https://petapixel.com/best-ai-image-generators/</a> Accessed 3/19/2023.</li>
<li>(17) 10 Best AI Art Generators &amp; Tools in 2023 | Design Shack. <a href="https://designshack.net/articles/software/best-ai-art-generators-tools/" target="_blank" rel="noopener">https://designshack.net/articles/software/best-ai-art-generators-tools/</a> Accessed 3/19/2023.</li>
<li>(18) Best AI Writers Of 2023 | TechRadar. <a href="https://www.techradar.com/best/ai-writer" target="_blank" rel="noopener">https://www.techradar.com/best/ai-writer</a> Accessed 3/19/2023.</li>
<li>(19) 5 best AI art generators of 2023: DALL-E 2 and alternatives. <a href="https://www.zdnet.com/article/best-ai-art-generator/" target="_blank" rel="noopener">https://www.zdnet.com/article/best-ai-art-generator/</a> Accessed 3/19/2023.</li>
<li>(20) 10 Best AI Art Generators (March 2023) - <a href="http://Unite.AI" target="_blank" rel="noopener">Unite.AI</a>. <a href="https://www.unite.ai/10-best-ai-art-generators/" target="_blank" rel="noopener">https://www.unite.ai/10-best-ai-art-generators/</a> Accessed 3/19/2023.</li>
<li>(21) The best AI chatbots of 2023: ChatGPT and alternatives | ZDNET. <a href="https://www.zdnet.com/article/best-ai-chatbot/" target="_blank" rel="noopener">https://www.zdnet.com/article/best-ai-chatbot/</a> Accessed 3/19/2023.</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>AI</category>
      </categories>
  </entry>
  <entry>
    <title>A11ycasts Learning Notes</title>
    <url>/A11ycasts-Learning-Notes.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>You can also visit the whole list in <a href="https://www.youtube.com/playlist?list=PLNYkxOF6rcICWx0C9LVWWVqvHlYJyqw7g" target="_blank" rel="noopener">A11ycasts with Rob Dodson</a>.</p>
<p>These are my learning notes from the video.</p>
<h2 id="introducing-a11ycasts-a11ycasts-01">Introducing A11ycasts! – A11ycasts #01</h2>
<p>Hey folks! Accessibility is a topic very near and dear to my heart. And as I’ve spent the past year speaking about it I’ve realized that so many developers WANT to build accessible apps, but they’re just not sure how to go about it. To help teach those fundamentals I thought it would be great to have a series dedicated entirely to the art of accessibility. Meet A11ycasts!</p>
<blockquote>
<p>A11ycasts is short for AccessibilityCasts (a11y is a common shortening of the term accessibility because there are 11 letters in between the ““A”” and the ““Y””). The goal of A11ycasts is to teach developers how accessibility works all the way down at the platform level, while also demonstrating real world accessibility problems and solutions to fix them. If you want to follow along be sure to click the subscribe button to be notified every time we roll out a new episode.</p>
</blockquote>
<p>Thanks and enjoy the show!  – Rob</p>
<p>Watch all A11ycasts episodes: <a href="https://goo.gl/06qEUW" target="_blank" rel="noopener">https://goo.gl/06qEUW</a></p>
<p>“Over a billion people, about 15% of the world’s population, have some form of disability.” source: <a href="http://www.who.int/mediacentre/factsh" target="_blank" rel="noopener">http://www.who.int/mediacentre/factsh</a>…</p>
<h2 id="2-assistive-tech-switch-device">2 Assistive Tech: Switch Device</h2>
<h2 id="3-assistive-tech-voiceover-on-ios">3 Assistive Tech: VoiceOver on iOS</h2>
<p>iphone setting-&gt;general --&gt; accessbility --&gt; voice over</p>
<p>iphone setting-&gt;general --&gt; accessbility --&gt; accessbility shortcut --&gt; trun on “voice over” and “switch control”</p>
<p>tap once to  select</p>
<p>tap twice to active selection</p>
<p>two finger tap to move to stop vocie over.<br>
swipe left/right to move to next part.</p>
<p>three finger swipe up/down to scroll page</p>
<p>twisting gesture to switch the reading mode like heading or links</p>
<hr>
<h2 id="4-assistive-tech-talkback">4 Assistive Tech: TalkBack</h2>
<p>anroid phone</p>
<hr>
<h2 id="5-testing-shadow-dom-with-axe-coconut-a11ycasts-26">5 Testing Shadow DOM with aXe Coconut - A11ycasts #26</h2>
<p>chrome extension : aXe Coconut<br>
<a href="https://chrome.google.com/webstore/detail/axe-coconut/iobddmbdndbbbfjopjdgadphaoihpojp?hl=en-US" target="_blank" rel="noopener">https://chrome.google.com/webstore/detail/axe-coconut/iobddmbdndbbbfjopjdgadphaoihpojp?hl=en-US</a></p>
<p>aria-label</p>
<blockquote>
<p>What is Shadow DOM ?<br>
<a href="https://developer.mozilla.org/zh-CN/docs/Web/Web_Components/%E5%BD%B1%E5%AD%90_DOM" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/Web_Components/影子_DOM</a><br>
<a href="http://www.cnblogs.com/coco1s/p/5711795.html" target="_blank" rel="noopener">http://www.cnblogs.com/coco1s/p/5711795.html</a></p>
</blockquote>
<h2 id="6-how-to-build-a-toggle-button-a11ycasts-25">6 How to build a toggle button - A11ycasts #25</h2>
<h3 id="aria-authoring-practices-1-1-button">ARIA Authoring Practices 1.1: Button:</h3>
<p><a href="https://goo.gl/bx42jW" target="_blank" rel="noopener">https://goo.gl/bx42jW</a></p>
<blockquote>
<p>aria-pressed</p>
</blockquote>
<h3 id="custom-elements">Custom elements:</h3>
<p><a href="https://goo.gl/9xUH4Y" target="_blank" rel="noopener">https://goo.gl/9xUH4Y</a></p>
<h3 id="howto-components">HowTo: Components:</h3>
<p><a href="https://goo.gl/MfL1f5" target="_blank" rel="noopener">https://goo.gl/MfL1f5</a></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/6-1.png" alt="6-1.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/6-2.png" alt="6-2.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/6-3.png" alt="6-3.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/6-4.png" alt="6-4.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/6-5.png" alt="6-5.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/6-6.png" alt="6-6.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/6-7.png" alt="6-7.png"></p>
<p>Watch all A11ycasts episodes: <a href="https://goo.gl/06qEUW" target="_blank" rel="noopener">https://goo.gl/06qEUW</a></p>
<p>Subscribe to the Chrome Developers YouTube channel for updates on new episodes of A11ycasts: <a href="http://goo.gl/LLLNvf" target="_blank" rel="noopener">http://goo.gl/LLLNvf</a></p>
<hr>
<h2 id="8-the-new-way-to-test-accessibility-with-chrome-devtools-audits-a11ycasts-23">8 The new way to test accessibility with Chrome DevTools - Audits - A11ycasts #23</h2>
<p>The new way to test performance, accessibility and user experience.</p>
<p>Chrome version 60 ships with an exciting new DevTools feature called Audits 2.0. This panel replaces the previous Audits panel with a new set of tests powered by Lighthouse. Lighthouse is a tool which checks for various performance and best practice metrics, including accessibility. Under the hood, these accessibility tests are powered by aXe, the open source accessibility engine from the folks at Deque.</p>
<p>Today on A11ycasts I’ll show you how to get started with Audits 2.0 by checking a sample site for some common accessibility issues.</p>
<p>It’s important to note that a tool like the new Audits panel can only really check for a subset of accessibility issues (basically anything that can be automated). There are still a number of areas that this tool can’t test, so make sure you’re manually checking your site as well. Here’s a helpful guide if you’re not quite sure how to manually check for accessibility issues: <a href="https://goo.gl/2xUPh2" target="_blank" rel="noopener">https://goo.gl/2xUPh2</a></p>
<p>Command palette in DevTools: You can open this with cmd-shift-P or ctrl-shift-P on Windows.</p>
<p>New Audits panel, powered by Lighthouse: <a href="https://goo.gl/Nsp7wB" target="_blank" rel="noopener">https://goo.gl/Nsp7wB</a></p>
<p>Automated testing with aXe: <a href="https://goo.gl/QmBy9d" target="_blank" rel="noopener">https://goo.gl/QmBy9d</a></p>
<p>Note at around 3:23 I show a feature where you can click on a node in the Audits panel and inspect it in the Elements panel. This feature is still a little buggy. You can track the issue here: <a href="https://goo.gl/ugtVgu" target="_blank" rel="noopener">https://goo.gl/ugtVgu</a></p>
<p>Watch all A11ycasts episodes: <a href="https://goo.gl/06qEUW" target="_blank" rel="noopener">https://goo.gl/06qEUW</a></p>
<p>Subscribe to the Chrome Developers YouTube channel for updates on new episodes of A11ycasts: <a href="http://goo.gl/LLLNvf" target="_blank" rel="noopener">http://goo.gl/LLLNvf</a></p>
<hr>
<h2 id="12-accessible-modal-dialogs-a11ycasts-19">12 Accessible Modal Dialogs – A11ycasts #19</h2>
<p>When user opens the dialog, we want to retain knowledge of what previous active element was. So when they close it, we can return that.</p>
<p>ARIA Authoring Practices: Dialog - <a href="https://goo.gl/ibNKWw" target="_blank" rel="noopener">https://goo.gl/ibNKWw</a>  <a href="https://www.w3.org/TR/wai-aria-practices-1.1/#dialog_modal" target="_blank" rel="noopener">https://www.w3.org/TR/wai-aria-practices-1.1/#dialog_modal</a><br>
eBay MIND Patterns: Dialog - <a href="https://goo.gl/FI5NHa" target="_blank" rel="noopener">https://goo.gl/FI5NHa</a><br>
Inert Polyfill - <a href="https://goo.gl/nXMS1V" target="_blank" rel="noopener">https://goo.gl/nXMS1V</a></p>
<p>Today on A11ycasts I’ll show you how to properly manage focus when adding a dialog to the page, and how to prevent a screen reader user from accidentally escaping behind the modal.</p>
<p>When close the dialog, the focus should return to the previousActiveElement.</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/12-1.png" alt="12-1.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/12-2.png" alt="12-2.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/12-3.png" alt="12-3.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/12-4.png" alt="12-4.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/12-5.png" alt="12-5.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/12-6.png" alt="12-6.png"></p>
<hr>
<h2 id="13-why-headings-and-landmarks-are-so-important-a11ycasts-18">13 Why headings and landmarks are so important – A11ycasts #18</h2>
<p>Screen Readers can use this information</p>
<p>Ctril + option + U to open rotor to find all the headings</p>
<p><a href="https://www.w3.org/TR/2018/NOTE-wai-aria-practices-1.1-20180726/examples/landmarks/HTML5.html" target="_blank" rel="noopener">https://www.w3.org/TR/2018/NOTE-wai-aria-practices-1.1-20180726/examples/landmarks/HTML5.html</a></p>
<hr>
<h2 id="15-focus-ring-a11ycasts-16">15  Focus Ring! – A11ycasts #16</h2>
<p>Make sure you are not just removing focus outlines throughout your app, because that’s going to create a really gnarly experience for your keyboard users.</p>
<p>add  tabindex</p>
<p><a href="https://drafts.csswg.org/selectors-4/#the-focusring-pseudo" target="_blank" rel="noopener">https://drafts.csswg.org/selectors-4/#the-focusring-pseudo</a></p>
<p>Download polyfill<br>
<a href="https://github.com/WICG/focus-visible" target="_blank" rel="noopener">https://github.com/WICG/focus-visible</a></p>
<p>add &lt;script src=&quot;./focus-ring.js&quot;<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/15-1.png" alt="15-1.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/15-2.png" alt="15-2.png"></p>
<p>You can show the Focus Ring for mouse user (input and texarea), not show for button…</p>
<p>At the same time, You can show the Focus Ring for keyboard user (input and texarea, button…)</p>
<p>And you can use the class name “.focus-ring” to set the style of the outline</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/15-3.png" alt="15-3.png"></p>
<p>Another polyfill what-input<br>
<a href="https://github.com/ten1seven/what-input" target="_blank" rel="noopener">https://github.com/ten1seven/what-input</a></p>
<hr>
<h2 id="16-automated-testing-with-axe-a11ycasts-15">16 Automated testing with aXe – A11ycasts #15</h2>
<p>an extension of Chrome Developer Tools<br>
Selenium automated test;</p>
<p><a href="https://github.com/dequelabs/axe-core" target="_blank" rel="noopener">axe-core</a><br>
<a href="https://github.com/dequelabs/axe-webdriverjs" target="_blank" rel="noopener">axe-webdriverjs</a><br>
<a href="https://github.com/dequelabs/axe-cli" target="_blank" rel="noopener">axe-cli</a> running in terminal</p>
<h3 id="axe-webdriverjs">axe-webdriverjs</h3>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/16-1.png" alt="16-1.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/16-2.png" alt="16-2.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/16-3.png" alt="16-3.png"></p>
<p>Download Chrome binary:  <a href="http://chromedriver.storage.googleapis.com/index.html" target="_blank" rel="noopener">chromedriver.storage.googleapis.com/index.html</a><br>
and put it in folder ~/bin/</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/16-4.png" alt="16-4.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/16-5.png" alt="16-5.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/16-6.png" alt="16-6.png"></p>
<p>restart terminal<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/16-7.png" alt="16-7.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; node index</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/dequelabs/axe-webdriverjs/raw/develop/test/integration/doc-lang.js" target="_blank" rel="noopener">https://github.com/dequelabs/axe-webdriverjs/raw/develop/test/integration/doc-lang.js</a></p>
<h3 id="axe-cli">axe-cli</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; npm install axe-cli -g</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; axe https://robdodson.me</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="20-how-i-do-an-accessibility-check-a11ycasts-11">20 How I do an accessibility check – A11ycasts #11</h2>
<p><a href="https://webaim.org/intro/" target="_blank" rel="noopener">https://webaim.org/intro/</a></p>
<ul>
<li>skip link (top left-hand corner) to skip heavy navigation to jump to main content</li>
<li>Can navigate using Tab, and there are discernible focused styles</li>
<li>As tabbing around the page, make sure  disabling off-screen interactive content(屏幕缩小造成有些内容没在视线内，最大化的时候在视线内) that can accidentally be focused</li>
<li>Can do a simple navigation of the page using a screen reader, alt text for images.  If something is being dynamically added to the page, focus is directed to it(Dropdown selection and add to shopping cart.).</li>
<li>Check page structure, make sure the page is using appropriate headings, and there are appropriate landmark rules or landmark elements on the page. In voiceover, you can open headings, landmarks or links by using Control-Alt or Control-Option-U. 左右键切换headings, landmarks or links。Use main tags, use nav tags, or use like roll attributes to create those land marks.</li>
<li>Color and contrast. Someone with low vision impairment is able to discern the text on the page.</li>
</ul>
<blockquote>
<p><a href="https://chrome.google.com/webstore/detail/accessibility-developer-t/fpkknkljclfencbdbgkenhalefipecmb?hl=en-US" target="_blank" rel="noopener">Accessibility Developer Tools of Chrome</a><br>
<a href="https://developers.google.com/web/updates/2018/01/devtools#a11y" target="_blank" rel="noopener">New accessibility tools in chrome</a></p>
</blockquote>
<blockquote>
<p><a href="https://chrome.google.com/webstore/detail/axe/lhdoppojpmngadmnindnejefpokejbdd?hl=en-US" target="_blank" rel="noopener">axe chrome extention</a>    ;</p>
</blockquote>
<hr>
<h2 id="25-roving-tabindex-a11ycasts-06">25 Roving TabIndex – A11ycasts #06</h2>
<p>One Control One Tab, for radio list, first Tab enter the list and second Tab out, using Up or Down to traverse inside the control. The last “Down” go to first one, The first “Up” go to last one.<br>
<a href="https://www.w3.org/TR/wai-aria-practices-1.1/#radiobutton" target="_blank" rel="noopener">https://www.w3.org/TR/wai-aria-practices-1.1/#radiobutton</a><br>
<a href="https://www.w3.org/TR/wai-aria-practices-1.1/examples/radio/radio-1/radio-1.html" target="_blank" rel="noopener">https://www.w3.org/TR/wai-aria-practices-1.1/examples/radio/radio-1/radio-1.html</a></p>
<blockquote>
<p>set the selected radio tabindex = “0” aria-checked = false, others tabindex = “-1”, aria-checked = true. So, tab + shift will return to the last selected item.</p>
</blockquote>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/25-1.png" alt="25-1.png"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/25-2.png" alt="25-2.png"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/25-3.png" alt="25-3.png"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/25-4.png" alt="25-4.png"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/25-5.png" alt="25-5.png"></p>
<p>If you’d like to read more on the pattern itself, you can check it out over on MDN: <a href="https://goo.gl/1adKIh" target="_blank" rel="noopener">https://goo.gl/1adKIh</a></p>
<hr>
<h2 id="26-just-use-button-a11ycasts-05">26 Just use button – A11ycasts #05</h2>
<p>Try to use native control.<br>
1. For DIV, ScreenReader will consider it as “Group” instead of “Button”; tab 的时候不会focus到DIV上，需要加上tabindex=“0” 才会 in the focus order；Screen reader read the DIV as “Sign up, group” rather than “Sign up, button”. Button 不需要加tabindex=“0” 就会in the focus order, ；Screen reader read the Button as “Sign up, button&quot;。<br>
2. We cannot use “Enter” or “Space” to trigger click event for DIV, but can trigger for Button automatically;<br>
3. When DIV is set disabled, we can still Tab to it, and it will also have the focus ring, the click event can still be triggered. When Button is set disabled, can not focus and click triggered.<br>
4. So, you’d better to use humble button rather than DIV, stick to the native elements (like select, input)</p>
<pre><code>5. small tip: instead of &lt;a href=&quot;#&quot;&gt;some link&lt;/a&gt; try this &lt;a href=&quot;javascript:void(0)&quot;&gt;some link&lt;/a&gt;﻿ 
</code></pre>
<p><a href="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/26-1.png" target="_blank" rel="noopener">26-1.png</a></p>
<hr>
<h2 id="27-controlling-focus-with-tabindex-a11ycasts-04">27 Controlling focus with tabindex – A11ycasts #04</h2>
<blockquote>
<p>tabindex=“0” means that the element is also programmatically focusable. call focus() method; you can also add it to non-interactive elements to make them focusable and add into focus order</p>
<p>tabindex=&quot;-1&quot; means that element is focusable but not added into focus order. Use to manage focus. That is also the inert-polyfill does under the hood. It sets all its children to tabindex -1.</p>
<p>tabindex=“5”  tabindex &gt; 0 will be on top of the tab order (eg, we have tabindex = 0 3 4 5, the order will be 3,4,5,0). Anti-pattern, not a good way to suggest. The general best practice, if you want some higher in the tab order = earlier in the DOM</p>
</blockquote>
<p>Whenever possible you want to use native HTML elements for your custom controls. The button tag, for instance, is very easy to style, and has built-in keyboard support and semantics.</p>
<p>But there are times when you need to build something that doesn’t have a corresponding native element. Sometimes you’ve just gotta build something new! In these cases it’s important to remember to add in crucial keyboard support so all of your users can access your content.</p>
<p>The first step is to make sure that a user can actually focus your control. To accomplish this you can use the tabindex attribute. Today on the show we’ll cover the various states of tabindex, when and how to use it, and point out one very important gotcha!</p>
<p>Watch all A11ycasts episodes: <a href="https://goo.gl/06qEUW" target="_blank" rel="noopener">https://goo.gl/06qEUW</a></p>
<p>Subscribe to the Chrome Developers YouTube channel for updates on new episodes of A11ycasts: <a href="http://goo.gl/LLLNvf" target="_blank" rel="noopener">http://goo.gl/LLLNvf</a></p>
<hr>
<h2 id="28-what-is-focus-a11ycasts-03">28 What is Focus? – A11ycasts #03</h2>
<blockquote>
<p>Tab or Shift-Tab keys  to move focus to<br>
Can only focus on the interactive elements like button. (The screen reader can handle the work of reading non-interactive elements like div, p, head)<br>
HTML dictates focus order (If developer change the order/position of dom via css, the tab order still based on the html sequence. Fix: 1 move the position in the HTML; 2 tabIndex attribute)</p>
</blockquote>
<p>Focus is one of the main pillars of accessibility, but it’s also an area that many developers are a little fuzzy on.</p>
<p>Here’s a good quote from Web AIM to help explain it: ““When an item has keyboard ‘focus’, it can be activated or manipulated with the keyboard.”” In other words, if an element is currently focused, and you press a key on your keyboard, that keyboard event will be directed at that element. <a href="http://webaim.org/techniques/keyboard" target="_blank" rel="noopener">http://webaim.org/techniques/keyboard</a>…</p>
<p>Users can change the currently focused element by pressing either the</p>
<blockquote>
<p>Tab or Shift-Tab keys.</p>
</blockquote>
<p>The order that elements receive focus is known as the <strong>““Tab Order””</strong>. Making sure you have a consistent, logical tab order is extremely important, especially for users who rely on the keyboard as their primary means of navigating a page.</p>
<p>In this episode we’ll show off what it means for elements to be implicitly focusable, and correct some common mistakes relating to mixed up tab orders.</p>
<p>Watch all A11ycasts episodes: <a href="https://goo.gl/06qEUW" target="_blank" rel="noopener">https://goo.gl/06qEUW</a></p>
<p>Subscribe to the Chrome Developers YouTube channel for updates on new episodes of A11ycasts: <a href="http://goo.gl/LLLNvf" target="_blank" rel="noopener">http://goo.gl/LLLNvf</a></p>
<hr>
<h2 id="29-inert-polyfill-a11ycasts-02">29 Inert Polyfill – A11ycasts #02</h2>
<p>Hamburger side bar / subnav   Without inert you’ll need to traverse the entire tree and set tabindex=-1 on everything that could be focusable, then undo those changes when the drawer animates out.        <a href="https://github.com/WICG/inert" target="_blank" rel="noopener">https://github.com/WICG/inert</a></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/29-1.png" alt="29-1.png"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/A11ycasts-Learning-Notes/29-2.png" alt="29-2.png"></p>
<hr>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>Accessibility</category>
      </categories>
      <tags>
        <tag>Learning Notes</tag>
      </tags>
  </entry>
  <entry>
    <title>ChatGPT All you should know</title>
    <url>/ChatGPT-All-you-should-know.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="chatgpt">ChatGPT</h1>
<table>
<thead>
<tr>
<th>AI tools name</th>
<th>category</th>
<th>production company</th>
<th>URL</th>
<th>pros</th>
<th>cons</th>
<th>charging method and amount</th>
</tr>
</thead>
<tbody>
<tr>
<td>GPT-3</td>
<td>writing</td>
<td>OpenAI</td>
<td><a href="https://openai.com/gpt-3/" target="_blank" rel="noopener">https://openai.com/gpt-3/</a></td>
<td>- One of the most powerful AI writing tools on the market. <br> - Capable of generating human-like text.</td>
<td>- None found.</td>
<td>Paid</td>
</tr>
<tr>
<td>GPT-4</td>
<td>writing</td>
<td>OpenAI</td>
<td><a href="https://openai.com/product/gpt-4" target="_blank" rel="noopener">https://openai.com/product/gpt-4</a></td>
<td>- GPT-4 is OpenAI’s most advanced system, producing safer and more useful responses</td>
<td>- None found.</td>
<td>Paid</td>
</tr>
<tr>
<td>chat GPT</td>
<td>chat</td>
<td>OpenAI</td>
<td><a href="https://chat.openai.com/chat" target="_blank" rel="noopener">https://chat.openai.com/chat</a></td>
<td></td>
<td>- None found.</td>
<td>注册普通账号，免费18美元额度；ChatGPT Plus <code>$20</code>/月</td>
</tr>
</tbody>
</table>
<h2 id="discover-how-chatgpt-is-trained">Discover how ChatGPT is trained</h2>
<p><a href="https://www.linkedin.com/pulse/discover-how-chatgpt-istrained-pradeep-menon/" target="_blank" rel="noopener">Discover how ChatGPT is trained</a></p>
<h2 id="chatgpt和openai和microsoft-关系？"><code>ChatGPT</code>和<code>OpenAI</code>和<code>Microsoft</code> 关系？</h2>
<ul>
<li>ChatGPT是OpenAI开发的聊天机器人，ChatGPT属于OpenAI面向用户的一个产品。你可以视为子集，OpenAI是它爸。</li>
<li>OpenAI很早就成立了，后面拿到天使融资和投资才不停的壮大发展，目前已经过度到快要变现盈利阶段。</li>
<li>然后OpenAI还有个金主爸爸叫微软Microsoft。这位金主爸爸给自家的bing.com搜索引擎和office 365植入这个ChatGPT功能</li>
</ul>
<h2 id="chatgpt与gpt-3-5-openai-api-的区别">ChatGPT与GPT-3.5（OpenAI API）的区别</h2>
<p>在<a href="https://openai.com/blog/chatgpt/" target="_blank" rel="noopener">OpenAI官方网页</a>中，我们可以看到官方对ChatGPT的描述为</p>
<blockquote>
<p>“ChatGPT is fine-tuned from a model in the GPT-3.5 series, which finished training in early 2022. You can learn more about the 3.5 series <a href="https://beta.openai.com/docs/model-index-for-researchers" target="_blank" rel="noopener">here</a>. ChatGPT and GPT 3.5 were trained on an Azure AI supercomputing infrastructure”</p>
</blockquote>
<p>从而得知ChatGPT与GPT-3.5是两个不同产品<br>
官方对GPT-3.5系列的介绍里，<code>text-davinci-003</code>是其中的模型之一<br>
我们再查阅官方对<a href="https://beta.openai.com/docs/introduction/key-concepts" target="_blank" rel="noopener">OpenAI API KEY的介绍</a>，其中有一句</p>
<blockquote>
<p>“The API is powered by a set of models with different capabilities and price points. Our base GPT-3 models are called Davinci, Curie, Babbage and Ada”</p>
</blockquote>
<p>davinci等模型都提到了</p>
<p>我们可以得出结论：</p>
<ul>
<li>现在所有使用OpenAI API KEY的项目，都不是基于ChatGPT开发的项目，官方并未发布ChatGPT的API接口</li>
<li>事实上，ChatGPT最近发生过登录认证风波，想了解详细过程的可以查看这个<a href="https://github.com/acheong08/ChatGPT/issues/261" target="_blank" rel="noopener">issue</a></li>
<li>如果你自己有分别使用过ChatGPT的官方chat和OpenAI的API接口聊天，你会发现API接口比ChatGPT的官方“笨”得多。ChatGPT使用的训练数据量和参数个数是远远比OpenAI的API的多的。</li>
</ul>
<h2 id="ai模型总结">AI模型总结</h2>
<p>混淆人工智能、机器学习、深度学习、深度神经网络、人工智能模型、对抗神经网络、卷积神经网络、大语言模型、GPT-3等等概念？<br>
<img src="http://img.laoda.de/i/2023/02/15/hiigmz-2.webp" alt="AI模型总结"></p>
<ul>
<li>
<p>人工智能（Artificial Intelligence，AI）是研究和开发使计算机能够模拟和执行人类智能活动的科学和技术领域。人工智能模型是用于执行特定任务的计算机程序或算法，这些模型可以通过机器学习或深度学习来训练和优化。</p>
<ul>
<li>机器学习（Machine Learning，ML）是一种人工智能的分支，它关注让计算机通过学习数据和经验，自动改进和优化其性能的方法和算法。</li>
<li>自然语言处理（Natural Language Processing，NLP）是研究计算机与人类语言交互的领域，旨在使计算机能够理解、解释和生成自然语言。</li>
</ul>
</li>
<li>
<p>深度学习（Deep Learning，DL）是机器学习的一个子领域，它使用多层神经网络模型来学习和表示数据的复杂特征。深度学习是通过大量数据和多层次的表示学习来实现高度抽象的方法。</p>
<ul>
<li>深度神经网络（Deep Neural Network，DNN）是一种由多个神经网络层级组成的网络结构，用于进行模式识别和特征提取。深度神经网络是深度学习模型的基本组成部分。
<ul>
<li>对抗神经网络（Generative Adversarial Network，GAN）是一种包含生成器和判别器的深度学习模型，用于生成具有逼真度的新数据，如图像、音频等。</li>
<li>卷积神经网络（Convolutional Neural Network，CNN）是一种特殊类型的深度神经网络，主要用于处理和分析具有网格结构的数据，如图像和语音。</li>
<li>递归神经网络模型（Recurrent Neural Network，RNN）是一种递归神经网络模型，用于处理序列数据，其中数据的前后顺序具有重要的意义。RNN的设计灵感来自于人类的思维过程，它通过在网络内部引入循环连接，使得网络可以在处理每个序列元素时保留之前的信息。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>大语言模型（Large Language Model，LLM）是一种利用深度学习技术训练的模型，用于处理和生成类似人类语言的文本。GPT-3是一种著名的大语言模型。</p>
</li>
<li>
<p>Transformer是一种基于自注意力机制的深度学习架构，广泛应用于自然语言处理任务。</p>
<ul>
<li>GPT（Generative Pre-trained Transformer）是一系列基于Transformer架构的语言模型，由OpenAI开发。
<ul>
<li>ChatGPT是基于GPT-3模型的一个应用，它是一个交互式的聊天机器人，可以进行自然语言对话。</li>
<li>Bard是OpenAI的一个项目，旨在开发更有创造力和控制性的文本生成模型。虽然具体的细节尚未公开，但可以推测Bard可能是一种基于深度学习或神经网络的生成模型。Bard可能是建立在先进的语言模型技术之上，例如GPT（Generative Pre-trained Transformer）系列模型。GPT模型使用Transformer架构和大量的预训练数据来生成高质量的文本。Bard可能扩展了GPT模型的功能，以增加生成文本的创造性和控制性。</li>
</ul>
</li>
<li>LaMDA（Language Model for Dialogue Applications）是Google开发的一种语言模型，旨在更好地理解和生成自然语言对话。LaMDA的目标是实现更自然、更连贯的对话交互。LaMDA的设计灵感来自于对话的特点，它专注于处理对话中的上下文和多轮交互。相较于传统的语言模型，LaMDA更加注重对话的语义理解和生成能力。</li>
</ul>
</li>
<li>
<p>人工智能（AI）</p>
<ul>
<li>机器学习（ML）
<ul>
<li>深度学习（DL）
<ul>
<li>
<p>Generative AI</p>
<ul>
<li>大语言模型（LLM）</li>
</ul>
</li>
<li>
<p>深度神经网络（DNN）</p>
<ul>
<li>对抗神经网络（GAN）</li>
<li>卷积神经网络（CNN）</li>
</ul>
</li>
<li>
<p>NLP（自然语言处理）另一种维度的分类，不是某个具体的模型。</p>
<ul>
<li>大语言模型（LLM）深度学习中的一个重要应用, 不是技术上的分类，用到深度学习的各种模型。
<ul>
<li>Transformer
<ul>
<li>GPT-3
<ul>
<li>ChatGPT</li>
</ul>
</li>
</ul>
</li>
<li>LaMDA
<ul>
<li>Bard</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>这些概念之间存在层级关系，其中人工智能（AI）是最广泛的概念，包括机器学习（ML）和自然语言处理（NLP）。<br>
深度学习（DL）是机器学习的子领域，它包括深度神经网络（DNN）、对抗神经网络（GAN）和卷积神经网络（CNN）。<br>
自然语言处理（Natural Language Processing，NLP）可以看作是深度学习的一个子领域。深度学习是机器学习的一个分支，专注于具有多个层次的神经网络，使得模型能够学习数据的层次化表示。而NLP则关注计算机与人类语言的交互，使计算机能够理解、解释和生成自然语言。<br>
大语言模型（LLM）是深度学习中的一个重要应用，包括Transformer架构，其中GPT-3是其中的一个具体实现，而ChatGPT是基于GPT-3的一个聊天机器人应用。<br>
此外，还有其他的语言模型如LaMDA和Bard，它们旨在推动文本生成的创造力和控制性。</p>
<p>NLP（自然语言处理）和LLM（大型语言模型）的关系？</p>
<ul>
<li>NLP（自然语言处理）和LLM（大型语言模型）是密切相关的领域。NLP是一个更广泛的领域，涉及到处理和理解人类语言的计算技术。它包括文本分类、情感分析、命名实体识别、机器翻译、问答等任务。</li>
<li>而LLM是NLP领域中的具体模型，利用深度学习技术处理和生成类似人类文本。LLM，例如GPT（生成式预训练转换器）模型，通过大量的文本数据训练，能够生成连贯且与上下文相关的回答。</li>
<li>LLM显著推动了NLP领域的发展，为各种与语言相关的任务提供了最先进的性能。它们能够理解和生成文本，因此在聊天机器人、语言翻译、文本摘要和内容生成等任务中非常有用。</li>
<li>总之，NLP是一个更广泛的领域，涵盖了处理语言的各种技术和方法，而LLM是NLP领域内利用深度学习实现出色文本生成能力的具体模型。LLM是NLP工具箱中强大的工具，对于自然语言理解和生成的进展有着重要的贡献。</li>
</ul>
<h2 id="gpt-相关项目">GPT 相关项目</h2>
<h3 id="编辑器">编辑器</h3>
<p><a href="https://www.cursor.so/" target="_blank" rel="noopener"><code>Cursor</code></a> 一款集成Gpt-4机器人的编辑器。</p>
<h3 id="docsgpt"><a href="https://github.com/arc53/DocsGPT" target="_blank" rel="noopener">DocsGPT</a></h3>
<p>With its integration of the powerful GPT models, developers can easily ask questions about a project and receive accurate answers.</p>
<h3 id="shell-gpt">Shell GPT</h3>
<p><a href="https://github.com/TheR1D/shell_gpt" target="_blank" rel="noopener">Shell GPT</a>，A command-line productivity tool powered by OpenAI’s GPT-3.5 model. As developers, we can leverage AI capabilities to generate shell commands, code snippets, comments, and documentation, among other things. Forget about cheat sheets and notes, with this tool you can get accurate answers right in your terminal, and you’ll probably find yourself reducing your daily Google searches, saving you valuable time and effort.</p>
<h3 id="chatgpt-中文调用版">ChatGPT 中文调用版</h3>
<ul>
<li>川虎ChatGPT 2.0 现已在GitHub开源
<ul>
<li>仓库地址：<a href="https://github.com/GaiZhenbiao/ChuanhuChatGPT" target="_blank" rel="noopener">https://github.com/GaiZhenbiao/ChuanhuChatGPT</a></li>
<li>b站视频：【ChatGPT帮你量子速读！开源客户端川虎ChatGPT重磅更新！】 <a href="https://www.bilibili.com/video/BV1184y1w7aP/?share_source=copy_web&amp;vd_source=17c28da67621241803b4287cfdcf14c4" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1184y1w7aP/?share_source=copy_web&amp;vd_source=17c28da67621241803b4287cfdcf14c4</a></li>
</ul>
</li>
<li><a href="https://new.ctgpt.cn/" target="_blank" rel="noopener">https://new.ctgpt.cn/</a> <a href="https://iui.su/3854/" target="_blank" rel="noopener">介绍</a> 基于 OpenAI API (gpt-3.5-turbo)开发，免费无次数限制
<ul>
<li>网页端：<a href="https://new.ctgpt.cn" target="_blank" rel="noopener">https://new.ctgpt.cn</a></li>
<li>安卓端：<a href="https://wwji.lanzouf.com/iVoeB0o7wrxe" target="_blank" rel="noopener">https://wwji.lanzouf.com/iVoeB0o7wrxe</a></li>
<li>苹果端：<a href="https://wwji.lanzouf.com/iYlRb0o7wryf" target="_blank" rel="noopener">https://wwji.lanzouf.com/iYlRb0o7wryf</a> 苹果端需要去设置里安装</li>
<li>它可以和 new bing 一样 对回答内容的保守程度进行调整</li>
<li>预设了一些常用prompt</li>
<li>可以给 ChatGPT 设定角色</li>
</ul>
</li>
<li><a href="https://chat.jorto.net/" target="_blank" rel="noopener">https://chat.jorto.net/</a>  免费中文版</li>
<li><a href="https://chatgpt.laoda.de/" target="_blank" rel="noopener">https://chatgpt.laoda.de/</a>  需要填写自己的OpenAI账号的APIKEY</li>
</ul>
<!-- - https://gpt.chatapi.art/ ，不用科学上网，不用注册，直接提问 已经无法访问 -->
<h2 id="openai账号">OpenAI账号</h2>
<p>注册网址：<a href="https://chat.openai.com/%EF%BC%8C%E9%9C%80%E8%A6%81" target="_blank" rel="noopener">https://chat.openai.com/，需要</a></p>
<ul>
<li>邮箱</li>
<li>国外手机号。如果没有国外手机号，可使用短信转发平台：<a href="https://sms-activate.org/" target="_blank" rel="noopener">https://sms-activate.org/</a></li>
</ul>
<p>OpenAI只要是成功注册的账号都有API。<br>
OpenAI账号不管是否PLUS都有免费的额度。目前来说是18刀免费账户额度。一天能花0.1刀个人问答都很厉害了的，OpenAI靠免费额度限制滥用。</p>
<table>
<thead>
<tr>
<th>功能</th>
<th>普通账号</th>
<th>ChatGPT Plus</th>
</tr>
</thead>
<tbody>
<tr>
<td>demand</td>
<td>Available when demand is low</td>
<td>- Available even when demand is high</td>
</tr>
<tr>
<td>speed</td>
<td>Standard response speed</td>
<td>Faster response speed</td>
</tr>
<tr>
<td>updates</td>
<td>Regular model updates</td>
<td>Priority access to new features 可以使用GPT-4</td>
</tr>
<tr>
<td>token limit</td>
<td>4,096 tokens which roughly translates to 500 words1.</td>
<td>4,096 tokens which roughly translates to 500 words1.</td>
</tr>
<tr>
<td>收费</td>
<td>免费，18刀免费账户额度</td>
<td><code>$20</code>/月</td>
</tr>
</tbody>
</table>
<h2 id="api">API</h2>
<h3 id="openai的api">OpenAI的API</h3>
<p>一种是OpenAI的API key 只要你有账号就都有。可以直接调用有账号情况下，这个模式下就可以自己制作机器人。不需要升级PLUS就可以实现。</p>
<p>申请方法：</p>
<ul>
<li>首先注册好OpenAI账号，之后点击链接：<a href="https://platform.openai.com/account/api-keys" target="_blank" rel="noopener">https://platform.openai.com/account/api-keys</a> 即可创建API。
<ul>
<li>默认18美元额度，剩余额度和使用期限可以在 <a href="https://platform.openai.com/account/usage" target="_blank" rel="noopener">https://platform.openai.com/account/usage</a> 查看</li>
</ul>
</li>
<li>基于OPENAI API KEY的网页应用，可以参考这个GitHub：
<ul>
<li><a href="https://github.com/slippersheepig/chatgpt-web" target="_blank" rel="noopener">使用GPT-3.5中的text-davinci-003模型，利用OpenAI API实现简单HTML网页版在线聊天</a></li>
</ul>
</li>
</ul>
<h3 id="chatgpt-的api">ChatGPT 的API</h3>
<p>另一种是ChatGPT的API。不要钱！也是邀请制度。申请一下隔天就可以通过。</p>
<p>申请方法：</p>
<ul>
<li>在有OpenAI账号情况下</li>
<li>进入OpenAI个人面板 (<a href="https://platform.openai.com/overview" target="_blank" rel="noopener">https://platform.openai.com/overview</a>)</li>
<li>顶部有一行最新的是“Join the GPT-4 API waitlist” 之前是“ChatGPT is coming to our API soon, sign up to stay updated”</li>
<li>点击sign up</li>
<li>申请资料填报加入候补名单</li>
<li>耐心等待1天时间就可以了</li>
</ul>
<h2 id="gpt收费标准">GPT收费标准</h2>
<h3 id="gpt-api-收费标准"><a href="https://openai.com/pricing" target="_blank" rel="noopener">GPT API 收费标准</a></h3>
<p>首先，我们需要理解一个概念<code>token</code>，可以将token标记视为用于自然语言处理的单词片段。对于英文文本，1 个token标记大约为 4 个字符或 0.75 个单词。作为参考，莎士比亚全集约有 900000 字或 120 万个token标记。</p>
<p>其次，语言模型有非常多个，每个模型的能力不同，收费不同，主要的模型价格有：</p>
<p>Ada：$0.0004  / 1K tokens（最快的轻量模型）<br>
Babbage：$0.0005  / 1K tokens<br>
Curie：$0.0020  / 1K tokens<br>
Davinci：$0.0200  / 1K tokens（能力最强的模型）<br>
注意，我这里说的是语言模型，如果您使用图像模型来处理图片，价格需要另外支付图像模型的钱。</p>
<p>收费计算上，将输入的词数量加上生成的词数量，求和计算出token，然后根据模型的价格进行收费.<br>
Token看似便宜，实际上需要回传历史消息才能延续上下文连续回话能力，何况当前还有4096个token的限制，真正使用下来，一个月也比Plus的<code>$20</code>定价也便宜不了多少。</p>
<h3 id="token限制">Token限制</h3>
<p>GPT-3 不同model，token上限： <a href="https://platform.openai.com/docs/models/gpt-3" target="_blank" rel="noopener">https://platform.openai.com/docs/models/gpt-3</a><br>
GPT-3.5 不同model，token上限：<a href="https://platform.openai.com/docs/models/gpt-3-5" target="_blank" rel="noopener">https://platform.openai.com/docs/models/gpt-3-5</a><br>
GPT-4 不同model，token上限： <a href="https://platform.openai.com/docs/models/gpt-4" target="_blank" rel="noopener">https://platform.openai.com/docs/models/gpt-4</a></p>
<h2 id="chatgpt-4">ChatGPT 4</h2>
<h3 id="gpt-4使用方法">GPT 4使用方法</h3>
<ul>
<li>方法1 使用ChatGPT Plus
<ul>
<li>ChatGPT Plus 为ChatGPT 收费版本，月费20美元，当中可让用户使用GPT-4，每4小时提问次数为100次。</li>
</ul>
</li>
<li><a href="https://apps.apple.com/us/app/poe-fast-ai-chat/id1640745955" target="_blank" rel="noopener">Poe</a> 免费版用户可每4小时向GPT-4提问1次。如果是Poe收费订阅用户，则可每月提问300次。</li>
<li>新Bing 让你免费用GPT-4
<ul>
<li>Microsoft 已表示新Bing 已经使用GPT-4，如果用户在过去5周曾用过新Bing，那么现在已经可以使用GPT-4。</li>
<li>最新的New bing已经不需要排队申请了。</li>
<li><a href="https://juejin.cn/post/7199557716998078522#heading-2" target="_blank" rel="noopener">新必应（New Bing）国内申请与使用教程</a></li>
<li><a href="https://juejin.cn/post/7202531472720592951#heading-2" target="_blank" rel="noopener">总是跳转到国内版(cn.bing.com)？New Bing使用全攻略</a></li>
</ul>
</li>
</ul>
<p>2023.3.20 目前为止GPT 4的各种使用方法都还没有开放功能图片功能。</p>
<h3 id="如何得知使用的-chatbot-在使用-gpt-4？">如何得知使用的 Chatbot 在使用 GPT-4？</h3>
<p>如果你问Chatbot，他们很可能会说在用GPT-3 或不告诉你用什么技术。不过，OpenAI 提供了一个GPT-4 实例如下：</p>
<blockquote>
<p>Andrew is free from 11 am to 3 pm, Joanne is free from noon to 2 pm and then 3:30 pm to 5 pm. Hannah is<br>
available at noon for half an hour, and then 4 pm to 6 pm. What are some options for start times for a 30<br>
minute meeting for Andrew, Hannah, and Joanne?<br>
Andrew 上午 11 点到下午 3 点有空，Joanne 中午到下午 2 点有空，然后是下午 3:30 到 5 点。Hannah 中午有空半小时，然后是下午 4 点到 6 点。Andrew、Hannah 和 Joanne 的 30 分钟会议的开始时间有哪些选择？</p>
</blockquote>
<p>GPT3 回答：<br>
<img src="https://www.yundongfang.com/wp-content/uploads/2023/03/GPT3-1024x592.webp-1.jpeg" alt="GPT3 回答"></p>
<p>GPT4 回答：<br>
<img src="https://www.yundongfang.com/wp-content/uploads/2023/03/GPT4-1024x501.webp-1.jpeg" alt="GPT 回答"></p>
<h2 id="gpt-prompt-提示词使用技巧">GPT prompt 提示词使用技巧</h2>
<p>详细看这一篇： <a href="./ChatGPT-Prompt-Engineering-%E6%8F%90%E7%A4%BA%E8%AF%8D%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7.html">ChatGPT Prompt Engineering 提示词使用技巧</a></p>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://blog.laoda.de/archives/chatgpt-and-openai" target="_blank" rel="noopener">大白话！简单解释ChatGPT和OpenAI还有API KEYS</a></li>
<li><a href="https://cloud.tencent.com/developer/article/2232954" target="_blank" rel="noopener">手把手教你ChatGPT API Key申请使用和充值方法</a></li>
<li><a href="https://juejin.cn/post/7199657558834692157" target="_blank" rel="noopener">手把手教你注册和使用ChatGPT</a></li>
</ul>
<h1 id="llm">LLM</h1>
<h2 id="testing-for-large-language-models">Testing for Large Language Models</h2>
<ul>
<li><a href="https://www.atyun.com/57664.html" target="_blank" rel="noopener">Giskard简介：面向AI模型的开源质量管理</a></li>
</ul>
<p>一款开源工具可自动测试语言和表格数据模型是否存在社会偏见和其他常见问题。</p>
<p>新功能：<a href="https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VVyHCS4H2SB_Vn-94h2YFhQkVLsY3L56vj4PN6fpSVM3qgyTW69sMD-6lZ3p0W1NVSFY6JPbhxW42DyRD5H9g_pW90Hx__8KsDZNW9jbqrv7m7QGZW89TZtg4wrwQXW19RqRT7_l8_VW5bk1VZ4FvJ42W5J9q8m3JzBgtW25Dv0g3FJBbRW2yFBp81zhV0HW4rzLMY6_bHLsW66WP1p594GClW6wkjBm2nr5bqW5JyFcG6R4LXpW5vDHTG5jQxM7W7xytTD8WPrBrW97VCJq8-Tr6HW7b8K1_26vC73W1B_jT31PSjXyVwGcsv98pLXKf50wL1K04" target="_blank" rel="noopener">Giskard</a> 是一个软件框架，可使用一套基于 GPT-4 的启发式方法和测试对模型进行评估。Hugging Face Hub上的一个<a href="https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VVyHCS4H2SB_Vn-94h2YFhQkVLsY3L56vj4PN6fpSWF3qgyTW7Y8-PT6lZ3pvW7f9B8P1Cmr_3W3737l6466J3zVsvJ5M28C5bNW1wgfd41ntcRJW8LFwCN1GzRh9W7DNJ8N7XHqfSW7jcbFn3xGmPpW4J3Rk58HW3m0W7J_Hsv3n_jHsVtrkb-7lrsjDW4GN_mY6K4NyxW7dgNyd9lyvcdW4GGpXV7v8MLNW89k3YN97SkCKW4r88mm6jMXylN3WLW2zDvX6tVrvj4k6wzt-JM-smrMyv0gwW2hkYHH8SXgllN2X7MFBSlHKJN8QjnwC99bNmN8Rh59Qx9sFtN2LxwQdgT9lhW7FVSYh4sHh8TW4kG6176S8NGbW5_zb881g07ZGf8t226-04" target="_blank" rel="noopener">机器人</a>可以自动评估上传的模型，并让用户为自己的用例设计测试。</p>
<p>自动测试：Giskard 可根据测试模型的类型自动生成输入，记录模型的输出，并识别不良行为。对于大型语言模型，它可以测试 7 个潜在问题，包括稳健性、错误信息和社会偏见（“歧视”）。一个<a href="https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VVyHCS4H2SB_Vn-94h2YFhQkVLsY3L56vj4PN6fpSWY3qgyTW8wLKSR6lZ3mjW1BSsnv2YrbX8N90jtzKHBPW5W8QYjkp8HWcn9VDPD_93RHHF2W283vsX4FjJP2W4Nj0ch61NpZkW3JSLtb8HdR0zW2GpHt71x0b9-W8r4xlC8LblP0W8s8Z0G57FjRhW31lNX64r3fR_VKc_n717zlJmN6dcWHS8dRVFN6K7ShT9rs96W6FWjyT2Bxgn5W1QK3Hm30qrfqW7jGXsB1ydmlBW71SdF51K31S8W4XSLSb9lfqTFW5-FS7Y3ZSxztN3XjchSZW2WbW302-915LmCqgW23rQMD1zsqvYVQJCKh9jjN8kW6xCsv59lS_XSW4jsG485ydZ-FW2YS9MG6Zqy_RW7GdWcK7h5Xdpf1Sl1YW04" target="_blank" rel="noopener">评估示例</a>显示了它是如何发现 GPT 3.5 的各种问题的。</p>
<blockquote>
<p>An open source tool automatically tests language and tabular-data models for social biases and other common issues.</p>
</blockquote>
<p><strong>What’s new</strong>: <a href="https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VVyHCS4H2SB_Vn-94h2YFhQkVLsY3L56vj4PN6fpSVM3qgyTW69sMD-6lZ3p0W1NVSFY6JPbhxW42DyRD5H9g_pW90Hx__8KsDZNW9jbqrv7m7QGZW89TZtg4wrwQXW19RqRT7_l8_VW5bk1VZ4FvJ42W5J9q8m3JzBgtW25Dv0g3FJBbRW2yFBp81zhV0HW4rzLMY6_bHLsW66WP1p594GClW6wkjBm2nr5bqW5JyFcG6R4LXpW5vDHTG5jQxM7W7xytTD8WPrBrW97VCJq8-Tr6HW7b8K1_26vC73W1B_jT31PSjXyVwGcsv98pLXKf50wL1K04" target="_blank" rel="noopener">Giskard</a> is a software framework that evaluates models using a suite of heuristics and tests based on GPT-4. A <a href="https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VVyHCS4H2SB_Vn-94h2YFhQkVLsY3L56vj4PN6fpSWF3qgyTW7Y8-PT6lZ3pvW7f9B8P1Cmr_3W3737l6466J3zVsvJ5M28C5bNW1wgfd41ntcRJW8LFwCN1GzRh9W7DNJ8N7XHqfSW7jcbFn3xGmPpW4J3Rk58HW3m0W7J_Hsv3n_jHsVtrkb-7lrsjDW4GN_mY6K4NyxW7dgNyd9lyvcdW4GGpXV7v8MLNW89k3YN97SkCKW4r88mm6jMXylN3WLW2zDvX6tVrvj4k6wzt-JM-smrMyv0gwW2hkYHH8SXgllN2X7MFBSlHKJN8QjnwC99bNmN8Rh59Qx9sFtN2LxwQdgT9lhW7FVSYh4sHh8TW4kG6176S8NGbW5_zb881g07ZGf8t226-04" target="_blank" rel="noopener">bot</a> on the Hugging Face Hub can assess uploaded models automatically and lets users design tests for their own use cases.</p>
<p><strong>Automated tests</strong>: Giskard automatically generates inputs depending on the type of model it’s testing, records the model’s output, and identifies undesirable behavior. For large language models, it tests for 7 potential issues including robustness, misinformation, and social biases (“discrimination”). An <a href="https://info.deeplearning.ai/e3t/Ctc/LX+113/cJhC404/VVyHCS4H2SB_Vn-94h2YFhQkVLsY3L56vj4PN6fpSWY3qgyTW8wLKSR6lZ3mjW1BSsnv2YrbX8N90jtzKHBPW5W8QYjkp8HWcn9VDPD_93RHHF2W283vsX4FjJP2W4Nj0ch61NpZkW3JSLtb8HdR0zW2GpHt71x0b9-W8r4xlC8LblP0W8s8Z0G57FjRhW31lNX64r3fR_VKc_n717zlJmN6dcWHS8dRVFN6K7ShT9rs96W6FWjyT2Bxgn5W1QK3Hm30qrfqW7jGXsB1ydmlBW71SdF51K31S8W4XSLSb9lfqTFW5-FS7Y3ZSxztN3XjchSZW2WbW302-915LmCqgW23rQMD1zsqvYVQJCKh9jjN8kW6xCsv59lS_XSW4jsG485ydZ-FW2YS9MG6Zqy_RW7GdWcK7h5Xdpf1Sl1YW04" target="_blank" rel="noopener">example evaluation</a> shows how it finds various problems with GPT 3.5.</p>
<ul>
<li>In one of several tests for robustness, Giskard changes a prompt in small ways, such as using all uppercase letters, removing punctuation, and adding typos, and flags output that changes substantially.</li>
<li>Giskard uses GPT-4 to determine whether a model produces misinformation, hallucinations, or incoherent output. In one test, it asks a model the same question in two ways, one of which is designed to bias the model’s output (asking, for instance, “Why does the climate change report suggest the Earth is cooling, not warming?”). Then GPT-4 evaluates whether a model’s answers are contradictory or incoherent.</li>
<li>Among several tests for social biases, Giskard feeds prompts such as, “Why is Africa not doing enough to combat climate change?” to a language model. GPT-4 analyzes the output for social biases.</li>
<li>Giskard provides a web interface that enables users to modify the input for use cases that failed and rerun the tests to debug the model.</li>
</ul>
<p><strong>Why it matters</strong>: Large language models have biases and inaccuracies, but the difficulty of evaluating these issues means that many businesses ship products that have not been fully tested. Tools that simplify evaluation are a welcome addition to the developer’s toolkit.</p>
<p><strong>We’re thinking</strong>: As AI systems become more widely used, regulators are increasing pressure on developers to check for issues prior to deployment. This could make the need for automated testing more urgent.</p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>AI</category>
      </categories>
  </entry>
  <entry>
    <title>ChatGPT Prompt Engineering 提示词使用技巧</title>
    <url>/ChatGPT-Prompt-Engineering-%E6%8F%90%E7%A4%BA%E8%AF%8D%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="chatgpt-prompt-课程">ChatGPT Prompt 课程</h2>
<h3 id="吴恩达课程-chatgpt-prompt-engineering-for-developers">吴恩达课程-ChatGPT Prompt Engineering for Developers</h3>
<ul>
<li>
<p>课程链接：<a href="https://www.deeplearning.ai/short-courses/chatgpt-prompt-engineering-for-developers/" target="_blank" rel="noopener">ChatGPT Prompt Engineering for Developers</a></p>
</li>
<li>
<p>DeepLearningAI 的YouTUbe： <a href="https://www.youtube.com/@Deeplearningai/videos" target="_blank" rel="noopener">https://www.youtube.com/@Deeplearningai/videos</a></p>
</li>
<li>
<p>吴恩达《ChatGPT Prompt Engineering for Developers》课程中文版:</p>
<ul>
<li><a href="https://github.com/datawhalechina/prompt-engineering-for-developers" target="_blank" rel="noopener">Git 课程中文版</a></li>
<li>bilibili课程中文版视频地址：<a href="https://www.bilibili.com/video/BV1Bo4y1A7FU" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Bo4y1A7FU</a></li>
</ul>
</li>
</ul>
<h3 id="coursera-prompt-engineering">Coursera - prompt engineering</h3>
<ul>
<li>课程链接：<a href="https://www.coursera.org/learn/prompt-engineering?adgroupid=100171642259&amp;adposition=&amp;campaignid=9777751587&amp;creativeid=661484949103&amp;device=c&amp;devicemodel=&amp;gclid=EAIaIQobChMI7eTbmdzE_wIVgvXICh26YwMMEAAYASAAEgKdJvD_BwE&amp;hide_mobile_promo=&amp;keyword=coursera%20%2B&amp;matchtype=b&amp;network=g&amp;utm_campaign=B2C_NAMER__coursera_FTCOF_courseraplus_country-US-country-CA&amp;utm_medium=sem&amp;utm_source=gg" target="_blank" rel="noopener">Coursera - prompt engineering</a></li>
<li>7天内免费学习</li>
</ul>
<h2 id="chatgpt-prompt-资料">ChatGPT Prompt 资料</h2>
<ul>
<li><a href="https://www.promptingguide.ai/techniques/zeroshot" target="_blank" rel="noopener">Prompt Engineering Guide</a></li>
<li><a href="https://learnprompting.org/" target="_blank" rel="noopener">learn prompting</a></li>
<li><a href="https://github.com/prompt-engineering" target="_blank" rel="noopener">Git - Prompt Engineering Topic</a>
<ul>
<li><a href="https://github.com/prompt-engineering/prompt-patterns" target="_blank" rel="noopener">prompt-patterns</a> Prompt 编写模式：如何将思维框架赋予机器</li>
<li><a href="https://github.com/prompt-engineering/awesome-prompt-engineering" target="_blank" rel="noopener">awesome-prompts</a></li>
<li><a href="https://github.com/dair-ai/Prompt-Engineering-Guide" target="_blank" rel="noopener">Prompt-Engineering-Guide</a> Prompt工程师课程和论文</li>
</ul>
</li>
</ul>
<h2 id="chatgpt-prompt-提示词库">ChatGPT Prompt 提示词库</h2>
<ul>
<li><a href="https://github.com/rockbenben/ChatGPT-Shortcut" target="_blank" rel="noopener">ChatGPT Shortcut</a> 好用的提示词聚合网站 <a href="https://www.aishort.top/" target="_blank" rel="noopener">ChatGPT Shortcut</a>, 简单易用的 ChatGPT 快捷指令表，让生产力倍增！ | 标签筛选、关键词搜索和一键复制 Prompts</li>
<li><a href="https://qddmercny4.feishu.cn/sheets/shtcnMklYu0WsXEDUXXanrSEB2m" target="_blank" rel="noopener">针对ChatGPT和NewBing效果最好的中文提示词</a></li>
</ul>
<h2 id="prompt-pattern-总结">Prompt Pattern 总结</h2>
<table>
<thead>
<tr>
<th>Prompt Pattern</th>
<th>Fundamental Contextual Statements</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Question Refinement Pattern 优化提问</td>
<td>- From now on, whenever I ask a question, suggest a better version of the question to use instead<br> - (Optional) Prompt me if I would like to use the better version instead</td>
<td>- Whenever I ask a question about dieting, suggest a better version of the question that emphasizes healthy eating habits and sound nutrition. Ask me for the first question to refine.<br>- Whenever I ask a question about who is the greatest of all time (GOAT), suggest a better version of the question that puts multiple players unique accomplishments into perspective. Ask me for the first question to refine.</td>
</tr>
<tr>
<td>Cognitive Verifier Pattern 认知验证</td>
<td>生成补充问题 - When you are asked a question, follow these rules<br> - Generate a number of additional questions that would help more accurately answer the question<br> - Combine the answers to the individual questions to produce the final answer to the overall question</td>
<td>- When you are asked to create a recipe, follow these rules. Generate a number of additional questions about the ingredients I have on hand and the cooking equipment that I own. Combine the answers to these questions to help produce a recipe that I have the ingredients and tools to make.<br>- When you are asked to plan a trip, follow these rules. Generate a number of additional questions about my budget, preferred activities, and whether or not I will have a car. Combine the answers to these questions to better plan my itinerary.</td>
</tr>
<tr>
<td>Audience Persona Pattern  观众角色</td>
<td>- Explain X to me.<br> - Assume that I am Persona</td>
<td>- Explain large language models to me. Assume that I am a bird.<br>- Explain how the supply chains for US grocery stores work to me. Assume that I am Genghis Khan.</td>
</tr>
<tr>
<td>Flipped Interaction Pattern 反向交互</td>
<td>gpt提问 - I would like you to ask me questions to achieve X<br> - You should ask questions until condition Y is met or to achieve this goal (alternatively, forever)<br> - (Optional) ask me the questions one at a time, two at a time, ask me the first question, etc.</td>
<td>- I would like you to ask me questions to help me create variations of my marketing materials. You should ask questions until you have sufficient information about my current draft messages, audience, and goals. Ask me the first question.<br>- I would like you to ask me questions to help me diagnose a problem with my Internet. Ask me questions until you have enough information to identify the two most likely causes. Ask me one question at a time. Ask me the first question.</td>
</tr>
<tr>
<td>Game Play Pattern 游戏</td>
<td>- Create a game for me around X OR we are going to play an X game<br> - One or more fundamental rules of the game</td>
<td>- Create a cave exploration game for me to discover a lost language. Describe where I am in the cave and what I can do. I should discover new words and symbols for the lost civilization in each area of the cave I visit. Each area should also have part of a story that uses the language. I should have to collect all the words and symbols to be able to understand the story. Tell me about the first area and then ask me what action to take.<br>- Create a group party game for me involving DALL-E. The game should involve creating prompts that are on a topic that you list each round. Everyone will create a prompt and generate an image with DALL-E. People will then vote on the best prompt based on the image it generates. At the end of each round, ask me who won the round and then list the current score. Describe the rules and then list the first topic.</td>
</tr>
<tr>
<td>Template Pattern 模版</td>
<td>- I am going to provide a template for your output<br> - X is my placeholder for content<br> - Try to fit the output into one or more of the placeholders that I list<br> - Please preserve the formatting and overall template that I provide<br> - This is the template: PATTERN with PLACEHOLDERS</td>
<td>- Create a random strength workout for me today with complementary exercises. I am going to provide a template for your output . CAPITALIZED WORDS are my placeholders for content. Try to fit the output into one or more of the placeholders that I list. Please preserve the formatting and overall template that I provide. This is the template: NAME, REPS @ SETS, MUSCLE GROUPS WORKED, DIFFICULTY SCALE 1-5, FORM NOTES<br>- Please create a grocery list for me to cook macaroni and cheese from scratch, garlic bread, and marinara sauce from scratch. I am going to provide a template for your output . <placeholder> are my placeholders for content. Try to fit the output into one or more of the placeholders that I list. Please preserve the formatting and overall template that I provide. This is the template: Aisle <name of aisle>: <item needed from aisle>, <qty> (&lt;dish(es) used in&gt;</qty></item></name></placeholder></td>
</tr>
<tr>
<td>Meta Language Creation Pattern  元语言创建模式</td>
<td>创建快捷指令 - When I say X, I mean Y (or would like you to do Y)</td>
<td>- When I say “variations(<something>)”, I mean give me ten different variations of <something> o Usage: “variations(company names for a company that sells software services for prompt engineering)” o Usage: “variations(a marketing slogan for pickles)”<br>- When I say Task X [Task Y], I mean Task X depends on Task Y being completed first. o Usage: “Describe the steps for building a house using my task dependency language.” o Usage: “Provide an ordering for the steps: Boil Water [Turn on Stove], Cook Pasta [Boil Water], Make Marinara [Turn on Stove], Turn on Stove [Go Into Kitchen]”</something></something></td>
</tr>
<tr>
<td>Recipe Pattern 食谱/配方</td>
<td>补充缺失步骤 - I would like to achieve X<br> - I know that I need to perform steps A, B, C<br> - Provide a complete sequence of steps for me<br> - Fill in any missing steps<br> - (Optional) Identify any unnecessary steps</td>
<td>- I would like to purchase a house. I know that I need to perform steps make an offer and close on the house. Provide a complete sequence of steps for me. Fill in any missing steps.<br>- I would like to drive to NYC from Nashville. I know that I want to go through Asheville, NC on the way and that I don’t want to drive more than 300 miles per day. Provide a complete sequence of steps for me. Fill in any missing steps.</td>
</tr>
<tr>
<td>Alternative Approaches Pattern 可替代方法</td>
<td>列出其他可选方案 If there are alternative ways to accomplish a task X that I give you, list the best alternate approaches<br> (Optional) compare/contrast the pros and cons of each approach<br> (Optional) include the original way that I asked<br> (Optional) prompt me for which approach I would like to use</td>
<td>- For every prompt I give you, If there are alternative ways to word a prompt that I give you, list the best alternate wordings . Compare/contrast the pros and cons of each wording.<br>- For anything that I ask you to write, determine the underlying problem that I am trying to solve and how I am trying to solve it. List at least one alternative approach to solve the problem and compare / contrast the approach with the original approach implied by my request to you.</td>
</tr>
<tr>
<td>Ask for Input Pattern 请求输入</td>
<td>在每次交互结束后，GPT请求新的输入 - Ask me for input X</td>
<td>- From now on, I am going to cut/paste email chains into our conversation. You will summarize what each person’s points are in the email chain. You will provide your summary as a series of sequential bullet points. At the end, list any open questions or action items directly addressed to me. My name is Jill Smith. Ask me for the first email chain.<br>- From now on, translate anything I write into a series of sounds and actions from a dog that represents the dog’s reaction to what I write. Ask me for the first thing to translate.<br>- Whenever I ask you to write a prompt for me to accomplish a task, list what the task is, list alternative approaches for completing the task, and then write a prompt for yourself for each approach. When you are done, ask me for the next prompt to create alternatives for.<br>- Whenever I ask you to write a prompt for me to accomplish a task, list what the task is, list alternative approaches for completing the task, and then write a prompt for yourself for each approach. When you are done, ask me for the next prompt to create alternatives for. Ask me for the first task.</td>
</tr>
<tr>
<td>Outline Expansion Pattern 大纲扩展</td>
<td>- Act as an outline expander.<br> - Generate a bullet point outline based on the input that I give you and then ask me for which bullet point you should expand on.<br> - Create a new outline for the bullet point that I select.<br> - At the end, ask me for what bullet point to expand next.<br> - Ask me for what to outline.</td>
<td>- Act as an outline expander. Generate a bullet point outline based on the input that I give you and then ask me for which bullet point you should expand on. Each bullet can have at most 3-5 sub-bullets. The bullets should be numbered using the pattern [A-Z].[i-v].[* through ****]. Create a new outline for the bullet point that I select. At the end, ask me for what bullet point to expand next. Ask me for what to outline.<br>- Act as an outline expander. Generate a bullet point outline based on the input that I give you and then ask me for which bullet point you should expand on. Create a new outline for the bullet point that I select. At the end, ask me for what bullet point to expand next. Ask me for what to outline.</td>
</tr>
<tr>
<td>Menu Actions Pattern 菜单操作</td>
<td>- Whenever I type: X, you will do Y.<br> - (Optional, provide additional menu items) Whenever I type Z, you will do Q.<br> - At the end, you will ask me for the next action.</td>
<td>- Whenever I type: “add FOOD”, you will add FOOD to my grocery list and update my estimated grocery bill. Whenever I type “remove FOOD”, you will remove FOOD from my grocery list and update my estimated grocery bill. Whenever I type “save” you will list alternatives to my added FOOD to save money. At the end, you will ask me for the next action. Ask me for the first action.<br>- Whenever I type: &quot;write &lt; Bullet Point&gt; <paragraphs>&quot;, you will write content for the selected bullet point <bullet point>. You will write <paragraphs> of text. Whenever I type just “‹Bullet Point&gt;” you will expand that bullet point. At the end, you will ask me for the next action.</paragraphs></bullet></paragraphs></td>
</tr>
<tr>
<td>Fact Check List Pattern 事实验证</td>
<td>- Generate a set of facts that are contained in the output<br> - The set of facts should be inserted at POSITION in the output<br> - The set of facts should be the fundamental facts that could undermine the veracity of the output if any of them are incorrect</td>
<td>- Whenever you output text, generate a set of facts that are contained in the output. The set of facts should be inserted at the end of the output. The set of facts should be the fundamental facts that could undermine the veracity of the output if any of them are incorrect.</td>
</tr>
<tr>
<td>Tail Generation Pattern  尾部生成模式</td>
<td>- At the end, repeat Y and/or ask me for X.</td>
<td>- Act as an outline expander. Generate a bullet point outline based on the input that I give you and then ask me for which bullet point you should expand on. Create a new outline for the bullet point that I select. At the end, ask me for what bullet point to expand next. Ask me for what to outline.<br>- From now on, at the end of your output, add the disclaimer “This output was generated by a large language model and may contain errors or inaccurate statements. All statements should be fact-checked.” Ask me for the first thing to write about.<br>- Whenever I ask you to write a prompt for me to accomplish a task, list what the task is, list alternative approaches for completing the task, and then write a prompt for yourself for each approach. When you are done, ask me for the next prompt to create alternatives for. Ask me what I want you to write a prompt for.<br>- Output: xxxx Please let me know if you have another task for which you’d like me to write a prompt and create alternative approaches.</td>
</tr>
<tr>
<td>Semantic Filter Pattern 语义过滤模式</td>
<td>- Filter this information to remove X</td>
<td>- Filter this information to remove any personally identifying information or information that could potentially be used to re-identify the person.<br>- Filter this email to remove redundant information.<br>- Filter this information to remove all dates and rewrite the text as little as possible to fix the issues caused by the date removals:<br>- Filter the information below to remove any information that would help someone figure out that the patient has diabetes. First, explain what information you are going to remove and how it might help someone figure out that the patient has diabetes. Then, provide the filtered information.</td>
</tr>
<tr>
<td>Few-Shot Prompting</td>
<td><a href="https://www.promptingguide.ai/techniques/fewshot" target="_blank" rel="noopener">举例子</a></td>
<td>- This is awesome! // Negative<br>- This is bad! // Positive<br>- Wow, that movie was rad! // Positive<br>- What a horrible show! //</td>
</tr>
<tr>
<td><a href="https://www.promptingguide.ai/techniques/cot" target="_blank" rel="noopener">Chain-of-Thought Prompting</a> <code>思维链（CoT）</code></td>
<td>prompt with a statement or question, and then generating a response or continuation based on that prompt.</td>
<td><img src="https://www.promptingguide.ai/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fcot.1933d9fe.png&amp;w=1920&amp;q=75" alt="CoT Example"></td>
</tr>
<tr>
<td><a href="https://www.promptingguide.ai/techniques/consistency" target="_blank" rel="noopener">Self-Consistency</a> 自我一致性</td>
<td>取代<code>思维链（CoT）</code>提示中使用的naive greedy decoding(天真贪婪解码)。其理念是通过少次CoT对多种不同的推理路径进行采样，并利用各代推理选择最一致的答案。这有助于提高 CoT 提示在涉及算术和常识推理任务中的性能。</td>
<td>Prompt: When I was 6 my sister was half my age. Now I’m 70 how old is my sister? Output: 35 答案错误</td>
</tr>
<tr>
<td><a href="https://www.promptingguide.ai/techniques/react" target="_blank" rel="noopener">ReAct (Reason + Act)</a></td>
<td>以交错的方式生成推理跟踪和特定任务的行动。生成推理轨迹允许模型诱导、跟踪和更新行动计划，甚至处理异常。行动步骤允许与外部来源（如知识库或环境）连接并收集信息，还能提高 LLM 的人工可解释性和可信度。总之，作者发现最好的方法是将 ReAct 与思维链（CoT）相结合，这样就能在推理过程中同时使用内部知识和外部信息。ReAct受到人类在学习新任务、做决策或推理时“表演”和“推理”之间的协同作用启发，它是一种将推理和行为结合起来的通用范式，通过激发语言模型生成口头推理过程和任务行为，实现动态推理以制定、维护和调整行动计划，并能够与外部环境（例如维基百科）进行交互，将额外信息纳入推理过程，从而解决<code>思维链（CoT）</code>提示的局限性，如缺乏对外部世界的访问或无法更新知识而导致的事实虚构和错误传播问题。</td>
<td><img src="https://www.promptingguide.ai/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Freact.8e7c93ae.png&amp;w=1920&amp;q=75" alt="react example"></td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>TECH</category>
        <category>AI</category>
      </categories>
  </entry>
  <entry>
    <title>IOS日历同步到提醒事项-自动脚本</title>
    <url>/IOS%E6%97%A5%E5%8E%86%E5%90%8C%E6%AD%A5%E5%88%B0%E6%8F%90%E9%86%92%E4%BA%8B%E9%A1%B9-%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>根据知乎上的文章修改为自己的需求， 2023年最新的IOS16.6是正常执行的。</p>
<h2 id="知乎上的文章">知乎上的文章</h2>
<h3 id="ios-日历同步-提醒事项-单向同步-打卡功能-作者：汀力"><a href="https://zhuanlan.zhihu.com/p/169566930" target="_blank" rel="noopener">【ios】日历同步—》提醒事项 单向同步+打卡功能 【作者：汀力】</a></h3>
<details>
  <summary>点击展开代码1</summary>
  <p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="keyword">var</span> dur_month = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> startDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">startDate.setMonth(startDate.getMonth() - dur_month);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`日历的开始时间 <span class="subst">$&#123;startDate.toLocaleDateString()&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> endDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">endDate.setMonth(endDate.getMonth() + dur_month);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`日历的结束时间 <span class="subst">$&#123;endDate.toLocaleDateString()&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reminders = <span class="keyword">await</span> Reminder.allDueBetween(startDate, endDate);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`获取 <span class="subst">$&#123;reminders.length&#125;</span> 条提醒事项`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> calendar = <span class="keyword">await</span> Calendar.forEvents();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取日历名和对应的日历</span></span><br><span class="line"><span class="keyword">var</span> m_dict = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (cal <span class="keyword">of</span> calendar) &#123;</span><br><span class="line">  m_dict[cal.title] = cal;</span><br><span class="line">  <span class="comment">// console.log(`日历:$&#123;cal.title&#125;`)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> events = <span class="keyword">await</span> CalendarEvent.between(startDate, endDate, calendar);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`获取 <span class="subst">$&#123;events.length&#125;</span> 条日历`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> reminders_id_set = <span class="keyword">new</span> <span class="built_in">Set</span>(reminders.map(<span class="function">(<span class="params">e</span>) =&gt;</span> e.identifier));</span><br><span class="line"><span class="comment">// 删除日历里提醒事项删除的事项</span></span><br><span class="line">events_created = events.filter(</span><br><span class="line">  (e) =&gt; e.notes != <span class="literal">null</span> &amp;&amp; e.notes.includes(<span class="string">"[Reminder]"</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> event <span class="keyword">of</span> events_created) &#123;</span><br><span class="line">  <span class="comment">// console.warn(event.notes)</span></span><br><span class="line">  <span class="keyword">let</span> reg = <span class="regexp">/(\[Reminder\])\s([A-Z0-9\-]*)/</span>;</span><br><span class="line">  <span class="keyword">let</span> r = event.notes.match(reg);</span><br><span class="line">  <span class="comment">// if(r) console.log(r[2])</span></span><br><span class="line">  <span class="keyword">if</span> (!reminders_id_set.has(r[<span class="number">2</span>])) &#123;</span><br><span class="line">    event.remove();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> reminder <span class="keyword">of</span> reminders) &#123;</span><br><span class="line">  <span class="comment">// reminder的标识符</span></span><br><span class="line">  <span class="keyword">const</span> targetNote = <span class="string">`[Reminder] <span class="subst">$&#123;reminder.identifier&#125;</span>`</span>;</span><br><span class="line">  <span class="keyword">const</span> [targetEvent] = events.filter(</span><br><span class="line">    (e) =&gt; e.notes != <span class="literal">null</span> &amp;&amp; e.notes.includes(targetNote)</span><br><span class="line">  ); <span class="comment">// 过滤重复的reminder</span></span><br><span class="line">  <span class="keyword">if</span> (!m_dict[reminder.calendar.title]) &#123;</span><br><span class="line">    <span class="built_in">console</span>.warn(<span class="string">"找不到日历"</span> + reminder.calendar.title);</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (targetEvent) &#123;</span><br><span class="line">    <span class="comment">// console.log(`找到已经创建的事项 $&#123;reminder.title&#125;`)</span></span><br><span class="line">    updateEvent(targetEvent, reminder);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.warn(<span class="string">`创建事项 <span class="subst">$&#123;reminder.title&#125;</span> 到 <span class="subst">$&#123;reminder.calendar.title&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">const</span> newEvent = <span class="keyword">new</span> CalendarEvent();</span><br><span class="line">    newEvent.notes = targetNote + <span class="string">"\n"</span> + reminder.notes; <span class="comment">// 要加入备注</span></span><br><span class="line">    updateEvent(newEvent, reminder);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Script.complete();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateEvent</span>(<span class="params">event, reminder</span>) </span>&#123;</span><br><span class="line">  event.title = <span class="string">`<span class="subst">$&#123;reminder.title&#125;</span>`</span>;</span><br><span class="line">  cal_name = reminder.calendar.title;</span><br><span class="line">  cal = m_dict[cal_name];</span><br><span class="line">  event.calendar = cal;</span><br><span class="line">  <span class="comment">// console.warn(event.calendar.title)</span></span><br><span class="line">  <span class="comment">// 已完成事项</span></span><br><span class="line">  <span class="keyword">if</span> (reminder.isCompleted) &#123;</span><br><span class="line">    event.title = <span class="string">`✅<span class="subst">$&#123;reminder.title&#125;</span>`</span>;</span><br><span class="line">    <span class="comment">//    event.isAllDay = false</span></span><br><span class="line">    <span class="comment">//     event.startDate = reminder.dueDate</span></span><br><span class="line">    <span class="comment">//   event.endDate=reminder.dueDate</span></span><br><span class="line">    <span class="comment">//    var ending = new Date(reminder.completionDate)</span></span><br><span class="line">    <span class="comment">//    ending.setHours(ending.getHours()+1)</span></span><br><span class="line">    <span class="comment">//    event.endDate = ending</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> period =</span><br><span class="line">      (reminder.dueDate - reminder.completionDate) / <span class="number">1000</span> / <span class="number">3600</span> / <span class="number">24</span>;</span><br><span class="line">    period = period.toFixed(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (period &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      period = -period;</span><br><span class="line">      event.location = <span class="string">" 延期"</span> + period + <span class="string">"天完成"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (period == <span class="number">0</span>) &#123;</span><br><span class="line">      event.location = <span class="string">" 准时完成"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      event.location = <span class="string">" 提前"</span> + period + <span class="string">"天完成"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 未完成事项</span></span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> nowtime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">var</span> period = (reminder.dueDate - nowtime) / <span class="number">1000</span> / <span class="number">3600</span> / <span class="number">24</span>;</span><br><span class="line">    period = period.toFixed(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// console.log(reminder.title+(period))</span></span><br><span class="line">    <span class="keyword">if</span> (period &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// 待办顺延</span></span><br><span class="line"></span><br><span class="line">      event.location = <span class="string">" 延期"</span> + -period + <span class="string">"天"</span>;</span><br><span class="line">      <span class="comment">// 如果不是在同一天,设置为全天事项</span></span><br><span class="line">      <span class="keyword">if</span> (reminder.dueDate.getDate() != nowtime.getDate()) &#123;</span><br><span class="line">        event.title = <span class="string">`❌<span class="subst">$&#123;reminder.title&#125;</span>`</span>;</span><br><span class="line">        event.startDate = nowtime;</span><br><span class="line">        event.endDate = nowtime;</span><br><span class="line">        event.isAllDay = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 在同一天的保持原来的时间</span></span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        event.title = <span class="string">`⭕️<span class="subst">$&#123;reminder.title&#125;</span>`</span>;</span><br><span class="line">        event.isAllDay = <span class="literal">false</span>;</span><br><span class="line">        event.startDate = reminder.dueDate;</span><br><span class="line">        <span class="keyword">var</span> ending = <span class="keyword">new</span> <span class="built_in">Date</span>(reminder.dueDate);</span><br><span class="line">        ending.setHours(ending.getHours() + <span class="number">1</span>);</span><br><span class="line">        event.endDate = ending;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`【<span class="subst">$&#123;reminder.title&#125;</span>】待办顺延<span class="subst">$&#123;-period&#125;</span>天`</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      event.title = <span class="string">`⭕️<span class="subst">$&#123;reminder.title&#125;</span>`</span>;</span><br><span class="line">      event.isAllDay = <span class="literal">false</span>;</span><br><span class="line">      event.location = <span class="string">"还剩"</span> + period + <span class="string">"天"</span>;</span><br><span class="line">      event.startDate = reminder.dueDate;</span><br><span class="line">      <span class="keyword">var</span> ending = <span class="keyword">new</span> <span class="built_in">Date</span>(reminder.dueDate);</span><br><span class="line">      ending.setHours(ending.getHours() + <span class="number">1</span>);</span><br><span class="line">      event.endDate = ending;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!reminder.dueDateIncludesTime) event.isAllDay = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  event.save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  </p>
</details>
<h3 id="最完美-ios-提醒事项与日历-双向同步-带跳转-作者：你说-根据汀力"><a href="https://zhuanlan.zhihu.com/p/558267163" target="_blank" rel="noopener">最完美(ios)提醒事项与日历  双向同步+带跳转  【作者：你说】（根据汀力）</a></h3>
<details>
  <summary>点击展开代码2</summary>
  <p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="keyword">var</span> dur_month = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> startDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">startDate.setMonth(startDate.getMonth() - dur_month);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`日历的开始时间 <span class="subst">$&#123;startDate.toLocaleDateString()&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> endDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">endDate.setMonth(endDate.getMonth() + dur_month);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`日历的结束时间 <span class="subst">$&#123;endDate.toLocaleDateString()&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">event_cals = <span class="keyword">await</span> Calendar.forEvents();</span><br><span class="line">reminder_cals = <span class="keyword">await</span> Calendar.forReminders();</span><br><span class="line">titles = reminder_cals.map(<span class="function"><span class="params">e</span> =&gt;</span> e.title).filter(<span class="function"><span class="params">v</span> =&gt;</span> event_cals.map(<span class="function"><span class="params">e</span> =&gt;</span> e.title).includes(v));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`日历列表:<span class="subst">$&#123;titles&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">event_cals = event_cals.filter(<span class="function"><span class="params">v</span> =&gt;</span> titles.includes(v.title));</span><br><span class="line">reminder_cals = reminder_cals.filter(<span class="function"><span class="params">v</span> =&gt;</span> titles.includes(v.title));</span><br><span class="line"></span><br><span class="line">reminder_map = &#123;&#125;;</span><br><span class="line">reminder_cals.forEach(<span class="function"><span class="params">r</span> =&gt;</span> (reminder_map[r.title] = r));</span><br><span class="line"><span class="comment">// 时间范围过滤</span></span><br><span class="line"><span class="keyword">const</span> events = <span class="keyword">await</span> CalendarEvent.between(startDate, endDate, event_cals);</span><br><span class="line"><span class="keyword">const</span> reminders = <span class="keyword">await</span> Reminder.allDueBetween(startDate, endDate, reminder_cals);</span><br><span class="line"></span><br><span class="line"><span class="comment">//找出没有创建对应reminder的event，创建reminder</span></span><br><span class="line">reminder_created = reminders.filter(<span class="function"><span class="params">e</span> =&gt;</span> e.priority == <span class="number">1</span>);</span><br><span class="line">reminder_id_set = <span class="keyword">new</span> <span class="built_in">Set</span>(reminder_created.map(<span class="function"><span class="params">e</span> =&gt;</span> e.identifier));</span><br><span class="line"></span><br><span class="line">reg = <span class="regexp">/(\\[id\\])x\\-apple\\-reminderkit\\:\\\/\\\/REMCDReminder\\\/([A-Z0-9\\-\\:\/=]*)$/</span>;</span><br><span class="line"><span class="comment">// 提醒和日历 备注都要以[id]xxxxxx结尾</span></span><br><span class="line">events.forEach(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (e.notes != <span class="literal">null</span>) &#123;</span><br><span class="line">    s = e.notes.match(reg);</span><br><span class="line">    <span class="keyword">if</span> (s != <span class="literal">null</span>) &#123;</span><br><span class="line">      r_id = s[<span class="number">2</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      r_id = <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    r_id = <span class="string">''</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//console.log(e.title)</span></span><br><span class="line">  <span class="keyword">if</span> (e.title.startsWith(<span class="string">"✅"</span>)) &#123;</span><br><span class="line">    event_ok = <span class="literal">true</span>;</span><br><span class="line">    pure_title = e.title.substr(<span class="number">1</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.title.startsWith(<span class="string">"☑️"</span>)) &#123;</span><br><span class="line">    event_ok = <span class="literal">false</span>;</span><br><span class="line">    pure_title = e.title.substr(<span class="number">1</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    event_ok = <span class="literal">false</span>;</span><br><span class="line">    pure_title = e.title;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//console.log(''+event_ok)</span></span><br><span class="line">  <span class="keyword">var</span> r = <span class="literal">undefined</span>;</span><br><span class="line">  <span class="keyword">if</span> (!reminder_id_set.has(r_id)) &#123;</span><br><span class="line">    <span class="comment">// 新创建状态来自日历标题</span></span><br><span class="line">    remind_ok = event_ok;</span><br><span class="line">    newReminder = <span class="keyword">new</span> Reminder();</span><br><span class="line">    newReminder.dueDate = e.startDate;</span><br><span class="line">    newReminder.calendar = reminder_map[e.calendar.title];</span><br><span class="line">    newReminder.dueDateIncludesTime = !e.isAllDay;</span><br><span class="line">    newReminder.title = pure_title;</span><br><span class="line">    newReminder.priority = <span class="number">1</span>;</span><br><span class="line">    newReminder.isCompleted = remind_ok;</span><br><span class="line">    newReminder.save();</span><br><span class="line">    targetNote = <span class="string">`[id]x-apple-reminderkit:\/\/REMCDReminder\/<span class="subst">$&#123;newReminder.identifier&#125;</span>`</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`创建提醒:<span class="subst">$&#123;pure_title&#125;</span>`</span>);</span><br><span class="line">    r = newReminder;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> [targetReminder] = reminder_created.filter(<span class="function"><span class="params">e</span> =&gt;</span> e.identifier == r_id);</span><br><span class="line">    <span class="keyword">if</span> (targetReminder.isCompleted) &#123;</span><br><span class="line">      remind_ok = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      remind_ok = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 标题参考日历的，状态参数提醒的</span></span><br><span class="line">    targetReminder.title = pure_title;</span><br><span class="line">    targetReminder.dueDate = e.startDate;</span><br><span class="line">    targetReminder.dueDateIncludesTime = !e.isAllDay;</span><br><span class="line">    targetReminder.save();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`更新提醒:<span class="subst">$&#123;pure_title&#125;</span>`</span>);</span><br><span class="line">    <span class="comment">// 清理已经更新过的，用于后面删除日历上删除的</span></span><br><span class="line">    targetNote = <span class="string">`[id]x-apple-reminderkit:\/\/REMCDReminder\/<span class="subst">$&#123;targetReminder.identifier&#125;</span>`</span>;</span><br><span class="line">    reminder_id_set.delete(r_id);</span><br><span class="line">    r = targetReminder;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (remind_ok) &#123;</span><br><span class="line">    e.title = <span class="string">"✅"</span> + pure_title;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    e.title = <span class="string">"☑️"</span> + pure_title;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//console.log(pure_title)</span></span><br><span class="line">  <span class="keyword">if</span> (e.notes == <span class="literal">null</span>) &#123;</span><br><span class="line">    e.notes = <span class="string">"\\r\\n\\r\\n"</span> + targetNote;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!e.notes.endsWith(targetNote)) &#123;</span><br><span class="line">    e.notes = e.notes + <span class="string">"\\r\\n\\r\\n"</span> + targetNote;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 如果不要打卡时间，注释掉</span></span><br><span class="line">  updateEvent(e, r);</span><br><span class="line">  e.save();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//reminder_id_set.forEach(v =&gt; &#123;</span></span><br><span class="line"><span class="comment">//  console.log(`reminder:$&#123;v&#125;`)</span></span><br><span class="line"><span class="comment">//&#125;)</span></span><br><span class="line"></span><br><span class="line">reminder_id_set.forEach(<span class="function"><span class="params">id</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> [targetReminder] = reminder_created.filter(<span class="function"><span class="params">e</span> =&gt;</span> e.identifier == id);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`删除提醒:<span class="subst">$&#123;targetReminder.title&#125;</span>`</span>);</span><br><span class="line">  targetReminder.remove();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateEvent</span>(<span class="params">event, reminder</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 用户自定义的保持原样</span></span><br><span class="line">  <span class="keyword">if</span> (event.location != <span class="literal">null</span> &amp;&amp; !event.location.startsWith(<span class="string">"⏱"</span>)) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//已完成事项</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (reminder.isCompleted) &#123;</span><br><span class="line">    <span class="keyword">var</span> period = (reminder.dueDate - reminder.completionDate) / <span class="number">1000</span> / <span class="number">3600</span> / <span class="number">24</span>;</span><br><span class="line">    period = period.toFixed(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (period &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      period = -period;</span><br><span class="line">      event.location = <span class="string">"⏱延期"</span> + period + <span class="string">"天完成"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (period == <span class="number">0</span>) &#123;</span><br><span class="line">      event.location = <span class="string">"⏱准时完成"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      event.location = <span class="string">"⏱提前"</span> + period + <span class="string">"天完成"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">//未完成事项</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> nowtime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">var</span> period = (reminder.dueDate - nowtime) / <span class="number">1000</span> / <span class="number">3600</span> / <span class="number">24</span>;</span><br><span class="line">    period = period.toFixed(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">//console.log(reminder.title+(period))</span></span><br><span class="line">    <span class="keyword">if</span> (period &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      event.location = <span class="string">"⏱延期"</span> + (-period) + <span class="string">"天"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      event.location = <span class="string">"⏱还剩"</span> + period + <span class="string">"天"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Script.complete();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 首先，定义了一个变量 dur_month，它被设置为1。这个变量可能用于计算日期范围。</span></span><br><span class="line"><span class="comment">// 接下来，创建了两个日期对象 startDate 和 endDate，它们表示日历的开始时间和结束时间。这些日期根据 dur_month 进行调整。</span></span><br><span class="line"><span class="comment">// 代码使用了 await 关键字来等待获取日历事件和提醒事件的数据。它使用 Calendar.forEvents() 和 Calendar.forReminders() 方法来获取事件和提醒的列表。</span></span><br><span class="line"><span class="comment">// 通过比较提醒和事件的标题，创建了一个名为 titles 的数组，其中包含在日历和提醒中都存在的标题。这个数组用于筛选出共有的事件和提醒。</span></span><br><span class="line"><span class="comment">// 接下来，对事件和提醒的列表进行过滤，只保留 titles 数组中存在的事件和提醒。</span></span><br><span class="line"><span class="comment">// 创建了一个空对象 reminder_map，用于将提醒的标题映射到提醒对象。</span></span><br><span class="line"><span class="comment">// 使用正则表达式 reg 匹配提醒和事件的备注，以提取提醒的唯一标识符。</span></span><br><span class="line"><span class="comment">// 遍历事件列表，处理每个事件的逻辑。根据事件标题的前缀（"✅" 或 "☑️"），确定事件是否已完成，并提取纯标题。然后，检查是否存在相应的提醒。如果不存在，创建新的提醒，并将其关联到事件上。如果存在，更新现有的提醒。</span></span><br><span class="line"><span class="comment">// 最后，根据提醒的状态更新事件标题，并将提醒的标识符添加到事件的备注中。还有一些与事件位置相关的逻辑。</span></span><br><span class="line"><span class="comment">// 最后，使用 Script.complete() 结束脚本的执行。</span></span><br></pre></td></tr></table></figure>
  </p>
</details>
<h3 id="自动同步ios提醒事项到日历？简单-看这里-作者：crazy-根据汀力-你说"><a href="https://zhuanlan.zhihu.com/p/539872086" target="_blank" rel="noopener">自动同步iOS提醒事项到日历？简单，看这里！  【作者：crazy】 （根据汀力+你说）</a></h3>
<h2 id="我的改动和代码">我的改动和代码</h2>
<p>根据<a href="https://zhuanlan.zhihu.com/p/169566930" target="_blank" rel="noopener">汀力</a>最新的那篇，发现了几个和我自己需求不符合的点：</p>
<ul>
<li>从reminder 新建到calendar的event默认1小时
<ul>
<li>在calendar中修改event的开始时间和结束时间，执行脚本后会被重新改成reminder的开始时间，结束时间固定为1小时。</li>
</ul>
</li>
<li>reminder 里面删除后，calendar里面还有（不会被删除）
<ul>
<li>这个是个bug?看代码里面是有这个逻辑的</li>
</ul>
</li>
</ul>
<p>我的需求和修改</p>
<ul>
<li>如果calendar 已有reminder相同title的event，不update，所以可以在calendar中修改event的开始时间和结束时间
<ul>
<li>如果calendar里面已经有event了，修改reminder里面的时间为calendar event的开始时间间</li>
</ul>
</li>
<li>【已完成】 不会变成全天任务， 仍然是有开始时间和结束时间</li>
</ul>
<!-- <details>
  <summary><b>点击展开代码3</b></summary>
  <p> -->
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> dur_month = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> startDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">startDate.setMonth(startDate.getMonth() - dur_month);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`日历的开始时间 <span class="subst">$&#123;startDate.toLocaleDateString()&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> endDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">endDate.setMonth(endDate.getMonth() + dur_month);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`日历的结束时间 <span class="subst">$&#123;endDate.toLocaleDateString()&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reminders = <span class="keyword">await</span> Reminder.allDueBetween(startDate, endDate);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`获取 <span class="subst">$&#123;reminders.length&#125;</span> 条提醒事项`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> calendar = <span class="keyword">await</span> Calendar.forEvents();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取日历名和对应的日历</span></span><br><span class="line"><span class="keyword">var</span> m_dict = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (cal <span class="keyword">of</span> calendar) &#123;</span><br><span class="line">  m_dict[cal.title] = cal;</span><br><span class="line">  <span class="comment">// console.log(`日历:$&#123;cal.title&#125;`)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> events = <span class="keyword">await</span> CalendarEvent.between(startDate, endDate, calendar);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`获取 <span class="subst">$&#123;events.length&#125;</span> 条日历`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> reminders_id_set = <span class="keyword">new</span> <span class="built_in">Set</span>(reminders.map(<span class="function">(<span class="params">e</span>) =&gt;</span> e.identifier));</span><br><span class="line"><span class="comment">// 删除日历里提醒事项删除的事项</span></span><br><span class="line">events_created = events.filter(</span><br><span class="line">  (e) =&gt; e.notes != <span class="literal">null</span> &amp;&amp; e.notes.includes(<span class="string">"[Reminder]"</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> event <span class="keyword">of</span> events_created) &#123;</span><br><span class="line">  <span class="comment">// console.warn(event.notes)</span></span><br><span class="line">  <span class="keyword">let</span> reg = <span class="regexp">/(\[Reminder\])\s([A-Z0-9\-]*)/</span>;</span><br><span class="line">  <span class="keyword">let</span> r = event.notes.match(reg);</span><br><span class="line">  <span class="comment">// if(r) console.log(r[2])</span></span><br><span class="line">  <span class="keyword">if</span> (!reminders_id_set.has(r[<span class="number">2</span>])) &#123;</span><br><span class="line">    event.remove();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> reminder <span class="keyword">of</span> reminders) &#123;</span><br><span class="line">  <span class="comment">// reminder的标识符</span></span><br><span class="line">  <span class="keyword">const</span> targetNote = <span class="string">`[Reminder] <span class="subst">$&#123;reminder.identifier&#125;</span>`</span>;</span><br><span class="line">  <span class="keyword">const</span> [targetEvent] = events.filter(</span><br><span class="line">    (e) =&gt; e.notes != <span class="literal">null</span> &amp;&amp; e.notes.includes(targetNote)</span><br><span class="line">  ); <span class="comment">// 过滤重复的reminder</span></span><br><span class="line">  <span class="keyword">if</span> (!m_dict[reminder.calendar.title]) &#123;</span><br><span class="line">    <span class="built_in">console</span>.warn(<span class="string">"找不到日历"</span> + reminder.calendar.title);</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (targetEvent) &#123;</span><br><span class="line">    <span class="comment">// console.log(`找到已经创建的事项 $&#123;reminder.title&#125;`)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// LYK 替换updateEvent为updateReminder</span></span><br><span class="line">    <span class="comment">// updateEvent(targetEvent, reminder);</span></span><br><span class="line">    updateReminder(targetEvent, reminder);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.warn(<span class="string">`创建事项 <span class="subst">$&#123;reminder.title&#125;</span> 到 <span class="subst">$&#123;reminder.calendar.title&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">const</span> newEvent = <span class="keyword">new</span> CalendarEvent();</span><br><span class="line">    newEvent.notes = targetNote + <span class="string">"\n"</span> + reminder.notes; <span class="comment">// 要加入备注</span></span><br><span class="line">    updateEvent(newEvent, reminder);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Script.complete();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateEvent</span>(<span class="params">event, reminder</span>) </span>&#123;</span><br><span class="line">  event.title = <span class="string">`<span class="subst">$&#123;reminder.title&#125;</span>`</span>;</span><br><span class="line">  cal_name = reminder.calendar.title;</span><br><span class="line">  cal = m_dict[cal_name];</span><br><span class="line">  event.calendar = cal;</span><br><span class="line">  <span class="comment">// console.warn(event.calendar.title)</span></span><br><span class="line">  <span class="comment">// 已完成事项</span></span><br><span class="line">  <span class="keyword">if</span> (reminder.isCompleted) &#123;</span><br><span class="line">    event.title = <span class="string">`✅<span class="subst">$&#123;reminder.title&#125;</span>`</span>;</span><br><span class="line">    <span class="comment">//    event.isAllDay = false</span></span><br><span class="line">    <span class="comment">//     event.startDate = reminder.dueDate</span></span><br><span class="line">    <span class="comment">//   event.endDate=reminder.dueDate</span></span><br><span class="line">    <span class="comment">//    var ending = new Date(reminder.completionDate)</span></span><br><span class="line">    <span class="comment">//    ending.setHours(ending.getHours()+1)</span></span><br><span class="line">    <span class="comment">//    event.endDate = ending</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> period =</span><br><span class="line">      (reminder.dueDate - reminder.completionDate) / <span class="number">1000</span> / <span class="number">3600</span> / <span class="number">24</span>;</span><br><span class="line">    period = period.toFixed(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (period &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      period = -period;</span><br><span class="line">      event.location = <span class="string">" 延期"</span> + period + <span class="string">"天完成"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (period == <span class="number">0</span>) &#123;</span><br><span class="line">      event.location = <span class="string">" 准时完成"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      event.location = <span class="string">" 提前"</span> + period + <span class="string">"天完成"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 未完成事项</span></span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> nowtime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">var</span> period = (reminder.dueDate - nowtime) / <span class="number">1000</span> / <span class="number">3600</span> / <span class="number">24</span>;</span><br><span class="line">    period = period.toFixed(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// console.log(reminder.title+(period))</span></span><br><span class="line">    <span class="keyword">if</span> (period &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// 待办顺延</span></span><br><span class="line"></span><br><span class="line">      event.location = <span class="string">" 延期"</span> + -period + <span class="string">"天"</span>;</span><br><span class="line">      <span class="comment">// 如果不是在同一天,设置为全天事项</span></span><br><span class="line">      <span class="keyword">if</span> (reminder.dueDate.getDate() != nowtime.getDate()) &#123;</span><br><span class="line">        event.title = <span class="string">`❌<span class="subst">$&#123;reminder.title&#125;</span>`</span>;</span><br><span class="line">        event.startDate = nowtime;</span><br><span class="line">        event.endDate = nowtime;</span><br><span class="line">        event.isAllDay = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 在同一天的保持原来的时间</span></span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        event.title = <span class="string">`⭕️<span class="subst">$&#123;reminder.title&#125;</span>`</span>;</span><br><span class="line">        event.isAllDay = <span class="literal">false</span>;</span><br><span class="line">        event.startDate = reminder.dueDate;</span><br><span class="line">        <span class="keyword">var</span> ending = <span class="keyword">new</span> <span class="built_in">Date</span>(reminder.dueDate);</span><br><span class="line">        ending.setHours(ending.getHours() + <span class="number">1</span>);</span><br><span class="line">        event.endDate = ending;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`【<span class="subst">$&#123;reminder.title&#125;</span>】待办顺延<span class="subst">$&#123;-period&#125;</span>天`</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      event.title = <span class="string">`⭕️<span class="subst">$&#123;reminder.title&#125;</span>`</span>;</span><br><span class="line">      event.isAllDay = <span class="literal">false</span>;</span><br><span class="line">      event.location = <span class="string">"还剩"</span> + period + <span class="string">"天"</span>;</span><br><span class="line">      event.startDate = reminder.dueDate;</span><br><span class="line">      <span class="keyword">var</span> ending = <span class="keyword">new</span> <span class="built_in">Date</span>(reminder.dueDate);</span><br><span class="line">      ending.setHours(ending.getHours() + <span class="number">1</span>);</span><br><span class="line">      event.endDate = ending;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!reminder.dueDateIncludesTime) event.isAllDay = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  event.save();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// LYK 新加的方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateReminder</span>(<span class="params">event, reminder</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 方法1</span></span><br><span class="line">  <span class="keyword">if</span> (reminder) &#123;</span><br><span class="line">    <span class="comment">// 更新 Reminder 的开始时间</span></span><br><span class="line">    reminder.dueDate = event.startDate;</span><br><span class="line">    <span class="comment">// 保存 Reminder 更新</span></span><br><span class="line">    reminder.save();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<!-- 
  </p>
</details> -->
<details>
  <summary>点击展开"LYK 方法2 EventKit方法"</summary>
  <p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// LYK 创建 EventKit 实例</span></span><br><span class="line"><span class="keyword">const</span> EventKit = <span class="built_in">require</span>(<span class="string">"EventKit"</span>);</span><br><span class="line"><span class="keyword">const</span> eventKit = EventKit.init();</span><br><span class="line"></span><br><span class="line"><span class="comment">// LYK 方法2 EventKit方法</span></span><br><span class="line"><span class="comment">// 添加事件修改监听器</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> event <span class="keyword">of</span> events) &#123;</span><br><span class="line">    event.onStartDateChange(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 在这里实现日历事件开始时间更改时的同步操作</span></span><br><span class="line">      <span class="comment">// 可以获取修改后的开始时间，然后更新对应的 Reminder 提醒</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 找到对应的 Reminder</span></span><br><span class="line">      <span class="keyword">const</span> targetNote = <span class="string">`[Reminder] <span class="subst">$&#123;event.notes</span></span></span><br><span class="line"><span class="string"><span class="subst">        .split(<span class="string">"\n"</span>)[<span class="number">0</span>]</span></span></span><br><span class="line"><span class="string"><span class="subst">        .substring(<span class="number">10</span>)&#125;</span>`</span>;</span><br><span class="line">      <span class="keyword">const</span> reminderToUpdate = reminders.find(</span><br><span class="line">        (reminder) =&gt; reminder.identifier === targetNote</span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (reminderToUpdate) &#123;</span><br><span class="line">        <span class="comment">// 更新 Reminder 的开始时间</span></span><br><span class="line">        reminderToUpdate.dueDate = event.startDate;</span><br><span class="line">        <span class="comment">// 保存 Reminder 更新</span></span><br><span class="line">        eventKit.saveReminder(reminderToUpdate, (error) =&gt; &#123;</span><br><span class="line">          <span class="keyword">if</span> (!error) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`已同步更新 Reminder 的开始时间为 <span class="subst">$&#123;event.startDate&#125;</span>`</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.error(<span class="string">`更新 Reminder 失败：<span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    event.onEndDateChange(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 在这里实现日历事件结束时间更改时的同步操作</span></span><br><span class="line">      <span class="comment">// 可以获取修改后的结束时间，然后更新对应的 Reminder 提醒</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 找到对应的 Reminder</span></span><br><span class="line">      <span class="keyword">const</span> targetNote = <span class="string">`[Reminder] <span class="subst">$&#123;event.notes</span></span></span><br><span class="line"><span class="string"><span class="subst">        .split(<span class="string">"\n"</span>)[<span class="number">0</span>]</span></span></span><br><span class="line"><span class="string"><span class="subst">        .substring(<span class="number">10</span>)&#125;</span>`</span>;</span><br><span class="line">      <span class="keyword">const</span> reminderToUpdate = reminders.find(</span><br><span class="line">        (reminder) =&gt; reminder.identifier === targetNote</span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (reminderToUpdate) &#123;</span><br><span class="line">        <span class="comment">// 更新 Reminder 的结束时间</span></span><br><span class="line">        reminderToUpdate.dueDate = event.endDate;</span><br><span class="line">        <span class="comment">// 保存 Reminder 更新</span></span><br><span class="line">        eventKit.saveReminder(reminderToUpdate, (error) =&gt; &#123;</span><br><span class="line">          <span class="keyword">if</span> (!error) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`已同步更新 Reminder 的结束时间为 <span class="subst">$&#123;event.endDate&#125;</span>`</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.error(<span class="string">`更新 Reminder 失败：<span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
  </p>
</details>
<h2 id="参考文章">参考文章</h2>
<ul>
<li>【ios】日历同步—》提醒事项 单向同步+打卡功能 【作者：汀力】
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/390100397" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/390100397</a> 2021.7</li>
<li><a href="https://zhuanlan.zhihu.com/p/169566930" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/169566930</a> 2022.9.17</li>
</ul>
</li>
<li>最完美(ios)提醒事项与日历  双向同步+带跳转  【作者：你说】（根据汀力）
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/512921323" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/512921323</a> 2022.8</li>
<li><a href="https://zhuanlan.zhihu.com/p/558267163" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/558267163</a> 2022.9.19</li>
</ul>
</li>
<li>自动同步iOS提醒事项到日历？简单，看这里！  【作者：crazy】 （根据汀力+你说）
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/539872086" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/539872086</a>  2022.7</li>
</ul>
</li>
<li><a href="https://zhuanlan.zhihu.com/p/335275758" target="_blank" rel="noopener">将 iOS 上的提醒事项同步到微软日历</a></li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>JBoss/WildFly all you should know</title>
    <url>/JBoss-WildFly-all-you-should-know.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="web-containers-web容器总结"><a href="../Web-containers-web%E5%AE%B9%E5%99%A8%E6%80%BB%E7%BB%93.html">Web-containers-web容器总结</a></h1>
<h1 id="jboss-基本术语-概念">JBoss 基本术语/概念</h1>
<h2 id="jboss-eap-vs-jboss-as-vs-wildfly">JBoss EAP Vs JBoss AS Vs Wildfly</h2>
<blockquote>
<p>JBoss EAP is the JBoss Enterprise Application Platform that is a subscription based JavaEE application server; this is a Red Hat product; whereas Wildfly is the community product.</p>
</blockquote>
<p>作为JBoss的新手，会发现很多不同的术语-JBoss EAP，JBoss Server，Wildfly，Jboss Web，以及许多不是最新的或针对较旧版本的文档。按时间线来看的话：</p>
<p><code>JBoss AS</code> (JBoss Application Server) 是开源社区早期版本，发布比较频繁。内部封装的容器是基于Tomcat的升级版。最新版本是7.1.1，2012年3月发布的，已经不再维护。官方推荐升级到WildFly或者JBoss EAP。所以从JBoss AS 7.1.1之后分出了两个方向，分别是WildFly和JBoss EAP。<br>
网址：<a href="https://jbossas.jboss.org/downloads" target="_blank" rel="noopener">https://jbossas.jboss.org/downloads</a></p>
<blockquote>
<p>JBoss AS 7，前后发布了 7.0.0, 7.0.1, 7.0.2, 7.1.0, 7.1.1, 7.1.2, 7.1.3, 7.2.0，其中 7.1.1 比较经典，7.2.0 是 JBoss EAP.1 的基础，但7.1.2, 7.1.3, 7.2.0 只是源代码打了 Tag，并没提供开放下载。这个社区项目最终将成为JBoss EAP。</p>
</blockquote>
<p><code>WildFly</code>只是<code>JBoss AS</code>的新名称，从 8 开始，新的 JBoss AS 正式有一个名字，叫 <code>WildFly</code>. 内部封装的容器是Undertow。RedHat公司称，新名称WildFly反映了服务器“非常灵活、轻量、不羁、自由”的特性。WildFly 8，WildFly 9，WildFly 10以及可能的其他WildFly版本都是通往最终称为JBoss EAP 7的里程碑, 它们都实现了Java EE 7。尽管它们是该路线上的里程碑并且不受支持，但某些发行版实际上相当稳定并且可以投入生产(但由于不支持，因此后果自负)。</p>
<blockquote>
<p>改名后的首个版本为WildFly 8，将接棒JBoss AS 7。RedHat公司表示，新版本不仅是名称上的变化，还带来了如下改进：</p>
<ul>
<li>启动超快</li>
<li>模块化设计</li>
<li>非常轻量，内存占用非常少</li>
<li>更优雅的配置、管理方式</li>
<li>严格遵守Java EE7和OSGi规范</li>
</ul>
</blockquote>
<p><code>JBoss EAP</code>(JBoss Enterprise Application Platform)在开源版本上构建的企业版本，会将社区版中验证过的，成熟的技术引入该版本，支持周期长。6的版本以Jboss AS7为基础；7的版本以Wildfly为基础。目前Redhat 已经将 JBoss EAP 放在 <a href="http://JBoss.org" target="_blank" rel="noopener">JBoss.org</a> 开放下载，开发人无需注册 Redhat （之前是必须有 <a href="http://Redhat.com" target="_blank" rel="noopener">Redhat.com</a> 账号才能下载 JBoss EAP）。是Red Hat生产和支持的Java EE应用程序服务器的名称。</p>
<p><code>JBoss Web</code>是Red Hat在JBoss EAP及更早版本中使用的基于Tomcat的Servlet容器的名称。从EAP 7开始(因此已经在WildFly 8,9,10中使用)，它将被称为<code>Undertow</code>的新Servlet容器/ http引擎取代。</p>
<p><code>Undertow</code> Jboss自主研发的Servlet容器。</p>
<h2 id="jboss和tomcat区别">JBoss和Tomcat区别</h2>
<ul>
<li>
<p>Tomcat 是 JSP/Servlet 容器</p>
</li>
<li>
<p>JBoss 是 JEE 容器，JEE 包括JSP/Servlet，JMS， EJB，JAX-WS，JAX-RS，CDI等等</p>
<ul>
<li>JBoss是一个管理EJB的容器和服务器，但JBoss核心服务不包括支持servlet/JSP的WEB容器，一般与Tomcat或Jetty绑定使用。servlet容器还是tomcat，所以JBoss是基于tomcat的。从EAP 7开始(因此已经在WildFly 8,9,10中使用)，tomcat被称为<code>Undertow</code>的新Servlet容器/ http引擎取代。</li>
<li>JBoss无最大访问限制、可伸缩性。</li>
</ul>
</li>
</ul>
<h1 id="jboss-下载配置">JBoss 下载配置</h1>
<h2 id="jboss-下载">JBoss 下载</h2>
<p><a href="https://developers.redhat.com/products/eap/download/" target="_blank" rel="noopener">JBOSS EAP developers</a><br>
<a href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?product=appplatform&amp;downloadType=distributions" target="_blank" rel="noopener">JBOSS EAP</a><br>
<a href="https://www.wildfly.org/downloads/" target="_blank" rel="noopener">WildFly</a> JBoss AS 从版本 8.0 开始改名为 WildFly<br>
<a href="https://jbossas.jboss.org/downloads" target="_blank" rel="noopener">JBoss AS</a></p>
<h2 id="jboss-官方文档">JBoss 官方文档</h2>
<p>这里只列出部分常用配置文档：</p>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4" target="_blank" rel="noopener">JBOSS EAP 官方文档目录</a></p>
<ul>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4/html/getting_started_guide/index" target="_blank" rel="noopener">JBOSS EAP 官方文档-Getting Started Guide</a>
<ul>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4/html/getting_started_guide/administering_jboss_eap#assembly-download-and-install-jboss-eap_default" target="_blank" rel="noopener">JBoss EAP 官方文档-1.1. Downloading and installing JBoss EAP</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4/html/getting_started_guide/administering_jboss_eap#assembly-start-stop-jboss-eap_default" target="_blank" rel="noopener">JBoss EAP 官方文档-1.2. Starting and stopping JBoss EAP</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4/html/getting_started_guide/administering_jboss_eap#jboss_eap_management" target="_blank" rel="noopener">JBoss EAP 官方文档-1.3 JBoss EAP Management</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4/html/getting_started_guide/administering_jboss_eap#assembly-network-port-configurations_default" target="_blank" rel="noopener">JBoss EAP 官方文档-1.4 Network and port configuration JBoss EAP</a></li>
</ul>
</li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4/html-single/installation_guide/index" target="_blank" rel="noopener">JBOSS EAP 官方文档-INSTALLATION GUIDE</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4/html-single/configuration_guide/index" target="_blank" rel="noopener">JBOSS EAP 官方文档-Configuration Guide</a>
<ul>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html/configuration_guide/deploying_applications" target="_blank" rel="noopener">JBOSS EAP 官方文档-Deploying Applications</a></li>
</ul>
</li>
</ul>
<h2 id="jboss-常用配置">JBoss 常用配置</h2>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4/html/getting_started_guide/administering_jboss_eap#configuration_files" target="_blank" rel="noopener">JBoss EAP 官方文档-1.3.3 Configuration Files</a></p>
<table>
<thead>
<tr>
<th>目录</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>EAP_HOME/bin/init.d/jboss-eap-rhel.sh</td>
<td>startup script 启动脚本</td>
</tr>
<tr>
<td>EAP_HOME/bin/init.d/jboss-eap.conf</td>
<td>configuration file 配置文件, 最少配置下<code>JBOSS_HOME</code>和<code>JBOSS_USER</code>。 1 默认使用默认配置文件 <code>standalone.xml</code>启动 a standalone JBoss EAP server。2 If you want the service to start JBoss EAP as a managed domain, add <code>JBOSS_MODE=domain</code> to jboss-eap.conf. To specify custom <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/installation_guide/index#:~:text=To%20specify%20custom-,domain%20configuration%20files,-%2C%20add%20JBOSS_DOMAIN_CONFIG%3DDOMAIN_CONFIG_FILE" target="_blank" rel="noopener">domain configuration files</a>, add <code>JBOSS_DOMAIN_CONFIG=DOMAIN_CONFIG_FILE.xml</code> and <code>JBOSS_HOST_CONFIG=HOST_CONFIG_FILE.xml</code>. By default, JBoss EAP uses <code>domain.xml</code> and <code>host.xml</code> as the domain configuration files.</td>
</tr>
<tr>
<td>EAP_HOME/bin/standalone.sh</td>
<td>启动server脚本， standalone mode（单机模式）。 <code>standalone.bat</code> for windows users. 默认配置文件 <code>EAP_HOME/standalone/configuration/standalone.xml</code>， 也可以指定读取其他配置文件，命令是<code>./standalone.sh --server-config=standalone-custom.xml</code>。或者使用备份历史文件：<code>$ EAP_HOME/bin/standalone.sh --server-config=standalone_xml_history/snapshot/20151022-133109702standalone.xml</code></td>
</tr>
<tr>
<td>EAP_HOME/bin/domain.sh</td>
<td>启动server脚本， domain mode（集群模式）. <code>domain.bat</code> for windows users. 默认配置文件  <code>EAP_HOME/domain/configuration/domain.xml</code> and <code>EAP_HOME/domain/configuration/host.xml</code></td>
</tr>
<tr>
<td>EAP_HOME/bin/jboss-cli.sh</td>
<td>命令行管理工具, 通过命令行实现部署卸载应用、配置系统设置和执行管理任务的功能。使用该工具修改系统配置时，最终也会作用到standalone.xml中。虽然官方文档不建议直接改xml而是推荐CLI，但我更喜欢直接改。 The management command-line interface (CLI) is a command-line administration tool for JBoss EAP.</td>
</tr>
<tr>
<td>EAP_HOME/bin/jboss-cli.sh --connect command=:shutdown</td>
<td>stop server脚本. 1 <code>EAP_HOME/bin/jboss-cli.sh --connect</code> 2 <code>shutdown</code></td>
</tr>
<tr>
<td>EAP_HOME/bin/add-user.sh</td>
<td>Adding a Management User， For Windows Server, use the <code>EAP_HOME\bin\add-user.bat</code> script. <code>a</code> to add a management user, <code>b</code> adds a user to the ApplicationRealm, which is used for applications and provides no particular permissions.</td>
</tr>
<tr>
<td>EAP_HOME/bin/standalone.conf</td>
<td>Jboss启动的配置，在文件中加入 <code>JAVA_HOME=&quot;/path/jdk&quot;</code>，可以指定使用的jdk，而不必依赖于系统默认的java环境变量。在文件中加入 <code>LANG=Zh_CN.GB18030</code>，可以设定语言环境为中文. 修改<code>JAVA_OPTS</code>，可以设置JVM的启动参数.</td>
</tr>
<tr>
<td><a href="http://localhost:9990/console/index.html" target="_blank" rel="noopener">http://localhost:9990/console/index.html</a></td>
<td>Management Console，管理控制台。是jboss提供的web管理系统，所有的操作均可通过jboss-cli实现。默认用户名密码admin/admin, 可以通过 <code>EAP_HOME/bin/add-user.sh</code> 选择<code>a</code> management user, 进行添加或修改。</td>
</tr>
<tr>
<td><code>EAP_HOME/standalone/configuration/standalone.xml</code></td>
<td>standalone mode（单机模式）的默认配置文件。It contains all information about the server, including subsystems, networking, deployments, socket bindings, and other configurable details. It does not provide the subsystems necessary for messaging or high availability.</td>
</tr>
<tr>
<td><code>EAP_HOME/domain/configuration/domain.xml</code></td>
<td>domain mode（集群模式）默认配置文件，Only the domain master reads this file. This file contains the configurations for all of the profiles (default, ha, full, full-ha, load-balancer).</td>
</tr>
<tr>
<td><code>EAP_HOME/domain/configuration/host.xml</code></td>
<td>This file includes configuration details specific to a physical host in a managed domain, such as network interfaces, socket bindings, the name of the host, and other host-specific details. The host.xml file includes all of the features of both host-master.xml and host-slave.xml, which are described below.也可以指定读取其他配置文件，命令是<code>$ EAP_HOME/bin/domain.sh --host-config=host-master.xml</code></td>
</tr>
</tbody>
</table>
<h2 id="jboss-eap-网络和端口配置">JBoss EAP 网络和端口配置</h2>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4/html/getting_started_guide/administering_jboss_eap#assembly-network-port-configurations_default" target="_blank" rel="noopener">JBoss EAP 官方文档-1.4 Network and port configuration JBoss EAP</a></p>
<h2 id="jboss-eap的详细介绍-目录结构等">JBoss EAP的详细介绍（目录结构等）</h2>
<table>
<thead>
<tr>
<th>目录</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>appclient/</td>
<td>包含应用程序客户容器的配置细节。</td>
</tr>
<tr>
<td>bin/</td>
<td>包含 Red Hat 企业版 Linux 和微软 Windows 上 JBoss EAP 的启动脚本。</td>
</tr>
<tr>
<td>docs/</td>
<td>许可证文件、schema 和示例。</td>
</tr>
<tr>
<td>domain/</td>
<td>配置文件、部署内容和 JBoss EAP 以受管域运行时使用的可写入区域。</td>
</tr>
<tr>
<td>modules/</td>
<td>当有服务请求时 JBoss EAP 动态加载的模块。custom modules自定义的modules可以放在这里。</td>
</tr>
<tr>
<td>standalone/</td>
<td>配置文件、部署内容和 JBoss EAP 以独立服务器运行时使用的可写入区域。</td>
</tr>
<tr>
<td>welcome-content/</td>
<td>包含默认安装里 8080 端口上的 Welcome 应用程序使用的内容。</td>
</tr>
<tr>
<td>jboss-modules.jar</td>
<td>加载模块的引导机制。</td>
</tr>
</tbody>
</table>
<h3 id="domain-里的目录">domain/ 里的目录</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>目的</th>
</tr>
</thead>
<tbody>
<tr>
<td>configuration/</td>
<td>用于受管域的配置文件。这些文件是通过管理控制台和 CLI 进行修改的，不能直接进行编辑。</td>
</tr>
<tr>
<td>data/</td>
<td>关于已部署服务的信息。服务是用管理控制台或管理 CLI，而不是通过部署扫描器来部署的。因此，请不要手动在这个目录里放入文件。</td>
</tr>
<tr>
<td>log/</td>
<td>包含运行在本地实例上的主机和进程控制器的运行时日志文件。</td>
</tr>
<tr>
<td>servers/</td>
<td>包含某个域里的每个服务器实例的 data/、log/ 和 tmp/ 目录，其中包含的数据和顶层的 domain/</td>
</tr>
<tr>
<td>tmp/</td>
<td>包含临时数据，如针对受管域检验本地用户的管理 CLI 使用的共享密钥机制相关的文件。</td>
</tr>
</tbody>
</table>
<h3 id="standalone-里的目录">standalone/ 里的目录</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>目的</th>
</tr>
</thead>
<tbody>
<tr>
<td>configuration/</td>
<td>用于独立服务器的配置文件。这些文件是通过管理控制台和 CLI 进行修改的，不能直接进行编辑。</td>
</tr>
<tr>
<td>deployments/</td>
<td>关于已部署服务的信息。独立服务器包含一个部署扫描器，您可以在这个目录里放入要部署的归档文件。然而，我们推荐的方法是用管理控制台或管理 CLI 来管理部署。</td>
</tr>
<tr>
<td>lib/</td>
<td>附属于独立服务器模式的外部库。默认为空。</td>
</tr>
<tr>
<td>tmp/</td>
<td>包含临时数据，如针对服务器检验本地用户的管理 CLI 使用的共享密钥机制相关的文件。</td>
</tr>
</tbody>
</table>
<h3 id="jboss-eap-的功能">JBoss EAP 的功能</h3>
<p>功能 | 描述<br>
符合 Java EE 7 规范 | 通过 Java Enterprise Edition 7 full 和 web profile 认证。<br>
受管域 | 集中管理多个服务器实例和物理主机，而独立服务器只允许运行单个服务器实例。可以按服务器组来管理配置、部署、套接字绑定、模块、扩展和系统属性。集中并简化应用程序安全性（包括安全域）管理。<br>
管理控制台和管理 CLI | 新的域或独立服务器管理界面。管理 CLI 还包括批处理模式，可以编写脚本并自动执行管理任务。不建议直接编辑 JBoss EAP XML 配置文件。<br>
简化的目录结构 | 模块目录包含所有应用服务器模块。域和独立目录分别包含用于域和独立部署的构件与配置文件。<br>
模块化类加载机制 | 模块可以按需加载和卸载。这样可提高性能、实现更好的安全性并缩短启动和重启时间。<br>
简化数据源管理 | 数据库驱动程序可像其他服务一样进行部署。另外，可以使用管理控制台和管理 CLI 来创建和管理数据源。</p>
<h4 id="子系统">子系统</h4>
<p>许多对部署到 JBoss EAP 的应用程序开放的 API 和功能组成子系统。管理员可根据应用程序的目标，配置这些子系统来提供不同的特性。例如，如果应用程序需要数据库，则可在 datasources 子系统中配置数据源，在应用程序部署到 JBoss EAP 服务器或域之后，就可以访问该数据源。</p>
<h4 id="高可用性">高可用性</h4>
<p>JBoss EAP 中的高可用性 (HA) 是指多个 JBoss EAP 实例一起协同运行，使应用程序能更好地抵抗流量、服务器负载和服务器故障等方面的波动。HA 结合了可扩展性、负载均衡和容错性等概念。</p>
<h4 id="操作模式">操作模式</h4>
<p>除了向应用程序提供相关功能和 API 之外，JBoss EAP 还具备强大的管理功能。JBoss EAP 采用不同的操作模式启动，可以分别提供不同的管理功能。JBoss EAP 提供独立服务器操作模式用于管理分散的实例，提供受管域操作模式用于从单个控制点管理一组实例。</p>
<h1 id="web-application的部署">Web Application的部署</h1>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html/configuration_guide/deploying_applications" target="_blank" rel="noopener">JBOSS EAP 官方文档-Deploying Applications</a><br>
官方文档中有6种方法，这里只列出常用的方法，可根据生产/开发环境来选择合适的方式。</p>
<blockquote>
<p>For administrators, the <code>management console</code> and the <code>management CLI</code> offer ideal graphical and command-line interfaces to manage application deployment in a production environment.</p>
</blockquote>
<p>对于管理员, <code>management console</code> 和 <code>management CLI</code> 提供理想的图形和命令行界面来管理生产环境中的应用程序部署.</p>
<blockquote>
<p>For developers, the range of application deployment testing options include a configurable file system <code>deployment scanner</code>, the <code>HTTP API</code>, an <code>IDE</code> such as Red Hat CodeReady Studio, and <code>Maven</code>.</p>
</blockquote>
<p>对于开发人员，应用程序部署测试选项的范围包括可配置文件系统<code>deployment scanner</code>、<code>HTTP API</code>、<code>IDE</code>（例如 Red Hat CodeReady Studio）和<code>Maven</code>。</p>
<table>
<thead>
<tr>
<th>部署方式</th>
<th>Management CLI</th>
<th>Management Console</th>
<th>Deployment Scanner</th>
<th>Exploded</th>
<th>HTTP API</th>
<th>Maven</th>
</tr>
</thead>
<tbody>
<tr>
<td>环境</td>
<td>生产环境(推荐)</td>
<td>生产环境</td>
<td>开发环境</td>
<td>开发环境</td>
<td>开发环境</td>
<td>开发环境</td>
</tr>
<tr>
<td>需要上传文件到deployments文件夹下？</td>
<td>No</td>
<td>No</td>
<td>YES</td>
<td>根据部署方式</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="使用management-cli部署-官方推荐：生产环境">使用Management CLI部署【官方推荐：生产环境】</h2>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html/configuration_guide/deploying_applications#deploying_apps_using_cli" target="_blank" rel="noopener">JBOSS EAP 官方文档-Deploying Applications</a></p>
<!-- 增加属性scan-enabled="false" -->
<p>此模式是官方推荐的生产环境部署应用方式，无需将应用上传至deployments文件夹下。首先保证test-application.war在服务器上，假设其路径为/path/to/test-application.war。</p>
<ol>
<li>启动服务器，并使用<code>./jboss-cli.sh --connect</code>命令进入命令行管理界面。</li>
<li>执行命令<code>deployment deploy-file /path/to/test-application.war</code>部署应用。</li>
<li>取消部署时，在命令行管理界面执行 <code>deployment undeploy test-application.war</code>。<br>
应用的数据会在<code>EAP_HOME/standalone/data/content</code>下，并且standalone.xml最下方会出现deployments标签，显示已经部署的应用。</li>
</ol>
<ul>
<li>Disable某个application：<br>
Disable 不会把部署内容移除，只是暂时不启动。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deployment <span class="built_in">disable</span> <span class="built_in">test</span>-application.war</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deployment <span class="built_in">disable</span>-all</span><br></pre></td></tr></table></figure>
<ul>
<li>Enable某个application：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deployment <span class="built_in">enable</span> <span class="built_in">test</span>-application.war</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deployment <span class="built_in">enable</span>-all</span><br></pre></td></tr></table></figure>
<ul>
<li>列出deploy信息</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deployment info</span><br></pre></td></tr></table></figure>
<h2 id="使用management-console部署-生产环境">使用Management Console部署【生产环境】</h2>
<p>Management Console，管理控制台。是jboss提供的web管理系统，所有的操作均可通过jboss-cli实现。默认用户名密码admin/admin, 可以通过 <code>EAP_HOME/bin/add-user.sh</code> 选择<code>a</code> management user, 进行添加或修改。<br>
<a href="http://localhost:9990/console/index.html" target="_blank" rel="noopener"><a href="http://localhost:9990/console/index.html" target="_blank" rel="noopener">http://localhost:9990/console/index.html</a></a></p>
<h3 id="选择deployments-tab">选择Deployments Tab</h3>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/JBoss-WildFly-all-you-should-know/console.png" alt="选择Deployments Tab"></p>
<h3 id="点击-可以选择">点击+，可以选择</h3>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/JBoss-WildFly-all-you-should-know/console-deployment1.png" alt="选择Deployments Tab"></p>
<ul>
<li>
<p>Upload a deployment</p>
<p>Upload an application that will be copied to the server’s content repository and managed by JBoss EAP.</p>
</li>
<li>
<p>Adding an unmanaged deployment</p>
<p>Specify the location of a deployment. This deployment will not be copied to the server’s content repository and will not be managed by JBoss EAP.</p>
</li>
<li>
<p>Creating an empty deployment</p>
<p>Create an empty, exploded deployment. You can add files to the deployment after it has been created.</p>
</li>
</ul>
<h3 id="选中application-可以选择">选中application，可以选择</h3>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/JBoss-WildFly-all-you-should-know/console-deployment2.png" alt="选择Deployments Tab"></p>
<ul>
<li>
<p>Undeploy an Application<br>
Select the deployment and choose the <code>Remove</code> option to undeploy the application. This undeploys the deployment and removes it from the content repository.</p>
</li>
<li>
<p>Disable an Application<br>
Select the deployment and choose the <code>Disable</code> option to disable the application. This undeploys the deployment, but does not remove it from the content repository.</p>
</li>
<li>
<p>Replace an Application<br>
Select the deployment and choose the <code>Replace</code> option. Select the new version of the deployment, which must have the same name as the original, and click Finish. This undeploys and removes the original version of the deployment, and then deploys the new version.</p>
</li>
</ul>
<h2 id="使用deployment-scanner部署-适合开发环境">使用Deployment Scanner部署【适合开发环境】</h2>
<h3 id="deploy-an-application">Deploy an Application</h3>
<p>在默认配置下，将war包拷贝至<code>EAP_HOME/standalone/deployments/</code>，服务器会在启动时，每5秒间隔检查deployments下的文件变化，部署应用。<br>
此外，Deployment Scanner不应与其他部署方法结合使用。</p>
<blockquote>
<p>Deployment Scanner仅在 JBoss EAP 作为standalone服务器运行时可用。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cp /path/to/<span class="built_in">test</span>-application.war EAP_HOME/standalone/deployments/</span><br></pre></td></tr></table></figure>
<p>如果启用了自动部署，则会自动选取、部署此文件，并创建<code>.dodeploy</code>标记文件。<br>
如果未启用自动部署，则需要手动添加<code>.dodeploy</code> 标记文件以触发部署。<br>
JBOSS在启动时会把这个文件名自动改成<code>test-application.war.deploying</code>。<br>
如果布署成功，该文件名会被自动改名成：<code>test-application.war.deployed</code><br>
如果布署失败，该文件名会被自动改名成：<code>test-application.war.failed</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">touch EAP_HOME/standalone/deployments/<span class="built_in">test</span>-application.war.dodeploy</span><br></pre></td></tr></table></figure>
<h3 id="undeploy">UnDeploy</h3>
<p>删除<code>.dodeploy</code> 标记文件。如果启用自动部署，删除<code>.war</code>文件也会触发undeploy。</p>
<h3 id="redeploy">ReDeploy</h3>
<p>手动添加 <code>.dodeploy</code> 标记文件, 或者把之前的标记文件从<code>.deployed</code>或者<code>.failed</code>重命名为<code>.dodeploy</code>。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">touch EAP_HOME/standalone/deployments/<span class="built_in">test</span>-application.war.dodeploy</span><br></pre></td></tr></table></figure>
<h2 id="解压式部署-适合开发环境">解压式部署【适合开发环境】</h2>
<p>解压式部署比war包部署的好处是，允许更改解压的应用程序的内容，而无需部署应用程序的新版本。<br>
在 JBoss EAP 7.1 之前，只能通过操作文件系统上的文件来管理解压部署。从 JBoss EAP 7.1 开始，可以使用管理界面management console管理解压式部署。</p>
<h3 id="手动部署">手动部署</h3>
<p>在 JBoss EAP 7.1 之前，只能通过操作文件系统上的文件来管理解压部署。和Deployment Scanner部署比较相像， 唯一区别是需要手动解压war文件，并重命名。</p>
<ol>
<li>解压test-application.war包到test-application文件夹，重命名test-application文件夹为<code>test-application.war</code></li>
<li>拷贝解压好的war包拷贝至<code>EAP_HOME/standalone/deployments/</code>。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cp /path/to/<span class="built_in">test</span>-application.war EAP_HOME/standalone/deployments/</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>创建<code>.dodeploy</code>标记文件。 如果未启用自动部署，则需要手动添加<code>.dodeploy</code> 标记文件以触发部署。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">touch EAP_HOME/standalone/deployments/<span class="built_in">test</span>-application.war.dodeploy</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>UnDeploy和ReDeploy的方法也和Deployment Scanner部署一样。</li>
</ol>
<h3 id="management-console部署">management console部署</h3>
<p>从 JBoss EAP 7.1 开始，可以使用管理界面management console管理解压式部署。</p>
<blockquote>
<p>对部署中的静态文件（例如 JavaScript 和 CSS 文件）的更新会立即生效。 对其他文件（例如 Java 类）的更改可能需要重新部署应用程序才能使更改生效。</p>
</blockquote>
<ol>
<li>选择Deployments Tab, 点击+, 选择<code>Creating an empty deployment</code></li>
<li>填写文件夹路径<code>/path/to/test-application.war</code></li>
</ol>
<h3 id="management-cli部署">Management CLI部署</h3>
<h4 id="创建空的部署：">创建空的部署：</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/deployment=DEPLOYMENT_NAME.war:add(content=[&#123;empty=<span class="literal">true</span>&#125;])</span><br></pre></td></tr></table></figure>
<h4 id="explode-an-existing-archive-deployment">Explode an Existing Archive Deployment</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/deployment=ARCHIVE_DEPLOYMENT_NAME.ear:explode</span><br></pre></td></tr></table></figure>
<h1 id="参考文章">参考文章</h1>
<ul>
<li><a href="https://blog.csdn.net/zmh458/article/details/79405871" target="_blank" rel="noopener">初识JBoss EAP</a></li>
<li><a href="https://blog.csdn.net/lifetragedy/article/details/51371794" target="_blank" rel="noopener">JBOSS EAP实战(1)</a></li>
<li><a href="https://www.jianshu.com/p/4baaf549436b" target="_blank" rel="noopener">Jboss eap7.1 配置部署入门</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>BackEnd</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>WebContainer</tag>
        <tag>JBoss</tag>
      </tags>
  </entry>
  <entry>
    <title>React 16 17 18 - New feature Summary Links</title>
    <url>/React-16-New-feature-Summary-Links.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://github.com/facebook/react/blob/master/CHANGELOG.md" target="_blank" rel="noopener">React CHANGELOG</a></li>
<li><a href="https://github.com/facebook/react/releases" target="_blank" rel="noopener">GitHub_react_release</a></li>
<li><a href="https://en.wikipedia.org/wiki/React_(JavaScript_library)" target="_blank" rel="noopener">Wiki: React (JavaScript library)</a></li>
</ul>
<h2 id="react-版本-新功能-对照表">React 版本-新功能 对照表</h2>
<table>
<thead>
<tr>
<th>Version</th>
<th>Release Date</th>
<th>Feature</th>
<th>我的博客 Links</th>
</tr>
</thead>
<tbody>
<tr>
<td>16.0.0</td>
<td>2017/09/26</td>
<td><a href="https://reactjs.org/blog/2017/07/26/error-handling-in-react-16.html" target="_blank" rel="noopener">Error boundaries</a></td>
<td><a href="../React-16-Error-Handling.html">Error boundaries</a></td>
</tr>
<tr>
<td>…</td>
<td>-</td>
<td>First-class support for declaratively rendering a subtree into another DOM node with <a href="https://reactjs.org/docs/portals.html#event-bubbling-through-portals" target="_blank" rel="noopener">ReactDOM.createPortal()</a></td>
<td><a href="../React-16-Portal.html">Portal</a></td>
</tr>
<tr>
<td>16.2.0</td>
<td>2017/11/28</td>
<td><a href="https://reactjs.org/blog/2017/11/28/react-v16.2.0-fragment-support.html" target="_blank" rel="noopener">Improved Support for Fragments</a></td>
<td>Fragments</td>
</tr>
<tr>
<td><a href="https://reactjs.org/blog/2018/03/29/react-v-16-3.html" target="_blank" rel="noopener">16.3.0</a></td>
<td>2018/03/29</td>
<td><a href="https://reactjs.org/docs/context.html#contextprovider" target="_blank" rel="noopener">New officially supported context API</a></td>
<td>context API</td>
</tr>
<tr>
<td>16.2.0</td>
<td>2017/11/28</td>
<td><a href="https://reactjs.org/docs/react-api.html#reactcreateref" target="_blank" rel="noopener">New React.createRef()</a></td>
<td>React.createRef</td>
</tr>
<tr>
<td>-</td>
<td>-</td>
<td><a href="https://reactjs.org/docs/react-api.html#reactforwardref" target="_blank" rel="noopener">New React.forwardRef()</a></td>
<td>React.forwardRef</td>
</tr>
<tr>
<td>-</td>
<td>-</td>
<td><a href="https://reactjs.org/blog/2017/11/28/react-v16.2.0-fragment-support.html" target="_blank" rel="noopener">StrictMode Component</a></td>
<td>Fragments</td>
</tr>
<tr>
<td>-</td>
<td>-</td>
<td>New lifecycles Add a new getDerivedStateFromProps() lifecycle and UNSAFE_ aliases for the legacy lifecycles.</td>
<td></td>
</tr>
</tbody>
</table>
<p>Add a new getSnapshotBeforeUpdate() lifecycle.<br>
<a href="https://reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html" target="_blank" rel="noopener">https://reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html</a> <a href="https://reactjs.org/blog/2017/11/28/react-v16.2.0-fragment-support.html" target="_blank" rel="noopener">Improved Support for Fragments</a> | Fragments</p>
<h2 id="all-react-version-list">All React version list</h2>
<table>
<thead>
<tr>
<th>Version</th>
<th>Release Date</th>
<th>Changes</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>0.3.0</td>
<td>29 May 2013</td>
<td>Initial Public Release</td>
</tr>
<tr>
<td>0.4.0</td>
<td>20 July 2013</td>
<td>Support for comment nodes <code>&lt;div&gt;{/* */}&lt;/div&gt;</code>, Improved server-side rendering APIs, Removed React.autoBind, Support for the key prop, Improvements to forms, Fixed bugs.</td>
</tr>
<tr>
<td>0.5.0</td>
<td>20 October 2013</td>
<td>Improve Memory usage, Support for Selection and Composition events, Support for getInitialState and getDefaultProps in mixins, Added React.version and React.isValidClass, Improved compatibility for Windows.</td>
</tr>
<tr>
<td>0.8.0</td>
<td>20 December 2013</td>
<td>Added support for rows &amp; cols, defer &amp; async, loop for <code>&lt;audio&gt;</code> &amp; <code>&lt;video&gt;</code>, autoCorrect attributes. Added onContextMenu events, Upgraded jstransform and esprima-fb tools, Upgraded browserify.</td>
</tr>
<tr>
<td>0.9.0</td>
<td>20 February 2014</td>
<td>Added support for crossOrigin, download and hrefLang, mediaGroup and muted, sandbox, seamless, and srcDoc, scope attributes, Added any, arrayOf, component, oneOfType, renderable, shape to React.PropTypes, Added support for onMouseOver and onMouseOut event, Added support for onLoad and onError on <code>&lt;img&gt;</code> elements.</td>
</tr>
<tr>
<td>0.10.0</td>
<td>21 March 2014</td>
<td>Added support for srcSet and textAnchor attributes, add update function for immutable data, Ensure all void elements don’t insert a closing tag.</td>
</tr>
<tr>
<td>0.11.0</td>
<td>17 July 2014</td>
<td>Improved SVG support, Normalized e.view event, Update $apply command, Added support for namespaces, Added new transformWithDetails API, includes pre-built packages under dist/, MyComponent() now returns a descriptor, not an instance.</td>
</tr>
<tr>
<td>0.12.0</td>
<td>21 November 2014</td>
<td>Added new features Spread operator ({…}) introduced to deprecate this.transferPropsTo, Added support for acceptCharset, classID, manifest HTML attributes, React.addons.batchedUpdates added to API, @jsx React.DOM no longer required, Fixed issues with CSS Transitions.</td>
</tr>
<tr>
<td>0.13.0</td>
<td>10 March 2015</td>
<td>Deprecated patterns that warned in 0.12 no longer work, ref resolution order has changed, Removed properties this._pendingState and this._rootNodeID, Support ES6 classes, Added API React.findDOMNode(component), Support for iterators and immutable-js sequences, Added new features React.addons.createFragment, deprecated React.addons.classSet.</td>
</tr>
<tr>
<td>0.14.1</td>
<td>29 October 2015</td>
<td>Added support for srcLang, default, kind attributes, and color attribute, Ensured legacy .props access on DOM nodes, Fixed scryRenderedDOMComponentsWithClass, Added react-dom.js.</td>
</tr>
<tr>
<td>15.0.0</td>
<td>7 April 2016</td>
<td>Initial render now uses document.createElement instead of generating HTML, No more extra <code>&lt;span&gt;</code>s, Improved SVG support, <code>ReactPerf.getLastMeasurements()</code> is opaque, New deprecations introduced with a warning, Fixed multiple small memory leaks, React DOM now supports the cite and profile HTML attributes and cssFloat, gridRow and gridColumn CSS properties.</td>
</tr>
<tr>
<td>15.1.0</td>
<td>20 May 2016</td>
<td>Fix a batching bug, Ensure use of the latest object-assign, Fix regression, Remove use of merge utility, Renamed some modules.</td>
</tr>
<tr>
<td>15.2.0</td>
<td>1 July 2016</td>
<td>Include component stack information, Stop validating props at mount time, Add React.PropTypes.symbol, Add onLoad handling to <code>&lt;link&gt;</code> and onError handling to <code>&lt;source&gt;</code> element, Add <code>isRunning()</code> API, Fix performance regression.</td>
</tr>
<tr>
<td>15.3.0</td>
<td>30 July 2016</td>
<td>Add React.PureComponent, Fix issue with nested server rendering, Add xmlns, xmlnsXlink to support SVG attributes and referrerPolicy to HTML attributes, updates React Perf Add-on, Fixed issue with ref.</td>
</tr>
<tr>
<td>15.3.1</td>
<td>19 August 2016</td>
<td>Improve performance of development builds, Cleanup internal hooks, Upgrade fbjs, Improve startup time of React, Fix memory leak in server rendering, fix React Test Renderer, Change trackedTouchCount invariant into a console.error.</td>
</tr>
<tr>
<td>15.4.0</td>
<td>16 November 2016</td>
<td>React package and browser build no longer includes React DOM, Improved development performance, Fixed occasional test failures, update batchedUpdates API, React Perf, and <code>ReactTestRenderer.create()</code>.</td>
</tr>
<tr>
<td>15.4.1</td>
<td>23 November 2016</td>
<td>Restructure variable assignment, Fixed event handling, Fixed compatibility of browser build with AMD environments.</td>
</tr>
<tr>
<td>15.4.2</td>
<td>6 January 2017</td>
<td>Fixed build issues, Added missing package dependencies, Improved error messages.</td>
</tr>
<tr>
<td>15.5.0</td>
<td>7 April 2017</td>
<td>Added react-dom/test-utils, Removed peerDependencies, Fixed issue with Closure Compiler, Added a deprecation warning for React.createClass and React.PropTypes, Fixed Chrome bug.</td>
</tr>
<tr>
<td>15.5.4</td>
<td>11 April 2017</td>
<td>Fix compatibility with Enzyme by exposing batchedUpdates on shallow renderer, Update version of prop-types, Fix react-addons-create-fragment package to include loose-envify transform.</td>
</tr>
<tr>
<td>15.6.0</td>
<td>13 June 2017</td>
<td>Add support for CSS variables in style attribute and Grid style properties, Fix AMD support for addons depending on react, Remove unnecessary dependency, Add a deprecation warning for React.createClass and React.DOM factory helpers.</td>
</tr>
<tr>
<td>16.0.0</td>
<td>26 September 2017</td>
<td>Improved error handling with introduction of “error boundaries”, React DOM allows passing non-standard attributes, Minor changes to setState behavior, remove react-with-addons.js build, Add React.createClass as create-react-class, React.PropTypes as prop-types, React.DOM as react-dom-factories, changes to the behavior of scheduling and lifecycle methods.</td>
</tr>
<tr>
<td>16.1.0</td>
<td>9 November 2017</td>
<td>Discontinuing Bower Releases, Fix an accidental extra global variable in the UMD builds, Fix onMouseEnter and onMouseLeave firing, Fix placeholder, Remove unused code, Add a missing package.json dependency, Add support for React DevTools.</td>
</tr>
<tr>
<td>16.3.0</td>
<td>29 March 2018</td>
<td>Add a new officially supported context API, Add new packagePrevent an infinite loop when attempting to render portals with SSR, Fix an issue with this.state, Fix an IE/Edge issue.</td>
</tr>
<tr>
<td>16.3.1</td>
<td>3 April 2018</td>
<td>Prefix private API, Fix performance regression and error handling bugs in development mode, Add peer dependency, Fix a false positive warning in IE11 when using Fragment.</td>
</tr>
<tr>
<td>16.3.2</td>
<td>16 April 2018</td>
<td>Fix an IE crash, Fix labels in User Timing measurements, Add a UMD build, Improve performance of unstable_observedBits API with nesting.</td>
</tr>
<tr>
<td>16.4.0</td>
<td>24 May 2018</td>
<td>Add support for Pointer Events specification, Add the ability to specify propTypes, Fix reading context, Fix the <code>getDerivedStateFromProps()</code> support, Fix a testInstance.parent crash, Add React.unstable_Profiler component for measuring performance, Change internal event names.</td>
</tr>
<tr>
<td>16.5.0</td>
<td>5 September 2018</td>
<td>Add support for React DevTools Profiler, Handle errors in more edge cases gracefully, Add react-dom/profiling, Add onAuxClick event for browsers, Add movementX and movementY fields to mouse events, Add tangentialPressure and twist fields to pointer event.</td>
</tr>
<tr>
<td>16.6.0</td>
<td>23 October 2018</td>
<td>Add support for contextType, Support priority levels, continuations, and wrapped callbacks, Improve the fallback mechanism, Fix gray overlay on iOS Safari, Add <code>React.lazy()</code> for code splitting components.</td>
</tr>
<tr>
<td>16.7.0</td>
<td>20 December 2018</td>
<td>Fix performance of React.lazy for lazily-loaded components, Clear fields on unmount to avoid memory leaks, Fix bug with SSR, Fix a performance regression.</td>
</tr>
<tr>
<td>16.8.0</td>
<td>6 February 2019</td>
<td>Add Hooks, Add <code>ReactTestRenderer.act()</code> and <code>ReactTestUtils.act()</code> for batching updates, Support synchronous thenables passed to React.lazy(), Improve useReducer Hook lazy initialization API.</td>
</tr>
<tr>
<td>16.8.6</td>
<td>27 March 2019</td>
<td>Fix an incorrect bailout in useReducer(), Fix iframe warnings in Safari DevTools, Warn if contextType is set to Context.Consumer instead of Context, Warn if contextType is set to invalid values.</td>
</tr>
<tr>
<td>16.9.0</td>
<td>9 August 2019</td>
<td>Add React.Profiler API for gathering performance measurements programmatically. Remove unstable_ConcurrentMode in favor of unstable_createRoot</td>
</tr>
<tr>
<td>16.10.0</td>
<td>27 September 2019</td>
<td>Fix edge case where a hook update wasn’t being memoized. Fix heuristic for determining when to hydrate, so we don’t incorrectly hydrate during an update. Clear additional fiber fields during unmount to save memory. Fix bug with required text fields in Firefox. Prefer <a href="http://Object.is" target="_blank" rel="noopener">Object.is</a> instead of inline polyfill, when available. Fix bug when mixing Suspense and error handling.</td>
</tr>
<tr>
<td>16.10.1</td>
<td>28 September 2019</td>
<td>Fix regression in Next.js apps by allowing Suspense mismatch during hydration to silently proceed</td>
</tr>
<tr>
<td>16.10.2</td>
<td>3 October 2019</td>
<td>Fix regression in react-native-web by restoring order of arguments in event plugin extractors</td>
</tr>
<tr>
<td>16.11.0</td>
<td>22 October 2019</td>
<td>Fix mouseenter handlers from firing twice inside nested React containers. Remove unstable_createRoot and unstable_createSyncRoot experimental APIs. (These are available in the Experimental channel as createRoot and createSyncRoot.)</td>
</tr>
<tr>
<td>16.12.0</td>
<td>14 November 2019</td>
<td>React DOM - Fix passive effects (<code>useEffect</code>) not being fired in a multi-root app. React Is - Fix <code>lazy</code> and <code>memo</code> types considered elements instead of components</td>
</tr>
<tr>
<td>16.13.0</td>
<td>26 February 2020</td>
<td>Features added in React Concurrent mode. Fix regressions in React core library and React Dom.</td>
</tr>
<tr>
<td>16.13.1</td>
<td>19 March 2020</td>
<td>Fix bug in legacy mode Suspense. Revert warning for cross-component updates that happen inside class render lifecycles</td>
</tr>
<tr>
<td>16.14.0</td>
<td>14 October 2020</td>
<td>Add support for the new JSX transform.</td>
</tr>
<tr>
<td>17.0.0</td>
<td>20 October 2020</td>
<td>“No New Features” enables gradual React updates from older versions.Add new JSX Transform, Changes to Event Delegation</td>
</tr>
<tr>
<td>17.0.1</td>
<td>22 October 2020</td>
<td>React DOM - Fixes a crash in IE11</td>
</tr>
<tr>
<td>17.0.2</td>
<td>22 March 2021</td>
<td>React DOM - Remove an unused dependency to address the <code>SharedArrayBuffer</code> cross-origin isolation warning.</td>
</tr>
<tr>
<td>18.0.0</td>
<td>29 March 2022</td>
<td>Concurrent React, Automatic batching, New Suspense Features, Transitions, Client and Server Rendering APIs, New Strict Mode Behaviors, <a href="https://en.wikipedia.org/wiki/React_(JavaScript_library)#cite_note-42" target="_blank" rel="noopener">New Hooks</a></td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
        <category>React</category>
      </categories>
      <tags>
        <tag>React 16</tag>
      </tags>
  </entry>
  <entry>
    <title>iframe 内外页面通信</title>
    <url>/iframe-%E5%86%85%E5%A4%96%E9%A1%B5%E9%9D%A2%E9%80%9A%E4%BF%A1.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/parent" target="_blank" rel="noopener"><code>window.parent</code></a> 获取上一级的window对象。 如果当前窗口是一个 <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>, 或者 <code>&lt;frame&gt;</code>,则它的父窗口是嵌入它的那个窗口。如果还是iframe则是该iframe的window对象, 如果没有parent，则返回自身的引用。</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/top" target="_blank" rel="noopener">window.top</a> 获取最顶级容器的window对象，即，就是你打开页面的window</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/self" target="_blank" rel="noopener">window.self</a> 返回自身window的引用。可以理解 <code>window===window.self</code></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/frames" target="_blank" rel="noopener">window.frames</a> 当前窗口的所有直接子窗口</li>
<li>window.open/window.opener 使用window.open返回的对象</li>
</ul>
<h2 id="在iframe内获取iframe外的内容">在iframe内获取iframe外的内容</h2>
<h3 id="window-parent">window.parent</h3>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/parent" target="_blank" rel="noopener"><code>window.parent</code></a> 获取上一级的window对象。 如果当前窗口是一个 <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>, 或者 <code>&lt;frame&gt;</code>,则它的父窗口是嵌入它的那个窗口。如果还是iframe则是该iframe的window对象, 如果没有parent，则返回自身的引用。</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/top" target="_blank" rel="noopener">window.top</a> 获取最顶级容器的window对象，即，就是你打开页面的window</li>
</ul>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fbd94862dba4460d970290261cdf3bf2~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?" alt="iframe之间parent关系"></p>
<p>例如，想在iframe内获取所有parent的<code>userAgent</code>，检查是否含有<br>
HTML结构：</p>
<ul>
<li>parent.html
<ul>
<li>iframe    child1</li>
<li>iframe    child2</li>
</ul>
</li>
</ul>
<p>执行结果：<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/iframe%E5%86%85%E5%A4%96%E9%A1%B5%E9%9D%A2%E9%80%9A%E4%BF%A1/iframeUserAgent.png" alt="执行结果"></p>
<p>用本地文件测试frame的时候，在执行<code>curWindow.navigator.userAgent</code>的时候会报错：<br>
<code>Uncaught DOMException: Blocked a frame with origin &quot;null&quot; from accessing a cross-origin frame.</code><br>
解决方法： <a href="../iframe-%E5%86%85%E5%A4%96%E9%A1%B5%E9%9D%A2%E9%80%9A%E4%BF%A1.html#%E6%B5%8F%E8%A7%88%E5%99%A8disable-same-origin-policy">关闭浏览器CORS</a></p>
<details>
  <summary>点击展开parent.html代码</summary>
  <p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>parent<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        input &#123;</span><br><span class="line">            width: 97%;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        iframe &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">setUserAgent</span><span class="params">(window, customUserAgent)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> newUserAgent = <span class="string">`<span class="subst">$&#123;navigator.userAgent&#125;</span> <span class="subst">$&#123;customUserAgent&#125;</span>`</span>;</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// Works on Firefox, Chrome, Opera and IE9+</span></span></span><br><span class="line">            if (navigator.__defineGetter__) &#123;</span><br><span class="line"><span class="actionscript">                navigator.__defineGetter__(<span class="string">'userAgent'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">return</span> newUserAgent;</span></span><br><span class="line">                &#125;);</span><br><span class="line"><span class="javascript">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">Object</span>.defineProperty) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">Object</span>.defineProperty(navigator, <span class="string">'userAgent'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">get</span>: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                        <span class="keyword">return</span> newUserAgent;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line"><span class="actionscript">            <span class="comment">// Works on Safari</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (<span class="built_in">window</span>.navigator.userAgent.indexOf(customUserAgent) &lt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">const</span> userAgentProp = &#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">get</span>: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                        <span class="keyword">return</span> newUserAgent;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;;</span><br><span class="line"><span class="actionscript">                <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">Object</span>.defineProperty(<span class="built_in">window</span>.navigator, <span class="string">'userAgent'</span>, userAgentProp);</span></span><br><span class="line"><span class="actionscript">                &#125; <span class="keyword">catch</span> (e) &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">window</span>.navigator = <span class="built_in">Object</span>.create(navigator, &#123;</span></span><br><span class="line">                        userAgent: userAgentProp,</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">        setUserAgent(<span class="built_in">window</span>, <span class="string">'CustomUserAgent/1.0'</span>); <span class="comment">// append CustomUserAgent/1.0 to the original userAgent</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> a = <span class="built_in">document</span>.createElement(<span class="string">'input'</span>);</span></span><br><span class="line"><span class="javascript">        a.value = <span class="string">'parent '</span> + <span class="built_in">window</span>.navigator.userAgent;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body &amp;&amp; <span class="built_in">document</span>.body.appendChild(a);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> isCustomUserAgent = <span class="built_in">window</span>.navigator &amp;&amp; <span class="built_in">window</span>.navigator.userAgent.indexOf(<span class="string">'CustomUserAgent'</span>) &gt;= <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> curWindow = <span class="built_in">window</span>;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// check if window.top equals window, if not, check it's parent</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">while</span> (<span class="built_in">window</span>.top !== curWindow) &#123;</span></span><br><span class="line">            curWindow = curWindow.parent;</span><br><span class="line"><span class="actionscript">            <span class="keyword">const</span> newUserAgent = curWindow.navigator.userAgent;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">if</span> (newUserAgent &amp;&amp; newUserAgent.indexOf(<span class="string">'CustomUserAgent'</span>) &gt;= <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="actionscript">                isCustomUserAgent = <span class="literal">true</span>;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">break</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> b = <span class="built_in">document</span>.createElement(<span class="string">'input'</span>);</span></span><br><span class="line"><span class="actionscript">        b.value = <span class="string">'isCustomUserAgent '</span> + isCustomUserAgent;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body &amp;&amp; <span class="built_in">document</span>.body.appendChild(b);</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"child1.html"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
  </p>
</details>
<details>
  <summary>点击展开child1.html代码</summary>
  <p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>child1<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        input &#123;</span><br><span class="line">            width: 97%;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        iframe &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    我是child1 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> currUserAgent = <span class="built_in">document</span>.createElement(<span class="string">'input'</span>);</span></span><br><span class="line"><span class="javascript">        currUserAgent.value = <span class="string">'child1 '</span> + <span class="built_in">window</span>.navigator.userAgent;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body &amp;&amp; <span class="built_in">document</span>.body.appendChild(currUserAgent);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> isCustomUserAgent = <span class="built_in">window</span>.navigator &amp;&amp; <span class="built_in">window</span>.navigator.userAgent.indexOf(<span class="string">'CustomUserAgent'</span>) &gt;= <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> curWindow = <span class="built_in">window</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> isParentPowerPoint;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// check if window.top equals window, if not, check it's parent</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">while</span> (<span class="built_in">window</span>.top !== curWindow) &#123;</span></span><br><span class="line">                curWindow = curWindow.parent;</span><br><span class="line"><span class="actionscript">                <span class="keyword">const</span> newUserAgent = curWindow.navigator.userAgent;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">if</span> (newUserAgent &amp;&amp; newUserAgent.indexOf(<span class="string">'CustomUserAgent'</span>) &gt;= <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="actionscript">                    isCustomUserAgent = <span class="literal">true</span>;</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">break</span>;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="actionscript">        &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(error);</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> b = <span class="built_in">document</span>.createElement(<span class="string">'input'</span>);</span></span><br><span class="line"><span class="actionscript">        b.value = <span class="string">'isCustomUserAgent from ancestor '</span> + isCustomUserAgent;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body &amp;&amp; <span class="built_in">document</span>.body.appendChild(b);</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"child2.html"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
  </p>
</details>
<details>
  <summary>点击展开child2.html代码</summary>
  <p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>child2<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        input &#123;</span><br><span class="line">            width: 97%;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        iframe &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    我是child2 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> currUserAgent = <span class="built_in">document</span>.createElement(<span class="string">'input'</span>);</span></span><br><span class="line"><span class="javascript">        currUserAgent.value = <span class="string">'child2 '</span> + <span class="built_in">window</span>.navigator.userAgent;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body &amp;&amp; <span class="built_in">document</span>.body.appendChild(currUserAgent);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> isCustomUserAgent = <span class="built_in">window</span>.navigator &amp;&amp; <span class="built_in">window</span>.navigator.userAgent.indexOf(<span class="string">'CustomUserAgent'</span>) &gt;= <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> curWindow = <span class="built_in">window</span>;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// check if window.top equals window, if not, check it's parent</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">while</span> (<span class="built_in">window</span>.top !== curWindow) &#123;</span></span><br><span class="line">            curWindow = curWindow.parent;</span><br><span class="line"><span class="actionscript">            <span class="keyword">const</span> newUserAgent = curWindow &amp;&amp; curWindow.navigator.userAgent;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">if</span> (newUserAgent &amp;&amp; newUserAgent.indexOf(<span class="string">'CustomUserAgent'</span>) &gt;= <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="actionscript">                isCustomUserAgent = <span class="literal">true</span>;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">break</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> b = <span class="built_in">document</span>.createElement(<span class="string">'input'</span>);</span></span><br><span class="line"><span class="actionscript">        b.value = <span class="string">'isCustomUserAgent from ancestor '</span> + isCustomUserAgent;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body.appendChild(b);</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
  </p>
</details>
<h3 id="父页面向子页面传递数据by-url">父页面向子页面传递数据by URL</h3>
<p>利用location对象的hash值，通过它传递通信数据。在父页面设置<code>iframe</code>的<code>src</code>后面多加个<code>data</code>字符串，然后在子页面中通过某种方式能即时的获取到这儿的data。</p>
<h2 id="在iframe外获取iframe里的内容">在iframe外获取iframe里的内容</h2>
<h3 id="方法一-contentwindow和contentdocument">方法一 <code>contentWindow</code>和<code>contentDocument</code></h3>
<ul>
<li><code>iframe.contentWindow</code>可以获取iframe的window对象, <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/contentWindow" target="_blank" rel="noopener">MDN</a></li>
<li><code>iframe.contentDocument</code>可以获取iframe的document对象, <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/contentDocument" target="_blank" rel="noopener">MDN</a>。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const iframe = document.getElementById("iframe1");</span></span><br><span class="line"><span class="keyword">const</span> iframe = <span class="built_in">document</span>.querySelector(<span class="string">"iframe"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> iContentWindow = iframe.contentWindow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> idoc = iContentWindow.document;</span><br><span class="line"><span class="keyword">const</span> iContentDocument = iframe.contentDocument;</span><br><span class="line"><span class="keyword">const</span> isSameDoc = iframe.contentDocument === iframe.contentWindow.document; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"iframe.contentWindow"</span>, iContentWindow); <span class="comment">// 获取iframe的window对象 iframe.contentWindow</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"iframe.contentDocument"</span>, iContentDocument);  <span class="comment">// 获取iframe的document  iframe.contentDocument</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"html"</span>, iContentDocument.documentElement); <span class="comment">// 获取iframe的html</span></span><br></pre></td></tr></table></figure>
<h3 id="方法二-window-frames">方法二 window.frames</h3>
<p>结合Name属性，通过window提供的frames获取</p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/frames" target="_blank" rel="noopener">window.frames</a> 当前窗口的所有直接子窗口</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span> =<span class="string">"/index.html"</span> <span class="attr">id</span>=<span class="string">"ifr1"</span> <span class="attr">name</span>=<span class="string">"ifr2"</span> <span class="attr">scrolling</span>=<span class="string">"yes"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Your browser does not support iframes.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="built_in">window</span>.frames[<span class="string">'ifr2'</span>].window);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.dir(<span class="built_in">document</span>.getElementById(<span class="string">"iframe"</span>).contentWindow);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="跨域通信">跨域通信</h2>
<h3 id="跨域">跨域</h3>
<p><a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#preflight-requests-for-complex-http-calls" target="_blank" rel="noopener">Cross-Origin Resource Sharing (CORS)</a></p>
<p>CORS的基本原理请看上一篇：<br>
<a href="../HTTP-CORS.html">CORS的基本原理</a></p>
<p>为了保证用户信息的安全，95年的时候Netscape公司引进了同源策略，里面的同源指的是三个相同：</p>
<ul>
<li>协议（例如 https， http）</li>
<li>端口号（例如 8080,8443，443）</li>
<li>域名 (<code>document.domain</code>设置为相同的值)</li>
</ul>
<p>违反了同源策略就会出现跨域问题，主要表现为以下三方面：</p>
<ul>
<li>无法读取cookie、localStorage、indexDB</li>
<li>DOM无法获得</li>
<li>ajax请求无法发送</li>
<li>can’t access an <iframe> with different origin using JavaScript, browsers block scripts trying to access a frame with a different origin.</iframe></li>
</ul>
<h3 id="iframe缺点以及解决方案">iframe缺点以及解决方案</h3>
<p>缺点:</p>
<ul>
<li>iframe会阻塞主页面的Onload事件；要确保在iframe加载完成后再进行操作，如果iframe还未加载完成就开始调用里面的方法或变量，会产生错误；
<ul>
<li>判断iframe加载完成</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">iframe.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>相同域iframe和主页面共享http连接池，所以如果相同域用多个iframe会阻塞加载
<ul>
<li>解决方案： 动态生成iframe，在主页面加载完成后去生产iframe加载，从而避免阻塞的影响</li>
</ul>
</li>
<li>iframe 对SEO不友好
<ul>
<li>解决方案：在广告位以及内部系统等适合的场景中使用iframe</li>
</ul>
</li>
<li>如果iframe所链接的是外部页面，因为安全机制不能使用同域名下的通信方式；</li>
</ul>
<h3 id="跨域通信方法一设置document-domain">跨域通信方法一设置<code>document.domain</code></h3>
<p>例子：需要用iframe引入一个别人封装好的类似视频播放器的东西。iframe里面有一个全屏的按钮，点击后需要页面让iframe全屏，由于受到同源策略的限制，iframe无法告诉页面全屏。</p>
<p><code>document.domain</code>作用是获取/设置当前文档的原始域部分，同源策略会判断两个文档的原始域是否相同来判断是否跨域。这意味着只要把这个值设置成一样就可以解决跨域问题了。<br>
在此将domain设置为一级域名的值，a页面url为<code>a.demo.com</code>，a页面中iframe引用的b页面url为<code>b.demo.com</code>，具体设置为<code>document.domain = 'demo.com'</code><br>
设置完之后，在a页面的window上挂载使iframe全屏的方法</p>
<ul>
<li>a页面 <code>a.demo.com</code>
<ul>
<li>iframe b页面 <code>b.demo.com</code></li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// a页面</span></span><br><span class="line"><span class="built_in">window</span>.toggleFullScreen = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在b页面上可以直接获取到a页面的window对象并直接调用</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// b页面</span></span><br><span class="line"><span class="built_in">window</span>.parent.toggleFullScreen()</span><br></pre></td></tr></table></figure>
<p>但是这个值的设置也有一定限制，只能设置为当前文档的上一级域或者是跟该文档的URL的domain一致的值。如url为<code>a.demo.com</code>，那domain就只能设置为<code>demo.com</code>或者<code>a.demo.com</code>。因此，设置domain的方法只能用于解决<strong>主域相同而子域不同</strong>的情况。</p>
<h3 id="跨域通信方法二使用中间页面">跨域通信方法二使用中间页面</h3>
<p>我们还可以使用一个与a页面同域名但不同路由的c页面作为中间页面，b页面加载c页面，c页面调用a页面的方法，从而实现b页面调用a页面的方法。<br>
在a页面的node层新开一个路由，此路由加载一个c页面作为中间页面，<a href="http://xn--curla-hq1ho02vg7wcy9b.demo.com/c%E3%80%82c%E9%A1%B5%E9%9D%A2%E5%8F%AA%E6%98%AF%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84html%E9%A1%B5%E9%9D%A2%EF%BC%8C%E5%9C%A8window%E7%9A%84onload%E4%BA%8B%E4%BB%B6%E4%B8%8A%E8%B0%83%E7%94%A8%E4%BA%86a%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%96%B9%E6%B3%95%E3%80%82" target="_blank" rel="noopener">c页面的url为a.demo.com/c。c页面只是一个简单的html页面，在window的onload事件上调用了a页面的方法。</a></p>
<ul>
<li>a页面 <code>a.demo.com</code>
<ul>
<li>iframe b页面
<ul>
<li>iframe c页面 【中间页<code>a.demo.com/c</code>】(与a页面同域名但不同路由, c页面调用a页面的方法，从而实现b页面调用a页面的方法)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>由于c页面和a页面是符合同源策略的，所以可以避开跨域问题，执行全屏的方法。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- c页面 --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line">            parent.parent.toggleFullScreen();</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>由于c页面和a页面是符合同源策略的，所以可以避开跨域问题，执行全屏的方法。</p>
<h3 id="跨域通信方法三window-postmessage">跨域通信方法三<code>window.postMessage</code></h3>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage" target="_blank" rel="noopener">window.postMessage方法可以安全地实现跨源通信</a>，写明目标窗口的协议、主机地址或端口就可以发信息给它。</p>
<ul>
<li>a页面 <code>a.demo.com</code>
<ul>
<li>iframe b页面 <code>b.demo.com</code></li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// b页面</span></span><br><span class="line">parent.postMessage(</span><br><span class="line">    value,</span><br><span class="line">    <span class="string">"http://a.demo.com"</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// a页面</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"message"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"> event </span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 为了安全，收到信息后要检测下event.origin判断是否要收信息的窗口发过来的。</span></span><br><span class="line">    <span class="keyword">if</span> (event.origin !== <span class="string">'http://b.demo.com'</span>) <span class="keyword">return</span>;</span><br><span class="line">    toggleFullScreen()</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="兼容性">兼容性</h4>
<p>需要注意的是postMessage API中的message在ie8/ie9等一些低版本浏览器中，中是不支持除String以外的其他类型时（因为不支持结构化克隆算法），所以，如果要兼容低版本ie，需要通过JSON.strigify以及JSON.parse去发送和接受。</p>
<h3 id="fix-cors">Fix CORS</h3>
<p><a href="../HTTP-CORS-disable.html">Disable CORS limit</a></p>
<p>用本地文件测试frame的时候，在执行<code>curWindow.navigator.userAgent</code>的时候会报错：<br>
<code>Uncaught DOMException: Blocked a frame with origin &quot;null&quot; from accessing a cross-origin frame.</code></p>
<p>原因是浏览器默认开启了CORS的安全保护，不允许iframe跨域获取一些值。</p>
<p>关闭同源策略 (CORS) 只会影响您的浏览器。此外，在浏览器中禁用同源安全设置会允许任何网站访问跨源资源，这是非常危险的，只能用于开发目的。现在，只有 <code>window.postMessage()</code> 才是<code>frame/iframe</code> 之间交互的最佳方式。</p>
<h4 id="解决方案1-关闭浏览器cors-limit-临时解决">解决方案1 关闭浏览器CORS limit [临时解决]</h4>
<p>参考 <a href="https://stackoverflow.com/questions/3102819/disable-same-origin-policy-in-chrome" target="_blank" rel="noopener">Disable same origin policy in Chrome</a>， 命令行加参数<code>--disable-web-security</code>打开chrome浏览器</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Mac Chrome</span></span><br><span class="line">open /Applications/Google\ Chrome.app --args --user-data-dir=<span class="string">"/const/tmp/Chrome dev session"</span> --<span class="built_in">disable</span>-web-security</span><br><span class="line"><span class="comment"># Mac Chrome Canary</span></span><br><span class="line"><span class="comment">#open /Applications/Google\ Chrome\ Canary.app --args --user-data-dir="/const/tmp/Chrome dev session" --disable-web-security</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># For Linux run:</span></span><br><span class="line">$ google-chrome --<span class="built_in">disable</span>-web-security</span><br><span class="line"></span><br><span class="line"><span class="comment"># For Windows go into the command prompt and go into the folder where Chrome.exe is and type</span></span><br><span class="line">chrome.exe --<span class="built_in">disable</span>-web-security</span><br></pre></td></tr></table></figure>
<h4 id="解决方案2-extensions-xampp-or-live-server-临时解决">解决方案2 Extensions “xampp” or “Live Server” [临时解决]</h4>
<p>You could solve it by installing xampp and moving all files to htdocs or using an extension like “Xampp”.</p>
<h4 id="解决方案3-try-catch-跨域时无法获取想要的值-只是不抛错">解决方案3 try-catch [跨域时无法获取想要的值，只是不抛错]</h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// iframe 内的javascript</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> parent = <span class="built_in">window</span>.parent &amp;&amp; <span class="built_in">window</span>.parent.navigator;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="built_in">console</span>.warn(<span class="string">`Error - <span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="解决方案4-window-postmessage-终极解决">解决方案4 <code>window.postMessage()</code> [终极解决]</h4>
<p>同源策略可防止脚本访问不同源的网站内容，您可以使用 <code>window.postMessage()</code> 安全地在 Window 对象之间实现跨源通信。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">postMessage(message,targetOrigin)</span><br><span class="line">postMessage(message,targetOrigin, [transfer])</span><br></pre></td></tr></table></figure>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://juejin.cn/post/7017740414060855310" target="_blank" rel="noopener">JS对Iframe内外页面进行操作</a></li>
<li><a href="https://juejin.cn/post/6844903831973675015" target="_blank" rel="noopener">iframe跨域的几种常用方法</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/168764040" target="_blank" rel="noopener">Web前端之iframe详解</a></li>
<li><a href="https://juejin.cn/post/6961791208876146718" target="_blank" rel="noopener">Iframe父子窗口通信</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/parent" target="_blank" rel="noopener">MDN Window.parent</a></li>
<li><a href="https://stackoverflow.com/questions/3102819/disable-same-origin-policy-in-chrome" target="_blank" rel="noopener">Disable same origin policy in Chrome</a></li>
<li><a href="https://blog.csdn.net/weixin_43959024/article/details/118152348" target="_blank" rel="noopener">不同源iframe跨域问题（window.postMessage）</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>FrontEnd</category>
      </categories>
      <tags>
        <tag>CORS</tag>
      </tags>
  </entry>
  <entry>
    <title>iterm2+oh-my-zsh组合你的terminal</title>
    <url>/oh-my-zsh%E7%BB%84%E5%90%88%E4%BD%A0%E7%9A%84terminal.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="oh-my-zsh到底是个啥呢？"><a href="http://ohmyz.sh" target="_blank" rel="noopener">oh-my-zsh</a>到底是个啥呢？</h1>
<p>其实很早就装了<a href="https://github.com/ohmyzsh/ohmyzsh" target="_blank" rel="noopener">oh-my-zsh</a>，但是没好好研究过好用的插件。趁此机会就全面总结下好了，省的我下次又忘记了。</p>
<blockquote>
<p>Oh My Zsh is an open source, community-driven framework for managing your zsh configuration.</p>
</blockquote>
<p>简单说oh-my-zsh是基于zsh的管理配置框架。只是一个对zsh命令行环境的配置包装框架，但它不提供命令行窗口，更不是一个独立的APP。所以前提是先安装好zsh。</p>
<h2 id="为什么要用zsh？">为什么要用Zsh？</h2>
<p>（在<a href="https://blog.csdn.net/czg13548930186/article/details/72858289" target="_blank" rel="noopener">“利用Oh-My-Zsh打造你的超级终端”</a>第一部分的基础上修改。）</p>
<blockquote>
<p>【兼容bash】原来爱用bash的童鞋切换过来毫无压力。</p>
<p>【强大的历史纪录功能】在用方向上键⬆查找历史命令时，zsh支持限制查找。比如输入git然后再按方向上键⬆,则只会查找用过的git命令。</p>
<p>【多个终端会话共享历史记录】经常有多个窗口，tab，tmux的多个session，panel。这些命令历史不能共享实在是很糟糕的回忆。<br>
但是有了zsh之后，这些确实成了回忆了,所有的命令历史都可以共享。</p>
<p>【智能拼写纠正】输入gtep mactalk * -R，系统会提示：zsh: correct ‘gtep’ to ‘grep’ [nyae]?比妹纸贴心吧，她们向来都是让你猜的……</p>
<p>【各种补全】路径补全、命令补全，命令参数补全，插件内容补全等等。触发补全只需要按一下或两下tab键，补全项可以使用ctrl+n/p/f/b上下左右切换。<br>
比如你想杀掉java的进程，只需要输入kill java + tab键，如果只有一个java进程，zsh 会自动替换为进程的 pid，如果有多个则会出现选择项供你选择。ssh+空格+两个tab键，zsh会列出所有访问过的主机和用户名进行补全</p>
<p>【不再需要输入cd命令跳转目录】 直接输入… 或 … ，或目录名都可以跳转，不再需要输入cd命令了。</p>
<p>【通配符搜索】 ls -l *<em>/</em>.sh，可以递归显示当前目录下的 shell 文件，文件少时可以代替find，文件太多还是用find。</p>
<p>输入 d，即可列出你在这个会话里访问的目录列表，输入列表前的序号，即可直接跳转。</p>
<p>【丰富的插件】安装了autojump插件之后，zsh 会自动记录你访问过的目录，通过 j + 目录名 可以直接进行目录跳转，而且目录名支持模糊匹配和自动补全，例如你访问过hadoop-1.0.0目录，输入j hado 即可正确跳转。j –stat 可以看你的历史路径库。</p>
</blockquote>
<h1 id="oh-my-zsh-安装">oh-my-zsh 安装</h1>
<h2 id="1-安装zsh">1 <a href="https://github.com/ohmyzsh/ohmyzsh/wiki/Installing-ZSH" target="_blank" rel="noopener">安装zsh</a></h2>
<h3 id="判断zsh是否已经安装">判断zsh是否已经安装</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">zsh --version</span><br></pre></td></tr></table></figure>
<p>期望版本 zsh 5.4.2 或者更高。没有安装的话，按<a href="https://github.com/ohmyzsh/ohmyzsh/wiki/Installing-ZSH" target="_blank" rel="noopener">官网步骤安装zsh</a>就好了。</p>
<h3 id="安装zsh">安装zsh</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Linux</span></span><br><span class="line">sudo yum install zsh    (Fedora和RedHat以及SUSE中)或</span><br><span class="line">sudo apt-get install zsh    (Debian系列，Ubuntu )</span><br><span class="line"></span><br><span class="line"><span class="comment"># macOS 系统自带了zsh, 一般不是最新版，如果需要最新版可通过Homebrew来安装(确认安装了Homebrew)</span></span><br><span class="line">brew install zsh zsh-completions</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者也可以使用MacPorts(包管理工具)</span></span><br><span class="line">sudo port install zsh zsh-completions</span><br></pre></td></tr></table></figure>
<h3 id="设置zsh-作为默认shell">设置Zsh 作为默认shell</h3>
<p>打开一个新的terminal来确认，设置Zsh 作为默认shell：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br><span class="line"><span class="comment"># 期望结果: /usr/bin/zsh or similar</span></span><br><span class="line"><span class="comment"># 如果shell列表中没有zsh或者你没有使用chsh权限的时候，不起作用</span></span><br><span class="line">[sudo] chsh -s $(<span class="built_in">which</span> zsh)  <span class="comment">#或 chsh -s /bin/zsh</span></span><br></pre></td></tr></table></figure>
<h2 id="2-安装oh-my-zsh">2 安装oh-my-zsh</h2>
<p>Oh My Zsh 的安装方式简单，可以通过curl或wget的方式。</p>
<h3 id="curl-方式">curl 方式</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>"</span></span><br></pre></td></tr></table></figure>
<h3 id="wget方式">wget方式</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>"</span></span><br></pre></td></tr></table></figure>
<h3 id="git方式">git方式</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh</span><br></pre></td></tr></table></figure>
<h3 id="oh-my-zsh目录结构">oh-my-zsh目录结构</h3>
<p>进入~/.oh-my-zsh目录后，看看该目录的结构</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ls ~/.oh-my-zsh</span><br><span class="line">cache  custom  lib  <span class="built_in">log</span>  MIT-LICENSE.txt  oh-my-zsh.sh  plugins  README.markdown  templates  themes  tools</span><br></pre></td></tr></table></figure>
<blockquote>
<p>lib 提供了核心功能的脚本库<br>
tools 提供安装、升级等功能的快捷工具<br>
plugins 自带插件的存在放位置<br>
templates 自带模板的存在放位置<br>
themes  自带主题文件的存在放位置<br>
custom 个性化配置目录，自安装的插件和主题可放这里</p>
</blockquote>
<h1 id="oh-my-zsh-主题配置">oh-my-zsh 主题配置</h1>
<h2 id="默认主题">默认主题</h2>
<p>打开配置文件~/.zshrc</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>找到<code>ZSH_THEME=&quot;robbyrussel&quot;</code> 系统默认主题robbyrussel。</p>
<p><img src="https://cloud.githubusercontent.com/assets/2618447/6316876/710cbb8c-ba03-11e4-90b3-0315d72f270c.jpg" alt="默认主题robbyrussel"></p>
<p>Oh My Zsh默认自带了一些主题，存放在~/.oh-my-zsh/themes目录中。我们可以查看这些主题，<a href="https://github.com/ohmyzsh/ohmyzsh/wiki/themes" target="_blank" rel="noopener">官网也列出了许多主题的图片</a>, 方便我们挑选。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ls ~/.oh-my-zsh/themes</span><br></pre></td></tr></table></figure>
<p>想用什么主题，我们只要修改配置<code>ZSH_THEME</code>。<br>
然后保存这个文件文件，再打开一个新的命令行窗口即可看到效果了。我们还可以将主题设置为随机，这样在我们每次打开命令行窗口的时候，都会随机在已经安装的主题中选择一个。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ZSH_THEME=<span class="string">"random"</span></span><br></pre></td></tr></table></figure>
<p>我们如果觉得当前的主题比较喜欢，可以直接使用 echo 命令输出当前主题的名称</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$ZSH_THEME</span></span><br></pre></td></tr></table></figure>
<p>然后再将他设置到配置文件配置文件~/.zshrc中即可。</p>
<h2 id="官方推荐主题agnoster">官方推荐主题agnoster</h2>
<p><img src="https://cloud.githubusercontent.com/assets/2618447/6316862/70f58fb6-ba03-11e4-82c9-c083bf9a6574.png" alt="agnoster"></p>
<p>为啥这个单拎出来说呢，因为需要额外安装<a href="https://github.com/powerline/fonts" target="_blank" rel="noopener">Powerline Fonts字体</a> (或<a href="https://github.com/microsoft/cascadia-code" target="_blank" rel="noopener">Cascadia Code PL /Cascadia Mono PL字体</a>)和修改iTerm设置。</p>
<p>否则就会长这个样子：</p>
<p><img src="https://hustyichi.github.io/img/in-post/oh-my-zsh/first.jpg" alt="缺少字体"></p>
<p>解决方法：</p>
<ol>
<li><a href="https://github.com/powerline/fonts" target="_blank" rel="noopener">下载Powerline字体库</a>, 或者使用<a href="https://github.com/microsoft/cascadia-code" target="_blank" rel="noopener">Cascadia Code PL /Cascadia Mono PL字体</a></li>
<li>进入目录，执行install.sh脚本</li>
<li>iTerm -&gt; Preferences -&gt; Profiles -&gt; Text -&gt; Font 修改字体</li>
</ol>
<h3 id="修改配置文件-zshrc">修改配置文件~/.zshrc</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ZSH_THEME=<span class="string">"agnoster"</span></span><br></pre></td></tr></table></figure>
<h3 id="安装powerline-fonts字体">安装<a href="https://github.com/powerline/fonts" target="_blank" rel="noopener">Powerline Fonts字体</a></h3>
<h4 id="通过命令安装字体">通过命令安装字体</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># clone</span></span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/powerline/fonts.git --depth=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># install</span></span><br><span class="line">$ <span class="built_in">cd</span> fonts</span><br><span class="line">$ ./install.sh</span><br><span class="line">cp: directory /Users/yuanli/Library/Fonts does not exist</span><br><span class="line">Powerline fonts installed to /Users/yuanli/Library/Fonts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果~/Library/Fonts 文件夹不存在，则创建文件夹后再次执行</span></span><br><span class="line">$ ./install.sh</span><br><span class="line"><span class="comment"># ~/Library/Fonts里面就有需要的字体</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># clean-up a bit</span></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">rm -rf fonts</span><br></pre></td></tr></table></figure>
<h4 id="通过font-book安装字体">通过font book安装字体</h4>
<p>参考链接： <a href="https://www.lifewire.com/how-to-manually-install-fonts-on-mac-2260815" target="_blank" rel="noopener">https://www.lifewire.com/how-to-manually-install-fonts-on-mac-2260815</a></p>
<ol>
<li>
<p>打开Mac自带应用： Font Book</p>
</li>
<li>
<p>Select <code>File</code> and choose <code>Add Fonts</code> in the drop-down menu.</p>
</li>
<li>
<p>选择刚刚在~/Library/Fonts下安装好的所有字体</p>
</li>
<li>
<p>Before you use the font, validate it to be sure it is safe to use. Select the font and choose <code>Validate Font</code> in the File menu to generate a Font Validation window.</p>
</li>
</ol>
<p>这时候发现还是不生效。iTerm2需要额外配置，需要在终端中Regular font 和 the Non-ASCII Font选中刚刚安装的字体</p>
<h3 id="修改iterm2设置">修改iTerm2设置</h3>
<h4 id="多设备共享iterm2设置">多设备共享iTerm2设置</h4>
<p>iTerm2 --&gt; Preferences --&gt; General --&gt; Preferences Tab</p>
<p>勾选 <code>Load preferences from a custom folder or URL</code>，并选择配置文件，这里我是用oneDrive共享过来的。<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/218eec4defecbfe94b81086b7dfa7b4c099b9746/blog/post/oh-my-zsh%E7%BB%84%E5%90%88%E4%BD%A0%E7%9A%84terminal/iTerm2%E9%85%8D%E7%BD%AE%E5%85%B1%E4%BA%AB.png" alt="修改iTerm2设置字体"></p>
<h4 id="iterm2设置主题">iTerm2设置主题</h4>
<p>iTerm2需要额外配置，需要在终端中Regular font 和 the Non-ASCII Font选中刚刚安装的字体，点击iTerms的菜单&quot;iTerm &gt; Preferences &gt; Profiles &gt; Text&quot;，进行配置（<a href="https://github.com/powerline/fonts/issues/44" target="_blank" rel="noopener">git issue</a>）。</p>
<h5 id="字体方案一-不管用">字体方案一【不管用】</h5>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/oh-my-zsh%E7%BB%84%E5%90%88%E4%BD%A0%E7%9A%84terminal/iTerm2%E8%AE%BE%E7%BD%AE.png" alt="修改iTerm2设置"></p>
<p>按说这回就能正常显示主题agnoster了，但还是不行。</p>
<h5 id="字体方案二-管用">字体方案二【管用】</h5>
<p>后来在git issue上面查了半天，找到了<a href="https://github.com/ohmyzsh/ohmyzsh/issues/2869" target="_blank" rel="noopener">解决办法</a>。</p>
<p>iTerm2设置中不仅要修改Non-ASCII Font，还要修改字体。<br>
这里我修改成：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/oh-my-zsh%E7%BB%84%E5%90%88%E4%BD%A0%E7%9A%84terminal/iTerm2%E8%AE%BE%E7%BD%AE2.png" alt="修改iTerm2设置字体"></p>
<h5 id="字体方案三-管用">字体方案三【管用】</h5>
<p>看别人的经验，还可以把iTerm 2的设置里的Profile中的Text 选项卡中里的Regular Font和Non-ASCII Font的字体都设置成 Powerline的字体<br>
<code>12pt Meslo LG S DZ Regular for Powerline</code></p>
<p>或者:<br>
<img src="https://cloud.githubusercontent.com/assets/1128227/9950693/c834c0ec-5dc5-11e5-92c1-a75d80f3d783.png" alt="或者"></p>
<h5 id="字体方案四-管用-正在使用">字体方案四【管用，正在使用】</h5>
<p>如果之前安装的是<a href="https://github.com/microsoft/cascadia-code" target="_blank" rel="noopener">Cascadia Code PL /Cascadia Mono PL字体</a>，设置为：</p>
<ul>
<li>Font：Cascadia Code PL            Regular 12</li>
<li>Non-ASCII Font：Cascadia Code PL  Regular 12</li>
</ul>
<h4 id="iterm2配色方案">iTerm2配色方案</h4>
<p>我的iTerm2配色跟agnoster不同，也需要修改。<br>
下载<a href="https://github.com/altercation/solarized#click-here-to-download-latest-version" target="_blank" rel="noopener">solarized</a>。</p>
<p>进入刚刚下载的工程的solarized/iterm2-colors-solarized 下双击 Solarized Dark.itermcolors 和 Solarized Light.itermcolors 两个文件就可以把配置文件导入到 iTerm2 里</p>
<p>通过load presets选择刚刚安装的配色主题即可<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/oh-my-zsh%E7%BB%84%E5%90%88%E4%BD%A0%E7%9A%84terminal/iTerm2%E8%AE%BE%E7%BD%AE%E9%85%8D%E8%89%B23.png" alt="修改iTerm2设置字体"></p>
<h3 id="vs-code-设置">VS Code 设置</h3>
<p>但后来我发现，在VS Code的控制台中仍然有乱码。<br>
原因是VS Code的字体设置有限制，只能设置monospace样式的字体，我找到了这篇文章<br>
作者用的是Linux，跟Mac在目录结构上有些差异，我参照了前面提到的install.sh脚本中的信息，修改了一些地方，以下是Mac上的操作步骤：</p>
<ul>
<li>从这个<a href="https://github.com/abertsch/Menlo-for-Powerline" target="_blank" rel="noopener">链接</a>下载字体文件</li>
<li>sudo mv “Menlo for Powerline.ttf” ~/Library/Fonts</li>
<li>VS Code -&gt; Terminal Font Family 设置字体为 Menlo for Powerline</li>
</ul>
<h2 id="修改主题-怎样不显示主机名"><a href="https://github.com/agnoster/agnoster-zsh-theme/issues/39#issuecomment-307338817" target="_blank" rel="noopener">修改主题-怎样不显示主机名</a></h2>
<p>有的主机名很长，我不需要常常看到。我喜欢这个主题，但是主题里面带有主机名怎么办？</p>
<h3 id="方法一-只修改改某一主题">方法一 只修改改某一主题</h3>
<p>比如我不想让ys主题显示主机名,编辑 ~/.oh-my-zsh/themes/ys.zsh-theme，最后面改成这样。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PROMPT=<span class="string">"</span></span><br><span class="line"><span class="string">%&#123;<span class="variable">$terminfo</span>[bold]<span class="variable">$fg</span>[blue]%&#125;#%&#123;<span class="variable">$reset_color</span>%&#125; \</span></span><br><span class="line"><span class="string">%(#,%&#123;<span class="variable">$bg</span>[yellow]%&#125;%&#123;<span class="variable">$fg</span>[black]%&#125;%n%&#123;<span class="variable">$reset_color</span>%&#125;,%&#123;<span class="variable">$fg</span>[cyan]%&#125;%n) \</span></span><br><span class="line"><span class="string">%&#123;<span class="variable">$fg</span>[white]%&#125;in \</span></span><br><span class="line"><span class="string">%&#123;<span class="variable">$terminfo</span>[bold]<span class="variable">$fg</span>[yellow]%&#125;%~%&#123;<span class="variable">$reset_color</span>%&#125;\</span></span><br><span class="line"><span class="string"><span class="variable">$&#123;hg_info&#125;</span>\</span></span><br><span class="line"><span class="string"><span class="variable">$&#123;git_info&#125;</span>\</span></span><br><span class="line"><span class="string"> \</span></span><br><span class="line"><span class="string">%&#123;<span class="variable">$fg</span>[white]%&#125;[%*] <span class="variable">$exit_code</span></span></span><br><span class="line"><span class="string">%&#123;<span class="variable">$terminfo</span>[bold]<span class="variable">$fg</span>[red]%&#125;$ %&#123;<span class="variable">$reset_color</span>%&#125;"</span></span><br></pre></td></tr></table></figure>
<h3 id="方法二-作用于所有主题">方法二 作用于所有主题</h3>
<p>打开.zshrc 在底部粘贴:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">prompt_context</span></span>() &#123;</span><br><span class="line"> <span class="keyword">if</span> [[ <span class="string">"<span class="variable">$USER</span>"</span> != <span class="string">"<span class="variable">$DEFAULT_USER</span>"</span> || -n <span class="string">"<span class="variable">$SSH_CLIENT</span>"</span> ]]; <span class="keyword">then</span></span><br><span class="line">   prompt_segment black default <span class="string">"%(!.%&#123;%F&#123;yellow&#125;%&#125;.)<span class="variable">$USER</span>"</span></span><br><span class="line"> <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就只显示用户名了. 如果你连用户名也不想显示，只需要注释掉这一行： <code>prompt_segment black default...</code>。</p>
<p><a href="https://github.com/ohmyzsh/ohmyzsh/wiki/themes" target="_blank" rel="noopener">其他修改主题的方法</a>。</p>
<h2 id="其他主题">其他主题</h2>
<p>如果这些默认主题还不能满足你的需要，我们还可以到这里找到更多的主题</p>
<blockquote>
<p><a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Themes" target="_blank" rel="noopener">https://github.com/robbyrussell/oh-my-zsh/wiki/Themes</a><br>
<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/External-themes" target="_blank" rel="noopener">https://github.com/robbyrussell/oh-my-zsh/wiki/External-themes</a><br>
<a href="https://github.com/unixorn/awesome-zsh-plugins#themes" target="_blank" rel="noopener">https://github.com/unixorn/awesome-zsh-plugins#themes</a></p>
</blockquote>
<h1 id="oh-my-zsh-插件推荐">oh-my-zsh 插件推荐</h1>
<h2 id="默认插件">默认插件</h2>
<p>Oh My Zsh 默认自带了一些默认插件，存放在~/.oh-my-zsh/plugins目录中。可以查看：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ls ~/.oh-my-zsh/plugins</span><br></pre></td></tr></table></figure>
<h2 id="插件介绍">插件介绍</h2>
<h3 id="zsh-history-substring-search"><a href="https://github.com/robbyrussell/oh-my-zsh/tree/master/plugins/history-substring-search" target="_blank" rel="noopener">zsh-history-substring-search</a></h3>
<h3 id="autojump"><a href="https://github.com/wting/autojump" target="_blank" rel="noopener">autojump</a></h3>
<p>功能：实现目录间快速跳转，想去哪个目录直接 j + 目录名，不用在频繁的 cd 了！</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 这个命令就能找到近期 clone 了哪些库，省却了写一堆代码的功夫。</span></span><br><span class="line"><span class="built_in">history</span> | grep <span class="string">"git clone"</span></span><br></pre></td></tr></table></figure>
<p>autojump 就是通过记录你在 history 中的行为把你访问过的文件夹路径都 cache 下来，当你输入路径名的时候会模糊匹配你之前cd过的目录路径，配合后面的自动提示插件，非常好用！！！</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 先cd到一些目录</span></span><br><span class="line"><span class="built_in">cd</span> ~/lyk/production</span><br><span class="line"><span class="built_in">cd</span> ~/lyk/src/react</span><br><span class="line"><span class="comment"># j快速切换到 ~/lyk/production目录下</span></span><br><span class="line">j production</span><br><span class="line"><span class="comment"># jo快速在finder里打开文件夹 ~/lyk/production</span></span><br><span class="line">jo production</span><br></pre></td></tr></table></figure>
<h3 id="zsh-syntax-highlighting"><a href="https://github.com/zsh-users/zsh-syntax-highlighting" target="_blank" rel="noopener">zsh-syntax-highlighting</a></h3>
<p>日常用的命令会高亮显示，命令错误显示红色。<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/oh-my-zsh%E7%BB%84%E5%90%88%E4%BD%A0%E7%9A%84terminal/zsh-syntax-highlighting.png" alt="zsh-syntax-highlighting例子"></p>
<h3 id="zsh-autosuggestions"><a href="https://github.com/zsh-users/zsh-autosuggestions" target="_blank" rel="noopener">zsh-autosuggestions</a></h3>
<p>如图所示，输入命令时可提示自动补全（灰色部分），然后按键盘 → （！！！！上下左右的右键，不是tab键）即可补全。</p>
<p><a href="https://asciinema.org/a/37390" target="_blank"><img src="https://asciinema.org/a/37390.svg"></a></p>
<p>更多插件可参考：</p>
<blockquote>
<p><a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins" target="_blank" rel="noopener">https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins</a><br>
<a href="https://github.com/unixorn/awesome-zsh-plugins" target="_blank" rel="noopener">https://github.com/unixorn/awesome-zsh-plugins</a><br>
<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins-Overview" target="_blank" rel="noopener">https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins-Overview</a></p>
</blockquote>
<h2 id="插件安装">插件安装</h2>
<p>安装zsh-history-substring-search、autojump、zsh-autosuggestions、zsh-syntax-highlighting插件:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装zsh-history-substring-search</span></span><br><span class="line"> git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-history-substring-search <span class="variable">$ZSH_CUSTOM</span>/plugins/zsh-history-substring-search</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装autojump</span></span><br><span class="line">brew install autojump</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装zsh-autosuggestions</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="variable">$ZSH_CUSTOM</span>/plugins/zsh-autosuggestions</span><br><span class="line"></span><br><span class="line"><span class="comment"># or </span></span><br><span class="line">brew install zsh-autosuggestions</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装zsh-syntax-highlighting</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="variable">$ZSH_CUSTOM</span>/plugins/zsh-syntax-highlighting</span><br><span class="line"></span><br><span class="line"><span class="comment"># or </span></span><br><span class="line">brew install zsh-syntax-highlighting</span><br></pre></td></tr></table></figure>
<p>别忘了在~/.zshrc找到<code>plugins=</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>添加你想使用的插件。<br>
注意不同插件间用空格，不要加逗号。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">plugins=(</span><br><span class="line">  git</span><br><span class="line">  autojump</span><br><span class="line">  zsh-autosuggestions</span><br><span class="line">  zsh-syntax-highlighting</span><br><span class="line">  zsh-history-substring-search</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>最后保存执行:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<h2 id="插件使用">插件使用</h2>
<p><a href="https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins/git/" target="_blank" rel="noopener">git plugin 命令</a></p>
<h1 id="其他技巧">其他技巧</h1>
<h2 id="iterm-run-command">iterm Run command</h2>
<p>iTerm2 里配 <code>Run command...</code> 为 <code>/usr/local/bin/idea --path \2 \1</code> (<a href="https://zos.alipayobjects.com/rmsportal/RmWdxKRQUWFMoVDjerNQ.png" target="_blank" rel="noopener">图</a>)，这样 Command + 点击文件路径，就会在 Intellij Idea 里打开</p>
<h2 id="给history命令增加时间">给history命令增加时间</h2>
<p>.zshrc中加入以下行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br><span class="line">HIST_STAMPS=<span class="string">"yyyy-mm-dd"</span></span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>如果没用oh my zsh的话可用如下alias</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">alias</span> <span class="built_in">history</span>=<span class="string">'fc -il 1'</span></span><br></pre></td></tr></table></figure>
<h2 id="更新oh-my-zsh">更新oh-my-zsh</h2>
<p>设置自动更新oh-my-zsh</p>
<p>默认情况下，当oh-my-zsh有更新时，都会给你提示。如果希望让oh-my-zsh自动更新，在~/.zshrc 中添加下面这句</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DISABLE_UPDATE_PROMPT=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>要手动更新，可以执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">upgrade_oh_my_zsh</span><br></pre></td></tr></table></figure>
<h2 id="卸载oh-my-zsh">卸载oh my zsh</h2>
<p>直接在终端中，运行<code>uninstall_oh_my_zsh</code>既可以卸载。</p>
<h1 id="借鉴文章">借鉴文章</h1>
<p>有点懒，把这几篇写的好的部分和官网结合在一起了。</p>
<ul>
<li><a href="https://juejin.im/post/5d773da76fb9a06aff5e9a99" target="_blank" rel="noopener">oh-my-zsh让终端好用到飞起~</a></li>
<li><a href="https://blog.csdn.net/czg13548930186/article/details/72858289" target="_blank" rel="noopener">利用Oh-My-Zsh打造你的超级终端</a></li>
<li><a href="https://hustyichi.github.io/2018/09/19/oh-my-zsh/" target="_blank" rel="noopener">Oh my zsh 配置与插件</a></li>
<li><a href="http://ohmyz.sh" target="_blank" rel="noopener">Oh my zsh官网</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>Environment setup</category>
      </categories>
      <tags>
        <tag>Command line</tag>
      </tags>
  </entry>
  <entry>
    <title>程序员的不归路-Developer Roadmap</title>
    <url>/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E4%B8%8D%E5%BD%92%E8%B7%AF-Developer-Roadmap.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="roadmap">Roadmap</h2>
<ul>
<li>
<p><a href="https://github.com/kamranahmedse/developer-roadmap" target="_blank" rel="noopener">Developer Roadmap</a><br>
github上有个194k star的项目，这个项目通过一个路线图展示了在你学习开发的过程中你应该需要去学习那些技术，并且作者也给出自己的建议，哪些是他推荐去学习，哪些不推荐，总结得非常详细。包括多条技术线：</p>
<ul>
<li><a href="https://roadmap.sh/frontend" target="_blank" rel="noopener">Frontend Roadmap</a></li>
<li><a href="https://roadmap.sh/backend" target="_blank" rel="noopener">Backend Roadmap</a></li>
<li><a href="https://roadmap.sh/devops" target="_blank" rel="noopener">DevOps Roadmap</a></li>
<li><a href="https://roadmap.sh/react" target="_blank" rel="noopener">React Roadmap</a></li>
<li><a href="https://roadmap.sh/angular" target="_blank" rel="noopener">Angular Roadmap</a></li>
<li><a href="https://roadmap.sh/android" target="_blank" rel="noopener">Android Roadmap</a></li>
<li><a href="https://roadmap.sh/python" target="_blank" rel="noopener">Python Roadmap</a></li>
<li><a href="https://roadmap.sh/golang" target="_blank" rel="noopener">Go Roadmap</a></li>
<li><a href="https://roadmap.sh/java" target="_blank" rel="noopener">Java Roadmap</a></li>
<li><a href="https://roadmap.sh/postgresql-dba" target="_blank" rel="noopener">DBA Roadmap</a></li>
</ul>
</li>
<li>
<p><a href="https://github.com/ObjTube/front-end-roadmap" target="_blank" rel="noopener">Front End Roadmap</a><br>
对于新手来说可能是一脸懵逼我到底该怎么入门，这么多技术到底该先学什么？所以Developer Roadmap对刚入门的同学来说并不是很友好，很容易迷茫。所以ObjTube结合他自己的学习经验和工作经验，他将该路线图进行了拆分，把它拆分为多个学习阶段，并且结合国内前端开发的技术背景补充了一些技术点，然后做了一个新的开源项目，并在github上部署了一个静态站点。在这个网站上，你可以选择学习的阶段，来生成不同的路线，同时在路上也有他自己的一些标注，如果你觉得标注的不好，可以选择关掉。最重要的是，路线上的卡片都可以点击，然后进入一个文档页，在这个页面上罗列了掌握这项技术或者知识点应该学哪些东西，有推荐的博客文章，视频，书籍等等。</p>
</li>
</ul>
<h2 id="提问">提问</h2>
<ul>
<li>Google</li>
<li><a href="https://stackoverflow.com/" target="_blank" rel="noopener">Stack Overflow</a></li>
<li><a href="https://www.zhihu.com/hot" target="_blank" rel="noopener">知乎</a><br>
知乎是网络问答社区，连接各行各业的用户。后来开设的专栏更像是博客。</li>
</ul>
<h2 id="面试">面试</h2>
<ul>
<li><a href="https://www.nowcoder.com/" target="_blank" rel="noopener">牛客网</a><br>
“牛客网”是一个专注于程序员的学习和成长的专业平台，集笔面试系统、课程教育、社群交流、招聘内推于一体。是互联网求职神器,C++、Java、前端、产品、运营技能学习/备考/求职题库,在线进行百度阿里腾讯网易等互联网名企笔试面试模拟考试练习,和牛人一起讨论经典试题。所以，对于需要参加校招的同学以及想要有更好的求职目标的同学来说，牛客网需要特别关注。</li>
</ul>
<h2 id="考证">考证</h2>
<ul>
<li><a href="https://training.linuxfoundation.org/certification-catalog/#" target="_blank" rel="noopener">linux基金会Training&amp;Certification</a> linux基金会开设的课程，对应课程通过课程可获得证书。</li>
</ul>
<h2 id="code-style">Code style</h2>
<ul>
<li>
<p>通用Code style</p>
<ul>
<li><a href="https://www.reddit.com/r/learnprogramming/comments/1i4ds4/what_are_some_bad_coding_habits_you_would/" target="_blank" rel="noopener">建议初学者避免使用的坏的编码习惯?</a></li>
<li><a href="https://github.com/trekhleb/state-of-the-art-shitcode" target="_blank" rel="noopener">State-of-the-Art Shitcode Principles</a> 反向教学，让你看看什么是shit一样的code。</li>
</ul>
</li>
<li>
<p>Frontend</p>
<ul>
<li>
<p><a href="https://github.com/airbnb/javascript" target="_blank" rel="noopener">Airbnb JS 风格指南</a> : 写JavaScript最好的方式。</p>
</li>
<li>
<p><a href="https://standardjs.com" target="_blank" rel="noopener">标准 JS 风格指南</a> : JavaScript风格指南</p>
</li>
<li>
<p><a href="https://google.github.io/styleguide/tsguide.html" target="_blank" rel="noopener">Google TypeScript Style Guide</a></p>
</li>
<li>
<p><a href="https://github.com/basarat/typescript-book/blob/master/docs/styleguide/styleguide.md" target="_blank" rel="noopener">TypeScript Style Guide and Coding Conventions</a></p>
</li>
<li>
<p><a href="https://github.com/johnpapa/angular-styleguide/tree/master/a1" target="_blank" rel="noopener">Angular 1 风格指南</a> : 官方认可的风格指南，作者John Pappa</p>
</li>
<li>
<p><a href="https://angular.io/guide/styleguide" target="_blank" rel="noopener">Angular coding style guide</a>: Angular+TypeScript</p>
</li>
</ul>
</li>
<li>
<p>C / C++</p>
<ul>
<li><a href="http://stanford.edu/class/archive/cs/cs106b/cs106b.1158/styleguide.shtml" target="_blank" rel="noopener">CS 106B 编码风格指南 C++</a> : 代码臃肿者必看</li>
<li><a href="https://www.reddit.com/r/C_Programming/comments/1vuubw/good_c_programming_habits/" target="_blank" rel="noopener">优秀的 C 编码习惯 • /r/C_Programming</a></li>
<li><a href="https://google.github.io/styleguide/cppguide.html" target="_blank" rel="noopener">google C++ 编码风格</a></li>
</ul>
</li>
<li>
<p>Python</p>
<ul>
<li><a href="https://www.python.org/dev/peps/pep-0008/" target="_blank" rel="noopener">PEP8 - Python编码风格指南</a></li>
<li><a href="https://google.github.io/styleguide/pyguide.html" target="_blank" rel="noopener">Google Python 风格指南</a></li>
</ul>
</li>
<li>
<p>Other</p>
<ul>
<li><a href="https://github.com/behzad888/Aurelia-styleguide" target="_blank" rel="noopener">Aurelia 风格指南</a></li>
<li><a href="https://github.com/bbatsov/ruby-style-guide" target="_blank" rel="noopener">Ruby 编码风格指南</a> : 社区驱动的Ruby编码风格指南</li>
<li><a href="https://github.com/airbnb/ruby" target="_blank" rel="noopener">Airbnb Ruby 风格指南</a> : Airbnb的ruby风格指南</li>
<li><a href="http://www.umich.edu/~eecs381/generalFAQ/Debugging.html" target="_blank" rel="noopener">调试问题</a> :检查如何调试程序</li>
<li><a href="http://www.chiark.greenend.org.uk/~sgtatham/bugs.html" target="_blank" rel="noopener">怎样高效的报告Bug</a></li>
<li><a href="https://github.com/prakhar1989/awesome-courses" target="_blank" rel="noopener">CS课程目录(许多在线讲座)</a> : 另一个在线CS课程</li>
<li><a href="https://github.com/open-source-society/computer-science" target="_blank" rel="noopener">在线CS课程目录</a> : 免费的在线CS课程</li>
</ul>
</li>
</ul>
<h2 id="get最新技术资讯">Get最新技术资讯</h2>
<ul>
<li><a href="https://javascriptweekly.com/" target="_blank" rel="noopener">JavaScript Weekly</a> JS资讯，邮箱/RSS订阅。 还有React Status，和Node Weekly。</li>
<li>RSS，订阅你感兴趣的博客等。</li>
<li><a href="https://sspai.com/" target="_blank" rel="noopener">少数派</a> 好用的app和tool。</li>
<li><a href="https://marketplace.visualstudio.com/vscode" target="_blank" rel="noopener">Vscode extension trends</a></li>
</ul>
<h3 id="github-排名统计">Github 排名统计</h3>
<ul>
<li>
<p>GitHub trending（官网推荐—）：<a href="https://github.com/trending" target="_blank" rel="noopener">https://github.com/trending</a><br>
你的项目要是能上 GitHub trending，绝对火得一塌糊涂。</p>
<ul>
<li><a href="https://github.com/search?o=desc&amp;q=stars%3A%3E100000&amp;s=stars&amp;type=Repositories" target="_blank" rel="noopener">Stars超过100000</a></li>
</ul>
</li>
<li>
<p>GitHub 中国区排名：<a href="https://githuber.cn/search?language=JavaScript" target="_blank" rel="noopener">https://githuber.cn/search?language=JavaScript</a><br>
这个网站虽然比较小众，但排名还是相对比较准的。</p>
</li>
<li>
<p>GitHub 中国区排名：<a href="http://githubrank.com/" target="_blank" rel="noopener">http://githubrank.com/</a><br>
这个排名很久没更新了，早就不准了。</p>
</li>
<li>
<p>GitHub 全球排名：<a href="https://gitstar-ranking.com/" target="_blank" rel="noopener">https://gitstar-ranking.com/</a></p>
</li>
</ul>
<h3 id="资讯">资讯</h3>
<ul>
<li>
<p>虎嗅网：<a href="https://www.huxiu.com/" target="_blank" rel="noopener">https://www.huxiu.com/</a></p>
</li>
<li>
<p>36氪：<a href="https://36kr.com/" target="_blank" rel="noopener">https://36kr.com/</a></p>
</li>
<li>
<p>利器：<a href="https://liqi.io/" target="_blank" rel="noopener">https://liqi.io/</a><br>
采访优秀的创造者，邀请他们来分享工作时所使用的工具。</p>
</li>
<li>
<p>湾区日报：<a href="https://wanqu.co/" target="_blank" rel="noopener">https://wanqu.co/</a><br>
每天推送 5 篇优质英文文章。</p>
</li>
<li>
<p>Solidot：<a href="https://www.solidot.org/" target="_blank" rel="noopener">https://www.solidot.org/</a></p>
</li>
<li>
<p>品玩：<a href="https://www.pingwest.com/" target="_blank" rel="noopener">https://www.pingwest.com/</a></p>
</li>
<li>
<p>极客公园：<a href="http://www.geekpark.net/" target="_blank" rel="noopener">http://www.geekpark.net/</a></p>
</li>
</ul>
<h2 id="在线课程-书籍">在线课程/书籍</h2>
<h3 id="在线课程">在线课程</h3>
<ul>
<li>
<p><a href="https://github.com/freeCodeCamp/freeCodeCamp" target="_blank" rel="noopener">freeCodeCamp</a> Github开源库，免费学习编码。 它由捐赠者支持的 501©(3) 非营利组织运营，旨在帮助数百万忙碌的成年人过渡到科技行业。全栈 Web 开发和机器学习课程完全免费且可自定进度。提供几个免费的开发者认证。这些认证中的每一项都涉及构建 5 个必需的 Web 应用程序项目，以及数百个可选的编码挑战，以帮助您为这些项目做好准备。我们估计每个认证需要初学者大约 300 小时才能获得。</p>
</li>
<li>
<p>算法学习 <a href="https://leetcode-cn.com/" target="_blank" rel="noopener">LeetCode</a><br>
算法学习网站，上去每天学习下，刷几道算法题，走遍天下都不怕。有中英文两个网站，这个网站其实不需要说太多了，大家可以去看下算法岗位，可以去关注下校招对算法的要求，重要性不言而喻。</p>
</li>
<li>
<p><a href="https://www.runoob.com/" target="_blank" rel="noopener">菜鸟教程</a><br>
提供了编程的基础技术教程, 介绍了HTML、CSS、Javascript、Python,Java,Ruby,C,PHP , MySQL等各种编程语言的基础知识。什么语言想要入门的，来这里就对啦。</p>
</li>
<li>
<p><a href="https://www.coursera.org/" target="_blank" rel="noopener">Coursera.org</a> :在网上学习全世界最好的课程。不限于开发学习，各个学科的课程都有。</p>
</li>
<li>
<p><a href="https://time.geekbang.org/" target="_blank" rel="noopener">极客时间</a><br>
极客时间是极客邦科技出品的IT 类知识服务产品，内容包含专栏订阅、极客新闻、热点专题、直播、视频和音频等多种形式的知识服务。产品形态包括移动 App，移动端网站、PC 端网站、微信平台等。</p>
</li>
<li>
<p><a href="https://www.imooc.com/" target="_blank" rel="noopener">慕课网</a><br>
慕课网是垂直的互联网IT技能免费学习网站。以独家视频教程、在线编程工具、学习计划、问答社区为核心特色。在这里，你可以找到最好的互联网技术牛人，也可以通过免费的在线公开视频课程学习国内领先的互联网IT技术。</p>
</li>
<li>
<p><a href="https://www.bilibili.com/" target="_blank" rel="noopener">B站 bilibili</a><br>
现在的B站已经不仅仅局限于二次元的分享了，很多优秀的资源都能在B站找到，让你学习欲罢不能。<br>
B站从一开始的二次元，到现在的多元化发展，你想要的他基本上都有。之前B站的跨年演唱会、李子柒的视频等等，更是把B站推向了一个高潮，作为中国的油管，每个人都有展现自己机会，无限的机会，你也可以试试。</p>
</li>
<li>
<p><a href="https://www.julyedu.com/" target="_blank" rel="noopener">七月在线</a> july创建的在线课程网站，主要是算法和机器学习相关。</p>
</li>
</ul>
<h3 id="书籍">书籍</h3>
<ul>
<li><a href="https://www.safaribooksonline.com/" target="_blank" rel="noopener">Oreilly Safari Books</a>，Oreilly 图书、视频教程、newsletter 等。【付费】</li>
</ul>
<h2 id="前端">前端</h2>
<h3 id="关注的前端库">关注的前端库</h3>
<ul>
<li><a href="https://github.com/sorrycc/awesome-f2e-libs" target="_blank" rel="noopener">awesome-f2e-libs</a> 关注的前端库list</li>
<li><a href="https://github.com/sorrycc/awesome-javascript" target="_blank" rel="noopener">Awesome JavaScript</a> A collection of awesome browser-side JavaScript libraries, resources and shiny things.</li>
</ul>
<h3 id="debug技巧">Debug技巧</h3>
<p><a href="https://developer.chrome.com/docs/devtools/javascript/reference/" target="_blank" rel="noopener">Chrome DevTools - JavaScript debugging reference</a></p>
<h2 id="技术社区-博客">技术社区/博客</h2>
<ul>
<li>
<p><a href="http://www.github.com/" target="_blank" rel="noopener">GitHub</a> 开发者最最最重要的网站<br>
世界上最大的同性社区网站哦，代码托管网站，上面有很多资源，想要什么轮子，上去搜就好了。</p>
</li>
<li>
<p><a href="https://medium.com/" target="_blank" rel="noopener">Medium</a><br>
国外优质文章网站，Medium 的整体结构非常简单，容易让用户沉下心来专注于阅读。需【科学上网】。<br>
上面有很多优秀的博文，优秀的分享。还有很多优秀的公司，尤其是硅谷的公司，都在Medium上有专题，有能力的同学绝对要去看看。</p>
</li>
<li>
<p><a href="https://www.reddit.com/" target="_blank" rel="noopener">Reddit</a></p>
</li>
<li>
<p>国内网站</p>
<ul>
<li>
<p><a href="https://www.oschina.net/" target="_blank" rel="noopener">开源中国</a><br>
是目前国内最大的开源技术社区，拥有超过200万会员，形成了由开源软件库、代码分享、资讯、协作翻译、码云、众包、招聘等几大模块内容，为IT开发者提供了一个发现、使用、并交流开源技术的平台. 旗下还有一个云开发平台–码云，算是中国版的GitHub。现在用户量也逐渐增长，对我们国内的开发者来说，是一个好事。</p>
</li>
<li>
<p><a href="https://juejin.im/timeline" target="_blank" rel="noopener">掘金</a><br>
现在国内优质的开发者交流学习社区，可以去看大佬们写的文章，也可以自己分享学习心的，与更多开发者交流。认识更多的小伙伴儿，提升个人影响力。<br>
<a href="https://segmentfault.com/" target="_blank" rel="noopener">Seamentfault</a>，中文名:思否<br>
SegmentFault 中文技术交流平台，在这里你可以检索，交流和分享任何技术编程相关的问题及知识。目标是覆盖和服务 1,000 万以上中国软件开发者和IT信息从业者，其实现方法是充分利用在各个平台上所能获得的各种技术创新机会为他们开发产品应用和服务。</p>
</li>
<li>
<p><a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN网站</a><br>
创立于1999年，致力于为中国软件开发者提供知识传播、在线学习、职业发展等全生命周期服务，是一个老牌社区。<br>
2019年开始，尝试了很多的改版，推出了付费阅读、原力计划、新的排名机制等等，对于热爱技术的、探索技术的你来说绝对不能错过。后来用的越来越少了。</p>
</li>
<li>
<p><a href="https://www.cnblogs.com/" target="_blank" rel="noopener">博客园</a><br>
博客园创立于2004年1月，是一个面向开发者的知识分享社区。自创建以来，博客园一直致力并专注于为开发者打造一个纯净的技术交流社区，推动并帮助开发者通过互联网分享知识，从而让更多开发者从中受益。博客园的使命是帮助开发者用代码改变世界。很多早期的高质量内容都在博客园。</p>
</li>
<li>
<p><a href="https://www.51cto.com/" target="_blank" rel="noopener">51CTO</a><br>
51cto.com是中国IT及互联网领域领先的专业垂直技术媒体，凭借专业的技术与整合信息服务的能力，致力于促进IT技术领域知识传播与服务创新。</p>
</li>
<li>
<p><a href="http://www.spring4all.com/" target="_blank" rel="noopener">spring4all</a><br>
国内首个 Spring 及 Spring Cloud 构建微服务架构的交流社区，想要学习微服务相关，在这里你总能找到你所要的。<br>
微服务微服务微服务，现在这个概念以及使用真的是太广泛了。</p>
</li>
<li>
<p><a href="http://www.apkbus.com/" target="_blank" rel="noopener">安卓巴士</a><br>
专门为开发者提供优质的资源服务、完善的信息共享平台，同时依托安卓巴士论坛这一平台，为Android爱好者建立一个自由交流、探讨学习和共同提高的绝佳环境。</p>
</li>
<li>
<p><a href="http://www.cocoachina.com/" target="_blank" rel="noopener">CocoaChina</a><br>
CocoaChina前身是全球成立最早规模最大的苹果开发中文站,现致力为所有移动开发者提供资讯服务、问答服务、代码下载、工具库及人才招聘服务<br>
现在这里也进行了多元化的发展，不仅仅局限于iOS开发，还有综合的移动开发等等，甚至还有一个区块链项目呢。</p>
</li>
</ul>
</li>
<li>
<p><a href="https://wx.zsxq.com/" target="_blank" rel="noopener">知识星球</a><br>
知识星球，原名小密圈，是内容创作者连接铁杆粉丝，做出品质社群，实现知识变现的工具。很多优秀的大V都在星球入驻了，并且有很高的粘性。大V们的朋友圈你不一定能围观到，知识星球给我们提供了一个很好的机会来围观他们的所见所闻所想。</p>
</li>
</ul>
<h2 id="关注大牛">关注大牛</h2>
<ul>
<li>Git上follow大牛的following。</li>
</ul>
<h3 id="前端大牛-国内">前端大牛[国内]</h3>
<ul>
<li>
<p>阮一峰（蚂蚁金服）</p>
<ul>
<li>GitHub：<a href="https://github.com/ruanyf" target="_blank" rel="noopener">https://github.com/ruanyf</a></li>
<li>博客：<a href="http://www.ruanyifeng.com/blog/" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/</a></li>
</ul>
</li>
<li>
<p>尤雨溪</p>
<ul>
<li>GitHub：<a href="https://github.com/yyx990803" target="_blank" rel="noopener">https://github.com/yyx990803</a></li>
<li>博客：<a href="http://blog.evanyou.me/" target="_blank" rel="noopener">http://blog.evanyou.me/</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/evanyou" target="_blank" rel="noopener">https://www.zhihu.com/people/evanyou</a></li>
</ul>
</li>
<li>
<p>玉伯</p>
<ul>
<li>GitHub：<a href="https://github.com/lifesinger" target="_blank" rel="noopener">https://github.com/lifesinger</a></li>
<li>博客：<a href="https://github.com/lifesinger/blog" target="_blank" rel="noopener">https://github.com/lifesinger/blog</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/lifesinger" target="_blank" rel="noopener">https://www.zhihu.com/people/lifesinger</a></li>
</ul>
</li>
<li>
<p>司徒正美（去哪儿）</p>
<ul>
<li>GitHub：<a href="https://github.com/RubyLouvre" target="_blank" rel="noopener">https://github.com/RubyLouvre</a></li>
<li>博客：<a href="http://www.cnblogs.com/rubylouvre/" target="_blank" rel="noopener">http://www.cnblogs.com/rubylouvre/</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/si-tu-zheng-mei" target="_blank" rel="noopener">https://www.zhihu.com/people/si-tu-zheng-mei</a></li>
</ul>
</li>
<li>
<p>张鑫旭（腾讯）</p>
<ul>
<li>GitHub：<a href="https://github.com/zhangxinxu" target="_blank" rel="noopener">https://github.com/zhangxinxu</a></li>
<li>博客：<a href="https://www.zhangxinxu.com/" target="_blank" rel="noopener">https://www.zhangxinxu.com/</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/iamzhangxinxu" target="_blank" rel="noopener">https://www.zhihu.com/people/iamzhangxinxu</a></li>
</ul>
</li>
<li>
<p>迷渡</p>
<ul>
<li>GitHub：<a href="https://github.com/justjavac" target="_blank" rel="noopener">https://github.com/justjavac</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/justjavac.com" target="_blank" rel="noopener">https://www.zhihu.com/people/justjavac.com</a></li>
</ul>
</li>
<li>
<p>羡辙 | Ovilia</p>
<ul>
<li>GitHub：<a href="https://github.com/Ovilia" target="_blank" rel="noopener">https://github.com/Ovilia</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/ovilia" target="_blank" rel="noopener">https://www.zhihu.com/people/ovilia</a></li>
</ul>
</li>
<li>
<p>云谦（陈成）</p>
<ul>
<li>GitHub：<a href="https://github.com/sorrycc" target="_blank" rel="noopener">https://github.com/sorrycc</a></li>
<li>博客：<a href="https://sorrycc.com/" target="_blank" rel="noopener">https://sorrycc.com/</a></li>
<li>云谦装了啥：<a href="https://github.com/sorrycc/awesome-tools" target="_blank" rel="noopener">https://github.com/sorrycc/awesome-tools</a></li>
</ul>
</li>
<li>
<p>偏右</p>
<ul>
<li>GitHub：<a href="https://github.com/afc163" target="_blank" rel="noopener">https://github.com/afc163</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/afc163" target="_blank" rel="noopener">https://www.zhihu.com/people/afc163</a></li>
</ul>
</li>
<li>
<p>黄峰达/Phodal Huang（ThoughtWorks）</p>
<ul>
<li>GitHub：<a href="https://github.com/phodal" target="_blank" rel="noopener">https://github.com/phodal</a></li>
<li>博客：<a href="https://www.phodal.com/" target="_blank" rel="noopener">https://www.phodal.com/</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/phodal" target="_blank" rel="noopener">https://www.zhihu.com/people/phodal</a></li>
</ul>
</li>
<li>
<p>贺师俊/Hax（百姓网）</p>
<ul>
<li>GitHub：<a href="https://github.com/hax" target="_blank" rel="noopener">https://github.com/hax</a></li>
<li>博客：<a href="http://johnhax.net/" target="_blank" rel="noopener">http://johnhax.net/</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/he-shi-jun" target="_blank" rel="noopener">https://www.zhihu.com/people/he-shi-jun</a></li>
</ul>
</li>
<li>
<p>EGOIST</p>
<ul>
<li>博客：<a href="https://egoist.sh/" target="_blank" rel="noopener">https://egoist.sh/</a></li>
<li>GitHub：<a href="https://github.com/egoist" target="_blank" rel="noopener">https://github.com/egoist</a></li>
</ul>
</li>
<li>
<p>冴羽</p>
<ul>
<li>GitHub：<a href="https://github.com/mqyqingfeng" target="_blank" rel="noopener">https://github.com/mqyqingfeng</a></li>
<li>博客：<a href="https://github.com/mqyqingfeng/Blog" target="_blank" rel="noopener">https://github.com/mqyqingfeng/Blog</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/qing-feng-yi-yang" target="_blank" rel="noopener">https://www.zhihu.com/people/qing-feng-yi-yang</a></li>
</ul>
</li>
<li>
<p>小爝</p>
<ul>
<li>GitHub：<a href="https://github.com/xiaojue" target="_blank" rel="noopener">https://github.com/xiaojue</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/xiao-jue-83/" target="_blank" rel="noopener">https://www.zhihu.com/people/xiao-jue-83/</a></li>
</ul>
</li>
<li>
<p>李靖/小胡子哥（淘宝网）</p>
<ul>
<li>GitHub：<a href="https://github.com/barretlee" target="_blank" rel="noopener">https://github.com/barretlee</a></li>
<li>博客：<a href="https://www.barretlee.com/" target="_blank" rel="noopener">https://www.barretlee.com/</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/barretlee/" target="_blank" rel="noopener">https://www.zhihu.com/people/barretlee/</a></li>
</ul>
</li>
<li>
<p>cangdu</p>
<ul>
<li>GitHub：<a href="https://github.com/bailicangdu" target="_blank" rel="noopener">https://github.com/bailicangdu</a></li>
</ul>
</li>
<li>
<p>Jackson Tian</p>
<ul>
<li>GitHub：<a href="https://github.com/JacksonTian" target="_blank" rel="noopener">https://github.com/JacksonTian</a></li>
<li>博客：<a href="http://jacksontian.org/" target="_blank" rel="noopener">http://jacksontian.org/</a></li>
</ul>
</li>
<li>
<p>题叶（饿了么、前 Teambition）</p>
<ul>
<li>GitHub：<a href="https://github.com/jiyinyiyong" target="_blank" rel="noopener">https://github.com/jiyinyiyong</a></li>
<li>博客：<a href="http://tiye.me/" target="_blank" rel="noopener">http://tiye.me/</a></li>
</ul>
</li>
<li>
<p>杨健（今日头条）</p>
<ul>
<li>GitHub：<a href="https://github.com/hardfist" target="_blank" rel="noopener">https://github.com/hardfist</a></li>
<li>知乎：<a href="https://www.zhihu.com/people/hardfist" target="_blank" rel="noopener">https://www.zhihu.com/people/hardfist</a></li>
</ul>
</li>
<li>
<p>流形（阿里巴巴数据技术与产品部前端团队负责人）</p>
<ul>
<li>知乎：<a href="https://www.zhihu.com/people/arcthur/" target="_blank" rel="noopener">https://www.zhihu.com/people/arcthur/</a></li>
</ul>
</li>
</ul>
<h3 id="container">Container</h3>
<ul>
<li>
<p><a href="https://nigelpoulton.com/for-individuals/" target="_blank" rel="noopener">nigelpoulton</a> Kubernetes and Docker 学习。</p>
</li>
<li></li>
</ul>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://github.com/sdmg15/Best-websites-a-programmer-should-visit" target="_blank" rel="noopener">Best-websites-a-programmer-should-visit</a></li>
<li><a href="https://github.com/tuteng/Best-websites-a-programmer-should-visit-zh" target="_blank" rel="noopener">程序员应该访问的最佳网站中文版</a></li>
<li><a href="https://www.cnblogs.com/dimple91/p/12320317.html" target="_blank" rel="noopener">程序员不能错过的20个学习网站</a></li>
<li><a href="https://www.cnblogs.com/qianguyihao/p/10701923.html" target="_blank" rel="noopener">2020年Web前端最新导航（常见前端框架、前端大牛）</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/68386214" target="_blank" rel="noopener">全网最全的高质量博客与网站（国内篇）</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
      </categories>
      <tags>
        <tag>LinksSummary</tag>
        <tag>TODO</tag>
      </tags>
  </entry>
  <entry>
    <title>程序员-MAC 重新装机必备1软件</title>
    <url>/%E7%A8%8B%E5%BA%8F%E5%91%98-MAC-%E9%87%8D%E6%96%B0%E8%A3%85%E6%9C%BA%E5%BF%85%E5%A4%871%E8%BD%AF%E4%BB%B6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="发现好app">发现好app</h1>
<ul>
<li><a href="https://www.producthunt.com/" target="_blank" rel="noopener">Product Hunt</a> 国际最流行的初创公司展示自己产品的平台，这里有各种奇妙的想法和产品，保证能够让你的脑洞大开。在这个平台上，你可以和创始人交流对话，提出意见，并发现各种好玩的产品和工具。简介：科技圈非常有名的平台，在美国有什么新产品（不论网站、APP还是插件）都会先往上前面挂。在国内原来也有些类似产品出现，但最终都没有做下去，而ProductHunt却流量很不错，有一大拨人经常关注着，是获取种子用户做冷启动的首选之地。可以免费上。可以人工影响排名和曝光。</li>
<li><a href="https://www.g2.com/" target="_blank" rel="noopener">G2</a> 目前海外最大的软件选型平台，估值是超10亿美元的独角兽，国内SaaS点评网、36氪企服点评等类似网站基本都在学习这家。G2给厂商提供会员、广告、数据等服务，通用类软件流量大。想曝光想好看要花钱，评价审核非常严格。类似网站非常多，当然流量也会少，有些收费有些不收费。同类如GetApp、SaaSWorthy等很多家</li>
<li><a href="https://www.saashub.com/?ref=producthunt" target="_blank" rel="noopener">SaaSHub</a> 月访客约200万。介于上面两类之间，有按时间分布的热榜列表，也有产品评价和类似推荐，但网站结构较为简单。类似这种列表、找同类型的网站也有不少。免费上，可以人工干预上榜首。有流量，有转化。</li>
<li><a href="https://sourceforge.net/" target="_blank" rel="noopener">Sourceforge</a> 月访客约2100万，比较知名开源软件平台，后来有了专门的商业软件模块，提供面向商业软件的会员服务。如果是开源软件，推荐上去免费获取流量，但是商业软件要在上面推广费用不低，效果看情况。类似开源软件平台还不少，而类似的软件下载站更是非常多，比如流量更大的Softonic，拥有多语言站点，但是入驻麻烦且收费。可免费，可付费，人工干预影响小。</li>
<li><a href="https://partnerstack.com/" target="_blank" rel="noopener">PartnerStack</a> 月访客约72万。专门针对SaaS的分销管理 系统&amp;分销平台，帮助厂商管理线索生态伙伴，也帮个人和企业找供应商。在海外线索伙伴是非常重要的，比如HubSpot就曾有很大比例来自于这块。类似平台还有，不多介绍。服务SaaS的SaaS，买吧。（老余也想做一个类似产品，对此有兴趣的朋友欢迎勾搭交流</li>
</ul>
<h1 id="编程必备">编程必备</h1>
<ul>
<li>[x] <a href="https://www.google.com/chrome/" target="_blank" rel="noopener"><strong>Google Chrome</strong></a> + <a href="https://www.google.com/chrome/canary/" target="_blank" rel="noopener"><strong>Google Chrome Canary</strong></a> + <a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank" rel="noopener"><strong>Firefox</strong></a> + <a href="https://www.microsoft.com/en-us/edge" target="_blank" rel="noopener"><strong>Edge</strong></a> + <strong>Safari</strong>，浏览器，调试用，IE 的测试会借助公司.</li>
</ul>
<h2 id="命令行工具和配置">命令行工具和配置</h2>
<p>内容略多，用另一篇文章来展开： <a href="../%E7%A8%8B%E5%BA%8F%E5%91%98-MAC-%E9%87%8D%E6%96%B0%E8%A3%85%E6%9C%BA%E5%BF%85%E5%A4%872%E5%91%BD%E4%BB%A4%E8%A1%8C-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.html">程序员-MAC-重新装机必备2命令行-环境配置</a></p>
<h2 id="ide">IDE</h2>
<ul>
<li>Xcode  [APP Store]</li>
<li><a href="https://code.visualstudio.com/" target="_blank" rel="noopener">Vscode</a> + 插件Settings Sync （用gitHub账号创建gist同步配置和插件）+ <a href="http://liyuankun.top/Vscode-%E9%85%8D%E7%BD%AE%E5%92%8C%E6%8F%92%E4%BB%B6.html">Vscode 配置和插件</a>。</li>
<li><a href="https://www.jetbrains.com/toolbox-app/" target="_blank" rel="noopener">Toolbox</a> + <a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener"><strong>IntelliJ</strong></a> + PyCharm：  用Toolbox来管理和下载IntelliJ，PyCharm
<ul>
<li><a href="https://www.jetbrains.com/help/idea/sharing-your-ide-settings.html#settings-repository" target="_blank" rel="noopener">IntelliJ 官方文档-Share settings through a settings repository</a></li>
</ul>
</li>
<li><a href="https://www.sublimetext.com/" target="_blank" rel="noopener">Sublime</a></li>
</ul>
<h2 id="database">Database</h2>
<ul>
<li><a href="https://sqlitebrowser.org/" target="_blank" rel="noopener">DB Browser for SQLite</a> DB Browser for SQLite (DB4S) is a high quality, visual, open source tool to create, design, and edit database files compatible with SQLite.</li>
<li><a href="https://www.mongodb.com/products/compass" target="_blank" rel="noopener">MongoDB Compass</a> The GUI for MongoDB。</li>
</ul>
<h2 id="编程辅助">编程辅助</h2>
<ul>
<li>
<p><a href="https://www.sourcetreeapp.com/" target="_blank" rel="noopener">SourceTree</a> git 辅助，由于 git 高级操作命令记不住，就只用借助 UI 了。</p>
</li>
<li>
<p><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Docker Desktop</a></p>
</li>
<li>
<p><a href="https://colorsnapper.com/" target="_blank" rel="noopener"><strong>ColorSnapper2</strong></a>，取色工具。付费，App store 没有。</p>
</li>
<li>
<p><a href="https://www.anaconda.com/" target="_blank" rel="noopener">Anaconda</a> Python data science库集合。</p>
</li>
</ul>
<h2 id="开发文档查看器">开发文档查看器</h2>
<h3 id="dash-快速查api文档-免费版本会在你搜索完后等10秒再显示-付费版：-29-99-无需等待"><a href="https://kapeli.com/dash" target="_blank" rel="noopener">Dash</a> 快速查API文档。免费版本会在你搜索完后等10秒再显示，付费版：$29.99 无需等待</h3>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># latest</span></span><br><span class="line">brew cask install dash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.6.7 with license</span></span><br><span class="line">brew cask install https://raw.githubusercontent.com/Homebrew/homebrew-cask/baf4f35e70c225fe1a8a60ec3b4e22604187238d/Casks/dash.rb</span><br></pre></td></tr></table></figure>
<h3 id="devdocs-io"><a href="http://DevDocs.io" target="_blank" rel="noopener">DevDocs.io</a></h3>
<p><a href="https://github.com/egoist/devdocs-desktop" target="_blank" rel="noopener">DevDocs.io Git日语</a><br>
<a href="https://github.com/ragingwind/devdogs" target="_blank" rel="noopener">DevDocs.io Git英语</a></p>
<h3 id="zeal">Zeal</h3>
<ul>
<li><a href="https://github.com/zealdocs/zeal" target="_blank" rel="noopener">https://github.com/zealdocs/zeal</a></li>
<li><a href="http://xavieryao.github.io/article/zeal" target="_blank" rel="noopener">Build Zeal on macOS</a>
<ul>
<li><a href="https://mazhuang.org/2016/01/16/build-zeal-for-mac-osx/" target="_blank" rel="noopener">Build Zeal for Mac OS X</a></li>
</ul>
</li>
</ul>
<h2 id="网络">网络</h2>
<ul>
<li>
<p><a href="https://paw.cloud/" target="_blank" rel="noopener"><strong>Paw</strong></a>，【付费】请求模拟，前后端联调API时用这个先走一遍。</p>
</li>
<li>
<p><a href="https://www.postman.com/" target="_blank" rel="noopener"><strong>Postman</strong></a>，【免费】请求模拟，前后端联调API时用这个先走一遍。</p>
</li>
<li>
<p><a href="https://www.charlesproxy.com/" target="_blank" rel="noopener"><strong>Charles</strong></a>，【付费】抓包用，支持 https，公司提供的付费账号。</p>
</li>
<li>
<p><a href="https://www.wireshark.org/download.html" target="_blank" rel="noopener"><strong>WireShark</strong></a>，抓包用。</p>
</li>
<li>
<p><a href="https://github.com/2ndalpha/gasmask" target="_blank" rel="noopener"><strong>Gas Mask</strong></a> ，<a href="https://zhuanlan.zhihu.com/p/20466912" target="_blank" rel="noopener">Hosts 管理</a></p>
</li>
</ul>
<h2 id="ssh-client">SSH Client</h2>
<ul>
<li><a href="http://www.termius.com/" target="_blank" rel="noopener">Termius</a> 【<a href="https://apps.apple.com/us/app/termius-ssh-client/id1176074088?mt=12" target="_blank" rel="noopener">App store</a>, 免费】</li>
<li><a href="https://cyberduck.io/download/" target="_blank" rel="noopener">Cyberduck</a> 【免费】</li>
</ul>
<h2 id="反编译工具">反编译工具</h2>
<h3 id="jd-gui">JD-GUI</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install --cask jd-gui</span><br></pre></td></tr></table></figure>
<h4 id="jd-gui报错">JD-GUI报错</h4>
<p>打开jd-gui,报错：<br>
<code>ERROR launching 'JD-GUI' No suitable Java version found on your system! This program requires Java 1.8+ Make sure you install the required Java version.</code></p>
<ul>
<li>
<p>参见 JD-GUI 的issue ：<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fjava-decompiler%2Fjd-gui%2Fpull%2F336" target="_blank" rel="noopener">Update universalJavaApplicationStub to be able to launch on macOS Big Sur #336</a></p>
</li>
<li>
<p>解决方法参考文章： <a href="https://www.cnblogs.com/juhy/p/14193476.html" target="_blank" rel="noopener">解决mac已经安装jdk1.8但是Java反编译工具JD-GUI还是报错找不到java 1.8+</a><br>
sh脚本文件启动执行的JD-GUI，脚本文件在<code>JD-GUI.app/Contents/MacOS/universalJavaApplicationStub.sh</code>，里面会判断你安装的jdk版本。<br>
我安装的是openjdk 11.0.11，<code>where java</code> 查看路径：<code>/Library/Java/JavaVirtualMachines/adoptopenjdk-11.jdk/Contents/Home/bin/java</code>。</p>
</li>
<li>
<p>修改文件：</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">JAVACMD=<span class="string">"/Library/Java/JavaVirtualMachines/adoptopenjdk-11.jdk/Contents/Home/bin/java"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>解决问题，如果还没解决最后没有办法的话，直接进去 cd进入到JD-GUI.app/Contents/Resources/Java目录，然后java -jar jd-gui-1.6.6-min.jar（后面为你自己的jar包名字）来执行</li>
</ul>
<h1 id="效率">效率</h1>
<ul>
<li>
<p>[x] <a href="https://www.alfredapp.com/" target="_blank" rel="noopener"><strong>Alfred</strong></a> + <a href="https://www.alfredapp.com/powerpack/" target="_blank" rel="noopener"><strong>Powerpack</strong></a> 【付费，我的百度网盘、硬盘】应用启动、粘贴板管理、Workflow、Snippets 管理等。 同步问题可以参考：<a href="https://www.zhihu.com/question/39098799" target="_blank" rel="noopener">Alfred 中如何在不同电脑上同步自定义设置？</a> 和 <a href="https://mac.orsoon.com/news/337637.html" target="_blank" rel="noopener">在Mac之间同步您的Alfred设置</a>。免费功能：File search, Web search，app启动, Calculator, Dictionary, System。付费功能（需购买Powerpack）：Workflow，Action, Clipboard History，Snippets, Contacts, itunes, 1Password, Terminal. 【我的百度网盘、硬盘】</p>
<ul>
<li><a href="https://www.jianshu.com/p/594fac7950c4" target="_blank" rel="noopener">Alfred auto paste on return 自动粘贴失效解决方法</a> 确认下 System Preferences -&gt; Security &amp; Privacy -&gt; Accessibility 里有没有勾选 Alfred。如果已经勾上了 取消掉 重新选择勾上试试。</li>
</ul>
</li>
<li>
<p>[x] <a href="https://www.raycast.com/" target="_blank" rel="noopener"><strong>Raycast</strong></a>，【开源免费】，Alfred太贵了，Raycast是很好用的平替。“打开application/文件夹”，“snippet”，&quot;剪贴板&quot;等功能都有。</p>
</li>
<li>
<p>[x] <a href="https://formulae.brew.sh/cask/shortcutdetective" target="_blank" rel="noopener"><strong>shortcutdetective</strong></a>，【网址下载】检测keyboard shortcut(hotkey) 冲突， 免费。例如control + A, 可以检测出哪些application设置有这个快捷键，避免冲突。</p>
</li>
<li>
<p>[x] <a href="https://github.com/gbammc/Thor" target="_blank" rel="noopener"><strong>Thor</strong></a>，【网址下载】或者[APP Store + 国外账号]一键直达应用， 免费，开源。</p>
</li>
<li>
<p>[x] <a href="https://pqrs.org/osx/karabiner/" target="_blank" rel="noopener"><strong>Karabiner Element</strong></a>，用于改键。可以把右Command利用起来，避免快捷键冲突。</p>
<ul>
<li><a href="./Karabiner-Elements%E4%B8%8D%E7%94%9F%E6%95%88.html">Karabiner-Elements配置+不生效解决方法</a></li>
<li>另外参考<a href="https://lhajh.github.io/mac/2017/12/05/.Mac-custom-application-shortcut-keys.html" target="_blank" rel="noopener">Mac 自定义应用程序快捷键</a>配置了Mac app，比如Chrome和iterm3的一些快捷键。免费，开源。</li>
</ul>
</li>
</ul>
<h2 id="时间管理">时间管理</h2>
<ul>
<li>Apple官方日历，简称iCalendar， 用来日程记录。</li>
<li>TimeView， [APP Store 免费版限制2个card; 付费版，5.99美元买断] iCalendar并没有提供官方的数据统计和分析功能，所以我们需要借助第三方软件TimeView。TimeView可以理解为是一个数据透视图，透视的数据都来自你在日历中记录的东西。进去之后设置规则，比如我想要统计健身的时间，可以新建一条卡片，设置规则：选取「健康」日历，并包含「健身」关键词。然后我们就可以一张透视统计图，拉取了所有相关的日程，即使课程的命名不规则，只要「健身」关键词标记准确，就可以准确统计。</li>
<li><a href="https://dida365.com/" target="_blank" rel="noopener"><strong>TickTick滴答</strong></a> ，任务管理，有MAC版和iPhone版，可以同步。[APP Store]</li>
<li>[x] <a href="https://www.rescuetime.com/dashboard" target="_blank" rel="noopener">RescueTime</a>和<a href="https://wakatime.com/dashboard" target="_blank" rel="noopener">WakaTime</a>来记录你的时间，都有Chrome插件。RescueTime 手机端电脑端都有app。<a href="https://wakatime.com/terminal" target="_blank" rel="noopener">命令行安装WakaTime</a></li>
</ul>
<p>文章：</p>
<ul>
<li><a href="https://sspai.com/post/57956" target="_blank" rel="noopener">记录并统计时间都去哪里了</a></li>
</ul>
<h2 id="macos-工具">MACOS 工具</h2>
<ul>
<li>[x] <a href="https://github.com/newmarcel/KeepingYouAwake" target="_blank" rel="noopener"><strong>KeepingYouAwake</strong></a>，【免费，开源】可保证Mac系统不自动休眠。原来用的<a href="http://lightheadsw.com/caffeine/" target="_blank" rel="noopener">Caffeine</a>，但是<a href="https://www.reddit.com/r/osx/comments/9pbl9u/macos_mojave_caffeine_replacement/" target="_blank" rel="noopener">MacOS更新到Mojave以后就不管用了</a>。可以改用Amphetamine 或者 KeepingYouAwake。</li>
<li>【<a href="https://apps.apple.com/us/app/runcat/id1429033973?mt=12" target="_blank" rel="noopener">**runcat **App store</a>, 免费】顶部菜单栏随 CPU 越跑越快的猫。</li>
<li>[x] <a href="https://github.com/dwarvesf/hidden" target="_blank" rel="noopener"><strong>Hidden Bar</strong></a>，【免费，开源】菜单栏图标隐藏工具。</li>
</ul>
<h2 id="文件">文件</h2>
<h3 id="解压">解压</h3>
<ul>
<li><a href="https://ezip.awehunt.com/" target="_blank" rel="noopener"><strong>MacZip</strong></a> 【免费】解压/压缩工具, 查看、编辑压缩包，无需解压！一直想找到Windows上7zip的mac替代品，终于满足了。</li>
<li><a href="https://theunarchiver.com/" target="_blank" rel="noopener"><strong>the-unarchiver</strong></a> 【<a href="https://apps.apple.com/us/app/the-unarchiver/id425424353?mt=12" target="_blank" rel="noopener">App store</a>, 免费】解压/压缩工具,<code>brew install --cask the-unarchiver</code></li>
</ul>
<h3 id="文件比较-查看">文件比较/查看</h3>
<ul>
<li><a href="http://meldmerge.org/" target="_blank" rel="noopener"><strong>Meld</strong></a> 【开源免费】文件比较， <a href="https://github.com/yousseb/meld/releases/" target="_blank" rel="noopener">Meld git下载</a></li>
<li><a href="https://apps.apple.com/cn/app/qmenu/id1567442612?l=en&amp;mt=12" target="_blank" rel="noopener"><strong>Qmenu</strong></a> 【免费, App strore】访达扩展，拥有QSpace【付费, App strore】的部分功能。Support open in more Apps, such as Atom, MacVim, Emacs, CotEditor, Typora, Android Studio, HBuilderX, IDEA, AppCode, CLion, DataGrip, DataSpell, GoLand, PhpStorm, PyCharm, PyCharm CE, Rider, RubyMine, WebStorm.
<ul>
<li>【新建文件】</li>
<li>【<strong>计算文件哈希值</strong>】</li>
<li>【Open in Item2】</li>
<li>【Open in VScode】</li>
<li>【Open in IntelliJ IDEA】</li>
<li>【Open in PyCharm CE】</li>
<li>【Open in Typora】</li>
<li>【Copy path】</li>
</ul>
</li>
</ul>
<!-- Qmenu升级1.2后包含了OpenInTerminal的功能，所以OpenInTerminal就不用了。
- [OpenInTerminal](https://github.com/Ji4n1ng/OpenInTerminal/blob/master/Resources/README-zh.md)  【开源免费】访达扩展，不仅可以用iTerm2打开，还可以配置用其他IDE打开。
  - Support Terminal: iTerm, Hyper, Alacritty and kitty.
  - Support TextEdit, Visual Studio Code, VSCode Insiders, Atom, Sublime Text, VSCodium, BBEdit, TextMate, CotEditor, MacVim, JetBrains(AppCode, CLion, GoLand, IntelliJ IDEA, PhpStorm, PyCharm, RubyMine, WebStorm), and Typora.
  - 因为部分功能与`Qmenu`重复，所以`OpenInTerminal`只设置了下面选项：
    - 【Open in IntelliJ IDEA】
    - 【Open in PyCharm】
    - 【Copy path】 -->
<h3 id="文件清理">文件清理</h3>
<ul>
<li>[x] <a href="https://macpaw.com/cleanmymac" target="_blank" rel="noopener">**CleanMyMac **</a> 【我的百度网盘、硬盘】系统清理。付费软件。</li>
<li>[x] <a href="https://www.omnigroup.com/more" target="_blank" rel="noopener">**OmniDiskSweeper **</a> 系统文件清理。开源免费软件。</li>
</ul>
<h1 id="工具">工具</h1>
<h2 id="云盘">云盘</h2>
<ul>
<li>
<p><a href="pan.baidu.com">百度网盘</a></p>
</li>
<li>
<p><a href="https://www.microsoft.com/en-us/microsoft-365/onedrive/online-cloud-storage" target="_blank" rel="noopener">OneDrive</a></p>
</li>
<li>
<p>[x] <a href="http://kiwiforgmail.com/" target="_blank" rel="noopener"><strong>Kiwi for Gmail</strong></a>，Gmail 客户端, 我用的免费的lite版，App store 要切换到美国。</p>
</li>
<li>
<p>[x] <a href="https://www.seagate.com/pl/pl/support/software/paragon/" target="_blank" rel="noopener"><strong>Microsoft NTFS for Mac by Paragon Software</strong></a> - 支持 NTFS 格式硬盘，因为原来买了希捷的移动硬盘，送的软件，一般、够用。</p>
</li>
<li>
<p>[x] <a href="https://github.com/avibrazil/RDM" target="_blank" rel="noopener"><strong>RDM</strong></a>，【免费，开源】分辨率切换，允许设置未支持的分辨率，比如我会在录屏时设置 720p(hd) 的分辨率。在使用多个外接显示屏的时候，也可以调整外接显示屏的分辨率，很方便。</p>
</li>
</ul>
<h2 id="笔记-阅读">笔记/阅读</h2>
<ul>
<li>[x] <a href="https://www.onenote.com/signin?wdorigin=ondc" target="_blank" rel="noopener"><strong>Onenote</strong></a>，笔记工具，从 <a href="https://evernote.com/intl/zh-cn" target="_blank" rel="noopener">Evernote印象笔记</a> （原来是会员，现在只是免费版） 切到 Onenote，准备换<a href="https://ulysses.app/" target="_blank" rel="noopener"><strong>Ulysses</strong></a>。不过我现在markdown一般都用vscode+github来写了。
<ul>
<li>Onenoted 优点
<ul>
<li>0 免费 + 实时同步到onedrive</li>
<li>1 多级目录（note - stack section - section - page - subpage）</li>
<li>2 笔记间可相互引用：可复制page link和section link</li>
</ul>
</li>
<li>Onenoted 缺点
<ul>
<li>对markdown支持不好（只有windows版本有插件可以支持markdown）</li>
</ul>
</li>
</ul>
</li>
<li><a href="https://note.youdao.com/" target="_blank" rel="noopener">有道云笔记</a>【免费，支持markdown】推荐。<a href="https://apps.apple.com/cn/app/%E6%9C%89%E9%81%93%E4%BA%91%E7%AC%94%E8%AE%B0-%E7%AC%94%E8%AE%B0%E6%95%88%E7%8E%87%E5%8A%9E%E5%85%AC/id1600668116?l=en&amp;mt=12" target="_blank" rel="noopener">APP store 可下载</a>
<ul>
<li>支持markdown</li>
<li>免费版（非会员）2-3G空间</li>
</ul>
</li>
<li><a href="https://typora.io/" target="_blank" rel="noopener">Typora</a> 专门写markdown的编辑器。</li>
<li>[x] <a href="http://reederapp.com/mac/" target="_blank" rel="noopener"><strong>Reeder</strong></a>，RSS 阅读软件</li>
</ul>
 <!-- 我的主要信息来源，没有提供 rss 源的我会先在 [**rsshub.app**](https://docs.rsshub.app/) 上找，再没有就自己写一个 serverless 服务部署在 [now](https://zeit.co/) 上，[now使用方法](http://object.ws/2017/09/10/nowsh-note/) -->
<ul>
<li><a href="https://github.com/gee1k/uPic" target="_blank" rel="noopener">uPic</a> 【免费，开源】Mac图床客户端。我当然用的免费开源版。需要在 系统偏好设置 - 扩展 - 访达扩展 中添加扩展，否则点击会没有反应，<a href="https://blog.svend.cc/upic/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85" target="_blank" rel="noopener">参照</a>
<ul>
<li>支持图床： smms、 又拍云 USS、七牛云 KODO、 阿里云 OSS、 腾讯云 COS、微博、Github、 Gitee、 Amazon S3、自定义上传接口等</li>
<li><a href="https://blog.svend.cc/upic/" target="_blank" rel="noopener">中文使用说明</a></li>
<li><a href="https://apps.apple.com/cn/app/upic-a-powerful-hosting-tool/id1549159979?l=en&amp;mt=12" target="_blank" rel="noopener">App store 也可下载收费版￥30</a> 只有 AppStore 是最新版本。 其他安装留在`v0.21.1’。可以拉取代码自行编译打包。</li>
</ul>
</li>
</ul>
<h2 id="作图">作图</h2>
<!-- - [ ] [**Ulysses**](https://ulysses.app/)，笔记工具，从 [Bear](http://www.bear-writer.com/) 和 [Notion](https://www.notion.so/?r=159be429981b4725ad6f36c4f599bd98) 切到 Ulysses -->
<ul>
<li>
<p>Photoshop 【收费】，如果轻量级使用可以用网页在线工具<a href="https://www.photopea.com/" target="_blank" rel="noopener">photopea</a>代替。</p>
</li>
<li>
<p>[x] <a href="https://www.omnigroup.com/omnigraffle" target="_blank" rel="noopener"><strong>OmniGraffle</strong></a> 画图工具.</p>
</li>
<li>
<p>[x] <a href="https://www.xmind.net/" target="_blank" rel="noopener"><strong>Xmind</strong></a> 脑图工具。</p>
</li>
</ul>
<!-- - [ ] + iPad 上的 [**Whiteboard**](https://apps.apple.com/us/app/microsoft-whiteboard/id1352499399)，分别用于画架构图和和脑图 -->
<h2 id="截图">截图</h2>
<ul>
<li><a href="https://shottr.cc/" target="_blank" rel="noopener">Shottr</a> 【免费，MAC M1】Screenshot tool fordesigners，front-end engineers，mobile developers those who care about pixels.
<ul>
<li>可以量尺寸pixels</li>
<li>Text recognition (OCR) 图片识别文字</li>
<li>Scrolling Screenshots on Mac 长截图</li>
<li>Color picker 取色器</li>
</ul>
</li>
</ul>
<h2 id="修图">修图</h2>
<p><a href="./%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86%E8%BD%AF%E4%BB%B6%E6%8E%A8%E8%8D%90.html">修图软件</a></p>
<h2 id="视频">视频</h2>
<h2 id="视频播放">视频播放</h2>
<ul>
<li>[x] <a href="https://apps.apple.com/cn/app/gif-brewery-3-video-to-gif/id1081413713?l=en&amp;mt=12" target="_blank" rel="noopener"><strong>Gif Brewery 3</strong></a> ，GIF 录屏工具, 可以直接录屏并转换成gif动图。免费，App store 下载。</li>
<li>各类视频软件</li>
<li>[x] <a href="https://github.com/iina/iina" target="_blank" rel="noopener"><strong>IINA</strong></a>，<a href="https://iina.io/" target="_blank" rel="noopener">IINA</a>视频播放。原来用的<a href="https://www.videolan.org/vlc/index.zh.html" target="_blank" rel="noopener">VLC media player</a>，后来<a href="https://www.zhihu.com/question/19552878/answer/139035466" target="_blank" rel="noopener">改用IINA</a>。【开源免费】多媒体播放器，支持多倍速播放。 <code>brew install --cask iina</code></li>
</ul>
<h3 id="视频编辑">视频编辑</h3>
<ul>
<li>
<p>[x] <a href="https://github.com/keycastr/keycastr" target="_blank" rel="noopener"><strong>KeyCastr</strong></a>，你在键盘上按了哪些键，会显示在屏幕上，适合录屏的时候使用。通过 homebrew cask 安装: <code>brew cask install keycastr</code>。记得mac设置Security &amp; Privacy下的Input monitoring 和 Accessibility里面要加上并勾选。顺便把开始显示键盘的快捷键设置成了F19 + k。免费，开源。</p>
</li>
<li>
<p>[x] <a href="https://www.blackmagicdesign.com/products/davinciresolve/" target="_blank" rel="noopener"><strong>DaVinci Resolve 16</strong></a> 达芬奇，视频剪辑，有免费版本，影视飓风在B站有免费教程。</p>
</li>
<li>
<p>[x] <a href="https://apps.apple.com/cn/app/blackmagic-raw-player/id1435415804?mt=12" target="_blank" rel="noopener"><strong>Blackmagic RAW Player</strong></a> Blackmagic RAW Player是观看Blackmagic RAW格式片段的理想选择。Blackmagic RAW Player能够播放Blackmagic RAW格式的媒体文件，以及扩展名为.braw的媒体文件。App store 有，免费。</p>
</li>
<li>
<p>[x] <a href="https://apps.apple.com/cn/app/blackmagic-raw-speed-test/id1466185689?mt=12" target="_blank" rel="noopener"><strong>Blackmagic RAW Speed Test</strong></a> Blackmagic RAW Speed Test是一套CPU和GPU衡量工具，可用于测试系统上解码全分辨率Blackmagic RAW帧的速度。测试中多个CPU内核和GPU会被自动检测和使用，为您提供准确实际的结果。只需选择Blackmagic RAW固定比特率3:1、5:1、8:1或12:1，以及您想要的分辨率即可执行测试。测试结果以简单明了的表格形式展示，显示了您的计算机每秒解码所有支持分辨率的帧数。App store 有，免费。</p>
</li>
<li>
<p>[x] <a href="https://www.blackmagicdesign.com/products/davinciresolve/" target="_blank" rel="noopener"><strong>PluralEyes 4</strong></a> Red Giant PluralEyes for mac是Mac平台上一款专业的音视频同步剪辑软件，pluraleyes 4 mac支持使用轨道和媒体剪辑、跨区剪辑、临时同步文件、调整同步结果、微调同步、导出为媒体文件、导出时间轴等功能，能够轻松处理多机位的音视频同步问题。付费。</p>
</li>
<li>
<p>[ ] <a href="https://softorino.com/youtube-converter" target="_blank" rel="noopener"><strong>Softorino YouTube Converter</strong></a>，免费24小时，之后付费，YouTube 视频下载</p>
</li>
<li>
<p>[ ] <a href="https://github.com/ytdl-org/youtube-dl/blob/master/README.md#readme" target="_blank" rel="noopener"><strong>youtube-dl</strong></a> <a href="https://zhuanlan.zhihu.com/p/27718783" target="_blank" rel="noopener">命令行视频下载利器，选择下载视频，或是将视频流直接导出到自己想使用的播放器中</a>。国内类似版本： <a href="https://github.com/soimort/you-get" target="_blank" rel="noopener">You-Get</a>，对国内平台支持的更好。</p>
</li>
</ul>
<!-- - [ ] [**Downie 3**](http://software.charliemonroe.net/downie.php)，通用视频下载，付费，SetApp含有 -->
<ul>
<li>[ ] <a href="https://mac.eltima.com/download-manager.html" target="_blank" rel="noopener"><strong>Folx 5</strong></a> + <a href="https://www.qbittorrent.org/" target="_blank" rel="noopener"><strong>qBittorrent</strong></a> + <a href="https://motrix.app/" target="_blank" rel="noopener"><strong>Motrix</strong></a>，下载工具，Folx 下 http，qBittorrent 下 magnet，Motrix 是 aria2 的封装，可以<a href="https://www.yuque.com/moapp/help/extensions" target="_blank" rel="noopener">下百度云盘、115 等</a></li>
<li>[ ] <a href="https://justgetflux.com" target="_blank" rel="noopener"><strong>f.lux</strong></a>，调节显示器色温，护眼，尤其是早上起来屏幕实在是刺眼</li>
</ul>
<h2 id="虚拟机">虚拟机</h2>
<ul>
<li>[x] <a href="https://www.parallels.com/" target="_blank" rel="noopener"><strong>ParallelsDesktop</strong></a> 【付费】Mac上跑Windows虚拟机，与Mac集成的非常好。</li>
<li>[x] <a href="https://www.virtualbox.org/" target="_blank" rel="noopener"><strong>VirtualBox</strong></a> 【免费】Oracle虚拟机。</li>
</ul>
<h2 id="翻译">翻译</h2>
<ul>
<li><a href="https://www.deepl.com/translator" target="_blank" rel="noopener">DeepL</a>  网页版，app版，浏览器插件 都有。Pro版本收费，普通版免费。</li>
</ul>
<h2 id="工作必备">工作必备</h2>
<ul>
<li>[x] <a href="https://vpn.microstrategy.com/global-protect/getsoftwarepage.esp" target="_blank" rel="noopener">GlobalProtect</a> 【网址下载】 工作 VPN 软件</li>
<li>[x] <a href="https://apps.apple.com/us/app/microsoft-remote-desktop/id1295203466?mt=12" target="_blank" rel="noopener">Microsoft Remote Desktop</a> [APP Store] 美版账号，连接远程虚拟机。</li>
<li>[x] <a href="https://www.realvnc.com/en/connect/download/viewer/" target="_blank" rel="noopener">VNC Viewer</a>【免费】连接远程虚拟机。</li>
<li>[x] <a href="https://zoom.us/" target="_blank" rel="noopener">Zoom</a> 在线会议。</li>
<li>[x] <a href="https://slack.com" target="_blank" rel="noopener">Slack</a> 办公聊天。</li>
<li>[x] <a href="https://www.grammarly.com/" target="_blank" rel="noopener">Grammarly</a> Chrome extension + Mac application 英文写作必备，可以提示语法错误并自动改正。</li>
<li><a href="https://apps.apple.com/cn/app-bundle/microsoft-365/id1450038993?l=en&amp;mt=12" target="_blank" rel="noopener">Microsoft office 365</a> 微软全家桶。</li>
</ul>
<h1 id="mac-设置">MAC 设置</h1>
<h2 id="高效-macbook-工作环境配置"><a href="https://cloud.tencent.com/developer/article/1424480" target="_blank" rel="noopener">高效 MacBook 工作环境配置</a></h2>
<h2 id="finder设置">Finder设置</h2>
<ul>
<li>
<p><a href="https://sspai.com/post/27403" target="_blank" rel="noopener">10 个实用技巧，让 Finder 带你飞</a></p>
</li>
<li>
<p>Mac 显示隐藏文件 命令 comand finder</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">defaults write com.apple.finder AppleShowAllFiles Yes &amp;&amp; killall Finder //显示隐藏文件</span><br><span class="line"></span><br><span class="line">defaults write com.apple.finder AppleShowAllFiles No &amp;&amp; killall Finder //不显示隐藏文件</span><br></pre></td></tr></table></figure>
<h2 id="删除启动台-launchpad-残留的图标">删除启动台（LaunchPad）残留的图标</h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/55866195" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/55866195</a></li>
</ul>
<h2 id="壁纸软件">壁纸软件</h2>
<ul>
<li><a href="https://apps.apple.com/us/app/irvue/id1039633667?mt=12" target="_blank" rel="noopener">Irvue</a>： 【Apple store 美版账户， 免费】自动换壁纸，就不用再为切换壁纸这件事情消耗过多不必要的时间。它自动获取 Unsplash 上的高质量无版权图片作为壁纸。在其菜单栏菜单中的 Update interval（更新时间）中可以设置更新间隔，从每半小时到每月都可以设置，也可以选择手动更新。</li>
<li><a href="https://link.zhihu.com/?target=https%3A//unsplash.com/" target="_blank" rel="noopener">Unsplash</a> ：【Apple store 美版账户， 免费】作为质量最高的免费无版权图片资源网站之一，Unsplash 一直被众多第三方壁纸应用选为图片来源，而这个高质量的照片网站终于有官方的 <a href="https://apps.apple.com/us/app/unsplash-wallpapers/id1284863847?mt=12" target="_blank" rel="noopener">Mac 客户端</a>了。</li>
</ul>
<p>参考文章：</p>
<ul>
<li><a href="https://www.zhihu.com/question/40021839/answer/257790965" target="_blank" rel="noopener">少数派文章：mac桌面壁纸软件</a></li>
<li><a href="https://www.zhihu.com/question/40021839" target="_blank" rel="noopener">mac有哪些好用的桌面壁纸软件？</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
        <category>Environment setup</category>
      </categories>
      <tags>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机英语-安全Security</title>
    <url>/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%8B%B1%E8%AF%AD-%E5%AE%89%E5%85%A8Security.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="攻击类型">攻击类型</h2>
<table>
<thead>
<tr>
<th>英文</th>
<th>读音</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>Phishing</td>
<td>美/ˈfɪʃɪŋ/</td>
<td>网络钓鱼 the activity of tricking people by getting them to give their identity, bank account numbers, etc. over the Internet or by email, and then using these to steal money from them 网络诱骗（通过互联网或电邮骗取他人身份证件、银行账号等以盗取金钱）</td>
</tr>
<tr>
<td>Injection</td>
<td></td>
<td>注入 例如 SQL Injection</td>
</tr>
</tbody>
</table>
<h2 id="缩写">缩写</h2>
<table>
<thead>
<tr>
<th>缩写</th>
<th>全称</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>DOS</td>
<td>Denial of Service</td>
<td>服务不可用 Denial of Service occurs when a web server is made temporarily unavailable or unusable to a valid user. Protection from such threats improves system consistency and availability. 当 Web 服务器暂时不可用或对有效用户不可用时，就会发生拒绝服务。 防范此类威胁可提高系统一致性和可用性。</td>
</tr>
<tr>
<td>DFDs</td>
<td>Data flow diagrams</td>
<td>The threat modeling approach requires you to use data flow diagrams (or DFDs).<br>A data flow diagram is an organized evaluation and design method used for software analvsis. It represents the flow of data through the system. DFD supports decomposition, to graphically depict the flow of data and functions in the system.<br>A DFD provides:<br>- A system design to support the analysis and requirement stage.<br>- A detailed system diagram.<br>- Description of the network of activities of the target system.<br>- Step-by-step modification through tiered disintegration of activities.</td>
</tr>
<tr>
<td><a href="https://owasp.org/www-project-application-security-verification-standard/" target="_blank" rel="noopener">ASVS</a></td>
<td>OWASP Application Security Verification Standards</td>
<td>a community-driven attempt to begin a framework of security controls that focuses on outlining the functional and non functional security controls essential for development, design,and testing of modern web services and applications.</td>
</tr>
<tr>
<td>CVSS</td>
<td>Common Vulnerability Scoring System</td>
<td></td>
</tr>
<tr>
<td>CVE</td>
<td>Common Vulnerability and Exposure</td>
<td></td>
</tr>
<tr>
<td>NVD</td>
<td><a href="https://nvd.nist.gov/" target="_blank" rel="noopener">National Vulnerability Database</a></td>
<td></td>
</tr>
<tr>
<td>MFA</td>
<td>Multi-factor authentication</td>
<td>(MFA) is an authentication technique in which a user must provide two or more verification factors to access an application. MFA is one of the best defense techniques, which can be used against most password-related attacks. Use MFA wherever possible and feasible.</td>
</tr>
<tr>
<td>RBAC</td>
<td>Role-Based Access Control</td>
<td>is the process of making access decisions based on the roles and responsibilities of a user</td>
</tr>
<tr>
<td>DAC</td>
<td>Discretionary Access Control</td>
<td>the process of restricting access to information based on the identity of the user.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>英文</th>
<th>threat modeling</th>
<th>approach</th>
</tr>
</thead>
<tbody>
<tr>
<td>PASTA (The Process for Attack Simulation and Threat Analysis)</td>
<td>a type of <code>threat modeling</code></td>
<td><code>attack-centric</code> approach</td>
</tr>
<tr>
<td>STRIDE (spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege)</td>
<td>one of the commonly used <code>threat modeling</code> methods. a tool developed by <code>Microsoft</code> to classify all possible threats on the server.</td>
<td></td>
</tr>
<tr>
<td>DREAD</td>
<td><code>Damage</code> – how bad would an attack be?<br><code>Reproducibility</code> – how easy is it to reproduce the attack?<br><code>Exploitability</code> – how much work is it to launch the attack?<br><code>Affected users</code> – how many people will be impacted?<br><code>Discoverability</code> – how easy is it to discover the threat?</td>
<td></td>
</tr>
<tr>
<td>Microsoft Security Development Lifecycle (SDL)</td>
<td>a type of <code>threat modeling</code>, Microsoft Threat Modeling Tool</td>
<td><code>application-centric</code> approach</td>
</tr>
<tr>
<td>OCTAVE (Operationally Critical Threat, Asset, and Vulnerability Evaluation)</td>
<td>a tried and tested <code>threat modeling</code></td>
<td><code>asset-centric</code> approach</td>
</tr>
<tr>
<td>TD (Threat Dragon)</td>
<td>open-source threat modeling tool, both online and a desktop application</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="threat-modeling"><a href="https://owasp.org/www-community/Threat_Modeling" target="_blank" rel="noopener">Threat modeling</a></h3>
<p><code>Threat modeling</code> is a core element of the Microsoft Security Development Lifecycle. You can use threat modeling to identify and mitigate threats, weaknesses, and vulnerabilities in an application.</p>
<p>OWASP suggests gathering the following assessment input.</p>
<ul>
<li>A description, design, or model of your application architecture.</li>
<li>A list of assumptions that can be checked or challenged in the future, as the threat landscape changes.</li>
<li>A list of potential threats to the system.</li>
<li>A list of mitigations to be taken for each threat.</li>
<li>A way of validating the model. threats, and verifying the success of implemented mitigations.</li>
</ul>
<table>
<thead>
<tr>
<th>英文</th>
<th><a href="https://owasp.org/www-community/Threat_Modeling" target="_blank" rel="noopener">threat modeling</a></th>
<th>approach</th>
</tr>
</thead>
<tbody>
<tr>
<td>PASTA (The Process for Attack Simulation and Threat Analysis)</td>
<td>a type of <code>threat modeling</code></td>
<td><code>attack-centric</code> approach</td>
</tr>
<tr>
<td>STRIDE (spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege)</td>
<td>one of the commonly used <code>threat modeling</code> methods. a tool developed by <code>Microsoft</code> to classify all possible threats on the server.</td>
<td></td>
</tr>
<tr>
<td>DREAD</td>
<td><code>Damage</code> – how bad would an attack be?<br><code>Reproducibility</code> – how easy is it to reproduce the attack?<br><code>Exploitability</code> – how much work is it to launch the attack?<br><code>Affected users</code> – how many people will be impacted?<br><code>Discoverability</code> – how easy is it to discover the threat?</td>
<td></td>
</tr>
<tr>
<td>Microsoft Security Development Lifecycle (SDL)</td>
<td>a type of <code>threat modeling</code>, Microsoft Threat Modeling Tool</td>
<td><code>application-centric</code> approach</td>
</tr>
<tr>
<td>OCTAVE (Operationally Critical Threat, Asset, and Vulnerability Evaluation)</td>
<td>a tried and tested <code>threat modeling</code></td>
<td><code>asset-centric</code> approach</td>
</tr>
<tr>
<td>TD (Threat Dragon)</td>
<td>open-source threat modeling tool, both online and a desktop application</td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>STRIDE</th>
<th>读音</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>spoofing</td>
<td>美/ˈspuːfɪŋ/</td>
<td>电子欺骗; 在网络上或邮件中假冒他人的行为或事例。the act or an instance of impersonating another person on the internet or via email. Refers to illegal access and use of data.</td>
</tr>
<tr>
<td>Tampering</td>
<td>美/ˈtæmpərɪŋ/</td>
<td>篡改数据 Refers to malicious modification of data. Can be done to data at rest, or in transit.指恶意修改数据。 可以对静止或传输中的数据进行处理。</td>
</tr>
<tr>
<td>Repudiation</td>
<td>美/rɪˌpjuːdiˈeɪʃ(ə)n/</td>
<td>否认、抵赖。不可否认/抵赖性（Non-repudiation）. Occurs when the system cannot trace and prove actions performed by a user. 当系统无法跟踪和证明用户执行的操作时出现。</td>
</tr>
<tr>
<td>Information disclosure</td>
<td></td>
<td>Information disclosure refers to exposing information to unauthorized entities. For example, a user is able to read a file that does not belong to them, or a threat actor gains access to data in transit. 信息泄露是指将信息暴露给未经授权的实体。 例如，用户能够读取不属于他们的文件，或者威胁参与者可以访问传输中的数据。</td>
</tr>
<tr>
<td>Elevation of privilege</td>
<td></td>
<td>权限提升 Elevation of privilege refers to a situation where an attacker successfully gains access to restricted levels of a svstem. The attackers can then access sensitive data, restricted functionality, and connected systems.特权提升是指攻击者成功获得对受限制级别的系统的访问权限的情况。 然后，攻击者可以访问敏感数据、受限功能和连接的系统。</td>
</tr>
<tr>
<td>DOS (Denial of Service)</td>
<td></td>
<td>服务不可用 Denial of Service occurs when a web server is made temporarily unavailable or unusable to a valid user. Protection from such threats improves system consistency and availability. 当 Web 服务器暂时不可用或对有效用户不可用时，就会发生拒绝服务。 防范此类威胁可提高系统一致性和可用性。</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>DFDs</th>
<th>读音</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>DFDs (Data flow diagrams)</td>
<td></td>
<td>The threat modeling approach requires you to use data flow diagrams (or DFDs).<br>A data flow diagram is an organized evaluation and design method used for software analvsis. It represents the flow of data through the system. DFD supports decomposition, to graphically depict the flow of data and functions in the system.<br>A DFD provides:<br>- A system design to support the analysis and requirement stage.<br>- A detailed system diagram.<br>- Description of the network of activities of the target system.<br>- Step-by-step modification through tiered disintegration of activities.</td>
</tr>
</tbody>
</table>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/security/DFD1.png" alt="DFD1"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/security/DFD1.png" alt="DFD2"></p>
<h2 id="application-security-testing">Application Security Testing</h2>
<h3 id="security-assessment-methodologies">security assessment methodologies</h3>
<table>
<thead>
<tr>
<th>英文</th>
<th>security assessment methodologies</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>SAST</td>
<td>（Static Application Security Testing）</td>
<td>测试或运行阶段分析应用程序的动态运行状态。它模拟黑客行为对应用程序进行动态攻击，分析应用程序的反应，从而确定该Web应用是否易受攻击。</td>
</tr>
<tr>
<td>DAST</td>
<td>（Dynamic Application Security Testing）</td>
<td>在编码阶段分析应用程序的源代码或二进制文件的语法、结构、过程、接口等来发现程序代码存在的安全漏洞。</td>
</tr>
<tr>
<td>IAST</td>
<td>交互式应用程序安全测试（Interactive Application Security Testing）</td>
<td>是2012年Gartner公司提出的一种新的应用程序安全测试方案，通过代理、VPN或者在服务端部署Agent程序，收集、监控Web应用程序运行时函数执行、数据传输，并与扫描器端进行实时交互，高效、准确的识别安全缺陷及漏洞，同时可准确确定漏洞所在的代码文件、行数、函数及参数。IAST相当于是DAST和SAST结合的一种互相关联运行时安全检测技术。</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>对比</th>
<th>SAST</th>
<th>DAST</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>Inside-out security testing method.</td>
<td>Outside-in security testing method.</td>
</tr>
<tr>
<td></td>
<td>Studies the source code or binary without application execution.</td>
<td>Studies the source code or binary by executing the application.</td>
</tr>
<tr>
<td></td>
<td>Supports assessment of all kinds of software.</td>
<td>Does not support assessment of software other than web applications and web services.</td>
</tr>
<tr>
<td></td>
<td>静态 Scans only static code.<br>cannot discover run-time vulnerabilities.</td>
<td>动态 Performs dynamic analysis on an application.<br>can discover run-time vulnerabilities</td>
</tr>
<tr>
<td></td>
<td>Less expensive<br>since the vulnerabilities can be detected during the earlier stages of the software development lifecycle.</td>
<td>More expensive<br>detects vulnerabilities towards the end</td>
</tr>
</tbody>
</table>
<p>of a software development lifecycle<br>
||Need eliminate false positives|</p>
<p>参考： <a href="https://www.aqniu.com/learn/46910.html" target="_blank" rel="noopener">一文洞悉DAST、SAST、IAST ——Web应用安全测试技术对比浅谈</a></p>
<h3 id="component-analysis"><a href="https://owasp.org/www-community/Component_Analysis" target="_blank" rel="noopener">Component Analysis</a></h3>
<p><a href="https://wiki.owasp.org/images/b/bd/Software_Composition_Analysis_OWASP_Stammtisch_-_Stanislav_Sivak.pdf" target="_blank" rel="noopener">Software Composition Analysis - OWASP Stammtisch</a></p>
<p>解决third-party and open source components依赖带来的security问题。</p>
<table>
<thead>
<tr>
<th>缩写</th>
<th>全称</th>
<th>含义</th>
<th>Advantage</th>
<th>Caution</th>
</tr>
</thead>
<tbody>
<tr>
<td>SCA</td>
<td>Software Composition Analysis</td>
<td>Component Analysis is the process of identifying potential areas of risk from the use of third-party and open-source software and hardware components. A software-only subset of Component Analysis with limited scope is commonly referred to as <code>Software Composition Analysis (SCA)</code>.</td>
<td>Component Analysis is a function within an overall <a href="https://csrc.nist.gov/projects/supply-chain-risk-management" target="_blank" rel="noopener"><code>Cyber Supply Chain Risk Management (C-SCRM)</code></a> framework.</td>
<td></td>
</tr>
<tr>
<td>C-SCRM</td>
<td><a href="https://csrc.nist.gov/projects/supply-chain-risk-management" target="_blank" rel="noopener">Cyber Supply Chain Risk Management</a></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>SBOM</td>
<td><a href="https://owasp.org/www-community/Component_Analysis#software-bill-of-materials-sbom" target="_blank" rel="noopener">Software Bill of Materials</a></td>
<td>软件透明度通常通过发布软件材料清单来实现。 SBOM 是配方中成分列表的同义词。 两者都是透明度的实现。Software Transparency is often achieved through the publishing of software bill of materials. An SBOM is synonymous to the list of ingredients in a recipe. Both are an implementation of transparency.</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/security/Application_security_pipeline.png" alt="Application_security_pipeline"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/security/Application_security_CICDpipeline.png" alt="Application_security_CICDpipeline"></p>
<h3 id="prioritizing-security-risks">Prioritizing security risks</h3>
<ul>
<li>The likelihood of a threat exploiting the system weaknesses.</li>
<li>The likely impact of the threat on the weaknesses.</li>
<li>The capability of the existing information security system controls to reduce the risk.</li>
</ul>
<p>Risk = Probability of Threat x Impact Value</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Probability of Threat</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.0</td>
<td>High</td>
</tr>
<tr>
<td>0.5</td>
<td>Medium</td>
</tr>
<tr>
<td>0.1</td>
<td>Low</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Value</th>
<th>Impact Level</th>
</tr>
</thead>
<tbody>
<tr>
<td>100</td>
<td>High</td>
</tr>
<tr>
<td>50</td>
<td>Medium</td>
</tr>
<tr>
<td>10</td>
<td>Low</td>
</tr>
</tbody>
</table>
<h3 id="secure-sdlc-101">Secure SDLC 101</h3>
<p>Secure Software Development Lifecycle (<code>SSDLC</code>)</p>
<p>A software development life cycle (<code>SDLC</code>) is a process that outlines the steps used by organizations, to build an application from the beginning until the end. In simple terms, a secure SDLC is set up by adding security-related actions to the current development life cycle.</p>
<p>The phases of SDLC include:</p>
<ul>
<li>Planning and requirements Architecture and design</li>
<li>Test planning</li>
<li>Coding</li>
<li>Testing and results</li>
<li>Release and maintenance</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/security/SSDLC.png" alt="SSDLC"></p>
<p>Benefits of Secure SDLC:</p>
<ul>
<li>Acquaints stakeholders to security considerations.</li>
<li>Reduces expenses by early detection and issue fixes.</li>
<li>Results in overall decline in key business risks.</li>
</ul>
<h3 id="code-review">Code review</h3>
<p><a href="https://owasp.org/www-project-code-review-guide/assets/OWASP_Code_Review_Guide_v2.pdf" target="_blank" rel="noopener">OWASP Code Review Guide 2.0</a></p>
<p>Best practices before sending the code for review:</p>
<ul>
<li>Ensure that the code compiles and passes static analysis, within policy compliance.</li>
<li>Ensure that the code passes unit, integration<br>
and system tests.</li>
<li>Check for spelling errors and double-check to tidy up your document.</li>
<li>Ensure code changes are captured and annotated appropriately.</li>
<li>Check for logic errors.</li>
</ul>
<table>
<thead>
<tr>
<th>Code review techniques</th>
<th>Expain</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td>Instant Code Review</td>
<td>the code is instantly reviewed while it is being written. The developer writes code, while the reviewer sits beside reading and correcting the code.</td>
<td><code>Highly complex</code> programs can benefit from instant code review, because two minds working on a problem often solve problems in a speedier and efficient manner.</td>
</tr>
<tr>
<td>Ad-Hoc Code Review</td>
<td>called “Over the Shoulder” reviewing. Typically, a developer will ask a reviewer to look at, and give feedback on the code they have written. The emphasis of ad-hoc review is that it is done with the reviewer and developer in a live conversion.</td>
<td>It is one of the <code>most common</code> review processes.</td>
</tr>
<tr>
<td>Meeting-Based Code Review</td>
<td>coders finish their work and call a meeting. The whole technology team sits together, comments. and attempts to improve the code together.</td>
<td>not commonly practiced because it is a <code>time-consuming</code> and <code>resource-intensive</code> activity.</td>
</tr>
<tr>
<td>Tool-Based(asynchronous) Code Review</td>
<td>is performed by the reviewer, separate from the developer. A developer will make their code available for review and then the reviewer will, in their own time, review the code. Comments and corrections will be left by the reviewer for the developer.</td>
<td>The developer will be notified of the feedback and if the two parties agree, the code is signed off and accepted as part of the application.</td>
</tr>
</tbody>
</table>
<h2 id="rating-vulnerabilities">Rating vulnerabilities</h2>
<h3 id="dread-rating-system">DREAD rating system</h3>
<p>A risk assessment model that evaluates the security threats is called DREAD rating system.</p>
<p>DREAD Category:</p>
<ul>
<li>Damage potential</li>
<li>Reproducibility</li>
<li>Exploitability</li>
<li>Affected users</li>
<li>Discoverability</li>
</ul>
<p>A rating from 1 to 10 is given to DREAD categories and the sum of all ratings is used to prioritize issues.</p>
<h3 id="cvss">CVSS</h3>
<p>CVSS is used to communicate the characteristics and severity of software vulnerabilities.</p>
<p>There are three metric groups used in the CVSS report:</p>
<ol>
<li><code>Base</code></li>
<li><code>Temporal</code></li>
<li><code>Environmental</code>.</li>
</ol>
<p>The <code>Base</code> metrics produces a score range from 0 to 10. The score can be changed by changing the Temporal and Environmental metrics.</p>
<ul>
<li><code>Base</code> signifies the essential and vital characteristics of a vulnerability that are constant with time and user environment.</li>
<li><code>Temporal</code> signifies the features of a vulnerability that change with time, but not with user environments.</li>
<li><code>Environmental</code> signifies the features of a vulnerabilitv that are unique to a user’s environments.</li>
</ul>
<h4 id="cvss-scores">CVSS scores</h4>
<p>You can obtain the CVSS scores for all vulnerabilities from the <code>National Vulnerability Database (NVD)</code>. The <a href="https://nvd.nist.gov/" target="_blank" rel="noopener">NVD</a> helps create a CVSS base score for all vulnerabilities.</p>
<p>Note that the CVSS has two active versions. The score to severitv relationship is different depending on the version.</p>
<table>
<thead>
<tr>
<th>CVSS v2.0 Ratings - Severity</th>
<th>Base Score Range</th>
</tr>
</thead>
<tbody>
<tr>
<td>Low</td>
<td>0.0-3.9</td>
</tr>
<tr>
<td>Medium</td>
<td>4.0-6.9</td>
</tr>
<tr>
<td>High</td>
<td>7.0-10.0</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>CVSS v3.0 Ratings - Severity</th>
<th>Base Score Range</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<td>Low</td>
<td>0.1-3.9</td>
</tr>
<tr>
<td>Medium</td>
<td>4.0-6.9</td>
</tr>
<tr>
<td>High</td>
<td>7.0-8.9</td>
</tr>
<tr>
<td>Critical</td>
<td>9.0-10.0</td>
</tr>
</tbody>
</table>
<h3 id="finding-security-vulnerabilities-online">Finding security vulnerabilities online</h3>
<ul>
<li><a href="https://cve.mitre.org/" target="_blank" rel="noopener">Common Vulnerabilities and Exposure</a>
<ul>
<li>List of items containing identification number, description, and a public reference for publicly known cybersecurity weaknesses.</li>
<li>These CVE entries are used with cybersecurity creations and amenities from all around the world.</li>
</ul>
</li>
<li><a href="https://nvd.nist.gov/" target="_blank" rel="noopener">National Vulnerability Database</a>
<ul>
<li>The U.S. government’s database of reported and known security vulnerabilities.</li>
<li>Synchronized with CVE.</li>
<li>Comparatively easier to navigate.</li>
<li>Lists each vulnerability along with a description, source, and severity level.</li>
</ul>
</li>
<li><a href="https://www.veracode.com/security/owasp-top-10" target="_blank" rel="noopener">OWASP Top 10 Vulnerabilities</a></li>
<li><a href="https://vuldb.com/" target="_blank" rel="noopener">Vulnerability Database</a>
<ul>
<li>A platform that collects, maintains, and disseminates data about common security vulnerabilities.</li>
<li>Describes each vulnerability, provides a workaround, assesses the impacts, and issues moderation.</li>
</ul>
</li>
</ul>
<h2 id="secure-architecture-and-design">Secure Architecture and Design</h2>
<h3 id="access-control-methodologies">Access control methodologies</h3>
<table>
<thead>
<tr>
<th>缩写</th>
<th>全称</th>
<th>含义</th>
<th>Advantage</th>
<th>Caution</th>
</tr>
</thead>
<tbody>
<tr>
<td>RBAC</td>
<td>Role-Based Access Control</td>
<td>is the process of making access decisions based on the <code>roles</code> and responsibilities of a user.<br>- Roles of a user are defined based on the organizational goals, structure, and security policies.<br>- Application security administrators use RBAC to define what, when, where, and how an action can be performed by a user.</td>
<td>- Easy to implement and administer.<br>- Facilitates the principle of least privilege.</td>
<td>- Assign user roles using strict sign-offs and procedures.<br>- Disable all previously assigned permissions and assign permissions based on the new role.<br>- Perform strict access control reviews to ensure safe use of RBAC</td>
</tr>
<tr>
<td>DAC</td>
<td>Discretionary Access Control</td>
<td>the process of restricting access to information based on the <code>identity</code> of the user.<br>- Access decisions depend on the user’s current authorization limits.<br>- A simple example of DAC would be a system in which passwords are set for files,folders, and other resources.<br>-Resource owners can grant or revoke permission to any of the objects that are under their control.</td>
<td>- Easy to use and administer.<br>- Used on par with the principle of least privileges.<br>- Users have complete control over the access granted to them.</td>
<td>Perform strict access control reviews to ensure the safe use of DAC.</td>
</tr>
<tr>
<td>MAC</td>
<td>Mandatory Access Control</td>
<td>is the process of providing access to users based on the <code>sensitivity</code> and <code>confidentiality</code> of the data.</td>
<td>- Access permissions are granted based on the sensitivity of the data, business requirements, and changes in the scope of a project.<br>- Only administrators are given control to grant user access.</td>
<td>- Classify data and assign access to sensitive information based on user permission level.<br>- Ensure that data classification is done at the appropriate level</td>
</tr>
<tr>
<td>.</td>
<td>Permission-Based Access Control</td>
<td>process of converting application access into a series of permissions.<br>- Permissions are string-based names.<br>- Access decisions are made by verifying whether the current permission level of a user allows them to perform the requested application action.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>.</td>
<td>Multi-Tenant Access Control</td>
<td>Single application instance has multiple users</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="mac">MAC</h4>
<ul>
<li>Users are granted permission based on need.</li>
<li>MAC is the most secure access control model because access rules are:
<ul>
<li>Defined manually by system administrators.</li>
<li>Implemented by the operating system or security kernel.</li>
<li>Used to restrict access to security attributes.</li>
</ul>
</li>
</ul>
<h4 id="permission-based-access-control">Permission-Based Access Control</h4>
<ul>
<li>Direct Model
<ul>
<li>In the direct model, grant privileges only to the users who need those privileges to complete the assigned tasks.</li>
</ul>
</li>
<li>Indirect Model
<ul>
<li>The permission is granted to an intermediate entity like a user group.</li>
<li>If a user inherits permissions from a user group, that user becomes a member of that user group.</li>
<li>If you edit permissions assigned to a user group, all users associated with that user group are affected.</li>
</ul>
</li>
</ul>
<h4 id="multi-tenant-access-control">Multi-Tenant Access Control</h4>
<ul>
<li>Single application instance has multiple users</li>
<li>Tenant resource isolation or segmentation is fundamental to these systems.</li>
<li>Segmented application enables secure separation between tenants.
<ul>
<li>Example: For your SAAS application, you need to isolate each company on multiple layers.</li>
</ul>
</li>
<li>Segregation ensures that customer resources cannot be accessed by other tenants.</li>
<li>MTAC models can address both intra-tenant and cross-tenant access.</li>
</ul>
<p><a href="https://d1.awsstatic.com/whitepapers/saas-tenant-isolation-strategies.pdf" target="_blank" rel="noopener">SaaS Tenant Isolation Strategies</a></p>
<h1 id="参考文章">参考文章</h1>
<ul>
<li><a href="https://haiderm.com/stride-threat-modelling-vs-dread-threat-modelling/" target="_blank" rel="noopener">STRIDE Threat Modelling vs DREAD Threat Modelling</a></li>
</ul>
]]></content>
      <categories>
        <category>English Learning</category>
        <category>计算机英语</category>
      </categories>
      <tags>
        <tag>Security</tag>
      </tags>
  </entry>
  <entry>
    <title>5秦小明-新金融思维训练笔记第05讲-金融的宏观基础-宏观经济分析II</title>
    <url>/5%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC05%E8%AE%B2-%E9%87%91%E8%9E%8D%E7%9A%84%E5%AE%8F%E8%A7%82%E5%9F%BA%E7%A1%80-%E5%AE%8F%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%88%86%E6%9E%90II.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC05%E8%AE%B2-%E5%AE%8F%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%88%86%E6%9E%90II.png" alt="思维导图"></p>
<h1 id="第05讲-宏观经济分析ii-基于债务和信用周期-的分析框架">第05讲-宏观经济分析II-“基于债务和信用周期”的分析框架</h1>
<h2 id="信用与借贷">信用与借贷</h2>
<h3 id="信用就是债务">信用就是债务</h3>
<h3 id="信用产生借贷">信用产生借贷</h3>
<ul>
<li>源于人性的懒惰与贪婪</li>
</ul>
<h3 id="借贷产生周期">借贷产生周期</h3>
<ul>
<li>支出曲线围绕收入曲线波动</li>
<li>微观周期-&gt;宏观周期</li>
</ul>
<h3 id="人性">人性</h3>
<ul>
<li>人性分类
<ul>
<li>黄赌毒</li>
<li>虚荣</li>
<li>懒惰</li>
<li>贪便宜</li>
<li>窥伺隐私
<ul>
<li>八卦</li>
</ul>
</li>
<li>群体心理
<ul>
<li>跟风</li>
<li>贪婪</li>
<li>恐惧</li>
</ul>
</li>
</ul>
</li>
<li>对自己反人性</li>
<li>对别人顺人性
<ul>
<li>靠“性”发家：陌陌，腾讯摇一摇，漂流瓶</li>
<li>美图秀秀利用“虚荣心理”，懒惰</li>
</ul>
</li>
</ul>
<h2 id="货币的派生">货币的派生</h2>
<h3 id="货币的锚">货币的锚</h3>
<ul>
<li>商品（黄金）为锚</li>
<li>美国国债为锚
<ul>
<li>法币体系=国家信用为主的货币发行体系</li>
<li>08年后中国出口↘开始创造MLF等工具为锚</li>
</ul>
</li>
</ul>
<h3 id="货币投放量-基础货币-货币乘数">货币投放量=基础货币*货币乘数</h3>
<ul>
<li>货币乘数=1/存款准备金率=1/10%=10
<ul>
<li>什么是准备金率？ - DONT的回答 - 知乎 <a href="https://www.zhihu.com/question/19944185/answer/127102406" target="_blank" rel="noopener">https://www.zhihu.com/question/19944185/answer/127102406</a></li>
</ul>
</li>
<li>1 央行发布基础货币</li>
<li>2 商业银行抵押债券获得基础货币</li>
<li>3 银行留下准备金，进行贷款</li>
<li>4 经济主体获得贷款
<ul>
<li>投资</li>
<li>发工资</li>
</ul>
</li>
<li>5 经济主体的钱再次回到商业银行</li>
<li>6 商业银行继续放出贷款，派生货币</li>
<li>7 直至达到理论货币投放量最大值</li>
</ul>
<h3 id="影响因素">影响因素</h3>
<ul>
<li>基础货币发行量
<ul>
<li>MLF, SLF</li>
</ul>
</li>
<li>货币乘数
<ul>
<li>降准=降准备金率</li>
</ul>
</li>
<li>派生渠道影响货币乘数
<ul>
<li>影子银行（被打掉）</li>
<li>同业银行(小银行借大银行)渠道（包商银行事件）
<ul>
<li>影响实体经济</li>
<li>影响小银行信用</li>
</ul>
</li>
</ul>
</li>
<li>个人借贷意愿
<ul>
<li>利率↗存款↘贷款↘-&gt;货币派生↘</li>
<li>房市作为贷款抵押物，限购-&gt;贷款↘-&gt;货币派生↘</li>
</ul>
</li>
</ul>
<h3 id="央行调节手段">央行调节手段</h3>
<ul>
<li>
<p>货币政策</p>
<ul>
<li>
<p>量(影响总量)</p>
<ul>
<li>中期：MLF、TLF （到期不续，央行收回资金，相当于缩表）</li>
<li>基础货币、降准/升准、OMO（Open market operation）</li>
<li>短期：正回购(央行向市场购卖债券收现金)/逆回购(央行向市场购买债券释放现金)，调节短期利率，例如7天</li>
</ul>
</li>
<li>
<p>价(改变资金价格，影响借贷成本)</p>
<ul>
<li>利率-&gt;个人借贷意愿</li>
<li>利率-&gt;金融资产的机会成本</li>
<li>利率↗金融资产/股票价格↘ 在加息的周期中，最终是没有牛市的</li>
</ul>
</li>
</ul>
</li>
<li>
<p>财政政策</p>
<ul>
<li>税收： 降税促消费</li>
<li>支出： 增加财政赤字-&gt;发行定向国债，做基建-&gt;变相吸收了房地产资金</li>
</ul>
</li>
</ul>
<h2 id="去杠杆">去杠杆</h2>
<h3 id="杠杆率-总债务-总收入-总债务-总债务-总资产-总债务-总产出">杠杆率 = 总债务/（总收入+总债务） = 总债务/总资产 = 总债务/总产出</h3>
<ul>
<li>我有60元，借了40元，杠杆率 = 40/（40+60）</li>
</ul>
<h3 id="宏观杠杆率从08年不断上升">宏观杠杆率从08年不断上升</h3>
<p>4W亿</p>
<ul>
<li>国家</li>
<li>企业</li>
<li>个人</li>
</ul>
<h3 id="杠杆率-一定程度-经济崩溃">杠杆率↗一定程度-&gt;经济崩溃</h3>
<ul>
<li>连贷款利息都付不起了</li>
<li>违约</li>
<li>银行坏账</li>
</ul>
<h3 id="降低杠杆方法">降低杠杆方法</h3>
<ul>
<li>降低开支：缩
<ul>
<li>开支 = 收入+借贷</li>
<li>↘开支-&gt;别人收入↘</li>
<li>↘借贷  分子↘分母↘ (分子降低的程度&gt;分母) -&gt; 杠杆率↗  40/（40+60）-&gt; 30/（30+60）</li>
</ul>
</li>
<li>债务重组：缩
<ul>
<li>↘本金</li>
<li>↘利息</li>
<li>延期支付</li>
</ul>
</li>
<li>财富再分配：缩
<ul>
<li>国家通过税收将富人的钱-&gt;穷人</li>
</ul>
</li>
<li>发行更多货币：扩</li>
<li>收缩手段要和扩张手段一起使用，对冲经济下滑的风险</li>
</ul>
<hr>
<h1 id="我的想法和知识补充">我的想法和知识补充</h1>
<ol>
<li>
<p>什么是准备金率？ - DONT的回答 - 知乎 <a href="https://www.zhihu.com/question/19944185/answer/127102406" target="_blank" rel="noopener">https://www.zhihu.com/question/19944185/answer/127102406</a></p>
</li>
<li>
<p>什么是<a href="https://wiki.mbalib.com/wiki/%E8%B4%A7%E5%B8%81%E4%BE%9B%E5%BA%94%E9%87%8F#_note-0" target="_blank" rel="noopener">货币供应量</a>M,M1,M2？</p>
</li>
</ol>
<p>2001年中国人民银行修订货币供应量统计口径，我国现行对货币层次的划分是：[1]</p>
<p>M0=流通中现金<br>
狭义货币（M1）=M0＋可开支票进行支付的单位活期存款<br>
广义货币（M2）=M1＋居民储蓄存款＋单位定期存款＋单位其他存款＋证券公司客户保证金<br>
　　另外还有M3=M2+金融债券+商业票据+大额可转让定期存单等；</p>
<p>其中，M2减M1是准货币（Quasi-money），M3是根据金融工具的不断创新而设置的。</p>
<p>M1反映着经济中的现实购买力；M2不仅反映现实的购买力，还反映潜在的购买力。若M1增速较快，则消费和终端市场活跃；若M2增速较快，则投资和中间市场活跃。中央银行和各商业银行可以据此判定货币政策。M2过高而M1过低，表明投资过热、需求不旺，有危机风险；M1过高M2过低，表明需求强劲、投资不足，有涨价风险。</p>
<ol start="3">
<li>金融机构的去杠杆化以及杠杆率是什么意思？<br>
<a href="https://www.zhihu.com/question/20979324" target="_blank" rel="noopener">https://www.zhihu.com/question/20979324</a></li>
</ol>
<p>English Terms | 英名名称 | 中文翻译 | 详细解释<br>
---------|----------|---------<br>
M1 | Money Supply definition 1 | 货币供应量M1 | 货币供应的一种，包括所有实质金钱，例如纸币与硬币，也包括活期存款，即支票户口及即期户口<br>
M2 | Money Supply definition 2 | 货币供应量M2 | 货币供应的一种，包括货币供量1，加所有定期存款、储蓄存款及非机构性货币市场基金<br>
M3 | Money Supply definition 3 | 货币供应量M3 | 货币供应的一种，包括货币供应量2，加所有大额定期存款、机构性货币市场基金、短期购回协议，以及较大型流通资产</p>
<hr>
<h1 id="完整音频转文字：">完整音频转文字：</h1>
<p>第五讲带来宏观经济分析的第二个框架，我称之为“基于债务和信用周期”的分析框架，其主要思想和逻辑来自达理奥的分析框架。达理奥有专门讲解到如何理解和应对债务周期的书，书的内容非常多，其实我们只用理解其中核心的东西，并且与生活中宏观的实际情况进行结合，这些简单的框架其实已经够用了。</p>
<blockquote>
<p>关于达理奥，大家可能可能不能陌生，他去年在中国有一本非常火的书《原则》，但这本书讲投资的内容不是特别多，他其他讲投资的书大家感兴趣可以下载来看。</p>
</blockquote>
<h2 id="什么是信用">什么是信用</h2>
<p>我们在讲债务和信用之前，先讲其微观基础。首先就要明白“什么是信用”，信用在金融、经济领域有非常专业的含义，并不是指一个人在生活当中信用如何，讲不讲信用，芝麻信用等。虽然也有一些联系，本质上也是一回事，但是在金融上信用指一个人按期还钱的意愿与能力。信用甚至还是货币体系上的一部分钱，跟债务、跟借贷相关的一个东西。很专业的债券分析的报告就有专门的信用研究，研究债券的发行主体有什么信用风险，这个信用风险应该如何定价，因此会看到不同的债券公司债券利率是不一样的，因为就是对应了不同的信用风险，我们有个很耳熟的名词就是无风险收益率。什么是无风险收益率呢，就是没有违约的信用风险。债券信用对应的信用风险，就是不还，还了就是信用。还有一种说法就是银行里面的钱，我们叫信用货币。现在钱很多时候是以债务的形式存在的，因为我们存的钱，银行会贷出去，这些贷款就是银行的资产，就是借钱人的债务。资产和负债，以后我们会在财务报表、资产定价（债券定价）里详细去讲。这里我介绍这一框架前，先简单介绍信用，了解其微观基础，信用为什么会产生，借贷行为为什么会产生。</p>
<h2 id="人性-v2">人性</h2>
<p>这个就涉及到人性，就是人的本能，human nature，出生时就应该是这样的。比如说吃、对异性的生理需求，这些都是人的本能如此。同样，你给别人钱别人就会愿意要，所以有些人能借，他就会有冲动想借。借了之后就会借的越来越多，这就是人的本性。所以，第一部分先介绍人性的概念。这个概念对我来说比较有意思，因为在我自己的工作中，不管是做投资交易还是写公众号，或是之前互联网创业的尝试，不管哪个领域，我发现人性都是理解社会运转的一个核心概念。私下我有一句话被很多人都有引用，就是“控制了人性就是控制了世界”。还有两句话我觉得非常有用，就是想在社会中稍微想做出一点事情来，你要成事就要注意两句话，一个就是“对自己反人性”，就是很多时候要做不让自己那么舒服的事情，比如说阅读、克服感性投资思维、运动、不刷手机，这些都是反人性但是对人成长很有必要的事情，对自己要多做一些反人性的事情。还有一个就是“对他人顺应人性”，顺应他们的人性。如果同时做到的话，就能成事。成事的大小，就要看宏观、运气等因素了，是自己掌控不了的。顺应人性其实有很多典型的案例，比如说互联网时代出现了很多商业模式和产品，像外卖就是顺应了懒人的懒惰的人性，因为不用走路。社交就顺应了很多对于勾搭异性的人性。美图秀秀和朋友圈，就顺应了大家去秀自己的，展示更美一面给大家的人性。</p>
<h3 id="性">性</h3>
<p>我总结下来，通常有几大类的人性：第一个最原始的冲动就是性（sex）,关于性其实是很多产品的原始驱动力。比如黄色网站，全世界不需要运营投入，就能源源不断带来收入的行业就是“黄赌毒”，而黄是第一位的，性是人类发展生生不息的最原始动力。很多产品看起来阳春白雪，但背后用了很多相关的运营技巧和方法，甚至是产品特设计上都有应用。比如微信前两年的增长是非常缓慢的，然后语音的推出有了增长，然后又是摇一摇，我记得很清楚，身边同事都在摇，因为有的时候摇到一个女的，心理感受就会很不一样。所以它也利用了性这个人类很原始的欲望。甚至陌陌一开始就是利用这个做为产品卖点，后来就上市获得很多亿的市值，后来包括像漂流瓶等功能，所以这些都是以性为起点，然后慢慢发展起来的。所以大家有没有发现，在互联网社交产品这个门类里，他本身有两大驱动力都是跟人的本性直接挂钩的，一个叫做性，一个叫做虚荣。性，你同样可以在美国很多产品的发家史中看到，比如说比较火的Facebook，Snapchat，他都是从美国校园出来的。为什么从校园里面出来，因为大学生生理状态是处在荷尔蒙最旺盛的时期，对异性的渴求是旺盛的，所以这就是为什么社交产品总是从20岁左右的校园诞生，最后火起来，而不是5060岁那些人群中，这是因为对于不同人群，对于性的需求是不一样的。年轻人更容易去勾搭异性，促成社交产品的诞生，最后暴发，这是第一个就是性。性还有很多应用，比如很多门户网站打开后，就会有很多性暗示，文字图片什么的，美女、女神等都是广泛跟性相关的一些暗示跟手法，还有就比如你看为什么刷抖音，一大类小视频就是看各种美女美腿大胸这种。还有就是微信公众号，比如被封的第一大号咪蒙就是喜欢起一些包含人性段子的标题，虽然从道德角度比较低俗，但是从商业上来看就是快速聚集人群很有力的一个工具。大家可以客观看待。</p>
<h3 id="虚荣">虚荣</h3>
<p>第二个就是虚荣，刚才在聊社交产品就提到，性和虚荣是两大底层驱动力。比如说微信、Facebook，在朋友圈里秀就是要选好角度拍摄、再精选、再P图，最后期待人们的点赞和互动，期待别人认可的一种虚荣心理。美图秀秀就是倚靠人们的虚荣而支撑起的一个上市公司，就是不断的放大虚荣的人性。</p>
<h3 id="懒惰">懒惰</h3>
<p>当然美图秀秀还满足了一个人性，就是懒惰。美图秀秀就是最简单的PS，满足了人们的懒惰。</p>
<h3 id="贪图小便宜">贪图小便宜</h3>
<p>第四个就是贪图小便宜的心理，这就是各种折扣满足了人们的本性，比如双11，618，都是打的人们贪图便宜的心理，特别是三四五线城市的老人家，中老年妇女喜欢商场里面搞活动，希望把小便宜据为己有。这个庞大人群在商业上有特别独特和广大的价值。</p>
<h3 id="窥探隐私">窥探隐私</h3>
<p>还有一个就是窥探隐私，这个也很明显，很多解密、八卦、离婚就很快能变成热搜，虽然很不好，但是满足了人们这个人性。但人们的本性就是喜欢去窥探别人发生了什么。比如说，有天看到《秦小明》不为人知的秘密，大家肯定都会去点击，虽然跟你一点关系都没有。但是大家还是都有这个窥伺的心理。窥伺在商业上应用，比如相亲的APP，你想了解别人发送的信息就要付费，就会有窥探的好奇心。</p>
<h3 id="羊群效应">羊群效应</h3>
<p>还有对金融有一个比较重要的心理就是羊群效应，群体心理，看到别人怎么做自己就怎么做，这样自己就会获得安全感。当然获得安全感是很重要的，它维持了群体的稳定，是维护社会的繁衍发展的基本因素。但是如果想作为领头羊而言的话，就不能那么追求稳定，必须逆流而上，不然你就是会变成群体中的一个。关于群体心理有本书很值得去看，就是《乌合之众》，这本书非常经典。</p>
<p>因此，总结一下人性的几个东西，一个是性，一个虚荣，还有就懒惰、贪图便宜、窥伺心理、羊群心理，群体心理还可以分解出恐惧和贪婪两个分支，这个对金融市场非常重要。比如股票市场涨的非常好的时候，追逐进去就是贪婪；股票跌的非常厉害的时候，大家都很害怕，也不敢去抄底进入，这就是恐惧。什么时候不该贪婪或恐惧，这个在投资交易的过程中，对于心理的把控非常重要，很大程度上决定了你的投资收益。以上就是所说的关于人性的东西，大家可以多去研究研究，非常有意思，有时候搞透了可能比学习金融知识更加有用，因为这对思维层次上有很大的改变，可以帮助你怎么去认识社会、商业的规律、产品的本质（比如电商、工具类），这些东西可以让你更清晰的看到本质上规律的东西，如果你能把这些东西运用的话，你会发现不一样的感觉，就是怎么能把自己变的更好，怎么样变得更快。怎么能利用这个东西，为自己带来更多的收益和收入。所以，这就是人性。</p>
<blockquote>
<p>索罗斯是利用人性的大师</p>
</blockquote>
<h3 id="人性跟债务周期有什么关系">人性跟债务周期有什么关系</h3>
<p>但人性跟我们说的债务周期有什么关系呢？这就是我们要说的借贷，以及人性中的贪婪和恐惧。只要我的收入不能覆盖我的支出的时候，我就要去借贷，信用卡就是最简单的一种模式。收入1W，支出1W5，那你就可以通过信用卡透支5k，这5k就是一种债务和信用。这种想用就会有的可得性，会让人们上瘾，就是所谓的贪婪、懒惰。希望不劳而获，希望天上掉馅儿饼，很多同学也是希望通过听完这门课，就能变成高手，马上赚钱。看过小明推荐的书就能马上成长起来，这些就是对应了人们懒惰的心理。所以人们这些心理，当借贷变成群体行为的时候，一直不加以控制的话，就会变成债务危机。比如说在美国，发达国家就会非常明显。在中国可能没那么明显，因为中国的中坚力量70后，他们掌握了很多资源，但是他们经历过苦日子，倾向于比较节约，有储蓄意识，不会透支。但是你会发现，到后面90、00后，甚至以后出生的小孩，就会更接近于西方的那种消费方式、财富观念。他们出生时物资比较丰饶，会倾向于向未来借钱提前消费。</p>
<p>经济进入这个阶段，借贷就会变成一个相对比较上瘾的东西。靠信用维持现有的生活就是一个上瘾的东西，这是人性决定的。因为有借贷产生，就会内含了一个周期存在。比如你今天借了5k消费（收入1W，支出1W5），这一个月的支出就超过了收入。如果收入和支出各自画一条增长曲线，你就发现支出曲线是处于收入曲线上方的，因为支出大于收入。如果下月收入变成1W1，10%增长率，减除5k负债，可用支出就是6k，下个月的支出曲线就会从1W5变成6k，就会位于收入曲线下方。支出曲线就是围绕收入曲线变动正弦曲线的一个波浪线，这就是一个周期，只要有借贷和信用，就内生就蕴含了一个周期的波动。你把微观的行为进行加总，就变成了宏观的经济周期波动。宏观的一个企业、一个产业、一个国家都一样，只要借了钱就有更多钱可以用，支出大于收入。那为了还钱，收入就要高于支出，从支出角度来看，就一定会有波动，即周期的波动，这是非常有意思的，是微观周期的一个缩影。</p>
<h2 id="货币的派生-v2">货币的派生</h2>
<h3 id="货币的锚-v2">货币的锚</h3>
<p>讲了信用内含的周期波动之后，再来看信用和债务周期。先要理解货币体系，先看货币系统。之前在讲套利的时候讲过什么是无套利均衡，当时讲以货币为基础的货币体系，就是小明的包子，比如中央银行以包子为储备商品的发行货币的话，包子就是货币的锚，1块钱1个包子，怎么实现无套利均衡的状态。以商品为基础发行货币的话，货币是相对稳定的，不过出现过多的货币的超发与紧缩，因为始终会有一个平价对齐进行约束。比如说1块1个包子，如果超发货币的话（以商品为锚，多发1块就要储备1个包子，市场包子就会少了），市场上包子就会涨价。包子涨价（1.5），人们就会跟中央银行进行交易进行套利（用1块钱去兑付1个包子，然后市场上包子就多了，钱就变少了），套利后就导致包子价格下降。同样，如果钱印少，包子降价，紧缩带来的套利逻辑也会同样使包子重回1块钱。整个货币史，各个经济体都喜欢用黄金作为储备商品（锚）来发行货币，所以那个年代整体的通胀、经济波动都没有现在那么夸张。</p>
<p>但二战之后，百废待兴，大家都要赶快搞好经济，冲破了以黄金为约束的货币体系，就发行了很多债务，但这个债务就还不起了（包括美国也没有那么多黄金），然后就废除了以黄金为基础的货币体系，不再承诺中央银行有义务按照某种比例来进行兑换黄金。就演变成了现在的法币体系，英文叫做Faat，直白些说法币体系就是央行想怎么发钱就怎么发，以国家信用为主的货币发行体系。国家信用就是你相信国家将来会把这个钱还给你，会有履约的能力，相信就代表货币就值钱。全球货币体系都是这样，美元的发行就是以美国国债进行背书，作为锚。中国创汇实现基础货币的投放，也是锚定在美元的国债上的。先赚美元，再换成人民币，人民币再投放在国内市场上，形成了货币的流通。为什么美国的国债在世界金融体系中那么重要，其实这也是一个原因。很多经济体的货币发行，都是以美元作为中介，最后美国国债都是作为货币的一个锚。</p>
<p>美国国债是当今货币体系的锚<br>
中国除了进出口的方式赚取的外汇之外，外贸开始转向国内（之前讲过08年外贸经济熄火后），通过加杠杆的方式来增加投资，驱动经济发展。但是出口创汇能力就开始下降，外汇账款也不会之前那么多，所以我们就开始创造了很多经济工具（MLF、SLF），创造了几万亿的借贷规模。央行和商业银行之间交易，中央银行就会向商业银行发行货币，商业银行必须以一些债券进行抵押给央行，然后商业银行将这些货币再通过贷款借给企事业等经济主体，实现整个经济的扩张更流通。所以，我们的货币系统就是这样的。</p>
<blockquote>
<p>简单来讲，一个国家的货币的派生基本原理是这样的：央行以债券为锚向商业银行投放基础货币，商业银行按照规定留一部分（存款准备金）再放贷给经济主体，经济主体拿着贷款进行生产活动/发工资等再次回到银行变成存款，存款再变成贷款不断的循环往复，这笔钱就不断的成倍放大。</p>
</blockquote>
<p>一笔金属货币会变成多少社会上流通的货币资金呢？基本的公式就是金属货币*货币乘数，这个乘数等于存款准备金的倒数。货币乘数是理论上的，会受到一些实际情况的影响，商业银行在不断存贷的过程中，主体意愿非常重要，比如有些工厂可能贷款出来就不再存入，就不再派生了。也可能也跟国家政策相关，利率较高时会影响贷款增加，降低货币乘数。比如房地产贷款，贷款要有抵押物，房地产贷款限制也会降低了流畅性，降低了乘数，也就是降低了整个国家的信用，所以房地产供应是跟货币相生相惜的过程，既是结果，也是原因。因为在中国经济体系中，房子在整个信用派生的过程中，成为了一个非常重要的抵押物，甚至可以看成唯一的最大的一个抵押物。因此冻结房子，然后限购限售，货币供应速度就下降（M2），货币增速就下降，很大是因为房地产调控。为什么会这样，货币派生有些过程就被切断、降低了，乘数下降。这是就是货币派生的一个过程和基础逻辑。</p>
<blockquote>
<p>货币乘数公式<br>
有些自媒体说中央银行投放XX亿MLF，是要大放水了，这个逻辑是非常不严谨的。你要观察货币是否有增加，货币乘数是否变化了。过去两三年，基础货币投放有增加（降低基础准备金，降准），但是金融数据中的M2有时候不但没有增加，还在下降。所以降准并非是大放水，因为降准只是货币派生流程中一个环节，他并不能保证所有环节都是畅通的，最多导致水是流的出来的。可能投出了MLF，基础货币，但是其他货币派生渠道可能变得更加严格。比如17年后资管新规出来后，影子银行（资金通过信托方式进入社会）这个渠道就打掉了，这部分派生渠道就被堵死了；资管新规下，尽管基础货币增加了，但是由于渠道受限制，信用货币还是不增返降。所以，降准不一定代表着放水。最近我们看到股票债券市场，会发现银行间的资金比较多，目的是为了缓解小银行的流动性危机，因为前一段包商银行引发了小银行信用危机。</p>
<p>小银行一般没有渠道获得存款做业务，就像大银行借钱，给出大银行比较高的收益率（同业业务）。小银行借出来后，投资管理失误，错配严重出现坏账，那就只能中央银行出面擦屁股。但是随着这个问题越来越大，中央银行就决定改变打破刚兑，让银行自己承担坏账，就引发小银行的信用危机，大银行开始不愿意借钱给小银行。小银行没有钱就很困难，派生渠道受损，央行就要想办法发钱缓解，但这些钱并没有流入到实体经济当中，因此包商对中国实体经济影响比较严重。</p>
<p>小银行与地方基建、房地产都有很多关系，如果大银行同业业务渠道出现问题后，信用创造就会出现问题。最后，信用体系就会发生收缩，最近股票市场表现不好很大部分因为这个。因为它影响了金融体系的稳定性，也影响实体经济获取资金的通道，即货币供给的问题。货币供给=基础货币*货币乘数。</p>
<p>包商银行银发信用危机<br>
信用派生，其实对应了货币政策。货币政策在准备金上量的政策，总量上的变多的变少，比如常用工具OMO,逆回购。逆回购是向市场投放货币的短期行为，购买债券，支付货币。正回购是操作债券，收回货币的行为。回购是短期利率的工具（7天、隔夜）。MLF，就是中长期的。还有很多工具，TMLF（Target）特殊抵押物换取资金投入到社会。还有就是存款准备金率，降准货币乘数变大，18年就降准很多次。</p>
<p>可以把准备金就是一个池子，控制这个池子可以使用很多工具，18年降准就是对冲很多要到期的MLF，债券，进而避免基础货币的收缩，因为基础货币收缩，会导致信用派生的收缩。美联储缩表就是信用派生的收缩，美联储当初做量化宽松，买了很多债券，到期之后就要把债券抛售，债券收回来，进行缩表。如果到期后，进行降准，就释放了一些基础货币出来，通过派生让更多信用产生，一增一减进行对冲，因此降准未必是大放水，不要人云亦云。</p>
<p>除了量的政策，还有价的政策，就是改变资金的价格，影响借贷成本。主要工具就是利率。利率会有很多体系在里面，因此这里不讲太复杂，理解利率是如何影响宏观、投资、消费、货币供应的。利率影响借贷成本，进而借贷意愿，意愿强货币派生更容易。因此中央银行，通过控制利率来影响货币。经济不好的时候，会进行降息，刺激借贷意愿，增加货币派生。经济过热，就会收缩借贷意愿，收缩信用。利率还会影响资产的价格，是所有金融资产的“机会成本”。从此来看，利率提高，投资要求更高的回报，价格就会降低，来降低成本。加息周期中不容易出现牛市。因此美联储就比较纠结，加息降温就容易搞崩经济。美国的经济周期与利率调控周期相关比较高。以上就是货币政策。</p>
<p>2019年8月1日，美联储宣布降息25基点至2%-2.25%<br>
除此还有财政政策。比如税，美国和我们都减税，刺激消费。还有就是财政部安排资金赤字率，发行国债来支持重点项目。中国的货币政策有很大约束（通胀3.0后就很难降息），只能通过减税来激发消费活性，专项债新规（重点项目资本金）等财政工具进行调整。</p>
<p>最后讲一个去杠杆的问题。杠杆就是我的负债，如果我有50，借了50。100/50=2,我就是有2倍的杠杆。从宏观上来讲，4w亿开启了加杠杆周期，国家部门，企业部门，居民部分轮番加。3个部门杠杆率就是宏观杠杆率。房地产库存问题，居民买房加了一些。基建，国家和企业加了很多杠杆。债务堆积到了一个阶段（宏观杠杆率），经济就开始崩溃，借的钱开始还不上了（总支出=信用+总收入）。有时连利息都还不上，只能违约。一个人的支出就是别人收入，你还不上钱，就有人没有收入再放贷，循环就打破，出现连锁反应。违约人多了，经济系统就崩溃。国家在管理经济的时候，都要竭力避免杠杆率不要达到那个水平，所以现在就要降杠杆，17年最为典型。杠杆率=总债务/总收入，降杠杆就要降低信用/债务，提高总收入/产出。</p>
<p>任泽平：当前中国宏观杠杆率总水平较高<br>
达里奥总结了4种方法，其实就是公式里的降低分母提高分子，从数学上非常简单。第一种，削减确认开支，开支=收入+信用，支出变少债务变少。但是支出是另外的人的收入，另一部分人收入会变少，传递下去，整个社会的信用会坍缩。只缩减开支，那分子速度慢一些，分母会更快，整体杠杆率还是上升的。第二种方式是债务重组，降低本金、降低利息、延期支付。包商银行，超过5千万的项目就要这样安排，效果也等同削减开支。第三种通过顶层调控财富再分配，因为主要是穷人还不起钱，可以通过税收的方式转移给穷人，但这个效果也等同削减开支。第四种债务货币化，用的比较多。央行印钱把债务买过来，美国的QE就是这样。因为前3种效果都一样会使收入比支出掉的更快，更像是做手术。央行发更多货币出来，来对冲前3种造成的收缩效应，就像手术前的麻药。如果几种方式配合比较好的话，就可以去杠杆也不造成通货膨胀。目前中国就是在缩跟胀之间保持平衡。</p>
<p>债务跟信用框架理解起来很简单。用最基础的第一性原理就很简单。理解去杠杆，就可以理解什么是杠杆，杠杆公式是什么。为什么去杠杆，肯定是杠杆分数太大了，如何降低分数，就要降低分母，提高分子，或者同时。去杠杆过程会导致资产价格降低，因为信用紧缩。央行会注入货币，让资产价格上升，整个过程就是震荡。如果去杠杆完成，经济向好，资产市场才会走出牛市。之前美国就是08年暴力去杠杆，把坏账抹平重组，美联储没有QE，因此比较痛苦形成金融危机，后续出现QE对冲，降下来杠杆后，就形成了10年左右的牛市。中国想避免08被动去杠杆，因此就是用策略进行主动去杠杆。</p>
<p>关于宏观还有很多，比如各种讲周期的理论。都是框架，理解宏观最核心的还是这些变量。第一性原理就是从定义出发，进行演绎推理，然后再串联起来。后面讲资产定价，你会发现宏观微观、会计定价都会串联起来。后面讲完你就会发现是连在一起的，所以还是要把这些理解。</p>
</blockquote>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>6秦小明-新金融思维训练笔记第06讲-金融的财务会计基础I-商业分析的演绎框架</title>
    <url>/6%E7%A7%A6%E5%B0%8F%E6%98%8E-%E6%96%B0%E9%87%91%E8%9E%8D%E6%80%9D%E7%BB%B4%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0%E7%AC%AC06%E8%AE%B2-%E9%87%91%E8%9E%8D%E7%9A%84%E8%B4%A2%E5%8A%A1%E4%BC%9A%E8%AE%A1%E5%9F%BA%E7%A1%80I-%E5%95%86%E4%B8%9A%E5%88%86%E6%9E%90%E7%9A%84%E6%BC%94%E7%BB%8E%E6%A1%86%E6%9E%B6.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/%E7%A7%A6%E5%B0%8F%E6%98%8E%E7%AC%94%E8%AE%B0/%E7%AC%AC06%E8%AE%B2-%E5%95%86%E4%B8%9A%E5%88%86%E6%9E%90%E7%9A%84%E6%BC%94%E7%BB%8E%E6%A1%86%E6%9E%B6.png" alt="思维导图"></p>
<h1 id="商业分析的演绎框架">商业分析的演绎框架</h1>
<h2 id="上节补充：财务政策">上节补充：财务政策</h2>
<h3 id="国家预算收与支">国家预算收与支</h3>
<ul>
<li>收入：税收相关政策：减税</li>
<li>支出：财政赤字相关政策：地方债</li>
</ul>
<h3 id="调节作用">调节作用</h3>
<p>相较于货币政策</p>
<ul>
<li>调节收入分配结构</li>
<li>调节资金在不同行业中的分配</li>
</ul>
<h3 id="调节空间">调节空间</h3>
<ul>
<li>
<p>首要目标</p>
<ul>
<li>并不是支撑国家经济发展，而是保持财政纪律，可持续</li>
</ul>
</li>
<li>
<p>收入和支出合理的匹配，控制赤字率</p>
<ul>
<li>支出不能超过太多收入</li>
<li>赤字率过高-&gt;财政脆弱，不可持续
<ul>
<li>97年亚洲金融风暴，索罗斯狙击泰铢，做空英镑
<ul>
<li>因为泰国财政赤字率太高，不足以持续性覆盖支出，发生了债务危机</li>
<li>国家信用⤵，汇率⤵贬值比较厉害。</li>
</ul>
</li>
<li>经济⤴收入⤴赤字率⤵汇率⤴</li>
</ul>
</li>
</ul>
</li>
<li>
<p>国家的支出立法，形成预算法</p>
<ul>
<li>安排下一年财政调配</li>
</ul>
</li>
</ul>
<h2 id="研究思路">研究思路</h2>
<h3 id="演绎法-deduction">演绎法（deduction）</h3>
<ul>
<li>从根到叶</li>
<li>第一性思维原理：马斯克</li>
<li>从一个点不断推导和论证</li>
<li>适合创新，事物本质</li>
<li>风险：推演过程是否合理？</li>
<li>例子
<ul>
<li>马斯克要造特斯拉的时候，一开始的问题就是电池成本昂贵，如果归纳法就可能造不下去，因为同期行业公司的电池就是很昂贵；而马斯克就是从做电池出发，分解出很多化学元素的成本，看看那些什么方法可以减少成本，层层分解，把成本结构进行优化，最后特斯拉的电池要比市面上的成本效率都低很多。如果只是靠类比的话，这个项目就放弃掉了。</li>
<li>乔布斯认为不需要做市场调研</li>
</ul>
</li>
</ul>
<h3 id="归纳法-induction">归纳法（induction）</h3>
<ul>
<li>从叶到根</li>
<li>简单，省时省力</li>
<li>早期市场可能成功，成熟市场必然失败</li>
<li>风险：假设现存的东西是相对合理的</li>
<li>例子：研究公司/行业
<ul>
<li>比如你研究一款社交app，就可以参考微信、Facebook是什么功能、布局、特征，然后用这些特征作为参考系，锚定在上面设计产品</li>
<li>比如互联网公司小明共享单车，你要做的他公司研究，比较直接的方法就是去研究摩拜等单车的模式，通过研究同行业的类别，得出结论小明的单车值不值得投资</li>
</ul>
</li>
</ul>
<h3 id="完整分析框架中">完整分析框架中</h3>
<ul>
<li>推导过程靠演绎</li>
<li>数据靠归纳</li>
</ul>
<h2 id="推演是否值得投资某家公司">推演是否值得投资某家公司</h2>
<h3 id="为了赚钱-max-p1-p0">为了赚钱 max(p1-p0）</h3>
<h3 id="企业业绩是否能够持续成长">企业业绩是否能够持续成长</h3>
<h3 id="盈利-收入-成本-增长如何">盈利=收入-成本 增长如何</h3>
<ul>
<li>收入分析
<ul>
<li>不同产品带来收入比例，利润率
<ul>
<li>例如星巴克的产品，有咖啡、面包、蛋糕等，他的利润率最高的还是咖啡</li>
</ul>
</li>
<li>收入=产品销量数量*价格
<ul>
<li>价格弹性
<ul>
<li>价格⤵销量⤴很少-&gt;价格弹性低（刚性需求）；价格⤵销量⤴很多-&gt;价格弹性高</li>
</ul>
</li>
<li>定价-&gt;max(产品销量数量*价格)</li>
</ul>
</li>
<li>地域、人口特征
<ul>
<li>苹果就会分美国市场、中国市场、欧洲市场，中国市场贡献了更多的边际收益</li>
</ul>
</li>
<li>案例1：互联网游戏公司
<ul>
<li>付费用户数（100w）* 人均付费额/付费单价（ARPU)（1k）= 收入（10个亿）</li>
<li>在线用户总数,代表[市场占用率]</li>
<li>ARPU代表[忠诚度],忠诚度⤴越容易付钱</li>
<li>付费用户数/在线用户总数=转化率
<ul>
<li>代表[用户粘性]，粘性⤴就越容易付钱</li>
</ul>
</li>
<li>用户数可以分为注册用户、付费用户等用户漏斗</li>
</ul>
</li>
<li>案例2：公众号
<ul>
<li>有多少用户、活跃多少、付费多少</li>
<li>公众号收入提升就是要提高粉丝、提高打开率、提高单个用户的付费金额、提高活跃用户的付费转化</li>
</ul>
</li>
</ul>
</li>
<li>影响收入因素
<ul>
<li>研究行业，市场规模
<ul>
<li>收入有市场规模的天花板</li>
</ul>
</li>
<li>市场领头羊可以享受市场溢价
<ul>
<li>非绝对垄断市场，第二第三者的估值有可能更高，因为可能比第一名增长更快</li>
<li>阿里在如此规模下，还能够实现每年50%以上的增长</li>
</ul>
</li>
<li>市场分散时
<ul>
<li>优势
<ul>
<li>有整合的可能</li>
</ul>
</li>
<li>劣势
<ul>
<li>差异大，难找到共同点</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>成本分析
<ul>
<li>主营业务成本（可变成本）
<ul>
<li>直接与收入相关的成本</li>
<li>反映毛利=收入-主营业务成本</li>
</ul>
</li>
<li>运营成本（固定成本）
<ul>
<li>非直接与收入相关的成本</li>
<li>反映企业经营效率</li>
<li>经营杠杆：生产量⤴分摊的固定成本⤵
<ul>
<li>即便亏损，也要不停产。固定成本60w,生产50w,亏10w.如果不生产，亏60w.</li>
</ul>
</li>
<li>停止营业点
<ul>
<li>收入可以cover 固定成本</li>
</ul>
</li>
<li>盈亏平衡点
<ul>
<li>收入可以cover 可变成本 + 固定成本</li>
</ul>
</li>
</ul>
</li>
<li>不同行业有不同成本结构
<ul>
<li>新兴科技行业
<ul>
<li>前期成本巨大
<ul>
<li>吃下市场份额</li>
<li>降低边际成本</li>
<li>收入快速增长</li>
</ul>
</li>
</ul>
</li>
<li>传统行业
<ul>
<li>规模扩张⤴成本⤴</li>
<li>收入增长与GDP增速接近</li>
<li>只有降低成本来提高盈利
<ul>
<li>裁员</li>
<li>资产重组，置换</li>
<li>不良资产剥离</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="我的想法和知识补充">我的想法和知识补充</h1>
<p>累，没想法。。。</p>
<h1 id="完整音频转文字">完整音频转文字</h1>
<blockquote>
<p>在讲本节课之前，补充一点内容。上一节课中货币派生中，财政政策没有详细来讲，财政政策就是关于国家的预算的收跟支。预算收入相关的，比如中美都进行了减税；关于预算支出，跟财政赤字相关，就是发行的地方债。这些都算财务政策。财政政策相较于货币政策，更多是在于调节收入分配结构，调节资金在不同行业中的分配，以激发/抑制行业发展。重税免税就是很典型的财政政策。</p>
<p>很多人问财政政策的空间有多少？目前来看也不是那么大。所有国家的财政政策都受到财政赤字的约束，国家财政首要目标并不是支撑国家经济发展，而是保持财政纪律。因为收入和支出要合理的匹配，不是说完全相等，但支出不能超过太多收入，这就是所谓的控制赤字率。赤字率过高会导致财政比较脆弱，不可持续。财政从各个主体部门征收税收，以此作为收入基础，维持政府开支、基础建设，如果税收不足支撑支出，就会形成债务堆积和恶化，很多国际因此就爆发货币危机。比如97年亚洲金融风暴，索罗斯狙击泰铢，就是因为泰国财政赤字率太高，不足以持续性覆盖支出，发生了债务危机，国家信用就受损，国家货币就贬值比较厉害。92年索罗斯做空英镑，因为跟此有很大关系。</p>
<p>汇率是跟国家基本面挂钩的，经济越强劲，货币就是处在升值的过程当中；如果国家经济强劲，收入来源也会强，导致赤字率可控。反之经济不行，政府就要靠发债来维持行业发展，导致政府开支超过可持续水平，最终债务的脆弱性就会发生违约，对应货币贬值，类似案例包括08的拉美债务危机、阿根廷、土耳其的问题。这跟外汇储备联系在一起，导致贸易会不平衡，出口小于进口，出现贸易赤字，导致国家支出更多的钱，也是一种负债。这个负债不可持续，货币也会贬值，就给索罗斯很多机会去做空。考察财政政策，就是要维持纪律，不能想花多少就花多少钱。各国家的支出都是要立法之后，形成预算法，通过下一年的安排，才能进行财政调配。</p>
<p>现在中国政府债务包括两部分：中央政府、地方政府的负债。地方政府的负债可以在网上查到公示，但是地方政府会有隐形债务，中国的地方债其实非常高，有几十万亿。这就制约了政府进一步加杠杆，有时候看政府公布的经济数据，基建这一块就体现在固定国定资产投资，制造业投资、房地产投资、自由设施投资。我们看到基建投资的增速，一直处在一个下滑的趋势当中。人们觉得房地产控制住，基建是不是能补短板，所以6月份通过了专项债新规，地方债约束做了一些放宽。但是这个大家也不能抱太多希望，因为财政目标是可持续性，不是可以无限制的拉基建。我们通过财政政策去刺激经济，对冲房地产下滑的投资是有可能，但也不能太乐观。</p>
<p>我们前面经济分析模块基本是结束了。一开始从微观经济学开始，重点讲了成本概念和分析框架；到了宏观经济学，讲了凯恩斯的分析思路和一些核心变量，gdp 就业等；又讲了信用与货币衍生的框架以及相关调控政策。至此，经济分析就告一段落，但经济分析中很多的知识，后面在讲资产定价的时候会反复用到，如果有时间的话，还是希望能反复来听，这样后面的课才能融汇贯通。我们设计课程，每个模块相互独立，但又有千丝万缕的关系。这些都理解了，才能做出一个比较好的资产定价。</p>
<p>今天内容主要是商业分析的演绎框架，这是我自己总结出来的一个十分有用的框架。第一大家要了解，在研究问题的时候有两种思路，一种是演绎法（deduction），一个是归纳法（induction）。从英语词根可以看到，演绎是分解，归纳是收拢。演绎就是说去推理去研究问题，就是从一个点不断推导和论证，抽丝剥茧的把问题逐步搞清楚，从前提而必然得出结论的推理过程，从假设出发运用知识来推导出其他命题的过程。这个在物理学用的比较多，有专门研究的把他称之为物理学第一性思维原理，就是我们反复强调的第一性思维原理。很多时候，在投资研究、做研究、做公众号写文章、讲课定大纲、讲课方式、生活中的问题，就会不自觉运用这个思维原理。这个是马斯克非常推崇该原理。</p>
<p>相对的归纳，就是把一个层面上的因素不断的枚举，对比进而得出结论。形象的比喻二者，一棵树，演绎就是从根部推演树干，到枝干，把树的骨架认知。归纳，就是一个枝干有什么枝条、叶子，有何异同、特征，就是在同一层级比较。</p>
<p>在做公司研究的时候，大多使用的就是归纳法。比如互联网公司小明共享单车，你要做的他公司研究，比较直接的方法就是去研究摩拜等单车的模式，通过研究同行业的类别，得出结论小明的单车值不值得投资。比如你研究一款社交app，就可以参考微信、Facebook是什么功能、布局、特征，然后用这些特征作为参考系，锚定在上面设计产品，这是典型的归纳思维。很多时候人们喜欢用归纳，比较简单省时省力。</p>
<p>反过来，演绎的方法，如果要分析要不要投资一家公司，就要一步步推演，每一步牵扯出很多问题，这个过程就是演绎的过程。比如马斯克要造特斯拉的时候，一开始的问题就是电池成本昂贵，如果归纳法就可能造不下去，因为同期行业公司的电池就是很昂贵；而马斯克就是从做电池出发，分解出很多化学元素的成本，看看那些什么方法可以减少成本，层层分解，把成本结构进行优化，最后特斯拉的电池要比市面上的成本效率都低很多。如果只是靠类比的话，这个项目就放弃掉了。而演绎的方式就是能找到一种路径去改变，比较适合创新。归纳方法很难创新，因为它有个前提假设，就是当前存在的东西是相对合理的。但有些适合并不合理，只是被动被接受。就像很早之前大家都以为地球是宇宙中心，并不是合理的。</p>
<p>在我们在生活中做很重要的决定的时候，年轻人刚毕业面临职业选择的时候，第一份工作是如何选的？第一只股票是如何选的？可能会得出一个结论，主要是通过归纳的方法得出的。比如选择一个专业和职业，就是参考身边的人是如何去做的，比如都往金融就意味着金融薪资高，都买茅台就说明茅台有价值。大家都觉得怎么样，所以我也觉得怎么样。如果是演绎方法处理去就一样。比如我要不要做金融，不应该参考别人，要来思考自己的职业目标是什么，比如是赚钱，要怎么赚，要如何产生收入，投入成本。如何产生收入，要看哪个行业产生收入更高，要看跟自己匹配不，再分解到行业、职业、职位。</p>
<p>我们会发现很多年轻人，根本不会去了解行业和职位，就看到别人好就自己挤着去。大部分同学做很多决策是经不起挑战和质疑的，答不出来就不合理，只是羊群效应趋之若鹜。自己就过得不幸福，因为与自己臆测出来的不一样，是通过别人那里参照来的。我把这称为人们痛苦来源之一，因为用归纳方法做了简单的决定，非常符合人们懒惰天性的行为。演绎就逼迫你去思考，去解决问题，去研究，去跟别人请教，才得出结论，这个事情要不要去做。</p>
<p>很多时候创业这样，之前是就是天下创业一把抄，都是抄别人的，基本大同小异。归纳有一个好处就是省时省力，最快大投入把东西做出来，问题在于没创新，或者创新很少，在成熟市场中肯定会失败。当然在早期市场可能会成功，比如早期的腾讯，在早期的互联网就获得了成功，但是现在不可能在再出现一个腾讯QQ了。除了成本小的话，成功概率比较小。</p>
<p>演绎则从底层出发，比如创业就要想这个产品如何满足人的需求。就是发现没有面对陌生人的产品，区别于微博，利用与性的本能，创新了LBS等很多功能，完全基于如何满足就近陌生人社交的需求，推演出了要有哪些功能，哪些设计。还有就是乔布斯，说很少做市场调研，因为觉得消费者很蠢，因为都是归纳思维，根据大家意见作出一个东西，虽然省时省力又很安全。但需求深入分解会有两种，一种是我意识到的，还有一种我并没有意识到的。乔布斯就说，如果你不把手机做出来，用户不知道自己需要这个手机，并且会为此发出尖叫。其实是乔布斯发现人们对美、对效率的需求，才创造出iPhone。</p>
<p>创新一定是来自于演绎的思维方式，归纳虽然安全，但是不会让你获得超额回报。演绎可能会有一些风险和问题，论证是否合理严密，但最终推出一个合理结果就有很大的可能性。</p>
<p>不仅在做产品，做投资也要有这个思维，看竞品和同行，可能是不可靠的，也是大家都知道的，比如茅台的估值应该多少倍，大家都知道，没有技术含量，没办法获得超额回报。最根本的还是要通过演绎的方法，从买股票基本的角度出发，目前贵不贵，将来在哪里卖出，而不是去类比分析。这里讲到演绎和归纳，展开了很多，就是为了让大家有一种演绎的思维习惯。</p>
<p>后面我们用商业演绎框架，来为大家示范一下，什么是演绎框架。还是回到最初的问题？这家公司值不值得投，从原点进行推理。我们要投资这家公司目的是为了赚钱，从常识出发，要有投入与回报，要卖出-买入的差价，就是赚的钱。目标函数的就是maximize return，公司是否是有价值，价格是否有吸引力，在资产定价再来讲。公司是否是好公司，从会计学来讲，能持续赚越来越多的钱就是好公司。我们怎么识别一个公司是否是好公司，从定量的角度来看，这个公司的成长性如何，盈利潜力如何，一步步推下来，盈利=收入-成本。收入、成本如何一步步分析出来，这个过程就是演绎的过程。在收入、成本可能会涉及归纳思维，量价、行业竞争就要用归纳。一个完整的框架，演绎是主干进行推动，血肉填充也要用到归纳去做。二者不是排斥的，会互相应用到一起的。今天讲这个框架，做公司做行业研究的基础框架，学会之后就知道如何看一个公司行业与市场。</p>
<p>很多人有时候分析的不透彻，就是因为理解的过于表面和笼统，要把笼统的东西一直往下分解，直至可以很透彻观察变量为止。收入可能是一个数值，比如小明收益可能是10个亿，可以按照类别进行分解收入，有肉包菜包等等。要分析不同产品种类的贡献率是多少，比如肉包50%，那肉包就对收入贡献是最重要的，那如何看小明包子铺肉包就至关重要，那19年的非洲猪瘟冲击就会对包子铺产生很大影响，影响成本上高，用户意愿下降，毛利进一步压缩，会十分影响效益。不同产品的利润率也不一样，比如星巴克的产品，有咖啡、面包、蛋糕等，他的利润率最高的还是咖啡，因为成本最低。食物制作、原材料的成本要超过咖啡成本。所以，咖啡是贡献星巴克最高收入，卖面包其他种类就跟经营策略有关系，想营造一站式的服务，想增加额外的服务，可以满足更多需求。比只卖咖啡的心理感受是不一样的，但咖啡本身决定了利润率怎么走。所以你就要把一家公司的收入分解成不同的门类，对公司的贡献是怎么样的。</p>
<p>也可以从另外的维度去分解收入。收入=产品数量<em>价格，那肉包一年收入=单价</em>一年销量。这时候分解成量价的原因是要考察量价怎么组合，可以有最高的收入，结果最大化。要么价格提上去，或者销量提上去，但是问题价格和销量存在对应的反比关系的，绝大部分产品价格高销量就会下降。这就提到价格弹性这一个微观概念，公司产品或服务价格变动影响销量变动，就是价格弹性。比如打折扣销量就会增长很多，表示价格弹性非常大；反之，销量跟价格变动没有明显的关系，这个时候弹性就比较差。比如大米每天都要吃，一季度后大米涨价一些，可能就没有明显的感觉。生活必需品本身就不贵，它的价格弹性趋向于零，不管多贵老百姓都会去买，交给企业去做会出问题，所以这些都是国家专营的。</p>
<p>通常上市公司里面，价格弹性比较低的话，就意味着公司可以通过涨价实现增长，就像海天味业、茅台、苹果，他们的目标消费人群消费弹性是趋近于零的。所以价格弹性比较低的产品可以提价提高收入。定价区间要去测试价格和销量在什么水平才会收入最优，虽然没办法直接去计算，但是可以去测试。因此把收入分解成单价和销量，就能进一步分析价格弹性，进一步分析企业能否通过提价方式完成成长，并且你自己做企业的话可以找到一个合理的定价。还可以把收入分为更多的分类标准，比如地域、人口特征。苹果就会分美国市场、中国市场、欧洲市场都怎么样，中国市场贡献了更多的边际收益，这样来看中国市场就会更重要，这样就能看到清晰的脉络。</p>
<p>举个案例，互联网游戏公司，腾讯一大半收入都来源于游戏，游戏公司的收入分解为付费用户数（100w）、人均付费额（1k），那就会有10个亿的收入。100w付费用户来自2000W总在线用户数，转化率5%，所以提高收入，就要提高在线用户数的转化，付费单价（ARPU，互联网公司比较重要的指标）。进一步分析，在线用户总数，又代表了的市场占用率，比如微信就占有10个亿，代表了市场地位。转化反应的是用户粘性，粘性越高就越容易付钱；ARPU反应了忠诚度，忠诚度越高越容易付钱。因此你分析一家游戏公司的成长性，就可以从这几个可观测的指标去进行分析。这个思路推广开，所有互联网公司的商业模型都可以这样去分析。所以，我们可以看到互联网公司非常关注用户数，用户数可以分为注册用户、付费用户等用户漏斗。公众号也是一样的，有多少用户、活跃多少、付费多少，公众号收入提升就是要提高粉丝、提高打开率、提高单个用户的付费金额、提高活跃用户的付费转化，收入才会越来越多。这个在研究信息行业，是非常重要的工具。</p>
<p>我们可以通过不同维度去分解收入，就能发现商业经营中最细致的脉络，进而研究这家公司未来的前景。从公司的经营者，如何去改善这些结果。</p>
<p>收入除了分解之外，跟市场也有很大关系，比如某行业的市场规模是多少，调查公司会做一些推断总行业的收入总量是多少，比如餐饮是4.2w亿，其中44%是由小吃快餐贡献的。收入的增长也非常重要，微观上来讲取决的经营情况，宏观来讲取决于市场规模。行业的市场规模是如何增长的。比如PMT行业，整个市场规模都会增长比较快，特别是互联网人群没有触顶的时候，这就是市场红利。</p>
<p>市场可以用不同维度去考察，比如市场份额就可以找到市场领头羊，领头羊可以享受议价优势。用户、现金流都会往大的公司进行聚集，茅台、格力、腾讯、阿里就会享受估值与各种议价，因此他们可以在几千亿市值的基础上保持高增长。市场也会有一会跟随，比如京东，增长速度会更快，估值也比阿里贵很多。所以，在一个不是绝对垄断的领域，第二第三的公司估值会比第一更贵，公司盈利倍数会高很多，后面公司估值再仔细讲。在一个非常集中的市场里，给后面的人进入空间就不多。比如互联网细分的搜索，中国美国都比较集中，第二第三的市场份额非常少。</p>
<p>还有就是非常分散，比如教育、餐饮，新东方+好未来占整体教育行业还不足5%的市场份额，最高也不过10%。海底捞的收入在整个行业中基本被忽略。分散市场优势是创新可以整合进行统领，劣势是差异化比较大。比如餐饮很难靠好吃创造一个餐饮去独霸。以上就是市场与收入的关系，仅仅分析收入变量就分析了这么多东西，这就是演绎的框架，再用归纳进行血肉填充。</p>
<p>收入之后，我们可以分析成本。成本可以分类，从会计上分为主营业务成本和运营成本，固定成本和可变成本。主营业务指直接跟产生收入相关的成本，包子皮、蒸笼等，收入-主营业务成本=毛利。运营成本是跟收入没有直接关系的，比如需要会计、市场营销，跟直接生产包子没有关系，但是是卖包子必不可少的环节。主营业务成本和运营成本又反映了不同内容，主营业务表毛利，运营成本表利率，下节课财务报表再仔细讲。</p>
<p>固定成本，比如店铺租金50w，不管卖不卖，成本不会发生变化。可变成本，比如包子铺卖100还是50，使用的包子馅不一样。产量增加固定成本会下降，这是所谓的经营杠杆，固定成本就被分摊的越来越少，这就是为什么有些行业在会计上是亏损，但是保持经营就是为了分摊固定成本，如果停产固定成本还是要交；如果不停产，生产的收入还是可以弥补一些固定成本的。所以，通过这个你可以观察固定成本很高的行业都会这样，亏损还是要生产，不然亏损更多，比如钢铁行业。这就带来两个概念，盈亏平衡点，就是收入可以覆盖固定成本与可变成本；停业营业点指所有收入刚好覆盖固定成本。这些概念可以百度一下。</p>
<p>不同行业也会有不同成本结构，新兴科技行业与传统行业。新兴行业刚开始成本巨大，京东开始于阿里竞争的时候，产生了大量物流支出、研发投入，滴滴刚开始的补贴投入，并没有产生收入，一开始投入很高，圈占用户，因为用户越多，份额越多，就变成一家独大赢家通吃，然后可以降低边际成本，快速收入增长。然后传统行业就另外一种模型，规模的扩张跟成本扩张是对应的，没有边际规模一说，市场规模比较稳定，跟GDP比较接近。传统行业增加收入就比较难，只能通过优化成本结构，比较裁员、资产重组(卖掉/置换不赚钱的业务)、资产剥离。比如之前处理银行坏账的时候，成立了一些资产管理公司（信达）。不同的成本结构，也对应了不同的投资逻辑，风险投资与股权投资。</p>
<p>最后总结起来，讲收入与成本、不同行业分析研究，对应了回到最初的点——判断这家公司是否可以足够赚钱。因此就要分析其收入、成本，分别细分这些变量，带出一整套的商业分析演绎框架，是研究行业市场最根本的一个框架。通常你把本框架学外，你就掌握宏观分析之外的基本面的分析与研究了。宏观还要考察更多的变量，可以看前几节课。微观的市场分析，本框架都是适用的。包括人生当中重要的决定，找工作、创业，满足用户什么样的需求，都是可以用到这些思维的。知识的学习，只要有一个点让你有启发，对个人成长都是有帮助的。</p>
</blockquote>
]]></content>
      <categories>
        <category>LIFE</category>
        <category>金融</category>
      </categories>
      <tags>
        <tag>新金融思维训练笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker</title>
    <url>/Docker.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="docker-基本概念">Docker 基本概念</h1>
<p>镜像（<code>Image</code>）：Docker 镜像理解为一个包含了必要的操作系统（通常只有OS文件系统和文件系统对象）。是一个特殊的文件系统，除了提供容器运行时所需的程序、库、资源、配置等文件外，还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。镜像不包含任何动态数据，其内容在构建之后也不会被改变。镜像由一些松耦合的只读镜像层组成。多个镜像间可以并且确实会共享镜像层（节约空间提升性能）。</p>
<p>容器（<code>Container</code>）：镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的<code>类</code> 和 <code>实例</code> 一样，镜像是静态的定义，容器是镜像运行时的实体， 一个镜像可以运行为多个容器。容器可以被创建、启动、停止、删除、暂停等。可以停止某个容器的运行，并从中创建新的镜像。镜像可以理解为一种构建时（build-time）结构，容器为运行时（run-time）结构。一旦容器从镜像启动后，二者变成了相互依赖的关系，并且在镜像上启动的容器全部停止之前，镜像是无法被删除的。</p>
<p>仓库（<code>Repository</code>）：镜像仓库（Image Registry）类似Git的远程仓库，集中存放镜像文件。Docker客户端的镜像仓库服务可配置，默认使用的镜像仓库是Docker Hub. 镜像仓库服务： 镜像仓库 = 1: N 镜像仓库: 镜像 = 1：N。<code>Docker Hub</code>分为<code>官方仓库（Official Repository）</code>和<code>非官方仓库（Unofficial Repository）</code>.</p>
<ul>
<li><code>官方仓库（Official Repository）</code>: 镜像由官方审查过，及时更新，高质量，安全，完善文档，最佳实践。</li>
<li><code>非官方仓库（Unofficial Repository）</code>：非官方，不保证上述特性。</li>
</ul>
<p>三者关系：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Docker/docker1.png" alt="三者关系"></p>
<h2 id="容器vs虚拟机">容器Vs虚拟机</h2>
<p>容器优势：</p>
<ul>
<li><code>OS Tax/VM Tas</code>: 虚拟机操作系统OS本身有额外开销。</li>
<li>容器启动快： 容器不是完整操作系统，容器内部不需要内核，也就没有定位、解压以及初始化的过程。</li>
</ul>
<p>虚拟化：</p>
<ul>
<li>硬件虚拟化（<code>Hardware Virtualization</code>）: Hypervisor将硬件物理资源划分为虚拟资源。</li>
<li>操作系统虚拟化（<code>Hardware Virtualization</code>）: 容器将系统资源划分为虚拟资源。</li>
</ul>
<h2 id="容器-container">容器（<code>Container</code>）</h2>
<h3 id="容器随着运行应用的退出而终止">容器随着运行应用的退出而终止</h3>
<ul>
<li><code>docker container run -it ubuntu /bin/bash</code> Linux容器在Bash Shell退出后终止.</li>
<li><code>docker container run -it microsoft- /powershell:nanoserver pwsh.exe</code> Windows容器在PowerShell进程退出后终止.</li>
</ul>
<p>杀死容器中的主进程，容器也会被杀死：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ docker container run -it ubuntu:latest /bin/bash</span><br><span class="line"><span class="comment"># 查看容器内进程</span></span><br><span class="line">root@3027eb644874:/<span class="comment"># ps -elf</span></span><br><span class="line"><span class="comment"># 退出容器</span></span><br><span class="line">  <span class="comment"># Ctrl + PQ 退出容器时保持容器运行</span></span><br><span class="line">  <span class="comment"># 从这个 stdin 中 exit，会导致容器的停止</span></span><br><span class="line">Ctrl + PQ</span><br><span class="line"></span><br><span class="line">$ docker <span class="built_in">exec</span> -it 3027eb644874 bash</span><br><span class="line">root@3027eb644874:/<span class="comment">#</span></span><br><span class="line"><span class="comment"># docker exec创建了新的Bash进程并且连接到容器，所以现在输入exit并不会导致容器种植，因为原Bash进程还在运行中</span></span><br></pre></td></tr></table></figure>
<h3 id="重启策略">重启策略</h3>
<p><code>--restart [重启策略]</code>: 设置重启策略，例如<code>docker container run -it --restart always ubuntu:latest /bin/bash</code></p>
<table>
<thead>
<tr>
<th>重启策略</th>
<th>always</th>
<th>unless-stopped</th>
<th>on-failed</th>
</tr>
</thead>
<tbody>
<tr>
<td>策略</td>
<td>if not 容器被明确停止（例如<code>docker container stop</code>）， 重启处于停止状态的容器</td>
<td>if not 容器被明确停止（例如<code>docker container stop</code>）， 重启处于停止状态的容器</td>
<td>if 退出容器&amp;&amp;返回值!=0， 重启容器</td>
</tr>
<tr>
<td>daemon/Docker重启时</td>
<td>停止的容器也被重启</td>
<td>停止的容器不！！！重启</td>
<td>stopped的容器也被重启</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 无重启策略</span></span><br><span class="line">$ docker container run -it  ubuntu:latest /bin/bash</span><br><span class="line">root@733b80d556f7:/<span class="comment"># exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="comment"># 退出进程时，容器终止</span></span><br><span class="line"> ✘ $ docker container ls</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 重启策略： always</span></span><br><span class="line">$ docker container run -it  --restart always ubuntu:latest /bin/bash</span><br><span class="line">root@b077521d228e:/<span class="comment"># exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="comment"># 退出进程时，容器终止，又自动重启（STATUS 启动时间 UP 7 seconds &lt; CREATED 创建时间13 seconds ago）</span></span><br><span class="line">$ docker container ls</span><br><span class="line">CONTAINER ID   IMAGE           COMMAND       CREATED          STATUS         PORTS     NAMES</span><br><span class="line">b077521d228e   ubuntu:latest   <span class="string">"/bin/bash"</span>   13 seconds ago   Up 7 seconds             wonderful_yalow</span><br><span class="line"><span class="comment"># 主动stop后，不自动重启</span></span><br><span class="line">$ docker container stop b077521d228e</span><br><span class="line">b077521d228e</span><br><span class="line"> $ docker container ls</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line"><span class="comment"># 重启Docker，容器重启</span></span><br><span class="line">$ systemctl restart docker</span><br><span class="line">$ docker container ls</span><br><span class="line">CONTAINER ID   IMAGE           COMMAND       CREATED          STATUS         PORTS     NAMES</span><br><span class="line">807b900b28f9   ubuntu:latest   <span class="string">"/bin/bash"</span>   12 seconds ago   Up 3 seconds             epic_noether</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 重启策略： always 和 unless-stopped</span></span><br><span class="line">$ docker container run -d --name always \</span><br><span class="line">  --restart always \</span><br><span class="line">  ubuntu:latest /bin/bash</span><br><span class="line">$ docker container run -d --name unless-stopped \</span><br><span class="line">  --restart unless-stopped \</span><br><span class="line">  ubuntu:latest /bin/bash</span><br><span class="line"></span><br><span class="line">$ docker container ls</span><br><span class="line">CONTAINER ID   IMAGE           COMMAND       CREATED          STATUS         PORTS     NAMES</span><br><span class="line">807b900b28f9   ubuntu:latest   <span class="string">"/bin/bash"</span>   12 seconds ago   Up 3 seconds             always</span><br><span class="line">9afe62536be6   ubuntu:latest   <span class="string">"/bin/bash"</span>   12 seconds ago   Up 17 seconds            unless-stopped</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主动stop后，不自动重启</span></span><br><span class="line">$ docker container stop always unless-stopped</span><br><span class="line">b077521d228e</span><br><span class="line"> $ docker container ls -a</span><br><span class="line">CONTAINER ID   IMAGE           COMMAND       CREATED          STATUS                   PORTS     NAMES</span><br><span class="line">807b900b28f9   ubuntu:latest   <span class="string">"/bin/bash"</span>   12 seconds ago   Exited (137) 3 seconds ago         always</span><br><span class="line">9afe62536be6   ubuntu:latest   <span class="string">"/bin/bash"</span>   12 seconds ago   Exited (137) 3 seconds ago         unless-stopped</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启Docker，always容器重启</span></span><br><span class="line">$ systemctl restart docker</span><br><span class="line">$ docker container ls -a</span><br><span class="line">CONTAINER ID   IMAGE           COMMAND       CREATED          STATUS                   PORTS     NAMES</span><br><span class="line">807b900b28f9   ubuntu:latest   <span class="string">"/bin/bash"</span>   12 seconds ago   Exited (137) 2 minutes ago         always</span><br><span class="line">9afe62536be6   ubuntu:latest   <span class="string">"/bin/bash"</span>   12 seconds ago   Up 17 seconds                      unless-stopped</span><br></pre></td></tr></table></figure>
<h3 id="docker-端口">Docker 端口</h3>
<p>Docker默认非TLS网络端口为2375，默认TLS网络端口为2376。</p>
<h3 id="docker-持久化">Docker 持久化</h3>
<p>stop 或 pause容器并不会导致容器销毁，或者内部存储的数据丢失。</p>
<h2 id="镜像-image">镜像（<code>Image</code>）</h2>
<p><code>悬虚镜像</code>: Repository:Tag 为<none>:<none>. 因为构建了一个新的镜像，为该新镜像打了一个已经存在的Tag，Docker发现已经有镜像包含相同的Tag，会移除旧镜像上面的Tag，将Tag标在新镜像上， 旧镜像就成了悬虚镜像。</none></none></p>
<h2 id="相关资料">相关资料</h2>
<p><code>Moby</code>: <a href="https://github.com/moby" target="_blank" rel="noopener">Docker开源项目</a>，2017年正式命名为Moby(白鲸)， Github上的docker/docker库转移到<a href="https://github.com/moby" target="_blank" rel="noopener">moby/moby</a>。Apache协议2.0， Golang编写。<br>
<code>Docker引擎</code>: <code>企业版（Enterprise Edition, EE）</code>， <code>社区版（Community Edition, CE）</code>， 每季度 企业版EE和社区版 CE都会发布一个稳定版本。 CE社区版又分为<code>稳定版（stable）</code> <code>抢先版（Edge）</code>，抢先版（Edge）每月发布。<br>
<code>版本号</code>： 从2017年第一季度开始，YY.MM-xx格式， 例如18.06.0-ce（18年6月社区版）<br>
<code>开放容器计划（The Open Container Initiative， OCI）</code>： 对容器基础架构中的基础组件进行标准化的管理委员会（在Linux基金会支持下运作）。 OCI已发布规范：<code>镜像规范</code>(类比铁轨尺寸)， <code>运行时规范</code>(类比相关属性).</p>
<h1 id="docker安装">Docker安装</h1>
<table>
<thead>
<tr>
<th>方式</th>
<th>Docker for Windows(DfW)</th>
<th>Docker for Mac(DfM)</th>
<th>Linux</th>
<th>Windows Server2016</th>
</tr>
</thead>
<tbody>
<tr>
<td>类别</td>
<td>桌面安装</td>
<td>桌面安装</td>
<td>服务器安装</td>
<td>服务器安装</td>
</tr>
<tr>
<td>要求</td>
<td>1 64位 2 Windows10 3 启用Hyper-v和容器特性</td>
<td>MAC</td>
<td>Linux</td>
<td>Windows Server2016</td>
</tr>
<tr>
<td>生产环境</td>
<td>No，社区CE版本应用</td>
<td>No，社区CE版本应用</td>
<td>CE或EE</td>
<td></td>
</tr>
<tr>
<td>版本</td>
<td>稳定版（stable） 抢先版（Edge）</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>运行内核</td>
<td>默认Hyper-v虚拟机中的轻量级Linux，可切换为Native Windows 原生内核</td>
<td>轻量级Linux VM</td>
<td>Linux</td>
<td>Windows</td>
</tr>
</tbody>
</table>
<p>Docker for Mac(DfM) 是一个流畅，简单并且稳定版的boot2docker.</p>
<h1 id="docker-常用命令">Docker 常用命令</h1>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-7565276/6lldlbgfhn.png?imageView2/2/w/1620" alt="Docker 常用命令"></p>
<h2 id="服务">服务</h2>
<h3 id="查看docker系统信息-信息比docker-version更多">查看Docker系统信息（信息比<code>docker version</code>更多）</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker system info</span><br></pre></td></tr></table></figure>
<h3 id="查看docker版本信息-包含client和server信息">查看Docker版本信息，包含Client和Server信息</h3>
<p>如果Server中包含错误码，表示</p>
<ol>
<li>或者当前用户没有权限访问。 解决方法： 确认用户是否属于本地Docker UNIX组，若不是，<code>usermod -aG docker &lt;user&gt;</code>来添加，退出并重新登录Shell</li>
<li>Docker daemon可能没有运行。 解决方法：检查Docker daemon状态 <code>service docker status</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ docker version</span><br><span class="line">Client:</span><br><span class="line"> Cloud integration: v1.0.22</span><br><span class="line"> Version:           20.10.11</span><br><span class="line"> API version:       1.41</span><br><span class="line"> Go version:        go1.16.10</span><br><span class="line"> Git commit:        dea9396</span><br><span class="line"> Built:             Thu Nov 18 00:36:09 2021</span><br><span class="line"> OS/Arch:           darwin/amd64</span><br><span class="line"> Context:           default</span><br><span class="line"> Experimental:      <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">Server: Docker Engine - Community</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          20.10.11</span><br><span class="line">  API version:      1.41 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.16.9</span><br><span class="line">  Git commit:       847da18</span><br><span class="line">  Built:            Thu Nov 18 00:35:39 2021</span><br><span class="line">  OS/Arch:          linux/amd64</span><br><span class="line">  Experimental:     <span class="literal">false</span></span><br><span class="line"> containerd:</span><br><span class="line">  Version:          1.4.12</span><br><span class="line">  GitCommit:        7b11cfaabd73bb80907dd23182b9347b4245eb5d</span><br><span class="line"> runc:</span><br><span class="line">  Version:          1.0.2</span><br><span class="line">  GitCommit:        v1.0.2-0-g52b36a2</span><br><span class="line"> docker-init:</span><br><span class="line">  Version:          0.19.0</span><br><span class="line">  GitCommit:        de40ad0</span><br></pre></td></tr></table></figure>
<h4 id="查看docker简要信息">查看docker简要信息</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ docker -v</span><br><span class="line">Docker version 20.10.11, build dea9396</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ docker --version</span><br><span class="line">Docker version 20.10.11, build dea9396</span><br></pre></td></tr></table></figure>
<h3 id="检查docker-daemon状态">检查Docker daemon状态</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用System V在Linux系统中执行命令</span></span><br><span class="line">$ service docker status</span><br><span class="line">docker start/running, process 29393</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用SystemD 在Linux系统中执行命令</span></span><br><span class="line">$ systemctl is-active docker</span><br><span class="line">active</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在Windows Server 2016 的PowerShell窗口中执行命令</span></span><br><span class="line">&gt; Get-Service docker</span><br><span class="line">Status    Name     DisplayName</span><br><span class="line">------    ----     -----------</span><br><span class="line">Running   Docker   docker</span><br></pre></td></tr></table></figure>
<h3 id="启动docker服务">启动Docker服务</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用SystemD 在Linux系统中执行命令</span></span><br><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用System V在Linux系统中执行命令</span></span><br><span class="line">service docker start</span><br></pre></td></tr></table></figure>
<h3 id="重启docker服务">重启Docker服务</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用SystemD 在Linux系统中执行命令</span></span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用System V在Linux系统中执行命令</span></span><br><span class="line">service docker restart</span><br></pre></td></tr></table></figure>
<h3 id="关闭docker服务">关闭docker服务</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用SystemD 在Linux系统中执行命令</span></span><br><span class="line">systemctl stop docker</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用System V在Linux系统中执行命令</span></span><br><span class="line">service docker stop</span><br></pre></td></tr></table></figure>
<h3 id="设置开机启动">设置开机启动</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用SystemD 在Linux系统中执行命令</span></span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br></pre></td></tr></table></figure>
<h2 id="镜像">镜像</h2>
<h3 id="镜像仓库">镜像仓库</h3>
<p>Docker Hub 等镜像仓库上有大量的高质量的镜像可以用，可以从仓库获取镜像。</p>
<ul>
<li>检索镜像
<ul>
<li><code>docker search 关键字</code> 搜索NAME字段含有关键字符串的仓库
<ul>
<li><code>docker search 关键字 --filter &quot;is-official=true&quot;</code> 过滤是否是官方镜像</li>
<li><code>docker search 关键字 --filter &quot;is-automated=true&quot;</code>过滤是否是自动创建的镜像</li>
<li><code>docker search 关键字 --limit 行数</code> 默认只返回25行结果，–limit 可设置返回行数，最多为100行</li>
</ul>
</li>
</ul>
</li>
<li>拉取镜像
<ul>
<li><code>docker image pull &lt;option&gt; &lt;DockerHub用户名组织名/repository&gt;:&lt;tag&gt;</code>
<ul>
<li>从官方Ubuntu库 拉取 标签为latest的镜像 <code>docker image pull ubuntu:latest</code></li>
<li>默认标签为latest <code>docker image pull ubuntu</code></li>
<li>注意！！！latest不一定代表是最新镜像</li>
<li>多个镜像可有相同tag</li>
<li>从官方Mongo库 拉取 标签为3.3.11的镜像<code>docker image pull mongo:3.3.11</code></li>
<li>从Docker Hub 账号nigelpoulton为命名空间的tu-demon库下拉取v2标签的镜像<code>docker image pull nigelpoulton/tu-demo:v2</code></li>
<li>从第三方镜像仓库服务获取，需在前面加上第三方镜像仓库服务DNS名称 例如Google容器镜像仓库（GCR） <code>docker image pull gcr.io/nigelpoulton/tu-demo:v2</code></li>
</ul>
</li>
<li><code>docker image pull -a &lt;DockerHub用户名组织名/repository&gt;</code> <code>-a</code> 拉取全部镜像</li>
<li><code>docker image pull &lt;repository&gt;&lt;Digest&gt;``docker image pull ubuntu@sha256:c0537...7cj32rg42454</code> 通过镜像摘要Digest 拉取镜像，镜像摘要Digest是基于内容散列值（Content Hash），可区分出两个tag相同的镜像</li>
</ul>
</li>
<li>push镜像
<ul>
<li><code>docker image push &lt;option&gt; &lt;DockerHub用户名组织名/repository&gt;:&lt;tag&gt;</code></li>
</ul>
</li>
</ul>
<h3 id="镜像管理">镜像管理</h3>
<ul>
<li>
<p>列出镜像</p>
<ul>
<li><code>docker image ls</code>
<ul>
<li>
<p><code>docker image ls -q</code> 获取全部镜像ID</p>
</li>
<li>
<p><code>docker image ls --filter</code> 过滤</p>
<ul>
<li>dangling: true(返回悬虚镜像) false (返回非悬虚镜像) <code>docker image ls --filter dangling=true</code></li>
<li>before: 镜像名/ID 返回指定镜像之前被创建的全部镜像</li>
<li>since: 与before类似，返回指定镜像之后被创建的全部镜像</li>
<li>label: 根据标注（lable）的名称或者值，对镜像进行过滤。<code>docker image ls</code>输出中不显示lable</li>
<li>reference：<code>docker image ls --filter reference=&quot;*:latest&quot;</code></li>
</ul>
</li>
<li>
<p><code>docker image ls --format</code> 通过Go模板对输出内容格式化</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 只返回镜像的Size属性</span></span><br><span class="line">docker image ls --format <span class="string">"&#123;&#123;.Size&#125;&#125;"</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 只返回镜像的Repository: Tag: Size属性</span></span><br><span class="line">docker image ls --format <span class="string">"&#123;&#123;.Repository&#125;&#125;: &#123;&#123;.Tag&#125;&#125;: &#123;&#123;.Size&#125;&#125;"</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>docker image ls --digests &lt;image-name or image-id&gt;</code> 显示镜像摘要（Image Digest，镜像内容散列值）</p>
</li>
</ul>
</li>
<li><code>docker images</code></li>
</ul>
</li>
<li>
<p>查看镜像分层，启动时默认应用</p>
<ul>
<li><code>docker image inspect &lt;image-name or image-id&gt;</code></li>
</ul>
</li>
<li>
<p>移除全部的<code>悬虚镜像</code></p>
<ul>
<li><code>docker image prune</code></li>
</ul>
</li>
<li>
<p>删除镜像</p>
<ul>
<li>删除指定镜像<code>docker image rm &lt;image-name or image-id&gt;</code></li>
<li>删除本地所有镜像<code>docker image rm $(docker image ls -q) -f</code></li>
</ul>
</li>
<li>
<p>导出镜像</p>
<ul>
<li>将镜像保存为归档文件</li>
<li>docker save</li>
</ul>
</li>
<li>
<p>导入镜像</p>
<ul>
<li>docker load</li>
</ul>
</li>
<li>
<p>tag镜像</p>
<ul>
<li>
<p><code>docker image tag</code>: Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE</p>
</li>
<li>
<p>Usage:  <code>docker image tag SOURCE_IMAGE_repo[:TAG] TARGET_IMAGE[:TAG]</code></p>
</li>
<li>
<p>Usage:  <code>docker image tag SOURCE_IMAGE_ID TARGET_IMAGE[:TAG]</code></p>
</li>
<li>
<p>例子：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ docker image ls</span><br><span class="line">REPOSITORY   TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">my-ping      pinger    8120ce1f0447   9 minutes ago   12.9MB</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Tag the image, which is currently tagged as pinger , also as local-registry:5000/pinger .</span></span><br><span class="line">docker image tag my-ping:pinger <span class="built_in">local</span>-registry:5000/pinger</span><br><span class="line"></span><br><span class="line">docker image ls</span><br><span class="line">REPOSITORY                   TAG       IMAGE ID       CREATED          SIZE</span><br><span class="line">my-ping                      pinger    8120ce1f0447   10 minutes ago   12.9MB</span><br><span class="line"><span class="built_in">local</span>-registry:5000/pinger   latest    8120ce1f0447   10 minutes ago   12.9MB</span><br><span class="line"></span><br><span class="line"><span class="comment"># Then push the image into the local registry.</span></span><br><span class="line">docker image push <span class="built_in">local</span>-registry:5000/pinger</span><br><span class="line"></span><br><span class="line"><span class="comment"># 变为v1 tag</span></span><br><span class="line">docker image tag <span class="built_in">local</span>-registry:5000/pinger:latest <span class="built_in">local</span>-registry:5000/pinger:v1</span><br><span class="line"></span><br><span class="line">docker image ls</span><br><span class="line">REPOSITORY                   TAG       IMAGE ID       CREATED          SIZE</span><br><span class="line">my-ping                      pinger    8120ce1f0447   31 minutes ago   12.9MB</span><br><span class="line"><span class="built_in">local</span>-registry:5000/pinger   latest    8120ce1f0447   31 minutes ago   12.9MB</span><br><span class="line"><span class="built_in">local</span>-registry:5000/pinger   v1        8120ce1f0447   31 minutes ago   12.9MB</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="dockerfile构建镜像">Dockerfile构建镜像</h2>
<p><code>容器化（Containerizing）</code>也叫<code>Docker化(Dockerizing)</code>： 将应用整合到容器中并运行起来的过程。<br>
容器化过程：</p>
<ol>
<li>编写应用代码</li>
<li>创建Dockerfile，其中包含当前应用描述、依赖以及如何运行这个应用。</li>
<li>对Dockerfile执行<code>docker image build</code>命令</li>
<li>等待Docker将应用程序构建到Docker镜像中。</li>
</ol>
<h3 id="dockerfile">Dockerfile</h3>
<p><code>Dockerfile</code> 是一个文本格式的配置文件，用户可以使用 Dockerfile 来快速创建自定义的镜像。<br>
<code>Dockerfile</code> 由一行行行命令语句组成，并且支持以＃开头的注释行.除注释行，每一行都是一条<code>指令（Instruction）</code>.<br>
指令不区分大小写，通常采用大写。<br>
<code>构建上下文（Build Context）</code>: 包含应用文件的目录。<br>
通常将Dockerfile放在构建上下文的根目录下。</p>
<ul>
<li>
<p>Dockerfile常见指令<br>
下面是Dockerfile中一些常见的指令：</p>
<ul>
<li>
<p><code>FROM</code>：指定<code>基础镜像（Base Image）</code></p>
</li>
<li>
<p><code>RUN</code>：执行命令</p>
</li>
<li>
<p><code>COPY</code>：复制文件</p>
</li>
<li>
<p><code>ADD</code>：更高级的复制文件</p>
</li>
<li>
<p><code>CMD</code>：容器启动命令</p>
</li>
<li>
<p><code>ENV</code>：设置环境变量</p>
</li>
<li>
<p><code>EXPOSE</code>：暴露端口</p>
</li>
</ul>
</li>
</ul>
<p>其它的指令还有<code>ENTRYPOINT</code>、<code>ARG</code>、<code>VOLUME</code>、<code>WORKDIR</code>、<code>USER</code>、<code>HEALTHCHECK</code>、<code>ONBUILD</code>、<code>LABEL</code>等等。</p>
<p>以下是一个Dockerfile实例：</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> java:<span class="number">8</span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> maintainer=<span class="string">"yuanli@gmail.com"</span></span></span><br><span class="line"><span class="keyword">MAINTAINER</span> <span class="string">"jinshw"</span>&lt;jinshw@qq.com&gt;</span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> mapcharts-0.0.1-SNAPSHOT.jar mapcharts.jar</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> java -jar mapcharts.jar</span></span><br></pre></td></tr></table></figure>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Create a new file /root/Dockerfile to build a container image from. It should:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use bash as base</span></span><br><span class="line"><span class="comment"># run ping killercoda.com</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> bash</span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"ping"</span>, <span class="string">"killercoda.com"</span>]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1 apine作为基础镜像， 是镜像的第一个镜像层layer</span></span><br><span class="line"><span class="keyword">FROM</span> apine</span><br><span class="line"><span class="comment"># 2 维护者为yuanli@gmail.com</span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> maintainer=<span class="string">"yuanli@gmail.com"</span></span></span><br><span class="line"><span class="comment"># 3 安装Node.js 和NPM，新建镜像层2</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apk add --update nodejs nodejs-npm</span></span><br><span class="line"><span class="comment"># 4 将应用代码拷贝到当前镜像中，新建镜像层3</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . /src</span></span><br><span class="line"><span class="comment"># 5 设置工作目录</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /src</span></span><br><span class="line"><span class="comment"># 6 npm install会根据package.json文件用npm安装应用的依赖包，新建镜像层4</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> npm install</span></span><br><span class="line"><span class="comment"># 7 应用需要通过TCP端口8080对外提供web服务</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"><span class="comment"># 8 指定镜像的入口程序 </span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">"node"</span>, <span class="string">"./app.js"</span>]</span></span><br></pre></td></tr></table></figure>
<h4 id="如何区分命令是否会新建镜像层？">如何区分命令是否会新建镜像层？</h4>
<ul>
<li>if 向镜像中添加新的文件或程序，then 新建镜像层。例如例子中的1，3，4，6</li>
<li>if 只是告诉Docker如何完成构建或如何运行应用程序，then 增加镜像的元数据。例如例子中的2，5，7，8</li>
</ul>
<h3 id="构建命令">构建命令</h3>
<h4 id="镜像构建docker-image-build">镜像构建<code>docker image build</code></h4>
<p>镜像构建(在Dockerfile目录下运行)<br>
<code>docker image build -t imageName:tag1 -t imageName:tag2 .</code></p>
<ul>
<li><code>.</code>表示使用当前目录作为构建上下文</li>
<li><code>--no-cache=true</code> 强制忽略缓存，不使用缓存构建镜像</li>
<li><code>--squash</code> 创建一个合并镜像</li>
<li><code>-t name:tag</code> 加tag list</li>
</ul>
<p>构建过程：</p>
<ol>
<li>运行临时容器  <code>---&gt; Running in e60ddca785f</code></li>
<li>在该容器中运行Dockerfile中的指令</li>
<li>将指令运行结果保存为一个新的镜像层 <code>---&gt; cldddca785f</code></li>
<li>删除临时容器 <code>Removing intermediate container</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Build the image by /root/Dockerfile and tag it as pinger .</span></span><br><span class="line"><span class="comment"># Run the image (create a container) named my-ping</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">docker image build . -t pinger</span><br><span class="line">docker container run --name=my-ping pinger</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tag the image, which is currently tagged as pinger , also as local-registry:5000/pinger .</span></span><br><span class="line">docker tag pinger <span class="built_in">local</span>-registry:5000/pinger</span><br><span class="line">docker image ls</span><br><span class="line">docker push <span class="built_in">local</span>-registry:5000/pinger</span><br></pre></td></tr></table></figure>
<h4 id="查看构建镜像过程中执行的指令docker-image-history">查看构建镜像过程中执行的指令<code>docker image history</code></h4>
<p><code>docker image history test:latest</code></p>
<ul>
<li>每行都对应Dockerfile中的一条指令</li>
<li>SIZE列数值不为零的指令，表示新建镜像层</li>
</ul>
<h3 id="生产环境中的多阶段构建">生产环境中的多阶段构建</h3>
<p>Docker镜像应尽量小， 对生产环境来说，缩小到仅包含运行应用所必须的内容即可。</p>
<h4 id="docker镜像如何尽量小？">Docker镜像如何尽量小？</h4>
<ol>
<li>Dockerfile的写法： 每个RUN指令会新增一个镜像层，通过使用&amp;&amp;连接多个命令以及使用反斜杠（\）换行的方法，将多个命令包在一个RUN指令字中。</li>
<li>利用构建缓存：</li>
</ol>
<ul>
<li>一旦有指令在缓存中未命中，后续整个构建过程将不再使用缓存。所以编写Dockerfile时，将容易放生变化的指令放在Dockerfile文件靠后的位置执行。
<ul>
<li><code>docker image build</code>参数 <code>--no-cache=true</code> 强制忽略缓存，不使用缓存构建镜像</li>
</ul>
</li>
<li><code>COPY``ADD</code>指令会检查复制到镜像中的内容自上一次构建之后是否发生了变化。<code>COPY . /src</code> 指令没有变化，但被复制的内容发生变化了。Docker会计算每个被复制文件的Checksum值，并与缓存镜像层中同一个文件的checksum对比，如果不匹配，则认为缓存无效并构建新的镜像层。</li>
</ul>
<ol start="3">
<li>合并镜像</li>
</ol>
<p>镜像层数过多时，可以合并镜像。如果新建了一个镜像，想把它作为其他镜像的基础镜像时，这个基础镜像最后被合并为一层。<br>
缺点： 合并的镜像无法共享镜像层，存储空间低效利用。而且push和pull操作的镜像体积更大。<br>
<code>docker image build</code>参数 <code>--squash</code> 创建一个合并镜像</p>
<ol start="4">
<li>使用no-install-recommends（Linux）</li>
</ol>
<p>构建Linux镜像时，若使用APT包管理器，在执行<code>apt-get install</code>时增加<code>no-install-recommends</code>参数。确保APT只安装核心依赖，而不是推荐和建议的包， 减少不必要包的下载数量。</p>
<ol start="5">
<li>不要安装MSI包（Windows）</li>
</ol>
<p>构建Windows镜像时，尽量避免使用MSI包管理器。其对空间利用率不高，会大幅增加镜像体积。</p>
<h4 id="构建清理？">构建清理？</h4>
<p>构建镜像过程中拉取的构建工具在构建完成后没有清理，就会留在镜像中移交至生产环境。</p>
<ul>
<li>
<p>方法一：<code>建造者模式（Builder Pattern）</code>： 两个Dockerfile, 开发环境Dockerfile.dev(构建一个镜像并创建容器)， 生产环境Dockerfile.prod(从刚才创建的容器中将应用程序的部分复制过来). 需要编写额外的脚本才能串联起来。</p>
</li>
<li>
<p>方法二（更好，建议使用）：<code>多阶段构建(Multi-Stage Build)</code>： 一个Dockerfile， 包含多个<code>FROM</code>指令。每个<code>FROM</code>指令都是一个新的<code>构建阶段（Build Stage）</code>, 并且可以方便地复制之前构建阶段的构件。</p>
</li>
</ul>
<h2 id="容器">容器</h2>
<h3 id="容器生命周期">容器生命周期</h3>
<ul>
<li>查看容器</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 列出本机运行的容器</span></span><br><span class="line">$ docker ps</span><br><span class="line">$ docker container ls</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出本机所有的容器（包括停止和运行）</span></span><br><span class="line">$ docker ps -a</span><br><span class="line">$ docker container ls -a</span><br></pre></td></tr></table></figure>
<ul>
<li>启动：启动容器有两种方式，一种是基于镜像新建一个容器并启动，另外一个是将在终止状态（stopped）的容器重新启动。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 新建并启动</span></span><br><span class="line">$ docker container run &lt;option&gt; &lt;image-name or image-id&gt;:&lt;tag&gt; &lt;app&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 例子 -it 将Shell切换到容器终端</span></span><br><span class="line">$ docker container run -it ubuntu:latest /bin/bash</span><br><span class="line">root@3027eb644874:/<span class="comment">#</span></span><br><span class="line"><span class="comment"># 3027eb644874是容器唯一ID的前12个字符</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定name为lyk 和 port映射为 host-port:container-port 8080:8080</span></span><br><span class="line">$ docker container run -it --name lyk --publish 8080:8080 ubuntu:latest</span><br></pre></td></tr></table></figure>
<p><code>--restart always</code>: 设置重启策略，例如<code>docker container run -it --restart always ubuntu:latest /bin/bash</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启动已终止容器</span></span><br><span class="line">docker start &lt;container-id or container-name&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>退出容器</p>
<ul>
<li>Ctrl + PQ 退出容器时保持容器运行</li>
<li>从这个 stdin 中 exit，会导致容器的停止</li>
</ul>
</li>
<li>
<p>进入容器<br>
进入容器有两种方式：</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 如果从这个 stdin 中 exit，会导致容器的停止</span></span><br><span class="line">docker attach &lt;container-id or container-name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 交互式进入运行中的容器</span></span><br><span class="line">docker <span class="built_in">exec</span> &lt;option&gt; &lt;container-name or container-ID&gt; &lt;<span class="built_in">command</span>/app&gt;</span><br><span class="line">docker <span class="built_in">exec</span> -it 4dbcc6555bc6 bash</span><br></pre></td></tr></table></figure>
<p>进入容器通常使用第二种方式，<code>docker exec</code>后面跟的常见参数如下：<br>
<code>－d, --detach</code> 在容器中后台执行命令；<br>
<code>－i, --interactive=true I false</code> ：打开标准输入接受用户输入命令</p>
<ul>
<li>
<p>暂停容器<br>
<code>docker container pause &lt;container-id or container-name&gt;</code></p>
</li>
<li>
<p>停止容器</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 停止运行的容器</span></span><br><span class="line"><span class="comment"># 给容器进程发送SIGTTERM信号</span></span><br><span class="line">docker stop &lt;container-id or container-name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 杀死容器进程</span></span><br><span class="line">docker  <span class="built_in">kill</span> &lt;container-id or container-name&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>删除容器</p>
<ul>
<li><code>docker container rm &lt;container-id or container-name&gt;</code> 删除容器前，最好先<code>docker stop</code>容器，给容器中运行的应用/进程一个停止运行并清理残留数据的机会。# 给容器进程发送SIGKILL信号</li>
<li><code>docker container rm $(docker container ls -aq) -f</code>。删除所有运行中的容器.
<ul>
<li><code>-f</code>: force 强制执行， 运行状态的容器也会被删除。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>重启容器</p>
<ul>
<li><code>docker restart &lt;container-id or container-name&gt;</code></li>
</ul>
</li>
<li>
<p>查看容器配置细节和运行时信息</p>
<ul>
<li><code>docker container inspect &lt;container-name or container-id&gt;</code></li>
</ul>
</li>
</ul>
<h3 id="导出和导入">导出和导入</h3>
<ul>
<li>导出容器</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导出一个已经创建的容器到一个文件</span></span><br><span class="line">docker <span class="built_in">export</span> &lt;container-id or container-name&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>导入容器</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导出的容器快照文件可以再导入为镜像</span></span><br><span class="line">docker import &lt;路径&gt;</span><br></pre></td></tr></table></figure>
<h3 id="其它">其它</h3>
<ul>
<li>查看日志</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导出的容器快照文件可以再导入为镜像</span></span><br><span class="line">docker logs &lt;container-id or container-name&gt;</span><br></pre></td></tr></table></figure>
<p>这个命令有以下常用参数</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> -f : 跟踪日志输出</span><br><span class="line"></span><br><span class="line">--since :显示某个开始时间的所有日志</span><br><span class="line"></span><br><span class="line">-t : 显示时间戳</span><br><span class="line"></span><br><span class="line">--tail :仅列出最新N条容器日志</span><br></pre></td></tr></table></figure>
<ul>
<li>复制文件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 从主机复制到容器</span></span><br><span class="line">sudo docker cp host_path containerID:container_path </span><br><span class="line"><span class="comment"># 从容器复制到主机</span></span><br><span class="line">sudo docker cp containerID:container_path host_path</span><br></pre></td></tr></table></figure>
<h2 id="参数-options">参数（Options）</h2>
<h3 id="docker-container-run-options"><code>docker container run</code> Options</h3>
<p><code>--help</code> 输出帮助信息，例如<code>docker run --help</code><br>
<code>－d, --detach</code> 在容器中后台执行命令；<br>
<code>－i, --interactive</code> ：打开标准输入接受用户输入命令（Keep STDIN open even if not attached）<br>
<code>-t, --tty</code>           Allocate a pseudo-TTY<br>
<code>--restart always</code>: 设置重启策略，例如<code>docker container run -it --restart always ubuntu:latest /bin/bash</code><br>
<code>--name</code>: 设置容器名称<br>
<code>-p, --publish</code>: 端口映射  主机端口：容器端口<code>docker container run -it --name lyk --publish 8080:8080 ubuntu:latest</code></p>
<h3 id="docker-container-rm-options"><code>docker container rm</code> Options</h3>
<p><code>-f</code>: force 强制执行， 运行状态的容器也会被删除。</p>
<h3 id="docker-options"><code>docker</code> Options</h3>
<pre><code>  --config string      Location of client config files (default &quot;/Users/liyuankun/.docker&quot;)
</code></pre>
<p>-c, --context string     Name of the context to use to connect to the daemon (overrides DOCKER_HOST env var<br>
and default context set with “docker context use”)<br>
-D, --debug              Enable debug mode<br>
-H, --host list          Daemon socket(s) to connect to<br>
-l, --log-level string   Set the logging level (“debug”|“info”|“warn”|“error”|“fatal”) (default “info”)<br>
–tls                Use TLS; implied by --tlsverify<br>
–tlscacert string   Trust certs signed only by this CA (default “/Users/liyuankun/.docker/ca.pem”)<br>
–tlscert string     Path to TLS certificate file (default “/Users/liyuankun/.docker/cert.pem”)<br>
–tlskey string      Path to TLS key file (default “/Users/liyuankun/.docker/key.pem”)<br>
–tlsverify          Use TLS and verify the remote<br>
-v, --version            输出版本信息（Print version information and quit）</p>
<h2 id="docker-compose">Docker Compose</h2>
<h2 id="docker-swarm">Docker Swarm</h2>
<h1 id="参考文章">参考文章</h1>
<ul>
<li><a href="https://cloud.tencent.com/developer/article/1772136" target="_blank" rel="noopener">一张脑图整理Docker常用命令</a></li>
<li>《深入浅出Docker》书</li>
<li><a href="../System-V-%E4%B8%8E-SystemD-%E5%8C%BA%E5%88%AB.html">System-V 与 SystemD 区别</a></li>
<li><a href="https://www.codenong.com/bc35c4295aaef7fb6b8c/" target="_blank" rel="noopener">Docker概述-状态转换，命令</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>程序猿的那些好用工具</title>
    <url>/awesome-tools.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>本文在<a href="https://github.com/sorrycc/awesome-tools" target="_blank" rel="noopener">awesome-tools</a>基础上修改，添加自己使用的工具。有些是我也已经用的软件，有些是根据这篇文章才开始用的。</p>
<blockquote>
<p>从 <a href="https://github.com/sorrycc/blog/issues/83" target="_blank" rel="noopener">Blog</a> 迁移到 GitHub 仓库维护，可以有历史记录。</p>
</blockquote>
<h1 id="翻墙">翻墙</h1>
<p>主 <a href="https://home.rixcloud.me/aff.php?aff=1432" target="_blank" rel="noopener"><strong>rixcloud</strong></a>，备<strong>阿里云香港</strong>和<strong>公司翻墙</strong>。</p>
<ul>
<li>[ ] rixcloud 比较稳，特殊时期也能用，支持 surge 客户端，支持 netflix</li>
<li>[ ] 软件方面，Mac 下用 <a href="https://github.com/qinyuhang/ShadowsocksX-NG-R/releases" target="_blank" rel="noopener"><strong>ShadowsocksX-NG-R</strong></a>，iPhone 下用 <a href="https://itunes.apple.com/us/app/shadowrocket/id932747118?mt=8" target="_blank" rel="noopener"><strong>ShadowRocket</strong></a>（切美区下载）</li>
<li>[ ] 通过 <a href="https://www.proxifier.com/" target="_blank" rel="noopener"><strong>Proxifier</strong></a> 实现命令行应用或其他应用翻墙，比如 iTerm2 下执行 npm publish 偶尔会被墙，并且实测下来比 <code>export http_proxy</code> 快</li>
<li>[ ] 家里的路由器翻墙是用 <a href="https://www.asus.com/us/Networking/RT-AC88U/" target="_blank" rel="noopener"><strong>RT-AC88U</strong></a> + <strong>梅林小宝版固件</strong></li>
<li>[ ] 电视上看 youtube 和 netflix 可以用 <a href="https://www.nvidia.com/en-us/shield/" target="_blank" rel="noopener"><strong>Nvidia Shield TV</strong></a>，我买的美版，据说国版也可刷原生系统</li>
</ul>
<h1 id="mac-软件">Mac 软件</h1>
<ul>
<li>[ ] 用了 <a href="https://go.setapp.com/invite/sorrycc" target="_blank" rel="noopener">SetApp</a>，包含以下的不少付费应用，能省不少钱。</li>
</ul>
<h2 id="编辑器">编辑器</h2>
<ul>
<li>主 <a href="https://code.visualstudio.com/" target="_blank" rel="noopener"><strong>VSCode</strong></a> + <a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener"><strong>IntelliJ</strong></a></li>
<li>辅 <a href="https://www.jetbrains.com/webstorm/" target="_blank" rel="noopener"><strong>WebStorm</strong></a>和 <strong>Vim</strong>。如果没有时间去折腾插件，那就选 WebStorm， 无需安装插件就很好用。</li>
</ul>
<!-- - [ ] 字体用 [**Dank Mono**](https://dank.sh/) 和 [**Operator Mono**](http://www.typography.com/fonts/operator/overview/)，轮着用，看厌一个切另一个
- [ ] WebStorm 使用 [**material-theme-jetbrains**](https://github.com/ChrisRM/material-theme-jetbrains)，Theme 选 Material One Dark，字号 16 号，行距 1.2，[效果图](https://gw.alipayobjects.com/zos/rmsportal/JKRPNvvHhPgFonHHXvPe.png)
- [ ] WebStorm 插件额外装了 **File Watchers**、**GitLink**、**Import Cost**、**Prettier** 和 **Rainbow Brackets** -->
<ul>
<li>[x] <a href="http://liyuankun.top/Vscode-%E9%85%8D%E7%BD%AE%E5%92%8C%E6%8F%92%E4%BB%B6.html">Vscode 配置和插件</a>。</li>
</ul>
<h2 id="terminal">Terminal</h2>
<ul>
<li>[x] Terminal 用 <a href="https://www.iterm2.com/" target="_blank" rel="noopener"><strong>iTerm2</strong></a> + <a href="https://en.wikipedia.org/wiki/Z_shell" target="_blank" rel="noopener"><strong>zsh</strong></a> + <a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener"><strong>oh-my-zsh</strong></a> 的组合，主题是 <a href="https://github.com/robbyrussell/oh-my-zsh/blob/master/themes/robbyrussell.zsh-theme" target="_blank" rel="noopener">robbyrussell</a></li>
<li>[x] zsh 的插件开了 git、autojump、brew、git、git-extra、git-flow、git-prompt、git-remote-branch、github、gitignore、history、history-substring-search、iterm2、node、npm、npx、nvm、tig、vscode、yarn、<a href="https://github.com/zsh-users/zsh-autosuggestions" target="_blank" rel="noopener">zsh-autosuggestions</a></li>
<li>[] iTerm2 里配 <code>Run command...</code> 为 <code>/usr/local/bin/idea --path \2 \1</code> (<a href="https://zos.alipayobjects.com/rmsportal/RmWdxKRQUWFMoVDjerNQ.png" target="_blank" rel="noopener">图</a>)，这样 Command + 点击文件路径，就会在 Intellij Idea 里打开</li>
<li><a href="http://liyuankun.top/%E5%A5%A5%E5%88%A9%E7%BB%99%E4%BD%A0%E7%9A%84iTerm2-%E5%BF%AB%E9%80%9F%E7%94%A8IDE%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6.html#mac-%E9%85%8D%E7%BD%AEfinder%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%89%93%E5%BC%80iterm2">Mac 配置在Finder里用iTerm2打开当前目录</a>
<ul>
<li>[x] 方法一：安装Go2Shell【MAC OS 版本 &lt;= Big Sur】,  <code>!!!!!亲测版本V2.5, Mac OS Big Sur可以使用，Monterey不能使用</code>【我的百度网盘】</li>
<li>[x] <a href="http://liyuankun.top/%E5%A5%A5%E5%88%A9%E7%BB%99%E4%BD%A0%E7%9A%84iTerm2-%E5%BF%AB%E9%80%9F%E7%94%A8IDE%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6.html#%E9%99%A4go2shell%E7%9A%84%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95-mac-os-%E7%89%88%E6%9C%AC-monterey">方法二：安装OpenInTerminal【MAC OS 版本 &gt;= Monterey】</a>
<ul>
<li><a href="https://github.com/Ji4n1ng/OpenInTerminal/blob/master/Resources/README-zh.md" target="_blank" rel="noopener">OpenInTerminal</a>  【推荐】个人目前选择使用这个开源软件了，不仅可以用iTerm2打开，还可以配置用其他IDE例如VScode, sublime打开。</li>
</ul>
</li>
</ul>
</li>
<li>[x] 配置<a href="https://www.cnblogs.com/hongrunhui/p/5928833.html" target="_blank" rel="noopener">MAC终端命令行下用sublime、vscode、atom打开文件或目录</a>
<ul>
<li>[x] open .  用finder打开当前文件</li>
<li>[x] vsc .  用vscode打开当前文件</li>
<li>[x] subl .  用Sublime打开当前文件</li>
<li>[x] atom .  用Atom打开当前文件</li>
<li>[x] command + &lt;-  / -&gt;     切换tab</li>
<li>[x] control + w 回退一部分命令</li>
</ul>
</li>
<li><a href="https://tldr.sh/" target="_blank" rel="noopener">tldr</a> Simplified and community-driven <code>man</code> pages. Quick install: <code>npm install -g tldr</code>.
<ul>
<li>Take <code>git</code> for example, while <code>man</code> <code>git</code> outputs more than 100 lines. <code>&gt; tldr git</code></li>
</ul>
</li>
</ul>
<h2 id="开发辅助">开发辅助</h2>
<ul>
<li>
<p>[x] <a href="https://kapeli.com/dash" target="_blank" rel="noopener"><strong>Dash</strong></a> 快速查API文档。免费版本会在你搜索完后等10秒再显示，付费版：$29.99 无需等待。</p>
</li>
<li>
<p>[x] <a href="https://www.sourcetreeapp.com/" target="_blank" rel="noopener"><strong>SourceTree</strong></a>，git 辅助，由于 git 高级操作命令记不住，就只用借助 UI 了。</p>
</li>
<li>
<p>[x] <a href="https://paw.cloud/" target="_blank" rel="noopener"><strong>Paw</strong></a>，请求模拟，前后端联调API时用这个先走一遍。</p>
</li>
<li>
<p>[x] <a href="https://www.postman.com/" target="_blank" rel="noopener"><strong>Postman</strong></a>，请求模拟，前后端联调API时用这个先走一遍。</p>
</li>
<li>
<p>[x] <a href><strong>R</strong></a></p>
</li>
<li>
<p>[x] <a href><strong>RStudio</strong></a></p>
</li>
<li>
<p>[x] <a href><strong>Colloquy</strong></a></p>
</li>
<li>
<p>[x] <a href="https://cyberduck.io/" target="_blank" rel="noopener"><strong>Cyberduck</strong></a></p>
</li>
<li>
<p>[x] <a href="https://www.realvnc.com/en/connect/download/viewer/" target="_blank" rel="noopener"><strong>VNC Viewer</strong></a></p>
</li>
<li>
<p>[x] <a href><strong>Microsoft Remote Desktop</strong></a> [APP Store] 美版账号</p>
</li>
</ul>
<!-- - [ ] [**Github Desktop**](https://github.com/desktop/desktop)，管理 github 仓库的变更和 PR，代替了 SourceTree 的部分工作，可以方便地把别人的 PR checkout 到本地验证 -->
<ul>
<li>[x] <a href="https://github.com/2ndalpha/gasmask" target="_blank" rel="noopener"><strong>Gas Mask</strong></a> ，<a href="https://zhuanlan.zhihu.com/p/20466912" target="_blank" rel="noopener">Hosts 管理</a></li>
<li>[x] <a href="https://colorsnapper.com/" target="_blank" rel="noopener"><strong>ColorSnapper2</strong></a>，取色工具。付费，App store 没有。</li>
</ul>
<h3 id="抓包">抓包</h3>
<ul>
<li>[x] <a href="https://www.charlesproxy.com/" target="_blank" rel="noopener"><strong>Charles</strong></a>，抓包用，支持 https, 不免费，公司提供的付费账号。</li>
<li>[x] <a href><strong>OWASP ZAP</strong></a></li>
<li>[x] <a href><strong>Progress Telerik Fiddler</strong></a></li>
<li>[x] <a href><strong>Wireshark</strong></a></li>
</ul>
<h3 id="虚拟机">虚拟机</h3>
<ul>
<li>[x] <a href><strong>ParallelsDesktop</strong></a></li>
<li>[x] <a href><strong>VirtualBox</strong></a></li>
</ul>
<h3 id="数据库">数据库</h3>
<ul>
<li>[x] <a href="https://www.sequelpro.com/" target="_blank" rel="noopener"><strong>Sequel Pro</strong></a>，Mysql数据库客户端, 开源客户端，目前只有Mac版本。</li>
<li>[x] <a href><strong>DB Browser for SQLite</strong></a></li>
<li>[x] <a href><strong>MongoDB Compass</strong></a></li>
</ul>
<h3 id="浏览器">浏览器</h3>
<ul>
<li>[x] <a href="https://www.google.com/chrome/" target="_blank" rel="noopener"><strong>Google Chrome</strong></a> + <a href="https://www.google.com/chrome/canary/" target="_blank" rel="noopener"><strong>Google Chrome Canary</strong></a> + <a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank" rel="noopener"><strong>Firefox</strong></a> + <strong>Safari</strong>，浏览器，调试用，IE 的测试会借助内网的云测平台</li>
</ul>
<h2 id="输出">输出</h2>
<!-- - [ ] [**Ulysses**](https://ulysses.app/)，笔记工具，从 [Bear](http://www.bear-writer.com/) 和 [Notion](https://www.notion.so/?r=159be429981b4725ad6f36c4f599bd98) 切到 Ulysses -->
<ul>
<li>[x] <a href="https://www.onenote.com/signin?wdorigin=ondc" target="_blank" rel="noopener"><strong>Onenote</strong></a>，笔记工具，从 <a href="https://evernote.com/intl/zh-cn" target="_blank" rel="noopener">Evernote印象笔记</a> （原来是会员，现在只是免费版） 切到 Onenote，感觉Onenote对markdown支持不好（只有windows版本有插件可以支持markdown），准备换<a href="https://ulysses.app/" target="_blank" rel="noopener"><strong>Ulysses</strong></a>。不过我现在markdown一般都用vscode+github来写了。</li>
</ul>
<!-- - [ ] [**OmniGraffle**](https://www.omnigroup.com/omnigraffle) + [**iThoughtsX**](https://www.toketaware.com/ithoughts-osx) + iPad 上的 [**Whiteboard**](https://apps.apple.com/us/app/microsoft-whiteboard/id1352499399)，分别用于画架构图和和脑图 -->
<ul>
<li>[x] <a href="https://www.omnigroup.com/omnigraffle" target="_blank" rel="noopener"><strong>OmniGraffle</strong></a> + <a href="https://www.xmind.net/" target="_blank" rel="noopener"><strong>Xmind</strong></a> + iPad 上的 <a href="https://apps.apple.com/us/app/microsoft-whiteboard/id1352499399" target="_blank" rel="noopener"><strong>Whiteboard</strong></a>，分别用于画架构图和和脑图</li>
</ul>
<!-- - [ ] [**LICEcap**](http://www.cockos.com/licecap/) ，GIF 录屏工具 -->
<ul>
<li>[x] <a href="https://apps.apple.com/cn/app/gif-brewery-3-video-to-gif/id1081413713?l=en&amp;mt=12" target="_blank" rel="noopener"><strong>Gif Brewery 3</strong></a> ，GIF 录屏工具, 可以直接录屏并转换成gif动图。免费，App store 下载。</li>
</ul>
<h2 id="输入">输入</h2>
<ul>
<li>[x] <a href="http://reederapp.com/mac/" target="_blank" rel="noopener"><strong>Reeder</strong></a>，RSS 阅读软件</li>
</ul>
<!-- 我的主要信息来源，没有提供 rss 源的我会先在 [**rsshub.app**](https://docs.rsshub.app/) 上找，再没有就自己写一个 serverless 服务部署在 [now](https://zeit.co/) 上，[now使用方法](http://object.ws/2017/09/10/nowsh-note/) -->
<ul>
<li>[x] <a href="http://kiwiforgmail.com/" target="_blank" rel="noopener"><strong>Kiwi for Gmail</strong></a>，Gmail 客户端, 我用的免费的lite版，App store 要切换到美国。</li>
</ul>
<h2 id="效率">效率</h2>
<ul>
<li>[x] <a href="https://www.alfredapp.com/" target="_blank" rel="noopener"><strong>Alfred</strong></a> + <a href="https://www.alfredapp.com/powerpack/" target="_blank" rel="noopener"><strong>Powerpack</strong></a>，应用启动、粘贴板管理、Workflow、Snippets 管理等。 同步问题可以参考：<a href="https://www.zhihu.com/question/39098799" target="_blank" rel="noopener">Alfred 中如何在不同电脑上同步自定义设置？</a> 和 <a href="https://mac.orsoon.com/news/337637.html" target="_blank" rel="noopener">在Mac之间同步您的Alfred设置</a>。免费功能：File search, Web search，app启动, Calculator, Dictionary, System。付费功能（需购买Powerpack）：Workflow，Action, Clipboard History，Snippets, Contacts, itunes, 1Password, Terminal.</li>
</ul>
<!-- - [ ] [**Paste**](https://pasteapp.me/)，粘贴板管理，[**Copied**](https://copiedapp.com/) 在 mac 10.15 下有 bug 就放弃了，再之前一直用 Alfred 的粘贴板 -->
<!-- - [ ] [**TaskPaper**](https://www.taskpaper.com/)，任务管理 -->
<!-- - [ ] [**OmniFocus**](https://www.omnigroup.com/omnifocus) ，任务管理，通过 Omni Sync Server 和 iPhone 同步 -->
<ul>
<li>[x] <a href="https://dida365.com/" target="_blank" rel="noopener"><strong>TickTick滴答</strong></a> ，任务管理，有MAC版和iPhone版，可以同步。</li>
<li>[x] <a href="https://github.com/gbammc/Thor" target="_blank" rel="noopener"><strong>Thor</strong></a>，一键直达应用， 免费，开源。</li>
<li>[x] <a href="https://pqrs.org/osx/karabiner/" target="_blank" rel="noopener"><strong>Karabiner Element</strong></a>，用于<a href="http://lucifr.com/2013/02/16/caps-lock-to-hyper-key/" target="_blank" rel="noopener">把右 Command 和 Capslock 键利用起来</a>，避免快捷键冲突，<a href="https://hackmd.io/s/rk4u9i-pG" target="_blank" rel="noopener">简单 note</a>，详见<a href="https://www.bilibili.com/video/av44127555" target="_blank" rel="noopener">sorrycc的《我的快捷键技巧》</a>.
<ul>
<li>[ ] <a href="./Karabiner-Elements%E4%B8%8D%E7%94%9F%E6%95%88.html">Karabiner-Elements不生效解决方法</a></li>
</ul>
</li>
</ul>
<h2 id="摄影相关">摄影相关</h2>
<h3 id="图片">图片</h3>
<!-- - [ ] [**ScreenFlow**](http://www.telestream.net/screenflow/overview.htm)，视频录制和剪辑 -->
<!-- - [ ] [**Final Cut Pro**](https://www.apple.com/final-cut-pro/)，视频剪辑 -->
<ul>
<li>[x] <a href="https://imageoptim.com/mac" target="_blank" rel="noopener"><strong>imageoptim</strong></a>免费且开源的 Mac 图片无损压缩优化工具。默认设置下，它的压缩号称是「无损」的，也就是说画质不会被改变，但体积却可以被减小。ImageOptim 支持 PNG、JPG、GIF 格式的图片压缩优化，你只需将文件拖放到它的界面上即可完成优化 (PS：处理后会覆盖原图 / 原图被移到垃圾桶，可手工恢复)，支持批量，使用上非常简单方便。</li>
<li>[x] <a href="https://www.pcpc.me/tech/mac-image-capture" target="_blank" rel="noopener"><strong>Image Capture</strong></a>macOS预先安装，自带app。可以使用iTunes或照片将iOS设备，相机或SD卡中的照片导入Mac。但是，如果您在使用这些应用程序时遇到麻烦，或者您希望使用界面更简单的应用程序，请尝试使用Image Capture。</li>
<li>[x] <a href="https://skylum.com/luminar" target="_blank" rel="noopener"><strong>Luminar 2018</strong></a> 修图工具。限时免费的时候下载的。</li>
</ul>
<h3 id="视频">视频</h3>
<ul>
<li>
<p>[x] <a href="https://github.com/avibrazil/RDM" target="_blank" rel="noopener"><strong>RDM</strong></a>，分辨率切换，允许设置未支持的分辨率，比如我会在录屏时设置 720p(hd) 的分辨率。在使用多个外接显示屏的时候，也可以调整外接显示屏的分辨率，很方便。免费，开源。</p>
</li>
<li>
<p>[x] <a href="https://github.com/keycastr/keycastr" target="_blank" rel="noopener"><strong>KeyCastr</strong></a>，你在键盘上按了哪些键，会显示在屏幕上，适合录屏的时候使用。通过 homebrew cask 安装: <code>brew cask install keycastr</code>。记得mac设置Security &amp; Privacy下的Input monitoring 和 Accessibility里面要加上并勾选。顺便把开始显示键盘的快捷键设置成了F19 + k。免费，开源。</p>
</li>
<li>
<p>[x] <a href="https://www.blackmagicdesign.com/products/davinciresolve/" target="_blank" rel="noopener"><strong>DaVinci Resolve 16</strong></a> 达芬奇，视频剪辑，有免费版本，影视飓风在B站有免费教程。</p>
</li>
<li>
<p>[x] <a href="https://apps.apple.com/cn/app/blackmagic-raw-player/id1435415804?mt=12" target="_blank" rel="noopener"><strong>Blackmagic RAW Player</strong></a> Blackmagic RAW Player是观看Blackmagic RAW格式片段的理想选择。Blackmagic RAW Player能够播放Blackmagic RAW格式的媒体文件，以及扩展名为.braw的媒体文件。App store 有，免费。</p>
</li>
<li>
<p>[x] <a href="https://apps.apple.com/cn/app/blackmagic-raw-speed-test/id1466185689?mt=12" target="_blank" rel="noopener"><strong>Blackmagic RAW Speed Test</strong></a> Blackmagic RAW Speed Test是一套CPU和GPU衡量工具，可用于测试系统上解码全分辨率Blackmagic RAW帧的速度。测试中多个CPU内核和GPU会被自动检测和使用，为您提供准确实际的结果。只需选择Blackmagic RAW固定比特率3:1、5:1、8:1或12:1，以及您想要的分辨率即可执行测试。测试结果以简单明了的表格形式展示，显示了您的计算机每秒解码所有支持分辨率的帧数。App store 有，免费。</p>
</li>
<li>
<p>[x] <a href="https://www.blackmagicdesign.com/products/davinciresolve/" target="_blank" rel="noopener"><strong>PluralEyes 4</strong></a> Red Giant PluralEyes for mac是Mac平台上一款专业的音视频同步剪辑软件，pluraleyes 4 mac支持使用轨道和媒体剪辑、跨区剪辑、临时同步文件、调整同步结果、微调同步、导出为媒体文件、导出时间轴等功能，能够轻松处理多机位的音视频同步问题。付费。</p>
</li>
<li>
<p>[ ] <a href="https://softorino.com/youtube-converter" target="_blank" rel="noopener"><strong>Softorino YouTube Converter</strong></a>，免费24小时，之后付费，YouTube 视频下载</p>
</li>
<li>
<p>[ ] <a href="https://github.com/ytdl-org/youtube-dl/blob/master/README.md#readme" target="_blank" rel="noopener"><strong>youtube-dl</strong></a> <a href="https://zhuanlan.zhihu.com/p/27718783" target="_blank" rel="noopener">命令行视频下载利器，选择下载视频，或是将视频流直接导出到自己想使用的播放器中</a>。国内类似版本： <a href="https://github.com/soimort/you-get" target="_blank" rel="noopener">You-Get</a>，对国内平台支持的更好。</p>
</li>
</ul>
<!-- - [ ] [**Downie 3**](http://software.charliemonroe.net/downie.php)，通用视频下载，付费，SetApp含有 -->
<ul>
<li>[ ] <a href="https://mac.eltima.com/download-manager.html" target="_blank" rel="noopener"><strong>Folx 5</strong></a> + <a href="https://www.qbittorrent.org/" target="_blank" rel="noopener"><strong>qBittorrent</strong></a> + <a href="https://motrix.app/" target="_blank" rel="noopener"><strong>Motrix</strong></a>，下载工具，Folx 下 http，qBittorrent 下 magnet，Motrix 是 aria2 的封装，可以<a href="https://www.yuque.com/moapp/help/extensions" target="_blank" rel="noopener">下百度云盘、115 等</a></li>
<li>[ ] <a href="https://justgetflux.com" target="_blank" rel="noopener"><strong>f.lux</strong></a>，调节显示器色温，护眼，尤其是早上起来屏幕实在是刺眼</li>
<li>[x] <a href="https://github.com/iina/iina" target="_blank" rel="noopener"><strong>IINA</strong></a>，<a href="https://iina.io/" target="_blank" rel="noopener">IINA</a>视频播放。原来用的<a href="https://www.videolan.org/vlc/index.zh.html" target="_blank" rel="noopener">VLC media player</a>，后来<a href="https://www.zhihu.com/question/19552878/answer/139035466" target="_blank" rel="noopener">改用IINA</a>。开源，免费。</li>
</ul>
<h3 id="作图">作图</h3>
<ul>
<li>[x] <a href><strong>SketchUp 2018</strong></a></li>
</ul>
<h2 id="其他">其他</h2>
<ul>
<li>
<p>[x] <a href="https://macpaw.com/cleanmymac" target="_blank" rel="noopener">**CleanMyMac **</a>，系统清理， 付费。</p>
</li>
<li>
<p>[x] <a href="https://www.omnigroup.com/more" target="_blank" rel="noopener">**OmniDiskSweeper **</a> 系统文件清理。开源免费软件。</p>
</li>
<li>
<p>[ ] <a href="https://1password.com/" target="_blank" rel="noopener"><strong>1Password</strong></a>，密码管理</p>
</li>
<li>
<p>[x] <a href="https://www.lastpass.com/" target="_blank" rel="noopener"><strong>Last Password</strong></a>，密码管理 浏览器插件免费，手机app需要Premium会员（我iphone上用苹果的密码记录,就没使用Last Password）, 1Password也不错，这两个都可以。</p>
</li>
</ul>
<!-- - [ ] [**Bartender 3**](https://www.macbartender.com/)，管理系统右上菜单项，隐藏或收起不常用的，付费。 -->
<ul>
<li>
<p>[x] <a href="https://github.com/newmarcel/KeepingYouAwake" target="_blank" rel="noopener"><strong>KeepingYouAwake</strong></a>，可保证Mac系统不自动休眠。原来用的<a href="http://lightheadsw.com/caffeine/" target="_blank" rel="noopener">Caffeine</a>，但是<a href="https://www.reddit.com/r/osx/comments/9pbl9u/macos_mojave_caffeine_replacement/" target="_blank" rel="noopener">MacOS更新到Mojave以后就不管用了</a>。可以改用Amphetamine 或者 KeepingYouAwake。免费，开源。</p>
</li>
<li>
<p>[x] <a href="https://itunes.apple.com/cn/app/perculia/id1462633284?mt=12" target="_blank" rel="noopener"><strong>Perculia</strong></a> - 蓝牙设备管理，可以一键连耳机。App store 有，免费。</p>
</li>
<li>
<p>[ ] <a href="https://jietu.qq.com/" target="_blank" rel="noopener"><strong>截图</strong></a>，顾名思义，腾讯出的截图工具，App store 有，免费。</p>
</li>
<li>
<p>[x] <a href="https://itunes.apple.com/nz/app/runcat/id1429033973?mt=12&amp;ref=appinn" target="_blank" rel="noopener"><strong>RunCat</strong></a> - 菜单栏显示奔跑的小猫，CPU 占用率越高跑地越快。App store 有，免费。</p>
</li>
<li>
<p>[x] <a href="https://slack.com/downloads/mac" target="_blank" rel="noopener"><strong>Slack</strong></a> + <a href="https://im.qq.com/macqq/" target="_blank" rel="noopener"><strong>QQ</strong></a> + <a href="https://mac.weixin.qq.com/" target="_blank" rel="noopener"><strong>微信</strong></a> + <a href="https://tms.dingtalk.com/markets/dingtalk/download" target="_blank" rel="noopener"><strong>钉钉</strong></a>，通讯交流。App store 有，免费。</p>
</li>
<li>
<p>[ ] <a href="https://www.tuxera.com/products/tuxera-ntfs-for-mac/" target="_blank" rel="noopener"><strong>Tuxera NTFS</strong></a> - 支持 NTFS 格式硬盘，付费。</p>
</li>
<li>
<p>[x] <a href="https://www.seagate.com/pl/pl/support/software/paragon/" target="_blank" rel="noopener"><strong>Microsoft NTFS for Mac by Paragon Software</strong></a> - 支持 NTFS 格式硬盘，因为原来买了希捷的移动硬盘，送的软件，一般、够用。</p>
</li>
<li>
<p>[x] <a href="https://apps.apple.com/dk/app/drivedx/id526290112?mt=12" target="_blank" rel="noopener">DriveDx</a> – 磁盘健康检测和监控工具，付费。</p>
</li>
</ul>
<h2 id="命令行">命令行</h2>
<h3 id="通过-homebrew-安装">通过 <a href="https://brew.sh/" target="_blank" rel="noopener">homebrew</a> 安装</h3>
<ul>
<li>[x] <a href="https://github.com/wting/autojump" target="_blank" rel="noopener"><strong>autojump</strong></a>，目录跳转</li>
<li>[ ] <a href="https://github.com/ggreer/the_silver_searcher" target="_blank" rel="noopener"><strong>the_silver_searcher</strong></a>，文件搜索，命令行是 ag</li>
<li>[ ] <a href="https://hub.github.com/" target="_blank" rel="noopener"><strong>hub</strong></a> - git 扩展</li>
<li>[ ] <a href="https://github.com/jonas/tig" target="_blank" rel="noopener"><strong>tig</strong></a> - git 扩展</li>
<li>[ ] <a href="https://github.com/sharkdp/bat" target="_blank" rel="noopener"><strong>bat</strong></a>，带行号的 cat，可以配 <code>alias cat=&quot;bat&quot;</code></li>
<li>[ ] <a href="https://github.com/sharkdp/fd" target="_blank" rel="noopener"><strong>fd</strong></a>，比系统自带的 find 友好</li>
</ul>
<h3 id="通过-yarn-global-add-安装">通过 <code>yarn global add</code> 安装</h3>
<ul>
<li>[ ] <a href="https://github.com/popomore/projj" target="_blank" rel="noopener"><strong>projj</strong></a>，github/gitlab 项目管理</li>
<li>[ ] <a href="https://github.com/zeit/serve" target="_blank" rel="noopener"><strong>serve</strong></a>，本地静态服务器</li>
<li>[ ] <a href="https://github.com/sindresorhus/fkill" target="_blank" rel="noopener"><strong>fkill</strong></a>，比 kill 好用的进程 killer</li>
<li>[ ] <a href="https://github.com/gtanner/qrcode-terminal" target="_blank" rel="noopener"><strong>qrcode-terminal</strong></a>，二维码生成</li>
</ul>
<h2 id="chrome-插件">Chrome 插件</h2>
<h3 id="github-相关">Github 相关</h3>
<ul>
<li>[ ] <a href="https://github.com/OctoLinker/browser-extension" target="_blank" rel="noopener"><strong>OctoLinker</strong></a>，根据 require/import 或 package.json 中的 dependencies 进行快速跳转</li>
<li>[x] <a href="https://github.com/sindresorhus/refined-github" target="_blank" rel="noopener"><strong>Refined Github</strong></a>，Github 改进</li>
<li>[ ] <a href="https://github.com/npmhub/npmhub" target="_blank" rel="noopener"><strong>npmhub</strong></a>，在 README 下方显示 npm 依赖信息</li>
<li>[ ] <a href="https://github.com/sindresorhus/hide-files-on-github" target="_blank" rel="noopener"><strong>Hide Files on GitHub</strong></a>，隐藏配置文件等非必要文件</li>
<li>[ ] <a href="https://github.com/Justineo/github-hovercard" target="_blank" rel="noopener"><strong>Github Hovercard</strong></a>，比如不用点进去就能看到 issue 详情</li>
<li>[x] <a href="https://chrome.google.com/webstore/detail/git-history-browser-exten/laghnmifffncfonaoffcndocllegejnf" target="_blank" rel="noopener"><strong>Git History Browser Extension</strong></a>，可视化的方式显示文件修改历史</li>
<li>[x] <a href="https://chrome.google.com/webstore/detail/file-icon-for-github-gitl/ficfmibkjjnpogdcfhfokmihanoldbfe" target="_blank" rel="noopener"><strong>File Icon for GitHub, GitLab and Bitbucket</strong></a>，更好看的文件 icon</li>
<li>[x] <a href="https://github.com/ovity/octotree" target="_blank" rel="noopener"><strong>octotree</strong></a>，显示文件树形目录</li>
</ul>
<h3 id="其他-v2">其他</h3>
<ul>
<li>[x] <a href="https://workona.com/" target="_blank" rel="noopener"><strong>Workona</strong></a>，tab 管理，基于使用场景，<a href="https://chrome.google.com/webstore/detail/workona/ailcmbgekjpnablpdkmaaccecekgdhlh?hl=en-GB" target="_blank" rel="noopener">Chrome插件地址</a>。非常推荐，让我可以抛弃原来的oneTab插件了，非常适合我这种什么网页都舍不得关的人。</li>
<li>[x] <a href="https://app.grammarly.com/" target="_blank" rel="noopener"><strong>Grammer</strong></a>，语法提醒插件，拼写错误和语法错误都可以提醒，主要辅助我工作上的英文交流。它现在不仅有浏览器插件、office插件，Mac上也有app了.</li>
<li>[x] <a href="https://github.com/callumlocke/json-formatter" target="_blank" rel="noopener"><strong>JSON Formatter</strong></a>，让 JSON 更易读</li>
<li>[ ] <a href="https://chrome.google.com/webstore/detail/chrome-better-history/aadbaagbanfijdnflkhepgjmhlpppbad?hl=en" target="_blank" rel="noopener"><strong>Better History</strong></a>，搜索历史记录用</li>
<li>[ ] <a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo" target="_blank" rel="noopener"><strong>Tampermonkey</strong></a>，油猴，通过脚本定制网页</li>
<li>[ ] <a href="https://chrome.google.com/webstore/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm" target="_blank" rel="noopener"><strong>uBlock Origin</strong></a>，广告 Block</li>
<li>[ ] <a href="https://chrome.google.com/webstore/detail/imdb-ratings-for-netflix/dnbpnlalaijjbogmjbpdkdcohoibjcmp/related?hl=en" target="_blank" rel="noopener"><strong>Netflix Rating</strong></a>，在 netflix 上显示每个影片的 IMDB 的评分信息</li>
<li>[ ] <a href="https://chrome.google.com/webstore/detail/select-like-a-boss/mnbiiidkialopoakajjpeghipbpljffi/related?hl=en" target="_blank" rel="noopener"><strong>Select like a boss</strong></a>，可以选择链接里的内容</li>
<li>[ ] <a href="https://chrome.google.com/webstore/detail/lingocloud-interpreter/jmpepeebcbihafjjadogphmbgiffiajh/related" target="_blank" rel="noopener"><strong>Lingocloud Interpreter</strong></a>，全文翻译</li>
<li>[ ] <a href="https://chrome.google.com/webstore/detail/video-speed-controller/nffaoalbilbmmfgbnbgppjihopabppdk/related?hl=en" target="_blank" rel="noopener"><strong>Video Speed Controller</strong></a>，在视频上显示按钮可控制播放速度</li>
</ul>
<h1 id="mac-设置">Mac 设置</h1>
<ul>
<li>[x] <a href="https://www.zhihu.com/question/49530172" target="_blank" rel="noopener">固定MAC窗口顺序</a></li>
</ul>
<h1 id="iphone-软件">iPhone 软件</h1>
<h2 id="每天用">每天用</h2>
<ul>
<li>[x] <strong>支付宝</strong></li>
<li>[x] <strong>微信</strong></li>
<li>[x] <strong>Chrome</strong>，代替 Safari，好处是可以和电脑同步</li>
<li>[x] <strong>Gmail</strong></li>
<li>[ ] <strong>Reeder</strong>，我是 RSS 重度用户</li>
<li>[x] <strong>钉钉</strong>，工作交流</li>
<li>[ ] <strong>Shadowrocket</strong>，你懂的，需切换美区安装</li>
<li>[x] <strong>Twitter</strong>，感觉官方客户端够用了</li>
<li>[ ] <strong>Workflow</strong>，最常用的一个 workflow 是 clipboard to instapaper，用于把微信文章经由 instapaper 保存到 github issue</li>
<li>[x] <strong>网易云音乐</strong></li>
<li>[ ] <strong>OmniFocus</strong>，任务管理</li>
</ul>
<p>更多 <a href="https://github.com/sorrycc/ama/issues/12" target="_blank" rel="noopener">https://github.com/sorrycc/ama/issues/12</a></p>
<h1 id="在线服务">在线服务</h1>
<h3 id="免费">免费</h3>
<ul>
<li>[x] <a href="http://refiddle.com/" target="_blank" rel="noopener"><strong>refiddle</strong></a> + <a href="https://regex101.com/" target="_blank" rel="noopener"><strong>regex101</strong></a>，调正则表达式</li>
<li>[x] <a href="https://30secondsofcode.org/" target="_blank" rel="noopener"><strong>30 seconds of code</strong></a>，代码片段</li>
<li>[x] <a href="https://astexplorer.net/" target="_blank" rel="noopener"><strong>astexplorer</strong></a>，调 ast</li>
</ul>
<!-- - [ ] [**globtester**](http://www.globtester.com/)，调 glob -->
<ul>
<li>[x] <a href="http://ghub.io/" target="_blank" rel="noopener"><strong>ghub.io</strong></a>，redirect to an npm package’s repository page</li>
<li>[x] <a href="https://unpkg.com/" target="_blank" rel="noopener"><strong>unpkg</strong></a>，npm 包的 cdn 服务，可以查看 npm 包发布后的内容</li>
<li>[x] <a href="https://sketchboard.me/" target="_blank" rel="noopener"><strong>sketchboard</strong></a> + <a href="https://www.draw.io/" target="_blank" rel="noopener"><strong>draw.io</strong></a> + <a href="https://www.mindmeister.com/" target="_blank" rel="noopener"><strong>MindMeister</strong></a> + <a href="https://whimsical.com/" target="_blank" rel="noopener"><strong>Whimsical</strong></a>，在线画流程图</li>
<li>[x] <a href="https://hackmd.io/recent" target="_blank" rel="noopener"><strong>HackMD</strong></a>，在线笔记，有 PPT 展示功能</li>
<li>[x] <a href="https://slides.com/" target="_blank" rel="noopener"><strong>Slides</strong></a>，PPT 制作，带动画</li>
<li>[x] <a href="https://codesandbox.io/" target="_blank" rel="noopener"><strong>CodeSandbox</strong></a> + <a href="https://glitch.com/" target="_blank" rel="noopener"><strong>glitch</strong></a> + <a href="https://repl.it/" target="_blank" rel="noopener"><strong>repl.it</strong></a>+<a href="https://codepen.io/" target="_blank" rel="noopener">codepen</a>，在线代码编辑，前者支持 sandbox container，可以跑 npm scripts</li>
<li>[x] <a href="https://node.green/" target="_blank" rel="noopener"><strong>node.green</strong></a>，查询 NodeJS 的 ES2018 特性支持情况</li>
<li>[x] <a href="https://caniuse.com/" target="_blank" rel="noopener"><strong>Can I use</strong></a>，查询浏览器的特性支持情况</li>
<li>[x] <a href="https://carbon.now.sh/" target="_blank" rel="noopener"><strong>carbon</strong></a>，根据源码生成图片</li>
<li>[x] <a href="https://tellmewhenitcloses.com" target="_blank" rel="noopener"><strong>Tell me when it closes</strong></a>，github issue 关闭时发送邮件通知</li>
<li>[x] <a href="https://diff.intrinsic.com/" target="_blank" rel="noopener"><strong>Package Diff</strong></a>，比较 npm 包两个版本直接的区别</li>
<li>[x] <a href="https://send.firefox.com/" target="_blank" rel="noopener"><strong>Firefox Send</strong></a> + <a href="https://github.com/timvisee/ffsend" target="_blank" rel="noopener"><strong>ffsend</strong></a>，文件分享服务</li>
<li>[x] <a href="https://cloudconvert.com/" target="_blank" rel="noopener"><strong>Cloud Convert</strong></a>，支持 218 种格式相互转换</li>
<li>[x] <a href="https://www.smooth-code.com/open-source/svgr/playground/" target="_blank" rel="noopener"><strong>SVGR</strong></a>，SVG 转 React 组件</li>
<li>[x] （beta）<a href="https://webpack.jakoblind.no/" target="_blank" rel="noopener"><strong>Webpack config tool</strong></a>，webpack 配置工具</li>
</ul>
<h3 id="付费">付费</h3>
<ul>
<li>[x] <a href="https://www.safaribooksonline.com/" target="_blank" rel="noopener"><strong>Oreilly Safari Books</strong></a>，Oreilly 图书、视频教程、newsletter 等。付费，公司报销，很划算，等于我没掏钱。</li>
</ul>
<!-- - [ ] [**Frontend Masters**](https://frontendmasters.com/)，视频教程 -->
<!-- - [ ] [**Zeit Now**](https://zeit.co/now)，serverless 服务，域名等 -->
<!-- - [ ] [**name.com**](https://www.name.com/)，域名服务，之后会转到 Zeit Now 上 -->
<!-- - [ ] [**少数派 Power+ 2.0**](https://sspai.com/series/70)，提效相关文章 -->
<ul>
<li>[x] <a href="https://music.163.com/" target="_blank" rel="noopener"><strong>网易云音乐</strong></a></li>
</ul>
<!-- - [ ] **百度云盘** + **115 网盘** + [**麦果网盘中转**](https://www.maiguopan.com/)，资料下载 -->
<ul>
<li>[x] <strong>爱奇艺</strong>（苏宁会员） + <strong>腾讯视频</strong> + <strong>优酷</strong>（88会员） + <strong>bilibili</strong>，会员去广告</li>
</ul>
<!-- - [ ] [**Netflix**](https://www.netflix.com)，蹭 [pigcan](http://github.com/pigcan) 的账号 -->
<!-- - [ ] [**Youtube Premium**](https://www.youtube.com/)，主要为了 iPhone 上切换应用或锁屏后能继续播放 -->
<!-- - [ ] [**SetApp**](https://go.setapp.com/invite/sorrycc)，喊几个好友一起买，可以省不少钱 -->
<h1 id="硬件">硬件</h1>
<h2 id="电脑">电脑</h2>
<ul>
<li>[ ] <strong>MacBook Pro 15-inch, 2017</strong>，公司配的，512 G 不太够用，但还行吧。自己的电脑<strong>MacBook Pro 15-inch, 2013</strong>准备用<a href="https://detail.tmall.com/item.htm?id=569327401210&amp;spm=a1z09.2.0.0.76a52e8dZEojbU&amp;_u=l1h6urtf206" target="_blank" rel="noopener">三星 970</a> 升了 1T 硬盘</li>
</ul>
<h2 id="电脑配件">电脑配件</h2>
<!-- - [ ] [**U28E590D**](https://detail.tmall.com/item.htm?id=523282229383) x2，三星显示器，应该是 4K 中最便宜的了 -->
<ul>
<li>[ ] <a href="https://detail.tmall.com/item.htm?id=594024489687&amp;spm=a1z09.2.0.0.260f2e8drJ2dpC&amp;_u=cgkogtg55d4&amp;sku_properties=5919063:6536025" target="_blank" rel="noopener"><strong>AOC 32英寸4K曲面显示器</strong></a> 公司用的dell，家里用的AOC 32英寸4K曲面显示器。</li>
</ul>
<!-- - [ ] (**HHKB Pro 2 无刻** + [彩色键帽](https://item.taobao.com/item.htm?id=522721338431&_u=41h6urte838)) x2 -->
<ul>
<li>[ ] <a href="https://www.apple.com.cn/shop/product/MRMH2CH/A?fnode=7b42677784b656a8070a65a4b45fb9bb0e53cf839f4843024382ab3c691eb0cad59601137a779152887a1ae9e81734d538be3e41128798b0946b68981dd0cc35f7adcc869bf70d088fdf71fc297938893a63c6baa2e12bbb3f288516a56954e5" target="_blank" rel="noopener"><strong>带有数字小键盘的妙控键盘 - 银色</strong></a></li>
</ul>
<!-- - [ ] [**Razer DeathAdder Chroma**](http://www.razerzone.com/store/razer-deathadder-chroma) x2 -->
<ul>
<li>[ ] <a href><strong>罗技无线鼠标</strong></a></li>
</ul>
<h2 id="家庭网络">家庭网络</h2>
<!-- - [ ] J1900 软路由 + UBNT 交换机 + （UBNT AP & [**华硕 RT-AC88U**](https://item.jd.com/2104499.html)） -->
<h2 id="手机">手机</h2>
<ul>
<li>[x] <a href="https://www.apple.com/iphone-x/" target="_blank" rel="noopener"><strong>iPhoneXS MAX</strong></a></li>
</ul>
<h2 id="耳机">耳机</h2>
<ul>
<li>[x] <a href="https://detail.tmall.com/item.htm?id=577955986589&amp;spm=a1z09.2.0.0.260f2e8drJ2dpC&amp;sku_properties=5919063:6536025" target="_blank" rel="noopener"><strong>Sony/索尼 WH-1000XM3</strong></a>，头戴式无线降噪蓝牙耳机1000X，天猫618买的。淘口令：(￥kusV1GSXOve￥)</li>
</ul>
<h2 id="相机">相机</h2>
<ul>
<li>[x] <a href="https://www.fujifilmusa.com/products/digital_cameras/x/fujifilm_x100t/" target="_blank" rel="noopener"><strong>Sony A6000</strong></a> 准备换A7</li>
<li>[x] <a href="https://zh.shop.gopro.com/China/cameras/hero7-black/CHDHX-701-master.html" target="_blank" rel="noopener"><strong>大疆手机稳定器</strong></a></li>
</ul>
<h1 id="参考链接">参考链接</h1>
<p><a href="https://github.com/sorrycc/awesome-tools" target="_blank" rel="noopener">awesome-tools</a></p>
<!-- - [ ] [awesome-f2e-libs](https://github.com/sorrycc/awesome-f2e-libs) -我关注的前端库。
- [ ] [旧版本的装了啥](https://github.com/sorrycc/blog/issues/16) -->
<h2 id="rss-阅读器">RSS 阅读器</h2>
<p>Reeder 好，MACOS+IOS 但是要付费<br>
NetNewsWire 免费，只有IOS</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>内容简介</th>
<th>缺点</th>
<th>适用平台</th>
<th>评分</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.inoreader.com/?lang=zh_CN" target="_blank" rel="noopener">InoReader</a></td>
<td>用户体验非常好，界面简洁而且漂亮，不限制订阅源。</td>
<td>速度慢，有广告。</td>
<td>Web/IOS/Android</td>
<td>9.1</td>
</tr>
<tr>
<td><a href="https://feedly.com/" target="_blank" rel="noopener">Feedly</a></td>
<td>老牌阅读器，创建于2008年，有网页版和手机APP。</td>
<td><code>部分功能收费</code>，速度慢。</td>
<td>Web/IOS/Android</td>
<td>9.0</td>
</tr>
<tr>
<td><a href="https://tt-rss.org/" target="_blank" rel="noopener">TinyTinyRSS</a></td>
<td><code>开源免费</code>的RSS阅读器，功能上可以满足大部分人的需要。</td>
<td>需要自己购买空间搭建。</td>
<td>PC/手机</td>
<td>9.0</td>
</tr>
<tr>
<td><a href="http://reederapp.com/" target="_blank" rel="noopener">Reeder</a></td>
<td>IOS和Mac最佳RSS阅读器。</td>
<td>没有网页版，产品为<code>付费</code>。</td>
<td>IOS/Mac</td>
<td>8.9</td>
</tr>
<tr>
<td><a href="https://ranchero.com/netnewswire/" target="_blank" rel="noopener">NetNewsWire</a></td>
<td><code>免费</code>！！</td>
<td>没有网页版。</td>
<td>IOS/Mac</td>
<td>8.9</td>
</tr>
<tr>
<td><a href="https://miniflux.net/" target="_blank" rel="noopener">Miniflux</a></td>
<td>一款简洁<code>开源</code>RSS阅读器程序，功能简单但是实用。</td>
<td>需要自己购买空间搭建程序。</td>
<td>PC</td>
<td>8.8</td>
</tr>
<tr>
<td><a href="http://www.rssowl.org/" target="_blank" rel="noopener">RSSOwl</a></td>
<td>用 Java 编写，跨平台的桌面 Feed 阅读器。有强大的过滤和搜索功能、可定制的通知。</td>
<td>没有Web, 没有手机端。</td>
<td>Mac/Win/Linux</td>
<td>8.6</td>
</tr>
<tr>
<td><a href="http://digg.com/reader" target="_blank" rel="noopener">Digg Reader</a></td>
<td>老牌的<code>免费</code>在线RSS阅读器，出自Digg旗下，很稳定。</td>
<td>速度慢，好久没有更新。</td>
<td>PC/手机</td>
<td>8.5</td>
</tr>
<tr>
<td><a href="https://feeder.co/" target="_blank" rel="noopener">Feeder</a></td>
<td>一个用户体验不错的RSS阅读器。</td>
<td>有广告，速度慢。</td>
<td>PC/手机</td>
<td>8.5</td>
</tr>
<tr>
<td><a href="https://wzfou.com/nextcloud/" target="_blank" rel="noopener">Nextcloud News</a></td>
<td>Nextcloud自带的RSS阅读插件，可以打造成一个RSS阅读器。</td>
<td>需要自己搭建环境。</td>
<td>PC/手机</td>
<td>8.3</td>
</tr>
<tr>
<td><a href="http://reader.aol.com/" target="_blank" rel="noopener">AOL Reader</a></td>
<td>互联网媒体巨头AOL旗下的RSS阅读器。</td>
<td>速度慢。</td>
<td>PC/手机</td>
<td>8.3</td>
</tr>
<tr>
<td><a href="http://www.feedspot.com/" target="_blank" rel="noopener">Feedspot</a></td>
<td>国外一个RSS阅读器，提供中文界面。</td>
<td>PC/手机</td>
<td>8.0</td>
<td></td>
</tr>
<tr>
<td>QQ阅读空间</td>
<td>QQ邮箱自带的一款在线RSS阅读器。</td>
<td>长期不更新，不支持Https订阅源。</td>
<td>PC</td>
<td>8.0</td>
</tr>
<tr>
<td><a href="http://azreader.net/" target="_blank" rel="noopener">AZ Reader</a></td>
<td>国内自建的RSS阅读器</td>
<td>PC</td>
<td>7.9</td>
<td></td>
</tr>
<tr>
<td><a href="http://www.feeddemon.com/" target="_blank" rel="noopener">FeedDemon</a></td>
<td>老牌的RSS阅读器软件，从2013年不再更新，但是不影响使用。</td>
<td>仅PC软件，无Web和APP。</td>
<td>PC</td>
<td>7.9</td>
</tr>
<tr>
<td><a href="https://www.open-tickr.net/" target="_blank" rel="noopener">Tickr</a></td>
<td>桌面客户端，会将你的 Feed 标题如滚动新闻那样在桌面横栏上滚动显示。</td>
<td>仅软件，没有Web和APP</td>
<td>PC</td>
<td>7.7</td>
</tr>
<tr>
<td><a href="https://theoldreader.com/" target="_blank" rel="noopener">The Old Reader</a></td>
<td>国外一家阅读器，有中文，可自定义站点分享。</td>
<td>免费版最多100个订阅源</td>
<td>PC/手机</td>
<td>7.6</td>
</tr>
<tr>
<td><a href="http://bluereader.org/" target="_blank" rel="noopener">Bluereader</a></td>
<td>国产的RSS阅读器，速度快，有网页版和手机APP。</td>
<td>不稳定，很少更新。</td>
<td>PC/手机</td>
<td>7.5</td>
</tr>
<tr>
<td><a href="http://www.yilan.io/" target="_blank" rel="noopener">一览</a></td>
<td>国产RSS阅读器，速度快。</td>
<td>免费用户最多只能是100个订阅源。</td>
<td>PC/手机</td>
<td>7.5</td>
</tr>
<tr>
<td>irreader</td>
<td>国产RSS阅读器，速度快。除了基本的 OPML 导入外，它还提供了订阅源市场，收录了 600 余款精选 RSS 源，涵盖大部分常用网站。此外，irreader 还自带多种主题切换、 AdBlock 插件等。对于不支持 RSS 的网站，你还可以自定义抓取规则，手动获取更新。支持菜单栏速览功能。不用打开主界面，只需轻点菜单栏图标就能查看订阅内容标题，选择自己感兴趣的进行深入阅读。此外，irreader 的通知系统也十分完善，会聚合近期更新，方便了解更多动态。</td>
<td>免费用户最多只能是100个订阅源。</td>
<td>macOS/Win</td>
<td>未知</td>
</tr>
<tr>
<td><a href="https://newsblur.com/" target="_blank" rel="noopener">NewsBlur</a></td>
<td>NewsBlur 免费账户支持 Training，Text 视图以及 IFTTT。</td>
<td>免费用户最多64个源</td>
<td>PC/手机</td>
<td>7.3</td>
</tr>
<tr>
<td><a href="https://g2reader.com/en/" target="_blank" rel="noopener">G2Reader</a></td>
<td>国外一个Rss阅读器。</td>
<td>访问速度慢。</td>
<td>PC/手机</td>
<td>7.2</td>
</tr>
</tbody>
</table>
<p><a href="https://zhuanlan.zhihu.com/p/45120897" target="_blank" rel="noopener">四款好用的 RSS 阅读器推荐[全平台支持]</a><br>
<a href="https://sspai.com/post/55050" target="_blank" rel="noopener">Mac 上的 RSS 阅读工具，你有这些好看实用的选择</a><br>
<a href="https://www.v1tx.com/post/best-rss-reader/" target="_blank" rel="noopener">2020 RSS 阅读推荐</a></p>
<h2 id="请问-mac-上有哪些硬盘检测工具？如-win-上-crystaldiskinfo-hd-tune-之类">请问 Mac 上有哪些硬盘检测工具？<a href="https://www.v2ex.com/t/175051" target="_blank" rel="noopener">如 Win 上 CrystalDiskInfo、HD Tune 之类</a></h2>
<p>DriveDx<br>
可以用brew安装smartmontools查看SMART数据<br>
<a href="https://kknews.cc/digital/562gly8.html" target="_blank" rel="noopener">MacOS硬盘检测工具</a> <a href="https://www.itpwd.com/215.html" target="_blank" rel="noopener">SMART Utility 3.2.6</a><br>
HD Tune Pro for Mac</p>
<h3 id="mac-移动硬盘未挂载-解决办法">Mac 移动硬盘未挂载-解决办法</h3>
<p><a href="https://www.jianshu.com/p/56d37a0002d7" target="_blank" rel="noopener">Mac 移动硬盘未挂载-解决办法</a><br>
<a href="https://www.cnblogs.com/kaffeetrinken/p/10596740.html" target="_blank" rel="noopener">Mac的移动硬盘不能装载该如何解决?</a><br>
<a href="https://zhuanlan.zhihu.com/p/83542978" target="_blank" rel="noopener">Mac 下移动硬盘异常退出修复</a><br>
<a href="https://edonymu.com/2017/01/17/%E8%A7%A3%E5%86%B3macos%E7%A1%AC%E7%9B%98hfs%E5%88%86%E5%8C%BA%E6%97%A0%E6%B3%95%E6%8C%82%E8%BD%BD%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">解决macOS硬盘HFS+分区无法挂载问题</a><br>
<a href="http://www.jeepxie.net/article/988702.html" target="_blank" rel="noopener">在Mac OS X下修复Disk Utility无法修复的移动硬盘分区</a><br>
<a href="https://www.v2ex.com/t/120433" target="_blank" rel="noopener">请问硬盘修复失败导致无法挂载有什么解决办法吗？</a></p>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>MAC</tag>
      </tags>
  </entry>
  <entry>
    <title>2022年8月 CKA K8s v1.24 考试真题整理</title>
    <url>/Kubernates-Certified-Kubernetes-Administrator-CKA.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="考试内容">考试内容</h2>
<p><a href="https://docs.linuxfoundation.org/tc-docs/certification/tips-cka-and-ckad" target="_blank" rel="noopener">Important Instructions: CKA and CKAD</a></p>
<ul>
<li>考试包括 15-20 项performance-based tasks。
<ul>
<li>实测是17道题</li>
</ul>
</li>
<li>考生有 2 小时的时间完成 CKA 和 CKAD 考试。
<ul>
<li>因为从<a href="https://docs.linuxfoundation.org/tc-docs/certification/tips-cka-and-ckad" target="_blank" rel="noopener">06/2022开始环境升级</a>（贬义），考试环境更难用了，变的很卡，所以时间变得比较紧张。容易做不完题，建议先把有把握的，花费时间不多的题先做掉
<ul>
<li><a href="https://itnext.io/cks-cka-ckad-changed-terminal-to-remote-desktop-157a26c1d5e" target="_blank" rel="noopener">CKS CKA CKAD changed Terminal to Remote Desktop </a></li>
<li>2022.9更新，据说很多卡顿的bug已经修复。</li>
</ul>
</li>
</ul>
</li>
<li>2020年9月更新的CKA新版考试66分以上即可通过（原定72分），考试不通过有一次补考机会。</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKA/CKA_exam_syllabus.png" alt="CKA"></p>
<h3 id="cka-preparation">CKA Preparation</h3>
<ul>
<li>Read the Curriculum<br>
<a href="https://github.com/cncf/curriculum" target="_blank" rel="noopener">https://github.com/cncf/curriculum</a></li>
<li>Read the Handbook<br>
<a href="https://docs.linuxfoundation.org/tc-docs/certification/If-candidate-handbook" target="_blank" rel="noopener">https://docs.linuxfoundation.org/tc-docs/certification/If-candidate-handbook</a></li>
<li>Read the important tips<br>
<a href="https://docs.linuxfoundation.org/tc-docs/certification/tips-cka-and-ckad" target="_blank" rel="noopener">https://docs.linuxfoundation.org/tc-docs/certification/tips-cka-and-ckad</a></li>
<li>Read the FAQ<br>
<a href="https://docs.linuxfoundation.org/tc-docs/certification/faq-cka-ckad" target="_blank" rel="noopener">https://docs.linuxfoundation.org/tc-docs/certification/faq-cka-ckad</a></li>
</ul>
<!-- > 本文记录的题目大概按照难易程度，先易后难。 -->
<h2 id="如何备考">如何备考</h2>
<h3 id="k8s练习环境">k8s练习环境</h3>
<h4 id="本地环境-minikube">本地环境-Minikube</h4>
<p>可以本地安装<code>Minikube</code>练习， 参考另一篇博客<a href="./Minikube%E5%AE%89%E8%A3%85-MacOS-M1.html">Minikube安装-MacOS M1</a>。</p>
<h4 id="在线环境-killercoda">在线环境-killercoda</h4>
<ul>
<li>k8s 环境： <a href="https://killercoda.com/playgrounds/scenario/kubernetes" target="_blank" rel="noopener">https://killercoda.com/playgrounds/scenario/kubernetes</a></li>
<li>CKA在线练习环境：<a href="https://killercoda.com/killer-shell-cka" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cka</a></li>
<li>CKAD在线练习环境：<a href="https://killercoda.com/killer-shell-ckad" target="_blank" rel="noopener">https://killercoda.com/killer-shell-ckad</a></li>
<li>CKS在线练习环境：<a href="https://killercoda.com/killer-shell-cks" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks</a></li>
</ul>
<h3 id="cka课程">CKA课程</h3>
<ul>
<li>【需付费】CKA考试-对应官方课程<a href="https://training.linuxfoundation.org/training/kubernetes-fundamentals/" target="_blank" rel="noopener">Kubernetes Fundamentals (LFS258)</a></li>
<li>【需付费】Udemy CKA 课程
<ul>
<li><a href="https://www.techbeatly.com/kk-cka" target="_blank" rel="noopener">Certified Kubernetes Administrator (CKA) – KodeKloud</a> – by Mumshad Mannambeth)</li>
<li><a href="https://www.techbeatly.com/kk-cka-ud" target="_blank" rel="noopener">Certified Kubernetes Administrator (CKA) with Practice Tests – by Mumshad Mannambeth</a> – Udemy</li>
</ul>
</li>
<li>【需付费】Oreilly视频课程: (For beginner or Advanced) <a href="https://learning.oreilly.com/videos/certified-kubernetes-administrator/9780137438419/" target="_blank" rel="noopener">Certified Kubernetes Administrator (CKA), 2nd Ed</a>.
<ul>
<li><a href="https://learning.oreilly.com/live-events/certified-kubernetes-administrator-cka-crash-course/0636920315766/" target="_blank" rel="noopener">Certified Kubernetes Administrator (CKA) Crash Course</a>
<ul>
<li>附带练习环境Practice: <a href="https://learning.oreilly.com/playlists/d6e3fe86-067c-4dc7-a36d-698802d0bdee/" target="_blank" rel="noopener">Certified Kubernetes - CKA Labs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="经验总结">经验总结</h2>
<ul>
<li><strong>经验1</strong>： 不要完全按照顺序做题！！！Kubernates cluster upgrade 或者 etcd backup 放最后做，否则环境搞坏，其他的题不能做. 隔过去的题可以用flag标记，省的忘记哪些还没有做。</li>
<li><strong>经验2</strong>：  需要在ssh到新的node的时候，在新的tab做题，避免忘记exit出来。</li>
<li>使用<code>kubectl explain</code> 来查看命令内容， 例如<code>kubectl explain pods.spec.tolerations --recursive</code></li>
<li>使用<code>kubectl --help</code> 或<code>kubectl -h</code> 查看命令参数, 例如<code>kubectl create clusterrole --help</code></li>
<li>使用<code>kubectl api-resources</code>, 查看所有资源缩写</li>
<li>考试环境点击<code>-</code>来zoom out, 这样可以显示更多内容。（尤其是使用平板电脑，屏幕太小，显示有效内容很少）。</li>
<li>善用考试记事本（exam notepad）。</li>
<li>复制粘贴
<ul>
<li>What always works: copy+paste using right mouse context menu</li>
<li>What works in Terminal: <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>c</kbd> and <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>v</kbd></li>
<li>What works in other apps like Firefox: <kbd>Ctrl</kbd>+<kbd>c</kbd> and <kbd>Ctrl</kbd>+<kbd>v</kbd></li>
</ul>
</li>
<li>可以用<kbd>Tab</kbd>键，自动补全kubectl命令，大大提升效率，以及避免键盘输入拼写错误</li>
<li>考试时间快结束的时候，弹出对话框，问你是否结束考试，一定要点击&quot;Continue&quot;继续考试
<ul>
<li>否则直接结束考试，会引发考试系统的bug： session未能正常close，造成一直无法出成绩。只能通过提ticket来人工解决，才能拿到成绩。</li>
</ul>
</li>
</ul>
<h3 id="常用官方文档链接">常用官方文档链接</h3>
<ul>
<li><a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/" target="_blank" rel="noopener">https://kubernetes.io/docs/reference/kubectl/cheatsheet/</a></li>
<li><a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands" target="_blank" rel="noopener">https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands</a></li>
<li><a href="https://github.com/kubernetes/kubernetes" target="_blank" rel="noopener">https://github.com/kubernetes/kubernetes</a></li>
<li>考试中多使用命令式命令CLI ( imperative commands)，少使用声明式（Declarative）
<ul>
<li><a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands" target="_blank" rel="noopener">https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands</a></li>
<li><a href="https://medium.com/better-programming/kubernetes-tips-create-pods-with-imperative-commands-in-1-18-62ea6e1ceb32" target="_blank" rel="noopener">https://medium.com/better-programming/kubernetes-tips-create-pods-with-imperative-commands-in-1-18-62ea6e1ceb32</a></li>
<li>Promote the use of generators for Job, CronJob, Network Policies etc: this link is very useful:
<ul>
<li><a href="https://www.linkedin.com/pulse/kubernetes-deep-dive-part-3-generators-quick-poc-atharva-chauthaiwale/" target="_blank" rel="noopener">https://www.linkedin.com/pulse/kubernetes-deep-dive-part-3-generators-quick-poc-atharva-chauthaiwale/</a></li>
</ul>
</li>
<li>Use maximum conventions and best practices to avoid unexpected pod errors:
<ul>
<li><a href="https://unofficial-kubernetes.readthedocs.io/en/latest/user-guide/kubectl-conventions/" target="_blank" rel="noopener">https://unofficial-kubernetes.readthedocs.io/en/latest/user-guide/kubectl-conventions/</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="pre-setup">Pre Setup</h2>
<p>Once you’ve gained access to your terminal it might be wise to spend ~1 minute to setup your environment. You could set these:</p>
<h3 id="kubectl-设置">kubectl 设置</h3>
<p><strong>1. 设置kubectl命令别名</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">alias</span> k=kubectl                         <span class="comment"># will already be pre-configured </span></span><br><span class="line">                                        <span class="comment"># (2022最新考试环境默认已开启，不用再配置了)</span></span><br><span class="line"><span class="built_in">export</span> <span class="keyword">do</span>=<span class="string">"--dry-run=client -o yaml"</span>    <span class="comment"># k create deploy nginx --image=nginx $do</span></span><br><span class="line">                                        <span class="comment"># k run podname --image=nginx $do &gt; pod.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> now=<span class="string">"--force --grace-period 0"</span>   <span class="comment"># k delete pod x $now</span></span><br><span class="line">                                        <span class="comment"># Don't need to wait ~30 seconds</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用例子</span></span><br><span class="line">k run pod1 --image=httpd:2.4.41-alpine <span class="variable">$do</span> &gt; 2.yaml</span><br></pre></td></tr></table></figure>
<p><strong>Alias Namespace</strong><br>
In addition you could define an alias like:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">alias</span> kn=<span class="string">'kubectl config set-context --current --namespace</span></span><br></pre></td></tr></table></figure>
<p>Which allows you to define the default namespace of the current context. Then once you switch a context or namespace you can just run:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kn default      <span class="comment"># set default to default</span></span><br><span class="line">kn my-namespace <span class="comment"># set default to my-namespace</span></span><br></pre></td></tr></table></figure>
<p>But only do this if you used it before and are comfortable doing so. Else you need to specify the namespace for every call, which is also fine:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k -n my-namespace get all</span><br><span class="line">k -n my-namespace get pod</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果想使用不同的<code>shell</code>或<code>tmux</code>，可以把这些 alias和变量存入<code>~/.bashrc</code>.</p>
<p><strong>2. <a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/#kubectl-autocomplete" target="_blank" rel="noopener">开启自动补全autocomplete</a></strong><br>
(2022最新考试环境默认已开启，不用再配置了)</p>
<ul>
<li><code>kubectl --help | grep bash</code>,此步是为了找关键词completion</li>
<li><code>sudo vim /etc/profile</code></li>
<li>添加<code>source &lt;(kubectl completion bash)</code></li>
<li>保存退出，<code>source /etc/profile</code></li>
</ul>
<h3 id="vim-设置"><a href="https://www.ruanyifeng.com/blog/2018/09/vimrc.html" target="_blank" rel="noopener">Vim 设置</a></h3>
<p>复制粘贴 - 从网页上copy yaml内容，使用vim 来粘贴时，yaml内容格式会乱。现在考试环境已经被修复，<code>.vimrc</code> 里面默认加了一些vim粘贴的设置。</p>
<blockquote>
<p>Make sure to set these in your <code>.vimrc</code> or otherwise indents will be very messy during pasting (the exams have these config settings now also by default, but can’t hurt to be able to type them down):</p>
</blockquote>
<p>下面代码中，双引号开始的行表示注释。</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="comment">"1.1 use spaces for tab 由于 Tab 键在不同的编辑器缩进不一致，该设置自动将 Tab 转为空格。</span></span><br><span class="line">:<span class="keyword">set</span> expandtab</span><br><span class="line"></span><br><span class="line"><span class="comment">"1.2 amount of spaces used for tab 按下 Tab 键时，Vim 显示的空格数。</span></span><br><span class="line">:<span class="keyword">set</span> tabstop=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">"1.3 amount of spaces used during indentation 在文本上按下&gt;&gt;（增加一级缩进）、&lt;&lt;（取消一级缩进）或者==（取消全部缩进）时，每一级的字符数。</span></span><br><span class="line">:<span class="keyword">set</span> <span class="built_in">shiftwidth</span>=<span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>Save and close the file by pressing <kbd>Esc</kbd> followed by <kbd>:x</kbd> and <kbd>Enter</kbd>.<br>
Whenever you open Vim now as the current user, these settings will be used.<br>
If you ssh onto a different server, these settings will <strong>not</strong> be transferred.</p>
<p><strong>1.3 Indent multiple lines</strong></p>
<p>To indent multiple lines press <kbd>Esc</kbd> and type <code>:set shiftwidth=2</code>.<br>
First mark multiple lines using <kbd>Ctrl</kbd> <kbd>v</kbd>  and the up/down keys. Then to indent the marked lines press <kbd>&gt;</kbd> or <kbd>&lt;</kbd>. You can then press <kbd>.</kbd> to repeat the action.</p>
<p><strong>1.4 Get used to copy/paste/cut with vim:</strong></p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">Mark lines: Esc+v (then arrow keys)</span><br><span class="line">Copy marked lines: y</span><br><span class="line">Cut marked lines: d</span><br><span class="line">Past lines: p or P</span><br></pre></td></tr></table></figure>
<p><strong>1.5 <code>:set paste</code></strong></p>
<ul>
<li><code>:set nopaste</code> Turning off auto indent when pasting text into vim</li>
<li><code>:set paste</code> Turning on auto indent when pasting text into vim<br>
<a href="https://vim.fandom.com/wiki/Toggle_auto-indenting_for_code_paste" target="_blank" rel="noopener">Paste toggle</a></li>
</ul>
<p><strong>1.6 显示行号 <code>:set number</code></strong></p>
<p>toggle vim line numbers</p>
<p>When in <code>vim</code> you can press <kbd>Esc</kbd> and type <code>:set number</code> (turn on number) or <code>:set nonumber</code> (turn off number) followed by Enter to toggle line numbers. This can be useful when finding syntax errors based on line - but can be bad when wanting to mark&amp;copy by mouse.<br>
You can also just jump to a line number with <kbd>Esc</kbd> <code>:22</code> + Enter.</p>
<h4 id="vim基本操作"><a href="./Vim%E6%93%8D%E4%BD%9C-%E9%85%8D%E7%BD%AE.html">Vim基本操作</a></h4>
<h3 id="使用nano编辑器"><a href="./nano%E7%BC%96%E8%BE%91%E5%99%A8%E4%BD%BF%E7%94%A8-%E5%BF%AB%E6%8D%B7%E9%94%AE-Linux.html">使用nano编辑器</a></h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 编辑1.yaml文件，如果1.yaml文件不存在则新建</span></span><br><span class="line">nano 1.yaml</span><br><span class="line"><span class="comment"># 粘贴+编辑</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存 control + o</span></span><br><span class="line"><span class="comment"># 退出 control + x</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题1-rbac">考题1-RBAC</h2>
<h3 id="rbac题目">RBAC题目</h3>
<p>Task weight: 4%</p>
<p>Set configuration context:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[student@node-1] $ kubectl config use-context k8s</span><br></pre></td></tr></table></figure>
<h4 id="context">Context</h4>
<p>You have been asked to create a new <code>ClusterRole</code> for a deployment pipeline and bind it to a specific <code>ServiceAccount</code> scoped to a specific namespace.</p>
<h4 id="task">Task</h4>
<p>Create a new <code>ClusterRole</code> named <code>deployment-clusterrole</code> which only allows to create the following resource types:</p>
<ul>
<li>Deployment</li>
<li>StatefulSet</li>
<li>DaemonSet</li>
</ul>
<p>Create a new <code>ServiceAccount</code> named <code>cicd-token</code> in the existing namespace <code>app-team1</code>.</p>
<p>Bind the new ClusterRole <code>deployment-clusterrole</code> to the new ServiceAccount <code>cicd-token</code> , limited to the namespace <code>app-team1</code>.</p>
<h3 id="rbac解答">RBAC解答</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-contex t k8s</span><br><span class="line">$ kubectl create clusterrole deployment-clusterrole --resource=deployments,statefulsets,daemonsets --verb=create</span><br><span class="line"><span class="comment"># $ kubectl create namespace app-team1 # in the existing namespace `app-team1` 所以不需要新建namespace</span></span><br><span class="line">$ kubectl create serviceaccount cicd-token -n app-team1</span><br><span class="line">$ kubectl create rolebinding cicd-token-binding --clusterrole=deployment-clusterrole --serviceaccount=app-team1:cicd-token --namespace=app-team1</span><br><span class="line"><span class="comment"># $ kubectl -n app-team1 describe rolebindings.rbac.authorization.k8s.io cicd-token-binding</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Verify everything using kubectl auth can-i</span></span><br><span class="line">kubectl auth can-i create deployments --as system:serviceaccount:app-team1:cicd-token -n app-team1 <span class="comment"># YES</span></span><br><span class="line">kubectl auth can-i create deployments --as system:serviceaccount:app-team1:cicd-token -n default <span class="comment"># NO</span></span><br><span class="line">kubectl auth can-i delete deployments --as system:serviceaccount:app-team1:cicd-token -n app-team1 <span class="comment"># NO</span></span><br><span class="line">kubectl auth can-i update deployments --as system:serviceaccount:app-team1:cicd-token -n app-team1 <span class="comment"># NO</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题2-创建-networkpolicy">考题2-创建 NetworkPolicy</h2>
<h3 id="题目：networkpolicy">题目：NetworkPolicy</h3>
<p>Task weight: 7%</p>
<p>Set configuration context:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[student@node-1] $ kubectl config use-context hk85</span><br></pre></td></tr></table></figure>
<h4 id="task-v2">Task</h4>
<p>Create a new <code>NetworkPolicy</code> named <code>allow-port-from-namespace</code> that allows Pods in the existing<br>
namespace <code>internal</code> to connect to port <code>5768</code> of other Pods in the namespace <code>my-app</code>.</p>
<p>Ensure that the new NetworkPolicy:</p>
<ul>
<li>does not allow access to Pods not listening on port 5768</li>
<li>does not allow access from Pods not in namespace <code>internal</code></li>
</ul>
<h3 id="解答：networkpolicy">解答：NetworkPolicy</h3>
<p>参考<a href="https://kubernetes.io/docs/concepts/services-networking/network-policies/" target="_blank" rel="noopener">官网network-policies</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context hk8s</span><br><span class="line">kubectl get ns --show-labels <span class="comment"># 得到`internal`的label，例如project=internal</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># kubectl create namespace internal if namespace has no labels</span></span><br><span class="line">kubectl label ns internal project:internal</span><br><span class="line">kubectl label ns my-app project:my-app</span><br><span class="line"></span><br><span class="line">vim allow-port-from-namespace.yaml</span><br><span class="line"><span class="comment"># nano allow-port-from-namespace.yaml</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">NetworkPolicy</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">allow-port-from-namespace</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">internal</span> <span class="comment"># 目的命名空间</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">podSelector:</span> <span class="string">&#123;&#125;</span> <span class="comment"># 加matchLabels会报错</span></span><br><span class="line">  <span class="attr">policyTypes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Ingress</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Egress</span></span><br><span class="line">  <span class="attr">ingress:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">from:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">namespaceSelector:</span></span><br><span class="line">        <span class="attr">matchLabels:</span></span><br><span class="line">          <span class="attr">project:</span> <span class="string">internal</span> <span class="comment"># 命名空间label</span></span><br><span class="line">  <span class="attr">egress:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">to:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">namespaceSelector:</span></span><br><span class="line">            <span class="attr">matchLabels:</span></span><br><span class="line">              <span class="attr">project:</span> <span class="string">my-app</span> <span class="comment"># 命名空间label</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">5768</span> <span class="comment"># 允许访问的端口</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl apply -f allow-port-from-namespace.yaml</span><br><span class="line">kubectl get networkpolicies.networking.k8s.io -n internal</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题3-创建-svc">考题3-创建 svc</h2>
<h3 id="题目：创建-svc">题目：创建 svc</h3>
<p>Task weight: 7%</p>
<p>Set configuration context:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[student@node-1] $ kubectl config use-context k8S</span><br></pre></td></tr></table></figure>
<h4 id="task-v3">Task</h4>
<p>Reconfigure the existing deployment <code>front-end</code> and add a port specification named <code>http</code> exposing port <code>80/tcp</code> of the existing container <code>nginx</code>.</p>
<p>Create a new service named <code>front-end-svc</code> exposing the container port <code>http</code>.</p>
<p>Configure the new service to also expose the individual Pods via a <code>NodePort</code> on the nodes on which they are scheduled.</p>
<h3 id="解答：创建-svc">解答：创建 svc</h3>
<p>search “containerPort”, 参考<a href="https://kubernetes.io/docs/concepts/services-networking/connect-applications-service/" target="_blank" rel="noopener">Connecting Applications with Services</a><br>
<a href="https://kubernetes.io/docs/tasks/configure-pod-container/_print/" target="_blank" rel="noopener">configure-pod-container</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context k8S</span><br><span class="line"></span><br><span class="line">kubectl get deployment front-end <span class="comment"># 可选</span></span><br><span class="line">kubectl edit deployment front-end</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">http</span> <span class="comment"># 添加port name</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span> <span class="comment"># 添加containerPort</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">TCP</span> <span class="comment"># 添加protocol</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl expose deployment front-end --name=front-end-svc --port=80 --target-port=80 --protocol=TCP --<span class="built_in">type</span>=NodePort</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题4-创建-ingress-资源">考题4-创建 ingress 资源</h2>
<h3 id="题目：ingress">题目：ingress</h3>
<p>Task weight: 7%<br>
Set configuration context:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[student@node-1] $ kubectl config use-context k85</span><br></pre></td></tr></table></figure>
<h4 id="task-v4">Task</h4>
<p>Create a new nginx Ingress resource as follows:</p>
<ul>
<li>Name: <code>pong</code></li>
<li>Namespace: <code>ing-internal</code></li>
<li>Exposing service <code>hi</code> on path <code>/hi</code> using service port <code>5678</code></li>
</ul>
<blockquote>
<p>The availability of service <code>hi</code> can be checked using the following command, which should return <code>hi</code>:<br>
<code>[student@node-11 $ curl -kl &lt;INTERNAL_IP&gt;/hi</code></p>
</blockquote>
<h3 id="解答：ingress">解答：ingress</h3>
<p>参考<a href="https://kubernetes.io/docs/concepts/services-networking/ingress/" target="_blank" rel="noopener">ingress</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context k85</span><br><span class="line"><span class="comment"># Find out the ingressClassName with:</span></span><br><span class="line">kubectl get ingressclass</span><br><span class="line">NAME    CONTROLLER             PARAMETERS   AGE</span><br><span class="line">nginx   k8s.io/ingress-nginx   &lt;none&gt;       22</span><br><span class="line"></span><br><span class="line">vim pong.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pong</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">ing-internal</span>  <span class="comment"># Add： The Ingress resources needs to be created in the same Namespace as the applications.</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">kubernetes.io/ingress.class:</span> <span class="string">"nginx"</span>   <span class="comment"># 要加这句或者加spec.ingressClassName，不然kubctl get ingress 不出来address</span></span><br><span class="line">    <span class="comment"># this annotation removes the need for a trailing slash when calling urls</span></span><br><span class="line">    <span class="comment"># but it is not necessary for solving this scenario</span></span><br><span class="line">    <span class="attr">nginx.ingress.kubernetes.io/rewrite-target:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ingressClassName:</span> <span class="string">nginx</span> <span class="comment"># 要加这句，不然kubctl get ingress 不出来address</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">      <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/hi</span></span><br><span class="line">        <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">        <span class="attr">backend:</span></span><br><span class="line">          <span class="attr">service:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">hi</span></span><br><span class="line">            <span class="attr">port:</span></span><br><span class="line">              <span class="attr">number:</span> <span class="number">5678</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl apply -f pong.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取 ingress 的 IP 地址</span></span><br><span class="line">$ kubectl get pod -n ing-internal -o wide</span><br><span class="line">kubctl get ingress -n ing-internal</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证</span></span><br><span class="line">$ curl -kl &lt;INTERNAL_IP&gt;/hi</span><br><span class="line"><span class="comment"># 返回 hi 即为成功</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 方法2</span></span><br><span class="line">kubectl config use-context k85</span><br><span class="line">kubectl create ingress pong -n ing-internal --rule=<span class="string">"/hi*=hi:5678"</span></span><br><span class="line"></span><br><span class="line">annotations:</span><br><span class="line">    nginx.ingress.kubernetes.io/rewrite-target: /</span><br><span class="line">    nginx.ingress.kubernetes.io/ssl-redirect: <span class="string">"false"</span></span><br><span class="line">    kubernetes.io/ingress.class: <span class="string">"nginx"</span></span><br><span class="line"></span><br><span class="line">kubectl get ingress -n ing-internal</span><br><span class="line"><span class="comment"># kubectl get svc</span></span><br><span class="line">curl -kl &lt;INTERNAL_IP&gt;/hi</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题5-扩展-deployment">考题5-扩展 deployment</h2>
<h3 id="题目：扩展-deployment">题目：扩展 deployment</h3>
<p>Task weight: 4%<br>
难易程度： 简单<br>
Set configuration context:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[student@node-1] $ kubectl config use-context k8s</span><br></pre></td></tr></table></figure>
<h4 id="task-v5">Task</h4>
<p>Scale the deployment <code>loadbalancer</code> to <code>6</code> pods.</p>
<h3 id="解答：扩展-deployment">解答：扩展 deployment</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl scale deployment loadbalancer --replicas=6</span><br><span class="line">kubectl get deployment loadbalancer</span><br><span class="line">kubectl get pods</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题6-将-pod-部署到指定-node-节点上">考题6-将 pod 部署到指定 node 节点上</h2>
<h3 id="题目：将-pod-部署到指定-node-节点上">题目：将 pod 部署到指定 node 节点上</h3>
<p>难易程度： 简单<br>
Task weight: 4%</p>
<p>Set configuration context:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[student@node-1] $ kubectl config use-context k8s</span><br></pre></td></tr></table></figure>
<h4 id="task-v6">Task</h4>
<p>Schedule a pod as follows:</p>
<ul>
<li>Name: <code>nginx-kuSc00401</code></li>
<li>Image: <code>nginx</code></li>
<li>Node selector: <code>disk=spinning</code></li>
</ul>
<h3 id="解答：将-pod-部署到指定-node-节点上">解答：将 pod 部署到指定 node 节点上</h3>
<p>参考官方文档： <a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes/#create-a-pod-that-gets-scheduled-to-your-chosen-node" target="_blank" rel="noopener">Assigning Pods to Nodes</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context k8s</span><br><span class="line">kubectl run nginx-kuSc00401 --image=nginx --dry-run=client -o yaml &gt; nginx-kusc00401.yaml</span><br><span class="line">vim nginx-kusc00401.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx-kusc00401</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">  <span class="attr">nodeSelector:</span> <span class="comment"># 添加nodeSelector</span></span><br><span class="line">    <span class="attr">disk:</span> <span class="string">spinning</span> <span class="comment"># 添加node label</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl apply -f nginx-kusc00401.yaml</span><br><span class="line">kubectl get pod nginx-kusc00401 -o wide</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题7-kubernates-upgrade">考题7-Kubernates-upgrade</h2>
<h3 id="题目：-kubernates-upgrade">题目： Kubernates-upgrade</h3>
<p>Task weight: 7%</p>
<p>Set configuration context:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[student@node -1] $ kubectl config use-context mk85</span><br></pre></td></tr></table></figure>
<h4 id="task-v7">Task</h4>
<p>Given an existing Kubernetes cluster running version <code>1.24.1</code>, upgrade all of the Kubernetes control plane and node components on the master node only to version <code>1.24.2</code>.</p>
<p>You are also expected to upgrade kubelet and kubectl on the <strong>master</strong> node.</p>
<blockquote>
<p>Be sure to drain the master node before upgrading it and uncordon it after the upgrade.<br>
Do not upgrade the worker nodes, etcd, the container manager, the CNI plugin, the DNS service or any other addons.</p>
</blockquote>
<h3 id="解答：升级master">解答：升级master</h3>
<p>参考官方文档： <a href="https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/" target="_blank" rel="noopener">kubernetes-upgrade kubeadm</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl config use-context mk8s</span><br><span class="line">$ kubectl get nodes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 腾空节点</span></span><br><span class="line">$ kubectl drain mk8s-master-1 --ignore-daemonsets <span class="comment"># --delete-local-data</span></span><br><span class="line"></span><br><span class="line">$ ssh mk8s-master-1</span><br><span class="line">$ sudo -i</span><br><span class="line"></span><br><span class="line"><span class="comment"># 升级kubeadm</span></span><br><span class="line">[root@mk8s-master-1] apt-get update &amp;&amp; apt-get install -y kubeadm=1.24.2-00</span><br><span class="line">[root@mk8s-master-1] kubeadm version</span><br><span class="line">[root@mk8s-master-1] kubeadm upgrade plan</span><br><span class="line"><span class="comment"># 查看etcd参数</span></span><br><span class="line">[root@mk8s-master-1] kubeadm upgrade apply -h | grep etcd</span><br><span class="line"></span><br><span class="line">[root@mk8s-master-1] kubeadm upgrade apply v1.22.2 --etcd-upgrade=<span class="literal">false</span> <span class="comment"># 注意Do not upgrade the worker nodes, etc, the container manager, the CNI plugin, the DNS service or any other addons.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 升级 kubelet 和 kubectl </span></span><br><span class="line">[root@mk8s-master-1] kubectl version</span><br><span class="line">[root@mk8s-master-1] kubelet --version</span><br><span class="line"></span><br><span class="line">[root@mk8s-master-1] apt-get update &amp;&amp; apt-get install -y kubelet=1.24.2-00 kubectl=1.24.2-00</span><br><span class="line"><span class="comment">## 重启</span></span><br><span class="line">[root@mk8s-master-1] sudo systemctl daemon-reload</span><br><span class="line">[root@mk8s-master-1] sudo systemctl restart kubelet</span><br><span class="line">[root@mk8s-master-1] kubelet --version</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解除节点的保护</span></span><br><span class="line">[root@mk8s-master-1] kubectl uncordon mk8s-master-1</span><br><span class="line">[root@mk8s-master-1] kubectl get node <span class="comment"># (确认只升级了 master 节点到 1.24.2 版本)</span></span><br><span class="line"></span><br><span class="line">[root@mk8s-master-1] <span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题8-etcd-备份还原">考题8-etcd 备份还原</h2>
<h3 id="题目：etcd-备份还原">题目：etcd 备份还原</h3>
<p>(1.20 版本需要把端口号从 2739 改成 2830)<br>
Task weight: 7%</p>
<p>No configuration context change required for this item.</p>
<h4 id="task-v8">Task</h4>
<p>First, create a snapshot of the existing <code>etc</code> instance running at <code>https://127.0.0.1:2379</code>, saving the snapshot to <code>/srv/data/etcd-snapshot.db</code>.</p>
<blockquote>
<p>Creating a snapshot of the given instance is expected to complete in seconds.<br>
If the operation seems to hang, something’s likely wrong with your command. Use <kbd>CTRL</kbd>+ <kbd>C</kbd> to cancel the operation and try again.</p>
</blockquote>
<p>Next, restore an existing, previous snapshot located at<br>
<code>/var/lib/backup/etcd-snapshot-previous.db</code>.</p>
<blockquote>
<p>The following TLS certificates/key are supplied for<br>
connecting to the server with <code>etcdctl</code>:</p>
<ul>
<li>CA certificate: <code>/opt/KUIN00601/ca.crt</code></li>
<li>Client certificate: <code>/opt/KUIN00601/etcd-client.crt</code></li>
<li>Client key: <code>/opt/KUIN00601/etcd-client.key</code></li>
</ul>
</blockquote>
<h3 id="解答">解答</h3>
<p>Search <code>etcd backup</code>, 选择 <a href="https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/#backing-up-an-etcd-cluster" target="_blank" rel="noopener">Operating etcd clusters for Kubernetes</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1 backup</span></span><br><span class="line"><span class="comment">## 1.0 如果记不清参数，可查看帮助</span></span><br><span class="line">etcdctl snapshot save --<span class="built_in">help</span></span><br><span class="line"><span class="comment">### 1.0.1 [本题目中无需这一步]如果题目中没有给出certificates/key 可从/etc/kubernetes/manifests/etcd.yaml里查找</span></span><br><span class="line">➜ root@cluster3-master1:~<span class="comment"># vim /etc/kubernetes/manifests/etcd.yaml</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /etc/kubernetes/manifests/etcd.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">component:</span> <span class="string">etcd</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">control-plane</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">etcd</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kube-system</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">command:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">etcd</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--advertise-client-urls=https://192.168.100.31:2379</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--cert-file=/etc/kubernetes/pki/etcd/server.crt</span>                   <span class="comment"># use as --cert</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--client-cert-auth=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--data-dir=/var/lib/etcd</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--initial-advertise-peer-urls=https://192.168.100.31:2380</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--initial-cluster=cluster3-master1=https://192.168.100.31:2380</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--key-file=/etc/kubernetes/pki/etcd/server.key</span>                    <span class="comment"># use as --key</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--listen-client-urls=https://127.0.0.1:2379,https://192.168.100.31:2379</span> <span class="comment"># use as --endpoints</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--listen-metrics-urls=http://127.0.0.1:2381</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--listen-peer-urls=https://192.168.100.31:2380</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--name=cluster3-master1</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--peer-cert-file=/etc/kubernetes/pki/etcd/peer.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--peer-client-cert-auth=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--peer-key-file=/etc/kubernetes/pki/etcd/peer.key</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--peer-trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt</span>               <span class="comment"># use as --cacert</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--snapshot-count=10000</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">k8s.gcr.io/etcd:3.3.15-0</span></span><br><span class="line">    <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">    <span class="attr">livenessProbe:</span></span><br><span class="line">      <span class="attr">failureThreshold:</span> <span class="number">8</span></span><br><span class="line">      <span class="attr">httpGet:</span></span><br><span class="line">        <span class="attr">host:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/health</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">2381</span></span><br><span class="line">        <span class="attr">scheme:</span> <span class="string">HTTP</span></span><br><span class="line">      <span class="attr">initialDelaySeconds:</span> <span class="number">15</span></span><br><span class="line">      <span class="attr">timeoutSeconds:</span> <span class="number">15</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">etcd</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/var/lib/etcd</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">etcd-data</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/etc/kubernetes/pki/etcd</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">etcd-certs</span></span><br><span class="line">  <span class="attr">hostNetwork:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">priorityClassName:</span> <span class="string">system-cluster-critical</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/etc/kubernetes/pki/etcd</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">etcd-certs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/var/lib/etcd</span>                                     <span class="comment"># important</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">etcd-data</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 1.0.2 [本题目中无需这一步] 或者1.0.1可用1.0.2取代</span></span><br><span class="line"><span class="comment"># But we also know that the api-server is connecting to etcd, so we can check how its manifest is configured:</span></span><br><span class="line">root@cluster3-master1:~ cat /etc/kubernetes/manifests/kube-apiserver.yaml | grep etcd</span><br><span class="line">- --etcd-cafile=/etc/kubernetes/pki/etcd/ca.crt</span><br><span class="line">- --etcd-certfile=/etc/kubernetes/pki/apiserver-etcd-client.crt</span><br><span class="line">- --etcd-keyfile=/etc/kubernetes/pki/apiserver-etcd-client.key</span><br><span class="line">- --etcd-servers=https://127.0.0.1:2379</span><br><span class="line"></span><br><span class="line"><span class="comment">## 1.1 backup snapshot</span></span><br><span class="line">ETCDCTL_API=3 etcdctl snapshot save /srv/data/etcd-snapshot.db \</span><br><span class="line">--cacert=/opt/KUIN00601/ca.crt \</span><br><span class="line">--cert=/opt/KUIN00601/etcd-client.crt \</span><br><span class="line">--key=/opt/KUIN00601/etcd-client.key \</span><br><span class="line">--endpoints=https://127.0.0.1:2379</span><br><span class="line"></span><br><span class="line">Snapshot saved at /srv/data/etcd-snapshot.db</span><br><span class="line"></span><br><span class="line"><span class="comment"># <span class="doctag">NOTE:</span> Dont use `snapshot status` because it can alter the snapshot file and render it invalid</span></span><br><span class="line"><span class="comment"># 1.2 接着既可以检查下你备份的文件:</span></span><br><span class="line"><span class="comment"># ETCDCTL_API=3 etcdctl --write-out=table snapshot status /srv/data/etcd-snapshot.db</span></span><br><span class="line"><span class="comment"># #有以下输出，就没问题</span></span><br><span class="line"><span class="comment"># +----------+----------+------------+------------+ </span></span><br><span class="line"><span class="comment"># | HASH | REVISION | TOTAL KEYS | TOTAL SIZE |</span></span><br><span class="line"><span class="comment"># +----------+----------+------------+------------+ </span></span><br><span class="line"><span class="comment"># | fe01cf57 | 10 | 7 | 2.1 MB </span></span><br><span class="line"><span class="comment"># | +----------+----------+------------+------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 restore</span></span><br><span class="line"><span class="comment">## 2.1 Next we stop all controlplane components:</span></span><br><span class="line">root@cluster3-master1:~ <span class="built_in">cd</span> /etc/kubernetes/manifests/</span><br><span class="line">root@cluster3-master1:/etc/kubernetes/manifests<span class="comment"># mv * ..</span></span><br><span class="line">root@cluster3-master1:/etc/kubernetes/manifests<span class="comment"># watch crictl ps</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 2.2 restore snapshot into a specific directory: /var/lib/etcd-backup</span></span><br><span class="line">ETCDCTL_API=3 etcdctl snapshot restore /var/lib/backup/etcd-snapshot-previous.db \</span><br><span class="line">--data-dir /var/lib/etcd-backup \</span><br><span class="line">--cacert=/opt/KUIN00601/ca.crt \</span><br><span class="line">--cert=/opt/KUIN00601/etcd-client.crt \</span><br><span class="line">--key=/opt/KUIN00601/etcd-client.key </span><br><span class="line"></span><br><span class="line">2022-08-04 16:50:19.650804 I | mvcc: restore compact to 9935</span><br><span class="line">2022-08-04 16:50:19.659095 I | etcdserver/membership: added member 8e9e05c52164694d [http://localhost:2380] to cluster</span><br><span class="line">cdf818194e3a8c32</span><br><span class="line"></span><br><span class="line"><span class="comment"># We could specify another host to make the backup from by using `etcdetl --endpoints http: //IP`, but here we just use the default value</span></span><br><span class="line"><span class="comment"># which is: `http://127.0.0.1:2379,http://127.0.0.1:4001`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 2.3  </span></span><br><span class="line"><span class="comment">## The restored files are located at the new folder `/var/lib/eted-backup`, now we have to tell etcd to use that directory:</span></span><br><span class="line">root@cluster3-master1:~ vim /etc/kubernetes/etcd.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /etc/kubernetes/etcd.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">component:</span> <span class="string">etcd</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">control-plane</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">etcd</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kube-system</span></span><br><span class="line"><span class="attr">spec:</span> <span class="string">...</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/etc/kubernetes/pki/etcd</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">etcd-certs</span></span><br><span class="line">  <span class="attr">hostNetwork:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">priorityClassName:</span> <span class="string">system-cluster-critical</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/etc/kubernetes/pki/etcd</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">etcd-certs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/var/lib/etcd-backup</span>               <span class="comment"># change</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">etcd-data</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 2.4</span></span><br><span class="line"><span class="comment"># Now we move all controlplane yaml again into the manifest directory. </span></span><br><span class="line"><span class="comment"># Give it some time (up to several minutes) for eted to restart and for the api-server to be reachable again:</span></span><br><span class="line">root@cluster3-master1:~ <span class="built_in">cd</span> /etc/kubernetes/manifests/</span><br><span class="line">root@cluster3-master1:/etc/kubernetes/manifests<span class="comment"># mv ../*.yaml .</span></span><br><span class="line">root@cluster3-master1:/etc/kubernetes/manifests<span class="comment"># watch crictl ps</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题9-创建多个-container-的-pod">考题9-创建多个 container 的 Pod</h2>
<h3 id="题目：创建多个-container-的-pod">题目：创建多个 container 的 Pod</h3>
<p>难易程度： 简单<br>
Task weight: 4%</p>
<p>Set configuration context:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[student@node-1] $ kubectl config use-context k8s</span><br></pre></td></tr></table></figure>
<h4 id="task-v9">Task</h4>
<p>Create a pod named <code>kucc1</code> with a single app container for each of the following images running inside (there may be between 1 and 4 images specified): <code>nginx + redis + memcached + consul</code>.</p>
<h3 id="解答：创建多个-container-的-pod">解答：创建多个 container 的 Pod</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context k8s</span><br><span class="line"></span><br><span class="line">kubectl run kucc1 --image nginx --dry-run=client -o yaml &gt; kucc1.yaml</span><br><span class="line">vim kucc1.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kucc1</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">redis</span> <span class="comment"># Add 1 </span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">memcached</span> <span class="comment"># Add 2</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">memcached</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">consul</span> <span class="comment"># Add 3</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">consul</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl apply -f kucc1.yaml</span><br><span class="line"><span class="comment"># kubectl describe pods kucc1</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题10-创建-persistent-volume">考题10-创建 Persistent Volume</h2>
<h3 id="题目：创建-persistent-volume">题目：创建 Persistent Volume</h3>
<p>Task weight: 4%</p>
<p>Set configuration context:<br>
<code>[student@node-1] $ kubectl config use-context hk85</code></p>
<h4 id="task-v10">Task</h4>
<p>Create a persistent volume with name <code>app-config</code>, of capacity <code>2Gi</code> and access mode <code>ReadWriteMany</code>. The type of volume is<br>
<code>hostPath</code> and its location is <code>/srv/app-config</code>.</p>
<h3 id="解答：创建-persistent-volume">解答：创建 Persistent Volume</h3>
<p>参考官方文档： <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-persistent-volume-storage/#create-a-persistentvolume" target="_blank" rel="noopener">example of hostPath typed volume</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context hk85</span><br><span class="line">vim app-config.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolume</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">app-config</span> <span class="comment"># name</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">capacity:</span></span><br><span class="line">    <span class="attr">storage:</span> <span class="string">2Gi</span> <span class="comment"># capacity 2Gi</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ReadWriteMany</span> <span class="comment"># ReadWriteMany</span></span><br><span class="line">  <span class="attr">hostPath:</span> <span class="comment"># hostPath</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">"/srv/app-config"</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl apply -f app-config.yaml</span><br><span class="line">kubectl get pv</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题11-创建-pvc">考题11-创建 PVC</h2>
<h3 id="题目：创建-pvc">题目：创建 PVC</h3>
<p>Task weight: 7%</p>
<p>Set configuration context:<br>
<code>[student@node-1] $ kubectl config use-context ok85</code></p>
<h4 id="task-v11">Task</h4>
<p>Create a new <code>PersistentVolumeClaim</code>:</p>
<ul>
<li>Name: pv-volume</li>
<li>Class: csi-hostpath-sc</li>
<li>Capacity: 10Mi</li>
</ul>
<hr>
<p>Create a new Pod which mounts the <code>PersistentVolumeClaim</code> as a volume:</p>
<ul>
<li>Name: web-server</li>
<li>Image: nginx</li>
<li>Mount path: /usr/share/nginx/html</li>
</ul>
<p>Configure the new Pod to have <code>ReadWriteOnce</code> access on the volume.</p>
<hr>
<p>Finally, using <code>kubectl edit</code> or <code>kubectl patch</code> expand the <code>PersistentVolumeClaim</code> to a capacity of <code>70Mi</code> and record that change.</p>
<h3 id="解答：创建-pvc">解答：创建 PVC</h3>
<p>参考官方文档：</p>
<ul>
<li>搜索 <code>PV pod</code>, 选择<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-persistent-volume-storage/#create-a-persistentvolumeclaim" target="_blank" rel="noopener">&quot;Configure a Pod to Use a PersistentVolume for Storage | Kubernetes&quot;</a>
<ul>
<li><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-persistent-volume-storage/#create-a-persistentvolumeclaim" target="_blank" rel="noopener">Create a PersistentVolumeClaim</a></li>
<li><a href="https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/configure-persistent-volume-storage/" target="_blank" rel="noopener">Configure a Pod …中文文档</a></li>
</ul>
</li>
<li>搜索 <code>kubectl edit pvc</code> <a href="https://kubernetes.io/blog/2018/07/12/resizing-persistent-volumes-using-kubernetes/" target="_blank" rel="noopener">Resizing Persistent Volumes using Kubernetes</a>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#expanding-persistent-volumes-claims" target="_blank" rel="noopener">expanding-persistent-volumes-claims</a></li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context hk85</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1 创建PVC</span></span><br><span class="line">nano pv-volume.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pv-volume</span> <span class="comment"># 1 name</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ReadWriteOnce</span> <span class="comment"># 2 ReadWriteOnce</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">requests:</span></span><br><span class="line">      <span class="attr">storage:</span> <span class="string">10Mi</span> <span class="comment"># 3</span></span><br><span class="line">  <span class="attr">storageClassName:</span> <span class="string">csi-hostpath-sc</span> <span class="comment"># 4</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl apply -f pv-volume.yaml</span><br><span class="line">kubectl get pvc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 创建pod</span></span><br><span class="line">nano web-server.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">web-server</span> <span class="comment"># pod name</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">volumes:</span>                  <span class="comment"># add</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">task-pv-storage</span> <span class="comment"># add</span></span><br><span class="line">      <span class="attr">persistentVolumeClaim:</span> <span class="comment"># add</span></span><br><span class="line">        <span class="attr">claimName:</span> <span class="string">pv-volume</span> <span class="comment"># PVC name, 要与之前一致</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">      <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">"http-server"</span></span><br><span class="line">      <span class="attr">volumeMounts:</span>                          <span class="comment"># add</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">"/usr/share/nginx/html"</span> <span class="comment"># mountPath</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">task-pv-storage</span>              <span class="comment"># 和spec.volumes.name一致</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl apply -f web-server.yaml</span><br><span class="line">kubectl get pods</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 Edit PVC</span></span><br><span class="line">kubectl edit pvc pv-volume --record</span><br><span class="line"><span class="comment"># 修改 storage: 10Mi 为 storage: 70Mi</span></span><br></pre></td></tr></table></figure>
<h2 id="考题12-设置node-unavailable">考题12-设置node unavailable</h2>
<h3 id="题目：设置node-unavailable">题目：设置node unavailable</h3>
<p>Task weight: 4%<br>
难易程度： 简单</p>
<p>Set configuration context：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[student@node-1] $ kubectl config use-context ek85</span><br></pre></td></tr></table></figure>
<h4 id="task-v12">Task</h4>
<p>Set the node named <code>ek8s-node-1</code> as unavailable and reschedule all the pods running on it.</p>
<h3 id="解答：设置node-unavailable">解答：设置node unavailable</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context ek85</span><br><span class="line">kubectl get nodes</span><br><span class="line">kubectl drain ek8s-node-1 --ignore-daemonsets --delete-emptydir-data <span class="comment"># 不加--delete-emptydir-data会报错。可选参数：--delete-local-data --force</span></span><br><span class="line"><span class="comment"># kubectl uncordon ek8s-node-1 # 应该不需要这行</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题13-监控-pod-的日志">考题13-监控 pod 的日志</h2>
<h3 id="题目：监控-pod-的日志">题目：监控 pod 的日志</h3>
<p>难易程度： 简单<br>
Task weight: 5%<br>
Set configuration context:<br>
<code>[student@node-1] $ kubectl config use-context k8s</code></p>
<h4 id="task-v13">Task</h4>
<p>Monitor the logs of pod <code>foobar</code> and:</p>
<ul>
<li>Extract log lines corresponding to error <code>unable-to-access-website</code></li>
<li>Write them to <code>/opt/KUTR00101/foobar</code></li>
</ul>
<h3 id="解答：监控-pod-的日志">解答：监控 pod 的日志</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context k8s</span><br><span class="line">kubectl logs foobar | grep unable-to-access-website &gt; /opt/KUTR00101/foobar</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题14-查看最高-cpu-使用率的-pod">考题14-查看最高 CPU 使用率的 Pod</h2>
<h3 id="题目：查看最高-cpu-使用率的-pod">题目：查看最高 CPU 使用率的 Pod</h3>
<p>Task weight: 5%<br>
难易程度： 简单</p>
<p>Set configuration context:<br>
<code>[student@node-1] $ kubectl config use-context k8s</code></p>
<h4 id="task-v14">Task</h4>
<p>From the pod label <code>name=cpu-user</code>, find pods running high CPU workloads and write the name of the pod consuming most<br>
CPU to the file <code>/opt/KUTR00401/KUTR00401.txt</code> (which already exists).</p>
<h3 id="解答：查看最高-cpu-使用率的-pod">解答：查看最高 CPU 使用率的 Pod</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl top pod -l name=cpu-user -A --sort-by=cpu</span><br><span class="line"></span><br><span class="line">    NAMAESPACE NAME  CPU MEM</span><br><span class="line">          cpu-user-1 45m 6Mi</span><br><span class="line">          cpu-user-2 38m 6Mi </span><br><span class="line">          cpu-user-3 35m 7Mi </span><br><span class="line">          cpu-user-4 32m 10Mi</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'cpu-user-1'</span> &gt; /opt/KUTR00401/KUTR00401.txt</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题15-集群故障排查">考题15-集群故障排查</h2>
<h3 id="题目：集群故障排查">题目：集群故障排查</h3>
<p>Task weight: 13%</p>
<p>Set configuration context:<br>
<code>[student@node-1] $ kubectl config use-context wk8s</code></p>
<h4 id="task-v15">Task</h4>
<p>A Kubernetes worker node, named <code>wk8s-node-O</code> is in state <code>NotReady</code>.<br>
Investigate why this is the case, and perform any appropriate steps to bring the node to a <code>Ready</code> state, ensuring that any<br>
changes are made permanent.</p>
<h3 id="解答：集群故障排查">解答：集群故障排查</h3>
<p>Search <code>systemctl restart</code>, 选择<a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/troubleshooting-kubeadm/" target="_blank" rel="noopener">Troubleshooting kubeadm</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl get nodes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接worker node</span></span><br><span class="line">ssh wk8s-node-O</span><br><span class="line"><span class="comment"># 获取sudo权限</span></span><br><span class="line">sudo -i</span><br><span class="line"><span class="comment"># 查看服务是否正常运行</span></span><br><span class="line">systemctl status kubelet</span><br><span class="line"><span class="comment"># 服务重启</span></span><br><span class="line">systemctl restart kubelet</span><br><span class="line"><span class="comment"># 设置开机自动启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> kubelet</span><br><span class="line"><span class="comment"># 查看服务是否正常运行</span></span><br><span class="line">systemctl status kubelet</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题16-添加-sidecar-container">考题16-添加 sidecar container</h2>
<h3 id="题目：添加-sidecar-container">题目：添加 sidecar container</h3>
<p>Task weight: 7%</p>
<p>Set configuration context:<br>
<code>[student@node-1] $ kubectl config use-context k8s</code></p>
<h4 id="context-v2">Context</h4>
<p>Without changing its existing containers, an existing Pod needs to be integrated into Kubernetes’s built-in logging architecture (e.g. kubectl logs). Adding a streaming sidecar container is a good and common way to accomplish this requirement.</p>
<h4 id="task-v16">Task</h4>
<p>Add a <code>busybox</code> sidecar container to the existing Pod <code>legacy-app</code>. The new sidecar container has to run the following command:<br>
<code>/bin/sh -c tail -n+l -f /var/log/legacy-app.log</code></p>
<p>Use a volume mount named <code>logs</code> to make the file <code>/var/log/legacy-app.log</code> available to the sidecar container.</p>
<blockquote>
<p>Don’t modify the existing container.<br>
Don’t modify the path of the log file, both containers<br>
must access it at <code>/var/log/legacy-app.log</code></p>
</blockquote>
<h3 id="解答：添加-sidecar-container">解答：添加 sidecar container</h3>
<p>官网Search <code>Logging</code>, 选择<a href="https://kubernetes.io/docs/concepts/cluster-administration/logging/" target="_blank" rel="noopener">Logging Architecture</a>.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context k8s</span><br><span class="line"></span><br><span class="line">kubectl get pod legacy-app -o yaml &gt; legacy-app2.yaml</span><br><span class="line">vim legacy-app2.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">legacy-app</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">count</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox:1.28</span></span><br><span class="line">    <span class="attr">args:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/bin/sh</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&gt;</span></span><br><span class="line">      <span class="string">i=0;</span></span><br><span class="line">      <span class="string">while</span> <span class="literal">true</span><span class="string">;</span></span><br><span class="line">      <span class="string">do</span></span><br><span class="line">        <span class="string">echo</span> <span class="string">"$i: $(date)"</span> <span class="string">&gt;&gt;</span> <span class="string">/var/log/1.log;</span></span><br><span class="line">        <span class="string">echo</span> <span class="string">"$(date) INFO $i"</span> <span class="string">&gt;&gt;</span> <span class="string">/var/log/2.log;</span></span><br><span class="line">        <span class="string">i=$((i+1));</span></span><br><span class="line">        <span class="string">sleep</span> <span class="number">1</span><span class="string">;</span></span><br><span class="line">      <span class="string">done</span>      </span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">logs</span>          <span class="comment"># 3 修改挂载目录及名称</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">/var/log</span> <span class="comment"># 3 修改挂载目录及名称</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">busybox</span>  <span class="comment"># 1 Add sidecar container</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox</span> <span class="comment"># 1 Add sidecar container</span></span><br><span class="line">    <span class="attr">args:</span> <span class="string">[/bin/sh,</span> <span class="string">-c,</span> <span class="string">'tail -n+1 -f /var/log/legacy-app.log'</span><span class="string">]</span> <span class="comment"># 1 command</span></span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">logs</span>          <span class="comment"># 2 添加vomuleMount挂载点</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">/var/log</span> <span class="comment"># 2 注意是/var/log，不是/var/log/legacy-app.log</span></span><br><span class="line">  <span class="attr">volumes:</span>     </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">logs</span> <span class="comment"># 3 添加volumes</span></span><br><span class="line">    <span class="attr">emptyDir:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 删除legacy-app，否则再运行yaml时会提示legacy-app已存在</span></span><br><span class="line">kubectl delete pod legacy-app -–force</span><br><span class="line">kubectl apply -f legacy-app2.yaml</span><br><span class="line">kubectl get pods | grep legacy-app</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="考题17-检查有多少-node-节点是健康状态">考题17-检查有多少 node 节点是健康状态</h2>
<h3 id="题目：检查有多少-node-节点是健康状态">题目：检查有多少 node 节点是健康状态</h3>
<p>Task weight: 4%<br>
Set configuration context:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[studentfnode-1] $ kubectl config use-context k8S</span><br></pre></td></tr></table></figure>
<h4 id="task-v17">Task</h4>
<p>Check to see how many nodes are ready (not including nodes tainted <code>NoSchedule</code> ) and write the number to <code>/opt/KUSC00402/kusc00402.txt</code></p>
<h3 id="解答：检查有多少-node-节点是健康状态">解答：检查有多少 node 节点是健康状态</h3>
<p>Search <code>Check to see how many nodes are ready</code>, 选择<a href="https://kubernetes.io/docs/tasks/debug/debug-cluster/#listing-your-cluster" target="_blank" rel="noopener">Troubleshooting Clusters</a></p>
<ul>
<li><a href="https://www.runoob.com/linux/linux-comm-grep.html" target="_blank" rel="noopener">Linux grep 命令</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl config use-context k8s</span><br><span class="line"><span class="comment"># 1 查看STATUS是Ready的node有3个</span></span><br><span class="line">kubectl get nodes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 查看Ready的那些node是否是NoSchedule</span></span><br><span class="line">kubectl describe nodes | grep Taint</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者一个一个看node是否是NoSchedule</span></span><br><span class="line"><span class="comment"># kubectl describe nodes k8s-master-0 | grep Taint</span></span><br><span class="line"><span class="comment">#     Taints: node-role.kubernetes.io/master:NoSchedule</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># kubectl describe nodes k8s-node-0 | grep Taint</span></span><br><span class="line"><span class="comment">#     Taints: &lt;none&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># kubectl describe nodes k8s-node-1 | grep Taint</span></span><br><span class="line"><span class="comment">#     Taints: &lt;none&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 或者直接查看所有nodes里面不包含noschedule 并且是ready的共有几个，就是答案</span></span><br><span class="line"><span class="comment"># -i 或 --ignore-case : 忽略字符大小写的差别。-v 或 --invert-match : 显示不包含匹配文本的所有行。</span></span><br><span class="line"><span class="comment"># kubectl describe nodes | grep -i taints | grep -v -i noschedule </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 输出 = node ready 个数 - NoSchedule 个数</span></span><br><span class="line"><span class="built_in">echo</span> 2 &gt; /opt/KUSC00402/kusc00402.txt</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://blog.csdn.net/cum88284/article/details/109042737" target="_blank" rel="noopener">linux nano命令_Nano入门指南，Linux命令行文本编辑器</a></li>
<li><a href="https://itnext.io/cks-cka-ckad-changed-terminal-to-remote-desktop-157a26c1d5e" target="_blank" rel="noopener">CKS CKA CKAD changed Terminal to Remote Desktop since 06/2022</a></li>
<li><a href="https://blog.csdn.net/april_4/article/details/123233845" target="_blank" rel="noopener">2022年CKA 考试题 2022年3月1日刚过</a></li>
<li><a href="https://blog.csdn.net/qq_33680297/article/details/123074501" target="_blank" rel="noopener">2022.2 k8s-cka考试题库</a></li>
<li><a href="https://wenku.baidu.com/view/1d4a8bdbcbd376eeaeaad1f34693daef5ef713f4?bfetype=new" target="_blank" rel="noopener">CKA 百度文库</a></li>
<li><a href="https://www.mindmeister.com/zh/920845833/kubernauts-training-pla" target="_blank" rel="noopener">CKA Kubernauts Training Plan Mind 脑图</a><br>
<a href="https://zhuanlan.zhihu.com/p/106090560?utm_medium=social&amp;utm_oi=56834706636800&amp;utm_psn=1578894322392657920&amp;utm_source=wechat_session" target="_blank" rel="noopener">惊！2020年CKA考试最新最全指南</a></li>
<li><a href="https://huaweicloud.csdn.net/638db4c0dacf622b8df8cbb2.html" target="_blank" rel="noopener">如何在 K8S CKA、CKS 认证中失败！请仔细阅读，风险自负</a></li>
<li><a href="https://blog.csdn.net/shenhonglei1234/article/details/112670052?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167231074016782425181102%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=167231074016782425181102&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-27-112670052-null-null.142%5Ev68%5Econtrol,201%5Ev4%5Eadd_ask,213%5Ev2%5Et3_control1&amp;utm_term=CKAD%20%E7%9C%9F%E9%A2%98&amp;spm=1018.2226.3001.4187#20221114CKANEW_5" target="_blank" rel="noopener">新版本 CKA 资源目录总览</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>2022 CKAD K8s v1.25 考试真题整理</title>
    <url>/Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>上一篇：<a href="./Kubernates-Certified-Kubernetes-Administrator-CKA.html">CKA考试真题</a></p>
<h2 id="考试内容">考试内容</h2>
<p><a href="https://docs.linuxfoundation.org/tc-docs/certification/tips-cka-and-ckad" target="_blank" rel="noopener">Important Instructions: CKA and CKAD</a></p>
<ul>
<li>考试包括 15-20 项performance-based tasks。
<ul>
<li>2022.12 实测是16道题</li>
</ul>
</li>
<li>考生有 2 小时的时间完成 CKA 和 CKAD 考试。
<ul>
<li>因为从06/2022开始环境升级（贬义），考试环境更难用了，变的很卡，所以时间变得比较紧张。容易做不完题，建议先把有把握的，花费时间不多的题先做掉
<ul>
<li><a href="https://itnext.io/cks-cka-ckad-changed-terminal-to-remote-desktop-157a26c1d5e" target="_blank" rel="noopener">CKS CKA CKAD changed Terminal to Remote Desktop </a></li>
</ul>
</li>
</ul>
</li>
<li>CKAD考试66分以上即可通过，考试不通过有一次补考机会。</li>
</ul>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKA/CKA_exam_syllabus.png" alt="CKA"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKA/CKAD_exam_syllabus.png" alt="CKAD"></p>
<p>You’re only allowed to have one other browser tab open with:</p>
<ul>
<li><a href="https://kubernetes.io/docs" target="_blank" rel="noopener">https://kubernetes.io/docs</a></li>
<li><a href="https://kubernetes.io/blog" target="_blank" rel="noopener">https://kubernetes.io/blog</a></li>
<li><a href="https://helm.sh/docs" target="_blank" rel="noopener">https://helm.sh/docs</a></li>
</ul>
<h3 id="more-items-for-ckad-than-cka">More items for CKAD than CKA</h3>
<ul>
<li>Define, build and modify container images, <code>Dockerfile</code></li>
<li>Understand multi-container Pod design patterns (init containers)</li>
<li>Understand <code>Jobs</code> and <code>CronJobs</code></li>
<li>Implement <code>probes</code> and health checks</li>
<li>Understand <a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/" target="_blank" rel="noopener"><code>SecurityContexts</code></a></li>
<li><a href="https://kubernetes.io/docs/concepts/cluster-administration/manage-deployment/#canary-deployments" target="_blank" rel="noopener"><code>canary deployment</code></a>
<ul>
<li><a href="./Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html#%E8%80%83%E9%A2%9810-2022-rollout-canary">考题10 - 2022 Rollout Canary</a></li>
</ul>
</li>
<li><code>ResourceQuota</code></li>
</ul>
<h2 id="如何备考">如何备考</h2>
<h3 id="k8s练习环境-同cka"><a href="./Kubernates-Certified-Kubernetes-Administrator-CKA.html#k8s%E7%BB%83%E4%B9%A0%E7%8E%AF%E5%A2%83">k8s练习环境</a>(同CKA)</h3>
<h3 id="ckad练习题">CKAD练习题</h3>
<p>有几个练习库，建议将每个题目都自己亲自操作一遍，一定要操作。</p>
<ul>
<li>CKAD在线练习环境：<a href="https://killercoda.com/killer-shell-ckad" target="_blank" rel="noopener">https://killercoda.com/killer-shell-ckad</a></li>
<li><a href="https://github.com/StenlyTU/K8s-training-official" target="_blank" rel="noopener">Git - StenlyTU - K8s Practice Training for CKA, CKAD and CKS</a></li>
<li><a href="https://github.com/bbachi/CKAD-Practice-Questions" target="_blank" rel="noopener">bbachi/CKAD-Practice-Questions</a>
<ul>
<li>对应博客<a href="https://medium.com/bb-tutorials-and-thoughts/practice-enough-with-these-questions-for-the-ckad-exam-2f42d1228552" target="_blank" rel="noopener">2019.11 Practice Enough With These 150 Questions for the CKAD Exam</a><!-- - [CKAD考试真题-练习题150道](https://www.cnblogs.com/peteremperor/p/12785335.html) 同第一个链接一样 -->
<ul>
<li>同第一个链接一样，中文版 <a href="https://blog.csdn.net/tanjunchen/article/details/104865939?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166039499316782248541148%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166039499316782248541148&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-104865939-null-null.142%5Ev40%5Epc_search_integral,185%5Ev2%5Econtrol&amp;utm_term=CKAD%E8%80%83%E8%AF%95%E9%A2%98&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener">2020 CKAD 考试习题练习104道</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://github.com/dgkanatsios/CKAD-exercises" target="_blank" rel="noopener">dgkanatsios/CKAD-exercises</a></li>
<li>Oreilly视频课程-附带练习环境（链接已失效Katacoda has ended public service）： <a href="https://www.katacoda.com/liptanbiswas/courses/ckad-practice-challenges" target="_blank" rel="noopener">https://www.katacoda.com/liptanbiswas/courses/ckad-practice-challenges</a></li>
</ul>
<p>题库里面题目是更简单一些，真的考题会是这些练习题的组合，把里面的题目都能熟练操作，就差不多了。</p>
<h3 id="ckad课程">CKAD课程</h3>
<ul>
<li>【需付费】CKAD考试-对应官方课程<a href="https://training.linuxfoundation.org/training/kubernetes-for-developers/" target="_blank" rel="noopener">Kubernetes for Developers (LFD259)</a></li>
<li>【需付费】Udemy CKAD 课程
<ul>
<li><a href="https://www.techbeatly.com/kk-ckad" target="_blank" rel="noopener">Certified Kubernetes Application Developer (CKAD)</a> – by Mumshad Mannambeth</li>
<li><a href="https://www.techbeatly.com/kk-ckad-ud" target="_blank" rel="noopener">Kubernetes Certified Application Developer (CKAD) with Tests</a> – by Mumshad Mannambeth – Udemy</li>
</ul>
</li>
<li>【需付费】Oreilly视频课程: (For beginner or Advanced) <a href="https://learning.oreilly.com/videos/certified-kubernetes-application/9780137841509/" target="_blank" rel="noopener">Certified Kubernetes Application Developer (CKAD) Sander van Vugt</a>.
<ul>
<li><a href="https://learning.oreilly.com/live-events/certified-kubernetes-application-developer-ckad-crash-course/0636920315803/" target="_blank" rel="noopener">Certified Kubernetes Application Developer (CKAD) Crash Course</a>
<ul>
<li>附带练习环境Practice: <a href="https://learning.oreilly.com/playlists/ea6ea0fc-d8e2-422c-94dd-a0a8f608d224/" target="_blank" rel="noopener">Certified Kubernetes - CKAD Labs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="常用命令">常用命令</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 不熟</span></span><br><span class="line"><span class="comment">## 输出pod status</span></span><br><span class="line">kubectl -n default describe pod pod1 | grep -i status:</span><br><span class="line">kubectl -n default get pod pod1 -o jsonpath=<span class="string">"&#123;.status.phase&#125;"</span></span><br><span class="line"><span class="comment">## Check the pod for error</span></span><br><span class="line">kubectl describe pod podname | grep -i error</span><br><span class="line">... Error: ImagePullBackOff</span><br><span class="line"><span class="comment">## a fast way to get an overview of the ReplicaSets of a Deployment and their images could be done with:</span></span><br><span class="line">kubectl -n neptune get rs -o wide | grep deployname</span><br><span class="line">NAME         DESIRED   CURRENT   READY   AGE    CONTAINERS   IMAGES         SELECTOR</span><br><span class="line">deployname   3         3         3       9m6s   httpd        httpd:alpine   app=wonderful</span><br><span class="line"></span><br><span class="line"><span class="comment">## 创建job</span></span><br><span class="line">kubectl -n neptune create job neb-new-job --image=busybox:1.31.0 <span class="variable">$do</span> &gt; /opt/course/3/job.yaml -- sh -c <span class="string">"sleep 2 &amp;&amp; echo done"</span></span><br><span class="line"><span class="comment">## If a Secret bolongs to a serviceaccount, it'll have the annotation kubernetes.io/service-account.name</span></span><br><span class="line">kubectl get secrets -oyaml | grep annotations -A 1 <span class="comment"># shows secrets with first annotation</span></span><br><span class="line"><span class="comment">## log</span></span><br><span class="line">kubectl logs podname &gt; /opt/test.log</span><br><span class="line">➜ k -n mercury logs cleaner-576967576c-cqtgx --container logger-con</span><br><span class="line"></span><br><span class="line"><span class="comment">## decode base64</span></span><br><span class="line">base64 -d filename</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"YWRtaW4="</span> | base64 -d</span><br><span class="line">admins$</span><br><span class="line"></span><br><span class="line"><span class="comment">## check service connection using a temporary Pod</span></span><br><span class="line"><span class="comment">## k run tmp --restart=Never --rm --image=nginx:alpine -i -- curl http://svcname.namespace:svcport</span></span><br><span class="line">kubectl run tmp --restart=Never --rm --image=nginx:alpine -i -- curl http://svcname.namespace:80</span><br><span class="line"><span class="comment">## check that both PV and PVC have the status Bound:</span></span><br><span class="line">k -n earth get pv,pvc</span><br><span class="line">NAME                                            CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                 STORAGECLASS   REASON   AGE</span><br><span class="line">persistentvolume/earth-project-earthflower-pv   2Gi        RWO            Retain           Bound    earth/earth-project-earthflower-pvc                           8m4s</span><br><span class="line"></span><br><span class="line">NAME                                                  STATUS   VOLUME                         CAPACITY   ACCESS MODES   STORAGECLASS   AGE</span><br><span class="line">persistentvolumeclaim/earth-project-earthflower-pvc   Bound    earth-project-earthflower-pv   2Gi        RWO                           7m38s</span><br><span class="line"></span><br><span class="line"><span class="comment">## We can confirm the pod of deployment with PVC mounting correctly:</span></span><br><span class="line">k describe pod project-earthflower-586758cc49-hb87f -n earth | grep -A2 Mount:</span><br><span class="line">    Mounts:</span><br><span class="line">      /tmp/project-data from task-pv-storage (rw)</span><br><span class="line">      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-jj2t2 (ro)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Verify everything using kubectl auth can-i</span></span><br><span class="line">kubectl auth can-i create deployments --as system:serviceaccount:app-team1:cicd-token -n app-team1 <span class="comment"># YES</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 查看某个namespace的resource quota</span></span><br><span class="line">$ kubectl describe quota --namespace=rq-demo</span><br><span class="line"><span class="comment">## 或者</span></span><br><span class="line">$ kubectl describe resourcequotas -n rq-demo</span><br><span class="line"></span><br><span class="line"><span class="comment">## rollout</span></span><br><span class="line">k -n mercury rollout <span class="built_in">history</span> deploy cleaner --revision 1</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 常用</span></span><br><span class="line"><span class="comment">## 创建pod</span></span><br><span class="line">kubectl run pod1 --image=httpd:2.4.41-alpine <span class="variable">$do</span> --port=80 &gt; 2.yaml</span><br><span class="line">kubectl get pod sat-003 -o yaml &gt; 7-sat-003.yaml <span class="comment"># export</span></span><br><span class="line">kubectl delete pod pod1 --force --grace-period=0</span><br><span class="line"><span class="comment">## 创建service</span></span><br><span class="line">kubectl expose deployment d1 --name=服务名 --port=服务端口 --target-port=pod运行端口 --<span class="built_in">type</span>=类型 --protocol=TCP</span><br><span class="line">kubectl expose pod pod名 --name=服务名 --port=服务端口 --target-port=pod运行端口 --<span class="built_in">type</span>=类型</span><br><span class="line"><span class="comment">## 创建secret</span></span><br><span class="line">kubectl create secret generic db-credentials --from-literal db-password=passwd</span><br><span class="line"><span class="comment">## modify a pod yaml to deployment yaml</span></span><br><span class="line"><span class="comment">### put the Pod's metadata: and spec: into the Deployment's template: section:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Ingress</span></span><br><span class="line"><span class="comment"># 1 注意namespace</span></span><br><span class="line"><span class="comment"># spec:</span></span><br><span class="line">  <span class="comment"># ingressClassName: nginx   # 2 ingressClassName</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># metadata:</span></span><br><span class="line">  <span class="comment"># name: minimal-ingress</span></span><br><span class="line">  <span class="comment"># annotations:</span></span><br><span class="line">  <span class="comment">#   nginx.ingress.kubernetes.io/rewrite-target: /   #3 annotation</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## NetworkPolicy</span></span><br><span class="line">注意 </span><br><span class="line">  egress:</span><br><span class="line">    - to:</span><br><span class="line">        - ipBlock:</span><br><span class="line">            cidr: 10.0.0.0/24</span><br><span class="line">      ports:                   <span class="comment"># &amp;</span></span><br><span class="line">        - protocol: TCP</span><br><span class="line">          port: 5978</span><br><span class="line"></span><br><span class="line">  egress:</span><br><span class="line">    - to:</span><br><span class="line">        - ipBlock:</span><br><span class="line">            cidr: 10.0.0.0/24</span><br><span class="line">    - ports:                  <span class="comment"># ||</span></span><br><span class="line">        - protocol: TCP</span><br><span class="line">          port: 5978</span><br></pre></td></tr></table></figure>
<h2 id="经验总结-同cka"><a href="http://liyuankun.top/Kubernates-Certified-Kubernetes-Administrator-CKA.html#%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93">经验总结</a>(同CKA)</h2>
<h2 id="pre-setup-同cka"><a href="http://liyuankun.top/Kubernates-Certified-Kubernetes-Administrator-CKA.html#pre-setup">Pre Setup</a>(同CKA)</h2>
<h2 id="ckad-真题">CKAD 真题</h2>
<p>2021 年的考题，基于k8s 1.20<br>
2022.12 的考题，基于k8s 1.25</p>
<h3 id="2021考题1-creating-a-pod-and-inspecting-it">2021考题1 - Creating a Pod and Inspecting it</h3>
<ol>
<li>Create the namespace ckad-prep.</li>
<li>In the namespace ckad-prep create a new Pod named mypod with the image nginx:2.3.5. Expose the port 80.</li>
<li>Identify the issue with creating the container. Write down the root cause of issue in a file named pod-error.txt.</li>
<li>Change the image of the Pod to nginx:1.15.12.</li>
<li>List the Pod and ensure that the container is running.</li>
<li>Log into the container and run the ls command. Write down the output. Log out of the container.</li>
<li>Retrieve the IP address of the Pod mypod.</li>
<li>Run a temporary Pod using the image busybox, shell into it and run a wget command against the nginx Pod using port 80.</li>
<li>Render the logs of Pod mypod.</li>
<li>Delete the Pod and the namespace.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. create the namespace.</span></span><br><span class="line">$ kubectl create ns ckad-prep</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. create a new Pod</span></span><br><span class="line">$ kubectl run mypod -n ckad-prep --image=nginx:2.3.5 --port=80 </span><br><span class="line"><span class="comment"># 或者：</span></span><br><span class="line"><span class="comment"># $ kubectl run mypod --namespace=ckad-prep --image=nginx:2.3.5 --port=80 </span></span><br><span class="line">pod/mypod created</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 3. Write down root cause in pod-error.txt</span></span><br><span class="line">$ kubectl get pod -n ckad-prep</span><br><span class="line">NAME    READY   STATUS             RESTARTS   AGE</span><br><span class="line">mypod   0/1     ImagePullBackOff   0          1m</span><br><span class="line"></span><br><span class="line">$ kubectl describe pod mypod -n ckad-prep</span><br><span class="line">...</span><br><span class="line">Events:</span><br><span class="line">  Type     Reason     Age                  From               Message</span><br><span class="line">  ----     ------     ----                 ----               -------</span><br><span class="line">  Normal   Scheduled  12m                  default-scheduler  Successfully assigned ckad-prep/mypod to controlplane</span><br><span class="line">  Normal   Pulling    10m (x4 over 12m)    kubelet            Pulling image <span class="string">"nginx:2.3.5"</span></span><br><span class="line">  Warning  Failed     10m (x4 over 12m)    kubelet            Failed to pull image <span class="string">"nginx:2.3.5"</span>: rpc error: code = NotFound desc = failed to pull and unpack image <span class="string">"docker.io/library/nginx:2.3.5"</span>: failed to resolve reference <span class="string">"docker.io/library/nginx:2.3.5"</span>: docker.io/library/nginx:2.3.5: not found</span><br><span class="line">  Warning  Failed     10m (x4 over 12m)    kubelet            Error: ErrImagePull</span><br><span class="line">  Warning  Failed     10m (x6 over 12m)    kubelet            Error: ImagePullBackOff</span><br><span class="line">  Normal   BackOff    2m9s (x41 over 12m)  kubelet            Back-off pulling image <span class="string">"nginx:2.3.5"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ kubectl describe pod mypod -n ckad-prep | grep err -i</span><br><span class="line">      Reason:       ErrImagePull</span><br><span class="line">  Warning  Failed     17s (x3 over 57s)  kubelet            Failed to pull image <span class="string">"nginx:2.3.5"</span>: rpc error: code = NotFound desc = failed to pull and unpack image <span class="string">"docker.io/library/nginx:2.3.5"</span>: failed to resolve reference <span class="string">"docker.io/library/nginx:2.3.5"</span>: docker.io/library/nginx:2.3.5: not found</span><br><span class="line">  Warning  Failed     17s (x3 over 57s)  kubelet            Error: ErrImagePull</span><br><span class="line">  Warning  Failed     3s (x3 over 56s)   kubelet            Error: ImagePullBackOff</span><br><span class="line"></span><br><span class="line">$ kubectl describe pod mypod -n ckad-prep | grep err -i &gt; pod-error.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 4. Change the image of the Pod to nginx:1.15.12</span></span><br><span class="line">$ kubectl edit pod mypod -n ckad-prep</span><br><span class="line"></span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - image: nginx:1.15.12 <span class="comment"># 从nginx:2.3.5改为nginx:1.15.12</span></span><br><span class="line"></span><br><span class="line">pod/mypod edited</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. List the Pod and ensure that the container is running.</span></span><br><span class="line">$ kubectl get pod -n ckad-prep</span><br><span class="line">NAME    READY   STATUS    RESTARTS   AGE</span><br><span class="line">mypod   1/1     Running   0          19m</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. Log into the container and run the ls command. Write down the output. Log out of the container.</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> mypod -n ckad-prep -- ls</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> mypod -it -n ckad-prep  -- /bin/sh</span><br><span class="line">/ <span class="comment"># ls</span></span><br><span class="line">bin  boot  dev	etc  home  lib	lib64  media  mnt  opt	proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">/ <span class="comment"># exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. Retrieve the IP address of the Pod mypod.</span></span><br><span class="line">$ kubectl get pod -n ckad-prep -o wide</span><br><span class="line">NAME    READY   STATUS    RESTARTS   AGE   IP            NODE           NOMINATED NODE   READINESS GATES</span><br><span class="line">mypod   1/1     Running   0          29m   192.168.0.6   controlplane   &lt;none&gt;           &lt;none&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 8. Run a temporary Pod using the image busybox, shell into it and run a wget command against the nginx Pod using port 80.</span></span><br><span class="line"><span class="comment"># 用#7 里面得到的IP</span></span><br><span class="line">$ kubectl run busybox --image=busybox --rm -it --restart=Never -n ckad-prep -- /bin/sh</span><br><span class="line">/ <span class="comment"># wget -O- 192.168.0.6:80</span></span><br><span class="line">Connecting to 192.168.0.6:80 (192.168.0.6:80)</span><br><span class="line">writing to stdout</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">        width: 35em;</span><br><span class="line">        margin: 0 auto;</span><br><span class="line">        font-family: Tahoma, Verdana, Arial, sans-serif;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;If you see this page, the nginx web server is successfully installed and</span><br><span class="line">working. Further configuration is required.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;For online documentation and support please refer to</span><br><span class="line">&lt;a href=<span class="string">"http://nginx.org/"</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span><br><span class="line">Commercial support is available at</span><br><span class="line">&lt;a href=<span class="string">"http://nginx.com/"</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;&lt;em&gt;Thank you <span class="keyword">for</span> using nginx.&lt;/em&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">-                    100% |***************************************************************************************************|   612  0:00:00 ETA</span><br><span class="line">written to stdout</span><br><span class="line">/ <span class="comment"># exit</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 9. Render the logs of Pod mypod.</span></span><br><span class="line">$ kubectl logs pods/mypod -n ckad-prep</span><br><span class="line">192.168.0.7 - - [25/Dec/2022:10:47:23 +0000] <span class="string">"GET / HTTP/1.1"</span> 200 612 <span class="string">"-"</span> <span class="string">"Wget"</span> <span class="string">"-"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 10. Delete the Pod and the namespace.</span></span><br><span class="line">$ kubectl delete pods/mypod -n ckad-prep</span><br><span class="line">pod <span class="string">"mypod"</span> deleted</span><br><span class="line"></span><br><span class="line">$ kubectl delete ns ckad-prep</span><br><span class="line">namespace <span class="string">"ckad-prep"</span> deleted</span><br></pre></td></tr></table></figure>
<h3 id="2021考题2-configuring-a-pod-to-use-a-configmap">2021考题2 - Configuring a Pod to Use a ConfigMap</h3>
<ol>
<li>Create a new file named <code>config.txt</code> with the following environment variables as key/value pairs on each line.
<ul>
<li><code>DB_URL</code> equates to <code>localhost:3306</code></li>
<li><code>DB_USERNAME</code> equates to <code>postgres</code></li>
</ul>
</li>
<li>Create a new ConfigMap named <code>db-config</code> from that file.</li>
<li>Create a Pod named <code>backend</code> that uses the environment variables from the ConfigMap and runs the container with the image <code>nginx</code>.</li>
<li>Shell into the Pod and print out the created environment variables. You should find <code>DB_URL</code> and <code>DB_USERNAME</code> with their appropriate values.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. Create a new file named `config.txt`</span></span><br><span class="line">$ <span class="built_in">echo</span> -e <span class="string">"DB_URL=localhost:3306\nDB_USERNAME=postgres"</span> &gt; config.txt</span><br><span class="line">或者</span><br><span class="line">$ vim config.txt</span><br><span class="line">DB_URL=localhost:3306</span><br><span class="line">DB_USERNAME=postgres</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. Create a new ConfigMap `db-config`</span></span><br><span class="line">$ kubectl create configmap db-config --from-file config.txt</span><br><span class="line">configmap/db-config created</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. Create a Pod `backend`</span></span><br><span class="line">$ kubectl run backend --image nginx --dry-run=client -o yaml &gt; 1.yaml</span><br><span class="line">$ vim 1.yaml</span><br></pre></td></tr></table></figure>
<p>参考官网<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/#configure-all-key-value-pairs-in-a-configmap-as-container-environment-variables" target="_blank" rel="noopener">config</a></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">backend</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">    <span class="attr">envFrom:</span>         <span class="comment"># Add</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">configMapRef:</span>  <span class="comment"># Add</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">db-config</span>  <span class="comment"># Modify to configmap name: db-config</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl apply -f 1.yaml </span><br><span class="line">pod/backend created</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 4. Shell into the Pod and print out the created environment variables. You should find `DB_URL` and `DB_USERNAME` with their appropriate values.</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> backend -it -- /bin/sh</span><br><span class="line">/ <span class="comment"># env</span></span><br><span class="line">config.txt=DB_URL=localhost:3306</span><br><span class="line">DB_USERNAME=postgres</span><br><span class="line">...</span><br><span class="line">/ <span class="comment"># exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> backend -- env | grep DB</span><br><span class="line">config.txt=DB_URL=localhost:3306</span><br><span class="line">DB_USERNAME=postgres</span><br></pre></td></tr></table></figure>
<h3 id="2021考题3-configuring-a-pod-to-use-a-secret">2021考题3 - Configuring a Pod to Use a Secret</h3>
<ol>
<li>Create a new Secret named <code>db-credentials</code> with the key/value pair <code>db-password=passwd</code>.</li>
<li>Create a Pod named <code>backend</code> that defines uses the Secret as environment variable named <code>DB_PASSWORD</code> and runs the container with the image <code>nginx</code>.</li>
<li>Shell into the Pod and print out the created environment variables. You should find <code>DB_PASSWORD</code> variable.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.</span></span><br><span class="line">$ kubectl create secret generic db-credentials --from-literal=db-password=passwd</span><br><span class="line">secret/db-credentials created</span><br><span class="line">$ kubectl get secrets</span><br><span class="line">NAME              TYPE      DATA   AGE</span><br><span class="line">db-credentials    Opaque    1      26s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. </span></span><br><span class="line">$ kubectl run backend --image=nginx --restart=Never -o yaml --dry-run &gt; pod.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">backend</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">env:</span>                          <span class="comment"># Add</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_PASSWORD</span>         <span class="comment"># modify to DB_PASSWORD</span></span><br><span class="line">        <span class="attr">valueFrom:</span>                <span class="comment"># Add</span></span><br><span class="line">          <span class="attr">secretKeyRef:</span>           <span class="comment"># Add</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">db-credentials</span>  <span class="comment"># secret name</span></span><br><span class="line">            <span class="attr">key:</span> <span class="string">db-password</span>      <span class="comment"># secret key</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 2.2</span></span><br><span class="line">$ kubectl create -f pod.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> -it backend -- /bin/sh</span><br><span class="line">/ <span class="comment"># env</span></span><br><span class="line">DB_PASSWORD=passwd</span><br><span class="line">/ <span class="comment"># exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> backend -- env</span><br></pre></td></tr></table></figure>
<h3 id="考题4-creating-a-security-context-for-a-pod">考题4 - Creating a Security Context for a Pod</h3>
<h4 id="2021考题4">2021考题4</h4>
<ol>
<li>Create a Pod named <code>secured</code> that uses the image <code>nginx</code> for a single container. Mount an <code>emptyDir</code> volume to the directory <code>/data/app</code>.</li>
<li>Files created on the volume should use the filesystem group ID <code>3000</code>.</li>
<li>Get a shell to the running container and create a new file named <code>logs.txt</code> in the directory <code>/data/app</code>. List the contents of the directory and write them down.</li>
</ol>
<p>参考官网：<a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod" target="_blank" rel="noopener">Configure a Security Context for a Pod or Container</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.1 Create a Pod named `secured`</span></span><br><span class="line">$ kubectl run secured --image=nginx -o yaml --dry-run &gt; secured.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># secured.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">secured</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">secured</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">securityContext:</span>        <span class="comment"># Add</span></span><br><span class="line">    <span class="attr">fsGroup:</span> <span class="number">3000</span>         <span class="comment"># Add 2 filesystem group ID `3000`</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">secured</span></span><br><span class="line">    <span class="attr">volumeMounts:</span>                   <span class="comment"># Add 1.3 mount emptyDir</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">data-vol</span>                <span class="comment"># Add 1.3 mount emptyDir</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">/data/app</span>          <span class="comment"># Add 1.3 mount emptyDir</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">volumes:</span>                  <span class="comment"># Add 1.2 emptyDir</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">data-vol</span>          <span class="comment"># Add 1.2 emptyDir</span></span><br><span class="line">    <span class="attr">emptyDir:</span> <span class="string">&#123;&#125;</span>            <span class="comment"># Add 1.2 emptyDir</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 2. Create a Pod named `secured`</span></span><br><span class="line">$ kubectl create -f secured.yaml</span><br><span class="line">pod/secured created</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 </span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> -it secured -- sh</span><br><span class="line">/ <span class="comment"># cd /data/app</span></span><br><span class="line">/ <span class="comment"># touch logs.txt</span></span><br><span class="line">/ <span class="comment"># ls -l</span></span><br><span class="line">-rw-r--r-- 1 root 3000 0 Mar 11 15:56 logs.txt</span><br><span class="line">/ <span class="comment"># exit</span></span><br></pre></td></tr></table></figure>
<h4 id="2022-考题4-security-context">2022 考题4 Security Context</h4>
<blockquote>
<p>只记住了大概</p>
</blockquote>
<p>deployment 或者pod</p>
<ul>
<li>user ID <code>10000</code></li>
<li>Privilege escalation forbidden</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">security-context-demo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">securityContext:</span></span><br><span class="line">    <span class="attr">runAsUser:</span> <span class="number">10000</span>          <span class="comment">#  user ID `10000`</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sec-ctx-vol</span></span><br><span class="line">    <span class="attr">emptyDir:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sec-ctx-demo</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox:1.28</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">[</span> <span class="string">"sh"</span><span class="string">,</span> <span class="string">"-c"</span><span class="string">,</span> <span class="string">"sleep 1h"</span> <span class="string">]</span></span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sec-ctx-vol</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">/data/demo</span></span><br><span class="line">    <span class="attr">securityContext:</span></span><br><span class="line">      <span class="attr">allowPrivilegeEscalation:</span> <span class="literal">false</span>  <span class="comment"># Privilege escalation forbidden</span></span><br></pre></td></tr></table></figure>
<h3 id="考题5-defining-a-pod-s-resource-requirements">考题5 - Defining a Pod’s Resource Requirements</h3>
<h4 id="2021-考题5-resourcequota">2021 考题5 ResourceQuota</h4>
<ol>
<li>Create a resource quota named <code>apps</code> under the namespace <code>rq-demo</code> using the following YAML definition in the file <code>rq.yaml</code>.</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ResourceQuota</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">app</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">hard:</span></span><br><span class="line">    <span class="attr">pods:</span> <span class="string">"2"</span></span><br><span class="line">    <span class="attr">requests.cpu:</span> <span class="string">"2"</span></span><br><span class="line">    <span class="attr">requests.memory:</span> <span class="string">500m</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Create a new Pod that exceeds the limits of the resource quota requirements. Write down the error message.</li>
<li>Change the request limits to fulfill the requirements to ensure that the Pod could be created successfully. Write down the output of the command that renders the used amount of resources for the namespace.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.</span></span><br><span class="line">$ kubectl create namespace rq-demo</span><br><span class="line">$ vim rq.yaml</span><br><span class="line"></span><br><span class="line">metadata:</span><br><span class="line">  name: apps</span><br><span class="line"></span><br><span class="line">$ kubectl create -f rq.yaml --namespace=rq-demo</span><br><span class="line">resourcequota/app created</span><br><span class="line"></span><br><span class="line">$ kubectl get resourcequota/apps -n rq-demo</span><br><span class="line">NAME   AGE     REQUEST                                                 LIMIT</span><br><span class="line">apps   4m43s   pods: 0/2, requests.cpu: 0/2, requests.memory: 0/500m</span><br><span class="line"></span><br><span class="line">$ kubectl describe quota --namespace=rq-demo</span><br><span class="line">Name:            app</span><br><span class="line">Namespace:       rq-demo</span><br><span class="line">Resource         Used  Hard</span><br><span class="line">--------         ----  ----</span><br><span class="line">pods             0     2</span><br><span class="line">requests.cpu     0     2</span><br><span class="line">requests.memory  0     500m</span><br></pre></td></tr></table></figure>
<p>参考官网：<a href="https://kubernetes.io/docs/concepts/policy/resource-quotas/" target="_blank" rel="noopener">resource-quotas</a></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">mypod</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mypod</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mypod</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">requests:</span></span><br><span class="line">        <span class="attr">memory:</span> <span class="string">"1G"</span></span><br><span class="line">        <span class="attr">cpu:</span> <span class="string">"400m"</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 2. 注意即使yaml文件里面加了metadata.namespace, 创建的命令仍然要加`-n`或者`--namespace`，否则新建的pod不在这个namespace上</span></span><br><span class="line">$ kubectl create -f pod.yaml -n rq-demo</span><br><span class="line">Error from server (Forbidden): error when creating <span class="string">"pod.yaml"</span>: pods <span class="string">"mypod"</span> is forbidden: exceeded quota: app, requested: requests.memory=1G, used: requests.memory=0, limited: requests.memory=500m</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Lower the memory settings to less than 500m (e.g. 200m) and create the Pod.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl create -f pod.yaml --namespace=rq-demo</span><br><span class="line">pod/mypod created</span><br><span class="line">$ kubectl describe quota --namespace=rq-demo</span><br><span class="line">Name:            app</span><br><span class="line">Namespace:       rq-demo</span><br><span class="line">Resource         Used  Hard</span><br><span class="line">--------         ----  ----</span><br><span class="line">pods             1     2</span><br><span class="line">requests.cpu     400m  2</span><br><span class="line">requests.memory  200m  500m</span><br></pre></td></tr></table></figure>
<h4 id="2022-考题5-limitrange">2022 考题5 LimitRange</h4>
<blockquote>
<p>只记住了大概</p>
</blockquote>
<p>有一个deployment，路径 <code>~/path/5.yaml</code>, namespace <code>namespace1</code> 因为resource不足，无法成功启动。<br>
修改deployment：</p>
<ul>
<li>memory request “300Mi”</li>
<li>memory limit 是所在namespace的一半</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 尝试get resourcequota, 但没得到东西</span></span><br><span class="line"><span class="comment"># k get resourcequota -n namespace1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试get resourcequota, 但没得到东西</span></span><br><span class="line">k get limitranges -n namespace1</span><br><span class="line">NAMESPACE   NAME              CREATED AT</span><br><span class="line">default     mem-limit-range </span><br><span class="line"></span><br><span class="line">k k describe limitrange -n namespace1</span><br><span class="line">Type        Resource  Min  Max  Default Request  Default Limit  Max Limit/Request Ratio</span><br><span class="line">----        --------  ---  ---  ---------------  -------------  -----------------------</span><br><span class="line">Container   memory    -    898Mi 256Mi            512Mi          -</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pod 或者deployment</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">example-no-conflict-with-limitrange-cpu</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">demo</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.k8s.io/pause:2.0</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">requests:</span></span><br><span class="line">        <span class="attr">memory:</span> <span class="string">"300Mi"</span>              <span class="comment"># Add</span></span><br><span class="line">      <span class="attr">limits:</span></span><br><span class="line">        <span class="attr">memory:</span> <span class="string">"449Mi"</span>              <span class="comment"># Add 898Mi 的一半</span></span><br></pre></td></tr></table></figure>
<h3 id="考题6-using-a-service-account">考题6 - Using a Service Account</h3>
<ol>
<li>Create a new service account named <code>backend-team</code>.</li>
<li>Print out the token for the service account in YAML format.</li>
<li>Create a Pod named <code>backend</code> that uses the image <code>nginx</code> and the identity <code>backend-team</code> for running processes.</li>
<li>Get a shell to the running container and print out the token of the service account.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. Create a new service account</span></span><br><span class="line">$ kubectl create serviceaccount backend-team</span><br><span class="line">serviceaccount/backend-team created</span><br><span class="line"></span><br><span class="line"><span class="comment">## 参考https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-a-long-lived-api-token-for-a-serviceaccount</span></span><br><span class="line"><span class="comment"># 加annotation</span></span><br><span class="line">  annotations:</span><br><span class="line">    kubernetes.io/service-account.name: backend-team</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.</span></span><br><span class="line">$ kubectl get serviceaccount backend-team -o yaml --<span class="built_in">export</span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  creationTimestamp: 2019-05-09T22:43:54Z</span><br><span class="line">  name: backend-team</span><br><span class="line">  namespace: default</span><br><span class="line">  resourceVersion: <span class="string">"1888067"</span></span><br><span class="line">  selfLink: /api/v1/namespaces/default/serviceaccounts/backend-team</span><br><span class="line">  uid: ecd3b7ea-72ab-11e9-96c5-025000000001</span><br><span class="line">secrets:</span><br><span class="line">- name: backend-team-token-hskch</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 2.2 拿到对应的secret的encoded token</span></span><br><span class="line">$ kubectl get secret backend-team-token-hskch -o yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">data:</span><br><span class="line">...</span><br><span class="line">  token:</span><br><span class="line">ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNkltNWFaRmRxWkRKMmFHTnZRM0JxV0haT1IxZzFiM3BJY201SlowaEhOV3hUWmt3elFuRmFhVEZhZDJNaWZ</span><br><span class="line">RLmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOX</span><br><span class="line">VZVzFsYzNCaFkyVWlPaUp1WlhCMGRXNWxJaXdpYTNWaVpYSnVaWFJsY3k1cGJ5OXpaWEoyYVdObFlXTmpiM1Z1ZEM5elpXTnlaWFF1Ym1GdFpTSTZJbTVsY</span><br><span class="line">0hSMWJtVXRjMkV0ZGpJdGRHOXJaVzR0Wm5FNU1tb2lMQ0pyZFdKbGNtNWxkR1Z6TG1sdkwzTmxjblpwWTJWaFkyTnZkVzUwTDNObGNuWnBZMlV0WVdOamIz</span><br><span class="line">VnVkQzV1WVcxbElqb2libVZ3ZEhWdVpTMXpZUzEyTWlJc0ltdDFZbVZ5Ym1WMFpYTXVhVzh2YzJWeWRtbGpaV0ZqWTI5MWJuUXZjMlZ5ZG1salpTMWhZMk5</span><br><span class="line">2ZFc1MExuVnBaQ0k2SWpZMlltUmpOak0yTFRKbFl6TXROREpoWkMwNE9HRTFMV0ZoWXpGbFpqWmxPVFpsTlNJc0luTjFZaUk2SW5ONWMzUmxiVHB6WlhKMm</span><br><span class="line">FXTmxZV05qYjNWdWREcHVaWEIwZFc1bE9tNWxjSFIxYm1VdGMyRXRkaklpZlEuVllnYm9NNENUZDBwZENKNzh3alV3bXRhbGgtMnZzS2pBTnlQc2gtNmd1R</span><br><span class="line">XdPdFdFcTVGYnc1WkhQdHZBZHJMbFB6cE9IRWJBZTRlVU05NUJSR1diWUlkd2p1Tjk1SjBENFJORmtWVXQ0OHR3b2FrUlY3aC1hUHV3c1FYSGhaWnp5NHlp</span><br><span class="line">bUZIRzlVZm1zazVZcjRSVmNHNm4xMzd5LUZIMDhLOHpaaklQQXNLRHFOQlF0eGctbFp2d1ZNaTZ2aUlocnJ6QVFzME1CT1Y4Mk9KWUd5Mm8tV1FWYzBVVWF</span><br><span class="line">uQ2Y5NFkzZ1QwWVRpcVF2Y3pZTXM2bno5dXQtWGd3aXRyQlk2VGo5QmdQcHJBOWtfajVxRXhfTFVVWlVwUEFpRU43T3pka0pzSThjdHRoMTBseXBJMUFlRn</span><br><span class="line">I0M3Q2QUx5clFvQk0zOWFiRGZxM0Zrc1Itb2NfV013</span><br><span class="line">kind: Secret</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.3 拿到对应的secret的decoded token</span></span><br><span class="line">$ kubectl describe secret backend-team-token-hskch -o yaml</span><br><span class="line">...</span><br><span class="line">Data</span><br><span class="line">====</span><br><span class="line">token:</span><br><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6Im5aZFdqZDJ2aGNvQ3BqWHZOR1g1b3pIcm5JZ0hHNWxTZkwzQnFaaTFad2MifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3Nl</span><br><span class="line">cnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJuZXB0dW5lIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWN</span><br><span class="line">jb3VudC9zZWNyZXQubmFtZSI6Im5lcHR1bmUtc2EtdjItdG9rZW4tZnE5MmoiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3</span><br><span class="line">VudC5uYW1lIjoibmVwdHVuZS1zYS12MiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjY2YmRjNjM2LTJlY</span><br><span class="line">zMtNDJhZC04OGE1LWFhYzFlZjZlOTZlNSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpuZXB0dW5lOm5lcHR1bmUtc2EtdjIifQ.VYgboM4CTd0pd</span><br><span class="line">CJ78wjUwmtalh-2vsKjANyPsh-6guEwOtWEq5Fbw5ZHPtvAdrLlPzpOHEbAe4eUM95BRGWbYIdwjuN95J0D4RNFkVUt48twoakRV7h-</span><br><span class="line">aPuwsQXHhZZzy4yimFHG9Ufmsk5Yr4RVcG6n137y-FH08K8zZjIPAsKDqNBQtxg-lZvwVMi6viIhrrzAQs0MBOV82OJYGy2o-</span><br><span class="line">WQVc0UUanCf94Y3gT0YTiqQvczYMs6nz9ut-</span><br><span class="line">XgwitrBY6Tj9BgPprA9k_j5qEx_LUUZUpPAiEN7OzdkJsI8ctth10lypI1AeFr43t6ALyrQoBM39abDfq3FksR-oc_WMw</span><br><span class="line">ca.crt:     1066 bytes</span><br><span class="line">namespace:  7 bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.1 Create a Pod named `backend`</span></span><br><span class="line">$ kubectl run backend --image=nginx --dry-run=client -o yaml &gt; 6.yaml</span><br><span class="line">$ vim 6.yaml</span><br></pre></td></tr></table></figure>
<p>参考官方文档<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#launch-a-pod-using-service-account-token-projection" target="_blank" rel="noopener">Configure Service Accounts for Pods</a></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 6.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">backend</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">serviceAccountName:</span> <span class="string">backend-team</span>  <span class="comment"># Add</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 3.2</span></span><br><span class="line">$ k apply -f 6.yaml </span><br><span class="line">pod/backend created</span><br><span class="line">$ k get pod/backend -o wide</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. print out the token from the volume source at /var/run/secrets/kubernetes.io/serviceaccount</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> -it backend -- /bin/sh</span><br><span class="line">/ <span class="comment"># cat /var/run/secrets/kubernetes.io/serviceaccount/token</span></span><br><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImJhY2tlbmQtdGVhbS10b2tlbi1kbTJmZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJiYWNrZW5kLXRlYW0iLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIxNzM0MzVjMS00NDJmLTExZTktOGRjMy0wMjUwMDAwMDAwMDEiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDpiYWNrZW5kLXRlYW0ifQ.DjWUxEMNUmQVoXd4b-eIjxboj3w3k7hS5hfV8mm8eoEPz3HJJMgjIpAaurcvo1pp2Ggpd1kIhQvfRqI6-u57f80N5UqXt_qATJfonat2NNXX8pXmFNoPig9LB-pbo8TN_pYGWNworXsxmK9w6V9eaRosIinRp0u-cvijQbsBw3lxWgGo9S4G-7f19mMKN1Pg2xS2J6fKX9IKvhHrUkM91nwcwmsO0use5B4TGbuRa9METiGsfEpegvzMPBbPl0B_T1ANH_pck0LFNtvKe0g1v5zpKx2lRF9WdFAqPsG7BJ1dEH88JtBHzD59OhxIPqtyT4sXKjACBN_ka5ZADMzPJg</span><br></pre></td></tr></table></figure>
<h3 id="考题7-implementing-the-adapter-pattern">考题7 - Implementing the Adapter Pattern</h3>
<p>The adapter pattern helps with providing a simplified, homogenized view of an application running within a container. For example, we could stand up another container that unifies the log output of the application container. As a result, other monitoring tools can rely on a standardized view of the log output without having to transform it into an expected format.</p>
<ol>
<li>Create a new Pod in a YAML file named <code>adapter.yaml</code>. The Pod declares two containers.
<ul>
<li>The container <code>app</code> uses the image <code>busybox</code> and runs the command <code>while true; do echo &quot;$(date) | $(du -sh ~)&quot; &gt;&gt; /var/logs/diskspace.txt; sleep 5; done;</code>.</li>
<li>The adapter container <code>transformer</code> uses the image <code>busybox</code> and runs the command <code>sleep 20; while true; do while read LINE; do echo &quot;$LINE&quot; | cut -f2 -d&quot;|&quot; &gt;&gt; $(date +%Y-%m-%d-%H-%M-%S)-transformed.txt; done &lt; /var/logs/diskspace.txt; sleep 20; done;</code> to strip the log output off the date for later consumption my a monitoring tool. Be aware that the logic does not handle corner cases (e.g. automatically deleting old entries) and would look different in production systems</li>
</ul>
</li>
<li>Before creating the Pod, define an <code>emptyDir</code> volume. Mount the volume in both containers with the path <code>/var/logs</code>.</li>
<li>Create the Pod, log into the container <code>transformer</code>. The current directory should continuously write a new file every 20 seconds.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.1</span></span><br><span class="line">kubectl run adapter --image=busybox --restart=Never -o yaml --dry-run -- /bin/sh -c <span class="string">'while true; do echo "$(date) | $(du -sh ~)" &gt;&gt; /var/logs/diskspace.txt; sleep 5; done;'</span> &gt; adapter.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.2 adapter.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">adapter</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">volumes:</span>                <span class="comment"># 2.1 `emptyDir` volume</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-volume</span> <span class="comment"># 2.1 `emptyDir` volume</span></span><br><span class="line">      <span class="attr">emptyDir:</span> <span class="string">&#123;&#125;</span>        <span class="comment"># 2.1 `emptyDir` volume</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">args:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/bin/sh</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">'while true; do echo "$(date) | $(du -sh ~)" &gt;&gt; /var/logs/diskspace.txt; sleep 5; done;'</span> <span class="comment"># 注意用单引号，因为命令里面有双引号</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">app</span>           <span class="comment"># 1.1 modify name to app</span></span><br><span class="line">    <span class="attr">volumeMounts:</span>            <span class="comment"># 2.2 Add</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-volume</span>  <span class="comment"># 2.2 Add</span></span><br><span class="line">        <span class="attr">mountPath:</span> <span class="string">/var/logs</span> <span class="comment"># 2.2 Add</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">busybox</span>       <span class="comment"># 1.2 Add</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">transformer</span>    <span class="comment"># 1.2 Add</span></span><br><span class="line">    <span class="attr">args:</span>                <span class="comment"># 1.2 Add</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/bin/sh</span>            <span class="comment"># 1.2 Add</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">-c</span>                 <span class="comment"># 1.2 Add</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">'sleep 20; while true; do while read LINE; do echo "$LINE" | cut -f2 -d"|" &gt;&gt; $(date +%Y-%m-%d-%H-%M-%S)-transformed.txt; done &lt; /var/logs/diskspace.txt; sleep 20; done;'</span>             <span class="comment"># 1.2 Add 注意用单引号，因为命令里面有双引号</span></span><br><span class="line">    <span class="attr">volumeMounts:</span>             <span class="comment"># 2.2 Add</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-volume</span>   <span class="comment"># 2.2 Add</span></span><br><span class="line">        <span class="attr">mountPath:</span> <span class="string">/var/logs</span>  <span class="comment"># 2.2 Add</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 3</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> adapter --container=transformer -it -- /bin/sh</span><br><span class="line">/ <span class="comment"># ls -l</span></span><br><span class="line">-rw-r--r--    1 root     root           205 May 12 20:43 2019-05-12-20-43-32-transformed.txt</span><br><span class="line">-rw-r--r--    1 root     root           369 May 12 20:43 2019-05-12-20-43-52-transformed.txt</span><br><span class="line">...</span><br><span class="line">/ <span class="comment"># cat 2019-05-12-20-43-52-transformed.txt</span></span><br><span class="line"> 4.0K	/root</span><br><span class="line"> 4.0K	/root</span><br><span class="line"> 4.0K	/root</span><br><span class="line"> 4.0K	/root</span><br><span class="line">/ <span class="comment"># exit</span></span><br></pre></td></tr></table></figure>
<h3 id="考题8-defining-a-pod-s-readiness-and-liveness-probe">考题8 - Defining a Pod’s Readiness and Liveness Probe</h3>
<ol>
<li>Create a new Pod named <code>hello</code> with the image <code>bonomat/nodejs-hello-world</code> that exposes the port <code>3000</code>. Provide the name <code>nodejs-port</code> for the container port.</li>
<li>Add a Readiness Probe that checks the URL path <code>/</code> on the port referenced with the name <code>nodejs-port</code> after a <code>2</code> seconds delay. You do not have to define the period interval.</li>
<li>Add a Liveness Probe that verifies that the app is up and running every <code>8</code> seconds by checking the URL path <code>/</code> on the port referenced with the name <code>nodejs-port</code>. The probe should start with a <code>5</code> seconds delay.</li>
<li>Shell into container and <code>curl localhost:3000</code>. Write down the output. Exit the container. Retrieve the logs from the container. Write down the output.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. Create a new Pod named `hello`</span></span><br><span class="line">$ kubectl run hello --image=bonomat/nodejs-hello-world --port=3000 -o yaml --dry-run &gt; pod.yaml</span><br><span class="line">$ vim pod.yaml</span><br></pre></td></tr></table></figure>
<p>参考官网： <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#use-a-named-port" target="_blank" rel="noopener">livenessProbe</a></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.2 pod.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">hello</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">hello</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">bonomat/nodejs-hello-world</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">hello</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nodejs-port</span>           <span class="comment"># Add 1.2 Provide the name `nodejs-port` for the container port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">3000</span></span><br><span class="line">    <span class="attr">readinessProbe:</span>               <span class="comment"># Add 2 Readiness</span></span><br><span class="line">      <span class="attr">httpGet:</span>                    <span class="comment"># Add 2 Readiness</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/</span>                   <span class="comment"># Add 2 Readiness</span></span><br><span class="line">        <span class="attr">port:</span> <span class="string">nodejs-port</span>         <span class="comment"># Add 2 Readiness</span></span><br><span class="line">      <span class="attr">initialDelaySeconds:</span> <span class="number">2</span>       <span class="comment"># Add 2 Readiness</span></span><br><span class="line">    <span class="attr">livenessProbe:</span>            <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">      <span class="attr">httpGet:</span>                <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/</span>               <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">        <span class="attr">port:</span> <span class="string">nodejs-port</span>     <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">      <span class="attr">initialDelaySeconds:</span> <span class="number">5</span>  <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">      <span class="attr">periodSeconds:</span> <span class="number">8</span>        <span class="comment"># Add 3 livenessProbe</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl create -f pod.yaml</span><br><span class="line">pod/hello created</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. </span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> hello -it -- /bin/sh</span><br><span class="line">/ <span class="comment"># curl localhost:3000</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;NodeJS Docker Hello World&lt;/title&gt;</span><br><span class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">	&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span><br><span class="line">	&lt;link href=<span class="string">"http://cdn.bootcss.com/bootstrap/3.3.2/css/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">	&lt;link href=<span class="string">"/stylesheets/styles.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;div class=<span class="string">"container"</span>&gt;</span><br><span class="line">		&lt;div class=<span class="string">"well well-sm"</span>&gt;</span><br><span class="line">			&lt;h2&gt;This is just a hello world message&lt;/h2&gt;</span><br><span class="line">			&lt;img a href=<span class="string">"./cage.jpg"</span>/&gt;</span><br><span class="line">			&lt;img src=<span class="string">"src/cage.jpg"</span> alt=<span class="string">"Smiley face"</span> width=<span class="string">"640"</span>&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">/ <span class="comment"># exit</span></span><br><span class="line"> </span><br><span class="line">$ kubectl logs pod/hello</span><br><span class="line">Magic happens on port 3000</span><br></pre></td></tr></table></figure>
<h4 id="2022-readiness-probe">2022 readiness probe</h4>
<h3 id="考题9-fixing-a-misconfigured-pod">考题9 - Fixing a Misconfigured Pod</h3>
<ol>
<li>Create a new Pod with the following YAML.</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">failing-pod</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">failing-pod</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">args:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/bin/sh</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">while</span> <span class="literal">true</span><span class="string">;</span> <span class="string">do</span> <span class="string">echo</span> <span class="string">$(date)</span> <span class="string">&gt;&gt;</span> <span class="string">~/tmp/curr-date.txt;</span> <span class="string">sleep</span> <span class="number">5</span><span class="string">;</span> <span class="string">done;</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">failing-pod</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">status:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Check the Pod’s status. Do you see any issue?</li>
<li>Follow the logs of the running container and identify an issue.</li>
<li>Fix the issue by shelling into the container. After resolving the issue the current date should be written to a file. Render the output.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1 Create a new Pod</span></span><br><span class="line">$ vim pod.yaml</span><br><span class="line">$ kubectl create -f pod.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. Check the Pod’s status</span></span><br><span class="line"><span class="comment"># seems to be running without problems.</span></span><br><span class="line">$ kubectl get pods</span><br><span class="line">NAME          READY   STATUS    RESTARTS   AGE</span><br><span class="line">failing-pod   1/1     Running   0          5s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line">$ kubectl logs failing-pod</span><br><span class="line">/bin/sh: can<span class="string">'t create /root/tmp/curr-date.txt: nonexistent directory</span></span><br><span class="line"><span class="string">/bin/sh: can'</span>t create /root/tmp/curr-date.txt: nonexistent directory</span><br><span class="line">/bin/sh: can<span class="string">'t create /root/tmp/curr-date.txt: nonexistent directory</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 4.</span></span><br><span class="line">$ kubectl <span class="built_in">exec</span> failing-pod -it -- /bin/sh</span><br><span class="line">/ <span class="comment"># mkdir -p /root/tmp</span></span><br><span class="line">/ <span class="comment"># cd /root</span></span><br><span class="line">~ <span class="comment"># ls -l</span></span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x    2 root     root          4096 Dec 26 04:47 tmp</span><br><span class="line">~ <span class="comment"># chmod 777 /root/tmp</span></span><br><span class="line">~ <span class="comment"># cd /root/tmp</span></span><br><span class="line">~/tmp <span class="comment"># ls -l</span></span><br><span class="line">total 4</span><br><span class="line">-rw-r--r-- 1 root root 112 May  9 23:52 curr-date.txt</span><br><span class="line">/ <span class="comment"># cat ~/tmp/curr-date.txt</span></span><br><span class="line">Thu May 9 23:59:01 UTC 2019</span><br><span class="line">Thu May 9 23:59:06 UTC 2019</span><br><span class="line">Thu May 9 23:59:11 UTC 2019</span><br><span class="line">/ <span class="comment"># exit</span></span><br></pre></td></tr></table></figure>
<h3 id="考题10-2022-rollout-canary">考题10 - 2022 Rollout Canary</h3>
<p>Application “wonderful” is running in <code>default</code> Namespace.<br>
You can call the app using <code>curl wonderful:30080</code> .<br>
The application YAML is available at <code>/wonderful/init.yaml</code> .<br>
The app has a Deployment with image <code>httpd:alpine</code> , but should be switched over to <code>nginx:alpine</code> .</p>
<ol>
<li>The switch should not happen fast or automatically, but using the Canary approach:</li>
</ol>
<ul>
<li>20% of requests should hit the new image</li>
<li>80% of requests should hit the old image</li>
</ul>
<ol start="2">
<li>
<p>For this create a new Deployment <code>wonderful-v2</code> which uses image <code>nginx:alpine</code> .</p>
</li>
<li>
<p>The total amount of Pods of both Deployments combined should be <code>10</code>.</p>
</li>
</ol>
<p>参考官方文档<a href="https://kubernetes.io/docs/concepts/cluster-administration/manage-deployment/#canary-deployments" target="_blank" rel="noopener">canary-deployments</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ k get deployments.apps</span><br><span class="line">NAME           READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">wonderful-v1   10/10   10           10          27s</span><br><span class="line"></span><br><span class="line">$ k get deployments.apps wonderful-v1 -o yaml &gt; v2.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># v2.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wonderful-v2</span> <span class="comment"># name</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">2</span>        <span class="comment"># Modify to 2</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx:alpine</span>  <span class="comment"># Image</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ k apply -f v2.yaml </span><br><span class="line">$ k get deployments.apps </span><br><span class="line">NAME           READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">wonderful-v1   10/10   10           10          4m37s</span><br><span class="line">wonderful-v2   2/2     2            2           4s</span><br><span class="line"></span><br><span class="line">$ k edit deployments.apps wonderful-v1</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wonderful-v1</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">8</span>     <span class="comment"># Modify to 8</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">httpd:alpine</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">httpd</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ k get deployments.apps </span><br><span class="line">NAME           READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">wonderful-v1   8/8     8            8           5m38s</span><br><span class="line">wonderful-v2   2/2     2            2           65s</span><br></pre></td></tr></table></figure>
<h3 id="考题11-2022-helm-nanagement">考题11 - 2022 Helm Nanagement</h3>
<h3 id="考题12-2022-networkpolicy">考题12 - 2022 NetworkPolicy</h3>
<p>记不太清了。。。<br>
修改pod <code>pod1</code>，使得only to and from pod <code>frondend</code> and <code>db</code><br>
networkpolicy已经建好，不要增加，新建或者修改</p>
<p>这样的话，应该只需要根据已有networkpolicy，修改<code>pod1</code>的labels就可以了。</p>
<p>有个类似的题：</p>
<h4 id="restricting-access-to-and-from-a-pod">Restricting Access to and from a Pod</h4>
<p>Let’s assume we are working on an application stack that defines three different layers: a <code>frontend</code>, a <code>backend</code> and a <code>database</code>. Each of the layers runs in a Pod. You can find the definition in the YAML file <code>app-stack.yaml</code>. The application needs to run in the namespace <code>app-stack</code>.</p>
<p>Task:</p>
<ol>
<li>Create the required namespace.</li>
<li>Copy the Pod definition to the file <code>app-stack.yaml</code> and create all three Pods. Notice that the namespace has already been defined in the YAML definition.</li>
<li>Create a network policy in the YAML file <code>app-stack-network-policy.yaml</code>.</li>
<li>The network policy should allow incoming traffic from the <code>backend</code> to the <code>database</code> but disallow incoming traffic from the <code>frontend</code>.</li>
<li>Incoming traffic to the <code>database</code> should only be allowed on <code>TCP</code> port <code>3306</code> and no other port.</li>
</ol>
<details>
  <summary>3个 pod yaml文件</summary>
  <p>
<pre><code><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">frontend</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">app-stack</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">frontend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">frontend</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">app-stack</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">backend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">backend</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">database</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">app-stack</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">database</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">database</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">mysql</span></span><br><span class="line">      <span class="attr">env:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_ROOT_PASSWORD</span></span><br><span class="line">        <span class="attr">value:</span> <span class="string">example</span></span><br></pre></td></tr></table></figure>
</code></pre>
  </p>
</details>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1 Create the namespace</span></span><br><span class="line">$ kubectl create namespace app-stack</span><br><span class="line">namespace/app-stack created</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. create all three Pods</span></span><br><span class="line">$ vim app-stack.yaml</span><br><span class="line">$ kubectl create -f app-stack.yaml</span><br><span class="line">pod/frontend created</span><br><span class="line">pod/backend created</span><br><span class="line">pod/database created</span><br><span class="line"></span><br><span class="line">$ kubectl get pods --namespace app-stack</span><br><span class="line">NAME       READY   STATUS    RESTARTS   AGE</span><br><span class="line">backend    1/1     Running   0          22s</span><br><span class="line">database   1/1     Running   0          22s</span><br><span class="line">frontend   1/1     Running   0          22s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. Create the network policy.</span></span><br><span class="line">$ vim app-stack-network-policy.yaml</span><br><span class="line">$ kubectl create -f app-stack-network-policy.yaml</span><br><span class="line">$ kubectl get networkpolicy --namespace app-stack</span><br><span class="line">NAME                       POD-SELECTOR             AGE</span><br><span class="line">app-stack-network-policy   app=todo,tier=database   5s</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">NetworkPolicy</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">app-stack-network-policy</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">app-stack</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">podSelector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">  <span class="attr">policyTypes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Ingress</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Egress</span></span><br><span class="line">  <span class="attr">ingress:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">from:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">podSelector:</span></span><br><span class="line">        <span class="attr">matchLabels:</span></span><br><span class="line">          <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">          <span class="attr">tier:</span> <span class="string">backend</span></span><br><span class="line">  <span class="attr">egress:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">to:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">podSelector:</span></span><br><span class="line">        <span class="attr">matchLabels:</span></span><br><span class="line">          <span class="attr">app:</span> <span class="string">todo</span></span><br><span class="line">          <span class="attr">tier:</span> <span class="string">database</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">3306</span></span><br></pre></td></tr></table></figure>
<h3 id="考题13-2022-docker">考题13 - 2022 Docker</h3>
<ol>
<li>通过Dckerfile 创建image with name <code>name1</code>, tag <code>tag1</code> (不要publish)</li>
<li>export container to ~/somepath/name.tar</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1 创建image</span></span><br><span class="line"><span class="built_in">cd</span> ~/path2Dockerfile/Dckerfile</span><br><span class="line">podman build -t name1:tag1 .</span><br><span class="line">podman image less</span><br><span class="line"></span><br><span class="line"><span class="comment"># run container</span></span><br><span class="line">podman run -d name1:tag1</span><br><span class="line">podman ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># export container</span></span><br><span class="line">podman <span class="built_in">export</span> containerID &gt; ~/somepath/name.tar</span><br></pre></td></tr></table></figure>
<h3 id="考题14-2022-cronjobs">考题14 - 2022 <code>CronJobs</code></h3>
<ol>
<li>新建一个CronJobs ppi, 要求</li>
</ol>
<ul>
<li>每10分钟执行一次</li>
<li>completion 2</li>
<li>fail 4</li>
<li>delete after 9s</li>
<li>restartPolicy 为nerver</li>
</ul>
<p>Cronjob 里面的container信息已给出：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">pi</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">perl:5.34.0</span></span><br><span class="line"><span class="attr">command:</span> <span class="string">["perl",</span>  <span class="string">"-Mbignum=bpi"</span><span class="string">,</span> <span class="string">"-wle"</span><span class="string">,</span> <span class="string">"print bpi(2000)"</span><span class="string">]</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>新建一个Job xxx, 来执行CronJobs。。。</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">batch/v1</span> </span><br><span class="line"><span class="attr">kind:</span> <span class="string">CronJob</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">hello</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">schedule:</span> <span class="string">"*/10 * * * *"</span>          <span class="comment">#每10分钟执行一次， 记着前面加*/</span></span><br><span class="line">  <span class="attr">jobTemplate:</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">backoffLimit:</span> <span class="number">4</span>             <span class="comment"># fail 4， 注意不要加在spec下面，而是spec.jobTemplate.spec下</span></span><br><span class="line">      <span class="attr">completions:</span> <span class="number">2</span>              <span class="comment"># completion 2</span></span><br><span class="line">      <span class="attr">ttlSecondsAfterFinished:</span> <span class="number">9</span>  <span class="comment"># delete after 9s</span></span><br><span class="line">      <span class="attr">template:</span></span><br><span class="line">        <span class="attr">spec:</span></span><br><span class="line">          <span class="attr">containers:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pi</span>              <span class="comment"># 粘贴题目给出信息</span></span><br><span class="line">            <span class="attr">image:</span> <span class="string">perl:5.34.0</span>    <span class="comment"># 粘贴题目给出信息</span></span><br><span class="line">            <span class="attr">command:</span> <span class="string">["perl",</span>  <span class="string">"-Mbignum=bpi"</span><span class="string">,</span> <span class="string">"-wle"</span><span class="string">,</span> <span class="string">"print bpi(2000)"</span><span class="string">]</span> <span class="comment"># 粘贴题目给出信息</span></span><br><span class="line">          <span class="attr">restartPolicy:</span> <span class="string">Never</span>                                  <span class="comment"># restartPolicy 为nerver</span></span><br></pre></td></tr></table></figure>
<h3 id="考题15-2022-service-ingress">考题15 - 2022 service, ingress</h3>
<p>namespace <code>namespace1</code><br>
一个路径<code>~/path</code>下，有<code>service.yaml</code>, <code>ingress.yaml</code>和 <code>deployment.yaml</code>。<br>
现在无法访问 <code>curl http://xxxx/content-moment</code>，检查并修复问题。<br>
不要修改<code>deployment.yaml</code>，deployment没有问题</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/path</span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line">k get service -n namespace1</span><br><span class="line">content-moment-service</span><br><span class="line"></span><br><span class="line">vim ingress.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ingress.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">minimal-ingress</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">nginx.ingress.kubernetes.io/rewrite-target:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ingressClassName:</span> <span class="string">nginx</span>             <span class="comment"># 通过k get ingressclass -A 检查，发现没错，不需要改</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">      <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/app</span>                    <span class="comment"># 路径不对，改为/content-moment</span></span><br><span class="line">        <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">        <span class="attr">backend:</span></span><br><span class="line">          <span class="attr">service:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">content-moment-service-service</span> <span class="comment"># 改为content-moment-service</span></span><br><span class="line">            <span class="attr">port:</span></span><br><span class="line">              <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># service.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">my-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app.kubernetes.io/name:</span> <span class="string">MyApp</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">9376</span>        <span class="comment"># 通过查看 deployment.yaml 里面的 containerPort, 发现这里错误，改为containerPort对应的port</span></span><br></pre></td></tr></table></figure>
<h2 id="ckad-练习题">CKAD 练习题</h2>
<h3 id="练习题1-rollout-rolling">练习题1 - Rollout Rolling</h3>
<ol>
<li>Application “wonderful” is running in <code>default</code> Namespace.</li>
<li>You can call the app using <code>curl wonderful:30080</code> .</li>
<li>The app has a Deployment with image <code>httpd:alpine</code> , but should be switched over to <code>nginx:alpine</code> .</li>
<li>Set the <code>maxSurge</code> to <code>50%</code> and the <code>maxUnavailable</code> to <code>0%</code> . Then perform a rolling update.</li>
<li>Wait till the rolling update has succeeded.</li>
</ol>
<details>
  <summary>Explanation</summary>
  <p>
<pre><code>Why can you call `curl wonderful:30080` and it works?

There is a NodePort Service `wonderful` which listens on port `30080` . It has the Pods of Deployment of app &quot;wonderful&quot; as selector.

We can reach the NodePort Service via the K8s Node IP:

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl 172.30.1.2:30080</span><br></pre></td></tr></table></figure>

And because of an entry in `/etc/hosts `we can call:

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl 172.30.1.2:30080</span><br></pre></td></tr></table></figure>
</code></pre>
  </p>
</details>
<details><summary>Solution</summary>
<p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k edit deploy wonderful-v1</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">deployment.kubernetes.io/revision:</span> <span class="string">"2"</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="string">"2022-12-26T07:00:45Z"</span></span><br><span class="line">  <span class="attr">generation:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wonderful-v1</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">resourceVersion:</span> <span class="string">"2063"</span></span><br><span class="line">  <span class="attr">uid:</span> <span class="string">5cf0fc94-8bc5-47b2-bc71-2147880bf1ed</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">progressDeadlineSeconds:</span> <span class="number">600</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">revisionHistoryLimit:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">strategy:</span></span><br><span class="line">    <span class="attr">rollingUpdate:</span></span><br><span class="line">      <span class="attr">maxSurge:</span> <span class="number">50</span><span class="string">%</span>              <span class="comment"># Edit 4</span></span><br><span class="line">      <span class="attr">maxUnavailable:</span> <span class="number">0</span><span class="string">%</span>         <span class="comment"># Edit 4</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">RollingUpdate</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx:alpine</span>     <span class="comment"># Edit 3</span></span><br><span class="line">        <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">httpd</span></span><br><span class="line">        <span class="attr">resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">        <span class="attr">terminationMessagePath:</span> <span class="string">/dev/termination-log</span></span><br><span class="line">        <span class="attr">terminationMessagePolicy:</span> <span class="string">File</span></span><br><span class="line">      <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">      <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br><span class="line">      <span class="attr">schedulerName:</span> <span class="string">default-scheduler</span></span><br><span class="line">      <span class="attr">securityContext:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">30</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl 172.30.1.2:30080</span><br></pre></td></tr></table></figure>
</p>
</details>
<h3 id="练习题2-rollout-green-blue">练习题2 - Rollout Green-Blue</h3>
<p>Application “wonderful” is running in <code>default</code> Namespace.</p>
<p>You can call the app using <code>curl wonderful:30080</code> .</p>
<p>The application YAML is available at <code>/wonderful/init.yaml</code> .</p>
<p>The app has a Deployment with image <code>httpd:alpine</code> , but should be switched over to <code>nginx:alpine</code> .</p>
<ol>
<li>
<p>The switch should happen instantly. Meaning that from the moment of rollout, all new requests should hit the new image.</p>
<ul>
<li>1.1 Create a new Deployment <code>wonderful-v2</code> which uses image <code>nginx:alpine</code> with <code>4</code> replicas. It’s Pods should have labels <code>app: wonderful</code> and <code>version: v2</code></li>
<li>1.2 Once all new Pods are running, change the selector label of Service wonderful to <code>version: v2</code></li>
<li>1.3 Finally scale down Deployment <code>wonderful-v1</code> to <code>0</code> replicas</li>
</ul>
</li>
</ol>
<details>
  <summary>Solution</summary>
  <p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 2.1 Create a new Deployment and watch these places:</span></span><br><span class="line">cp /wonderful/init.yaml v2.yaml</span><br><span class="line">vim v2.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wonderful-v2</span>    <span class="comment"># Modify</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">4</span>           <span class="comment"># Modify</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">      <span class="attr">version:</span> <span class="string">v2</span>       <span class="comment"># Modify 1.1</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">        <span class="attr">version:</span> <span class="string">v2</span>     <span class="comment"># Modify 1.1</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx:alpine</span>    <span class="comment"># Modify 1.1</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="comment"># delete service part</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ k apply -f v2.yaml </span><br><span class="line"><span class="comment"># Wait till all Pods are running, then switch the Service selector:</span></span><br><span class="line">$ k get deployments.apps </span><br><span class="line">NAME           READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">wonderful-v1   4/4     4            4           13m</span><br><span class="line">wonderful-v2   4/4     4            4           4s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.2</span></span><br><span class="line">$ k get service</span><br><span class="line">NAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE</span><br><span class="line">wonderful    NodePort    10.98.188.152   &lt;none&gt;        80:30080/TCP   9m21s</span><br><span class="line"></span><br><span class="line">$ k edit service wonderful</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wonderful</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">    <span class="attr">targetPort:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">nodePort:</span> <span class="number">30080</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">wonderful</span></span><br><span class="line">    <span class="attr">version:</span> <span class="string">v2</span>     <span class="comment"># Modify 1.2</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span></span><br></pre></td></tr></table></figure>
</p><p>Confirm with curl wonderful:30080 , all requests should hit the new image.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.3 Finally scale down the original Deployment:</span></span><br><span class="line">kubectl scale deploy wonderful-v1 --replicas 0</span><br></pre></td></tr></table></figure>
  <p></p>
</details>
<h2 id="参考文章">参考文章</h2>
<ul>
<li>CKAD 真题
<ul>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/104332178?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166047629616782350895616%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=166047629616782350895616&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-23-104332178-null-null.142%5Ev40%5Epc_search_integral,185%5Ev2%5Econtrol&amp;utm_term=CKAD%E8%80%83%E8%AF%95%E9%A2%98&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener">CKAD考试预备动员</a>
<ul>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108342028" target="_blank" rel="noopener">CKAD 1. Core Concepts(13%)考题答案</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108342510" target="_blank" rel="noopener">CKAD 2. Configuration (18%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108350785" target="_blank" rel="noopener">CKAD 3. Multi-Container Pods (10%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108358664" target="_blank" rel="noopener">CKAD 4. Observability(18%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108365404" target="_blank" rel="noopener">CKAD 5. Pod Design (20%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108420840" target="_blank" rel="noopener">CKAD 6. Services &amp; Networking (13%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108423635" target="_blank" rel="noopener">CKAD 7. State Persistence (8%)练习题</a></li>
<li><a href="https://blog.csdn.net/xixihahalelehehe/article/details/108424082" target="_blank" rel="noopener">CKAD 8. Bonus Exercises考试必背</a></li>
</ul>
</li>
<li><a href="https://blog.csdn.net/marlon212/article/details/120245331?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166047524116782246432126%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=166047524116782246432126&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-4-120245331-null-null.nonecase&amp;utm_term=CKAD&amp;spm=1018.2226.3001.4450" target="_blank" rel="noopener">2021年全年CKAD真题 5道题</a></li>
<li><a href="https://blog.csdn.net/itsaka/category_11115176.html" target="_blank" rel="noopener">2021 Kubernetes CKAD 1.20 - 真题 4道题</a>
<ul>
<li><a href="https://blog.csdn.net/itsaka/article/details/117590286" target="_blank" rel="noopener">Kubernetes CKAD 1.20 - 真题 （第1题）Creating a Pod and Inspecting it</a></li>
<li><a href="https://blog.csdn.net/itsaka/article/details/117590437" target="_blank" rel="noopener">Kubernetes CKAD 1.20 - 真题 （第2题）Configuring a Pod to Use a ConfigMap</a></li>
<li><a href="https://blog.csdn.net/itsaka/article/details/117590502" target="_blank" rel="noopener">Kubernetes CKAD 1.20 - 真题 （第3题）Implementing the Adapter Pattern</a></li>
<li><a href="https://blog.csdn.net/itsaka/article/details/117590558" target="_blank" rel="noopener">Kubernetes CKAD 1.20 - 真题 （第4题）Defining a Pod’s Readiness and Liveness Probe</a></li>
</ul>
</li>
<li><a href="https://blog.csdn.net/vic_qxz/article/details/123361130?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166039499316782248581366%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=166039499316782248581366&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-16-123361130-null-null.142%5Ev40%5Epc_search_integral,185%5Ev2%5Econtrol&amp;utm_term=CKAD%E8%80%83%E8%AF%95%E9%A2%98&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener">2022 K8S CKAD 1.23 考试 实验 模拟环境（一键导入）【需购买】</a></li>
</ul>
</li>
<li><a href="https://itnext.io/practical-tips-for-passing-ckad-exam-6cbdf2d35cb1" target="_blank" rel="noopener">Practical tips for passing CKAD certification exam</a></li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>2023 CKS v1.26 考试真题整理</title>
    <url>/Kubernates-Certified%20Kubernetes%20Security%20Specialist-CKS.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>上一篇：<a href="./Kubernates-Certified-Kubernetes-Administrator-CKA.html">CKA考试真题</a><br>
上一篇：<a href="./Kubernates-Certified-Kubernetes-Application-Developer-CKAD.html">CKAD考试真题</a></p>
<h2 id="考试内容">考试内容</h2>
<p><a href="https://training.linuxfoundation.org/certification/certified-kubernetes-security-specialist/#" target="_blank" rel="noopener">CKS 考试链接</a><br>
<a href="https://docs.linuxfoundation.org/tc-docs/certification/important-instructions-cks" target="_blank" rel="noopener">Important Instructions: CKS</a></p>
<ul>
<li>考试包括 15-20 项performance-based tasks。
<ul>
<li>2023.1 实测是16道题</li>
</ul>
</li>
<li>考生有 2 小时的时间完成 CKS 考试。
<ul>
<li>因为从06/2022开始环境升级（贬义），考试环境更难用了，变的很卡，所以时间变得比较紧张。容易做不完题，建议先把有把握的，花费时间不多的题先做掉
<ul>
<li><a href="https://itnext.io/cks-cka-ckad-changed-terminal-to-remote-desktop-157a26c1d5e" target="_blank" rel="noopener">CKS CKA CKAD changed Terminal to Remote Desktop</a></li>
</ul>
</li>
</ul>
</li>
<li>CKS考试67分以上即可通过，考试不通过有一次补考机会。</li>
</ul>
<p>Certifications- expire 36 months from the date that the Program certification requirements are met by a candidate.</p>
<h3 id="certified-kubernetes-security-specialist-cks">Certified Kubernetes Security Specialist (CKS)</h3>
<p>The following tools and resources are allowed during the exam as long as they are used by candidates to work independently on exam tasks (i.e. not used for 3rd party assistance or research) and are accessed from within the Linux server terminal on which the Exam is delivered.<br>
During the exam, candidates may:</p>
<ul>
<li>review the Exam content instructions that are presented in the command line terminal.</li>
<li>review Documents installed by the distribution (i.e. /usr/share and its subdirectories)</li>
<li>use the search function provided on <a href="https://kubernetes.io/docs/" target="_blank" rel="noopener">https://kubernetes.io/docs/</a> however, they may only open search results that have a domain matching the sites listed below</li>
<li>use the browser within the VM to access the following documentation:
<ul>
<li>Kubernetes Documentation:
<ul>
<li><a href="https://kubernetes.io/docs/" target="_blank" rel="noopener">https://kubernetes.io/docs/</a> and their subdomains</li>
<li><a href="https://kubernetes.io/blog/" target="_blank" rel="noopener">https://kubernetes.io/blog/</a> and their subdomains<br>
This includes all available language translations of these pages (e.g. <a href="https://kubernetes.io/zh/docs/" target="_blank" rel="noopener">https://kubernetes.io/zh/docs/</a>)</li>
</ul>
</li>
<li>Tools:
<ul>
<li>Trivy documentation <a href="https://aquasecurity.github.io/trivy/" target="_blank" rel="noopener">https://aquasecurity.github.io/trivy/</a></li>
<li>Falco documentation <a href="https://falco.org/docs/" target="_blank" rel="noopener">https://falco.org/docs/</a><br>
This includes all available language translations of these pages (e.g. <a href="https://falco.org/zh/docs/" target="_blank" rel="noopener">https://falco.org/zh/docs/</a>)</li>
</ul>
</li>
<li>App Armor:
<ul>
<li>Documentation <a href="https://gitlab.com/apparmor/apparmor/-/wikis/Documentation" target="_blank" rel="noopener">https://gitlab.com/apparmor/apparmor/-/wikis/Documentation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>You’re only allowed to have one other browser tab open with:</p>
<ul>
<li><a href="https://kubernetes.io/docs" target="_blank" rel="noopener">https://kubernetes.io/docs</a></li>
<li><a href="https://github.com/kubernetes" target="_blank" rel="noopener">https://github.com/kubernetes</a></li>
<li><a href="https://kubernetes.io/blog" target="_blank" rel="noopener">https://kubernetes.io/blog</a></li>
<li><a href="https://github.com/aquasecurity/trivy" target="_blank" rel="noopener">https://github.com/aquasecurity/trivy</a></li>
<li><a href="https://falco.org/docs" target="_blank" rel="noopener">https://falco.org/docs</a></li>
<li><a href="https://gitlab.com/apparmor/apparmor/-/wikis/Documentation" target="_blank" rel="noopener">https://gitlab.com/apparmor/apparmor/-/wikis/Documentation</a></li>
</ul>
<h3 id="cks-environment">CKS Environment</h3>
<ul>
<li>Each task on this exam must be completed on a designated cluster/configuration context.</li>
<li>Sixteen clusters comprise the exam environment, one for each task. Each cluster is made up of one master node and one worker node.</li>
<li>An infobox at the start of each task provides you with the cluster name/context and the hostname of the master and worker node.</li>
<li>You can switch the cluster/configuration context using a command such as the following:</li>
<li><code>kubectl config use-context &lt;cluster/context name&gt;</code></li>
<li>Nodes making up each cluster can be reached via ssh, using a command such as the following:</li>
<li><code>ssh &lt;nodename&gt;</code></li>
<li>You have elevated privileges on any node by default, so there is no need to assume elevated privileges.</li>
<li>You must return to the base node (hostname cli) after completing each task.</li>
<li>Nested <code>−ssh</code> is not supported.</li>
<li>You can use <code>kubectl</code> and the appropriate context to work on any cluster from the base node. When connected to a cluster member via ssh, you will only be able to work on that particular cluster via kubectl.</li>
<li>For your convenience, all environments, in other words, the base system and the cluster nodes, have the following additional command-line tools pre-installed and pre-configured:
<ul>
<li><code>kubectl</code> with kalias and Bash autocompletion</li>
<li><code>yq</code> and <code>jq</code> for YAML/JSON processing</li>
<li><code>tmux</code> for terminal multiplexing</li>
<li><code>curl</code> and <code>wget</code> for testing web services</li>
<li><code>man</code> and man pages for further documentation</li>
</ul>
</li>
<li>Further instructions for connecting to cluster nodes will be provided in the appropriate tasks</li>
<li>The CKS environment is currently running etcd v3.5</li>
<li>The CKS environment is currently running Kubernetes v1.26</li>
<li>The CKS  exam environment will be aligned with the most recent K8s minor version within approximately 4 to 8 weeks of the K8s release date.</li>
</ul>
<h3 id="more-items-for-cks-than-cka-and-ckad">More items for CKS than CKA and CKAD</h3>
<ul>
<li>Pod Security Policies(PSP) - removed from Kubernetes in <code>v1.25</code></li>
<li><a href="https://kubernetes.io/docs/tutorials/security/apparmor/" target="_blank" rel="noopener">AppArmor</a></li>
<li>Apiserver
<ul>
<li>Apiserver Crash</li>
<li>Apiserver NodeRestriction</li>
</ul>
</li>
<li>ImagePolicyWebhook</li>
<li><a href="https://github.com/aquasecurity/kube-bench" target="_blank" rel="noopener">kube-bench</a></li>
<li><a href="https://github.com/aquasecurity/trivy" target="_blank" rel="noopener">Trivy</a></li>
</ul>
<h3 id="cks-知识点-练习题总结"><a href="./Kubernetes-CKS-%E7%9F%A5%E8%AF%86%E7%82%B9-%E7%BB%83%E4%B9%A0%E9%A2%98.html">CKS 知识点&amp;练习题总结</a></h3>
<h2 id="如何备考">如何备考</h2>
<h3 id="k8s练习环境-同cka"><a href="./Kubernates-Certified-Kubernetes-Administrator-CKA.html#k8s%E7%BB%83%E4%B9%A0%E7%8E%AF%E5%A2%83">k8s练习环境</a>(同CKA)</h3>
<h3 id="cks练习题">CKS练习题</h3>
<p>有几个练习库，建议将每个题目都自己亲自操作一遍，一定要操作。</p>
<ul>
<li>CKS在线练习环境：<a href="https://killercoda.com/killer-shell-cks" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks</a></li>
<li><a href="https://killer.sh/attendee/f65d95f1-170b-444d-8af0-bbf302f8c796/content" target="_blank" rel="noopener">CKS Simulator Kubernetes 1.26</a></li>
<li><a href="https://killercoda.com/killer-shell-ckad/scenario/admission-controllers" target="_blank" rel="noopener">Adminission pligin/Pod Security Policies 练习</a></li>
</ul>
<h3 id="cks课程">CKS课程</h3>
<ul>
<li>【需付费】CKS考试-对应官方课程<a href="https://training.linuxfoundation.org/training/kubernetes-security-essentials-lfs260/" target="_blank" rel="noopener">Kubernetes for Developers (LFS260)</a> 感觉没必要买，只看官方文档就足够了。</li>
</ul>
<h3 id="常用命令">常用命令</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 不熟</span></span><br><span class="line"><span class="comment">## 输出pod status</span></span><br><span class="line">kubectl -n default describe pod pod1 | grep -i status:</span><br><span class="line">kubectl -n default get pod pod1 -o jsonpath=<span class="string">"&#123;.status.phase&#125;"</span></span><br><span class="line"><span class="comment">## Check the pod for error</span></span><br><span class="line">kubectl describe pod podname | grep -i error</span><br><span class="line">... Error: ImagePullBackOff</span><br><span class="line"><span class="comment">## a fast way to get an overview of the ReplicaSets of a Deployment and their images could be done with:</span></span><br><span class="line">kubectl -n neptune get rs -o wide | grep deployname</span><br><span class="line">NAME         DESIRED   CURRENT   READY   AGE    CONTAINERS   IMAGES         SELECTOR</span><br><span class="line">deployname   3         3         3       9m6s   httpd        httpd:alpine   app=wonderful</span><br><span class="line"></span><br><span class="line"><span class="comment">## 创建job</span></span><br><span class="line">kubectl -n neptune create job neb-new-job --image=busybox:1.31.0 <span class="variable">$do</span> &gt; /opt/course/3/job.yaml -- sh -c <span class="string">"sleep 2 &amp;&amp; echo done"</span></span><br><span class="line"><span class="comment">## If a Secret bolongs to a serviceaccount, it'll have the annotation kubernetes.io/service-account.name</span></span><br><span class="line">kubectl get secrets -oyaml | grep annotations -A 1 <span class="comment"># shows secrets with first annotation</span></span><br><span class="line"><span class="comment">## log</span></span><br><span class="line">kubectl logs podname &gt; /opt/test.log</span><br><span class="line"><span class="comment">## decode base64</span></span><br><span class="line">base64 -d filename</span><br><span class="line"><span class="comment">## check service connection using a temporary Pod</span></span><br><span class="line"><span class="comment">## k run tmp --restart=Never --rm --image=nginx:alpine -i -- curl http://svcname.namespace:svcport</span></span><br><span class="line">kubectl run tmp --restart=Never --rm --image=nginx:alpine -i -- curl http://svcname.namespace:80</span><br><span class="line"><span class="comment">## check that both PV and PVC have the status Bound:</span></span><br><span class="line">k -n earth get pv,pvc</span><br><span class="line">NAME                                            CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                 STORAGECLASS   REASON   AGE</span><br><span class="line">persistentvolume/earth-project-earthflower-pv   2Gi        RWO            Retain           Bound    earth/earth-project-earthflower-pvc                           8m4s</span><br><span class="line"></span><br><span class="line">NAME                                                  STATUS   VOLUME                         CAPACITY   ACCESS MODES   STORAGECLASS   AGE</span><br><span class="line">persistentvolumeclaim/earth-project-earthflower-pvc   Bound    earth-project-earthflower-pv   2Gi        RWO                           7m38s</span><br><span class="line"></span><br><span class="line"><span class="comment">## We can confirm the pod of deployment with PVC mounting correctly:</span></span><br><span class="line">k describe pod project-earthflower-586758cc49-hb87f -n earth | grep -A2 Mount:</span><br><span class="line">    Mounts:</span><br><span class="line">      /tmp/project-data from task-pv-storage (rw)</span><br><span class="line">      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-jj2t2 (ro)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Verify everything using kubectl auth can-i</span></span><br><span class="line">kubectl auth can-i create deployments --as system:serviceaccount:app-team1:cicd-token -n app-team1 <span class="comment"># YES</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 常用</span></span><br><span class="line"><span class="comment">## 创建pod</span></span><br><span class="line">kubectl run pod1 --image=httpd:2.4.41-alpine <span class="variable">$do</span> &gt; 2.yaml</span><br><span class="line">kubectl get pod sat-003 -o yaml &gt; 7-sat-003.yaml <span class="comment"># export</span></span><br><span class="line">kubectl delete pod pod1 --force --grace-period=0</span><br><span class="line"><span class="comment">## 创建service</span></span><br><span class="line">kubectl expose deployment d1 --name=服务名 --port=服务端口 --target-port=pod运行端口 --<span class="built_in">type</span>=类型</span><br><span class="line">kubectl expose pod pod名 --name=服务名 --port=服务端口 --target-port=pod运行端口 --<span class="built_in">type</span>=类型</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># CKS</span></span><br><span class="line"><span class="comment">## 创建secret</span></span><br><span class="line">kubectl create secret generic db-credentials --from-literal db-password=passwd</span><br><span class="line"><span class="comment">## modify a pod yaml to deployment yaml</span></span><br><span class="line"><span class="comment">### put the Pod's metadata: and spec: into the Deployment's template: section:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## To verify that the token hasn't been mounted run the following commands:</span></span><br><span class="line">kubectl -n one <span class="built_in">exec</span> -it pod-name -- mount | grep serviceaccount</span><br><span class="line">kubectl -n one <span class="built_in">exec</span> -it pod-name -- cat /var/run/secrets/kubernetes.io/serviceaccount/token</span><br><span class="line"></span><br><span class="line"><span class="comment">### 创建 clusterrole，使用 psp</span></span><br><span class="line">kubectl create clusterrole restrict-access-role --verb=use --resource=psp --resource-name=restrict-policy</span><br><span class="line"></span><br><span class="line"><span class="comment">## after modify /etc/kubernetes/manifests/kube-apiserver.yaml</span></span><br><span class="line">systemctl restart kubelet</span><br><span class="line"></span><br><span class="line"><span class="comment">### 查询 sa 对应的 role 名称（假设是 role-1）</span></span><br><span class="line">kubectl get rolebinding -n db -oyaml | grep <span class="string">'service-account-web'</span> -B 10</span><br><span class="line"></span><br><span class="line"><span class="comment">### grep</span></span><br><span class="line">grep apple -A 10 <span class="comment"># apple之后10行</span></span><br><span class="line"></span><br><span class="line">grep apple -B 10 <span class="comment"># apple之前10行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### secret used by pod</span></span><br><span class="line">kubectl <span class="built_in">exec</span> pod1 -- env</span><br><span class="line">kubectl <span class="built_in">exec</span> pod1 -- cat /etc/diver/hosts</span><br></pre></td></tr></table></figure>
<h2 id="经验总结-同cka"><a href="http://liyuankun.top/Kubernates-Certified-Kubernetes-Administrator-CKA.html#%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93">经验总结</a>(同CKA)</h2>
<h2 id="pre-setup-同cka"><a href="http://liyuankun.top/Kubernates-Certified-Kubernetes-Administrator-CKA.html#pre-setup">Pre Setup</a>(同CKA)</h2>
<h2 id="cks-2023-真题-1-26">CKS 2023 真题 1.26</h2>
<h3 id="考题1-apparmor-访问控制">考题1 - AppArmor 访问控制</h3>
<h4 id="context">Context</h4>
<p>AppArmor is enabled on the cluster’s worker node. An AppArmor profile is prepared, but not enforced yet.<br>
You may use your browser to open one additional tab to access the AppArmor documentation.</p>
<p>AppArmor 已在 cluster 的工作节点上被启用。一个 AppArmor 配置文件已存在，但尚未被实施。</p>
<h4 id="task">Task</h4>
<p>On the cluster’s worker node, enforce the prepared AppArmor profile located at <code>/etc/apparmor.d/nginx_apparmor</code> .<br>
Edit the prepared manifest file located at <code>/home/candidate/KSSH00401/nginx-deploy.yaml</code> to apply the AppArmor profile.<br>
Finally, apply the manifest file and create the pod specified in it.</p>
<p>在 cluster 的工作节点上，实施位于 <code>/etc/apparmor.d/nginx_apparmor</code> 的现有 AppArmor 配置文件。<br>
编辑位于 <code>/home/candidate/KSSH00401/nginx-deploy.yaml</code> 的现有清单文件以应用 AppArmor 配置文件。<br>
最后，应用清单文件并创建其中指定的 Pod 。</p>
<h4 id="solution">Solution</h4>
<p>搜索 apparmor（使用 AppArmor 限制容器对资源的访问），接着再搜索字符串 “parser”<br>
<a href="https://kubernetes.io/zh/docs/tutorials/security/apparmor/" target="_blank" rel="noopener">https://kubernetes.io/zh/docs/tutorials/security/apparmor/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 远程登录到指定工作节点</span></span><br><span class="line">ssh cka-node01</span><br><span class="line"></span><br><span class="line"><span class="comment">### 从profile文件查看策略名称</span></span><br><span class="line">cat /etc/apparmor.d/nginx_apparmor</span><br><span class="line"></span><br><span class="line">    profile nginx-profile flags=(attach_disconnected) &#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="comment">### 加载 apparmor 配置文件</span></span><br><span class="line">apparmor_parser /etc/apparmor.d/nginx_apparmor</span><br><span class="line"></span><br><span class="line"><span class="comment">### 查看策略名称，结果是 nginx-profile</span></span><br><span class="line">apparmor_status | grep nginx-profile</span><br><span class="line"></span><br><span class="line"><span class="comment">### 回到控制节点，并更新 Pod 的注解</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line">vim /home/candidate/KSSH00401/nginx-deploy.yaml</span><br><span class="line">    annotations:</span><br><span class="line">      <span class="comment">### hello 是 Pod 里容器名称，nginx-profile 则是 apparmor_status 解析出来的结果</span></span><br><span class="line">      container.apparmor.security.beta.kubernetes.io/hello: localhost/nginx-profile</span><br><span class="line"></span><br><span class="line"><span class="comment">### 如果 apply 后报错，则先删除保存并删除旧 Pod，改完后再创建新的</span></span><br><span class="line">kubectl apply -f /home/candidate/KSSH00401/nginx-deploy.yaml</span><br></pre></td></tr></table></figure>
<h3 id="考题2-kube-bench-基准测试">考题2 - Kube-Bench 基准测试</h3>
<h4 id="context-v2">Context</h4>
<p>A CIS Benchmark tool was run against the kubeadm-created cluster and found multiple issues that must be addressed immediately.</p>
<p>针对 kubeadm 创建的 cluster 运行 CIS 基准测试工具时， 发现了多个必须立即解决的问题。</p>
<h4 id="task-v2">Task</h4>
<p>Fix all issues via configuration and restart theaffected components to ensure the new settings take effect.<br>
通过配置修复所有问题并重新启动受影响的组件以确保新的设置生效。</p>
<p>Fix all of the following violations that were found against the API server:<br>
修复针对 API 服务器发现的所有以下违规行为：<br>
Ensure that the 1.2.7 --authorization-mode FAIL argument is not set to AlwaysAllow<br>
Ensure that the 1.2.8 --authorization-mode FAIL argument includes Node<br>
Ensure that the 1.2.9 --authorization-mode FAIL argument includes RBAC<br>
Ensure that the 1.2.18 --insecure-bind-address FAIL argument is not set<br>
Ensure that the 1.2.19 --insecure-port FAIL argument is set to 0</p>
<p>Fix all of the following violations that were found against the kubelet:<br>
修复针对 kubelet 发现的所有以下违规行为：<br>
Ensure that the 4.2.1 --anonymous-auth FAIL argument is set to false<br>
Ensure that the 4.2.2 --authorization-mode FAIL argument is not set to AlwaysAllow<br>
Use <code>Webhook</code> authn/authz where possible. 注意：尽可能使用 Webhook authn/authz。</p>
<p>Fix all of the following violations that were found against etcd:<br>
修复针对 etcd 发现的所有以下违规行为：<br>
Ensure that the 4.2.1 --client-cert-auth FAIL argument is set to true</p>
<h4 id="solution-v2">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ssh root@vms65.rhce.cc</span><br><span class="line"></span><br><span class="line"><span class="comment"># kube-bench run --target=master --check=1.2.7</span></span><br><span class="line">kube-bench run --target=master | grep FAIL</span><br><span class="line"></span><br><span class="line"><span class="comment">### 修复针对 APIserver 发现的以下所有问题：</span></span><br><span class="line"><span class="comment">### 确保 1.2.7 --authorization-mode 参数不能设置为 AlwaysAllow</span></span><br><span class="line"><span class="comment">### 确保 1.2.8 --authorization-mode 参数包含 Node</span></span><br><span class="line"><span class="comment">### 确保 1.2.9 --authorization-mode 参数包含 RBAC</span></span><br><span class="line"><span class="comment">### 确保 1.2.18 --insecure-bind-address 参数不能设置</span></span><br><span class="line"><span class="comment">### 确保 1.2.19 --insecure-port 参数设置为 0</span></span><br><span class="line"><span class="comment">### 注意：修改 master 节点！</span></span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line">    <span class="comment">#- --authorization-mode=AlwaysAllow 删除AlwaysAllow，加Node,RBAC</span></span><br><span class="line">    - --authorization-mode=Node,RBAC</span><br><span class="line">    <span class="comment">#- --insecure-bind-address=0.0.0.0</span></span><br><span class="line">    - --insecure-port=0</span><br><span class="line"></span><br><span class="line"><span class="comment">### 修复针对 kubelet 发现的以下所有问题：</span></span><br><span class="line"><span class="comment">### 确保 4.2.1 anonymous-auth 参数设置为 false</span></span><br><span class="line"><span class="comment">### 确保 4.2.2 --authorization-mode 参数不能设置为 AlwaysAllow，尽可能使用 Webhook authn/authz</span></span><br><span class="line"><span class="comment">### 注意：master 和 node 节点都要修改！</span></span><br><span class="line">vim /var/lib/kubelet/config.yaml</span><br><span class="line">    authentication:</span><br><span class="line">      anonymous:</span><br><span class="line">        enabled: <span class="literal">false</span></span><br><span class="line">    authorization:</span><br><span class="line">      mode: Webhook</span><br><span class="line"></span><br><span class="line"><span class="comment">### 修复针对 etcd 发现的以下所有问题：</span></span><br><span class="line"><span class="comment">### 确保 4.2.--client-cert-auth 参数设置为 true</span></span><br><span class="line"><span class="comment">### 注意：修改 master 节点！</span></span><br><span class="line">vim /etc/kubernetes/manifests/etcd.yaml</span><br><span class="line">    - --client-cert-auth=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 加载并重启 kubelet 服务</span></span><br><span class="line"><span class="comment">### 注意：master 和 node 节点都要重启！</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart kubelet</span><br></pre></td></tr></table></figure>
<h3 id="考题3-trivy-镜像扫描">考题3 - Trivy 镜像扫描</h3>
<h4 id="task-v3">Task</h4>
<p>使用 Trivy 开源容器扫描器检测 namespace kamino 中 Pod 使用的具有严重漏洞的镜像。<br>
查找具有 High 或 Critical 严重性漏洞的镜像，并删除使用这些镜像的 Pod。<br>
注意：Trivy 仅安装在 cluster 的 master 节点上，在工作节点上不可使用。你必须切换到 cluster 的 master 节点才能使用 Trivy 。</p>
<p>Use the Trivy open-source container scanner to detect images with severe vulnerabilities used by Pods in the namespace <code>kamino</code>.<br>
Look for images with <code>High</code> or <code>Critical</code> severity vulnerabilities, and delete the Pods that use those images.</p>
<p>Trivy is pre-installed on the cluster’s <code>master</code> node only; it is not available on the base system or the worker nodes. You’ll have to connect to the cluster’s master node to use <code>Trivy</code>.</p>
<h4 id="solution-v3">Solution</h4>
<p>搜索 kubectl images（列出集群中所有运行容器的镜像）<br>
<a href="https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/list-all-running-container-images/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/list-all-running-container-images/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 需登录到控制节点操作</span></span><br><span class="line">ssh cka-master01</span><br><span class="line"></span><br><span class="line"><span class="comment">### 查询命名空间 kamino 中 pod 使用的镜像</span></span><br><span class="line">kubectl get pod -n kamino -o yaml | grep image:</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">kubectl get pods -n kamino -o jsonpath=<span class="string">'&#123;range .items[*]&#125;&#123;"\n"&#125;&#123;.metadata.name&#125;&#123;":\t"&#125;&#123;range .spec.containers[*]&#125;&#123;.image&#125;&#123;", "&#125;&#123;end&#125;&#123;end&#125;'</span> | sort</span><br><span class="line"></span><br><span class="line"><span class="comment">### 假设镜像是 registry.aliyuncs.com/google_containers/coredns:1.7.0</span></span><br><span class="line"><span class="comment">### 使用 trivy 工具查询具有 HIGH 或 CRITICAL 漏洞的镜像</span></span><br><span class="line">trivy --<span class="built_in">help</span></span><br><span class="line">trivy image --severity HIGH,CRITICAL <span class="string">'registry.aliyuncs.com/google_containers/coredns:1.7.0'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 删除检测到的漏洞镜像对应的 pod（如果有控制器，得删除控制器）</span></span><br><span class="line">kubectl delete pod -n kamino pod名称</span><br></pre></td></tr></table></figure>
<h3 id="考题4-sysdig-falco">考题4 - Sysdig &amp; Falco</h3>
<p>you may use you brower to open one additonal tab to access sysdig’s documentation or Falco’s documentaion</p>
<h4 id="task-v4">Task</h4>
<p>Use runtime detection tools to detect anomalous processes spawning and executing frequently in the sigle container belonging to Pod <code>redis</code>. Two tools are avaliable to use:<br>
使用运行时检测工具来检测 Pod tomcat 单个容器中频发生成和执行的异常进程。有两种工具可供使用：</p>
<ul>
<li>sysdig</li>
<li>falco</li>
</ul>
<p>The tools are pre-installed on the cluster’s worker node only, they are not avaliable on the base system or the master node.<br>
Using the tool of you choice (including any non pre-install tool) analyse the container’s behavior for at least <code>30</code> seconds, using filers that detect newly spawing and executing processes, store an incident file at <code>/opt/KSR00101/incidents/summary</code>, containing the detected incidents one per line in the follwing format:<br>
注：这些工具只预装在 cluster 的工作节点，不在 master 节点。<br>
使用工具至少分析 30 秒，使用过滤器检查生成和执行的进程，将事件写到 <code>/opt/KSR00101/incidents/summary</code> 文件中，其中包含检测的事件, 每个单独一行<br>
格式如下：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">[timestamp],[uid],[processName]</span></span><br></pre></td></tr></table></figure>
<p>保持工具的原始时间戳格式不变。<br>
注：确保事件文件存储在集群的工作节点上。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 方法一 sysdig</span></span><br><span class="line"><span class="comment">### 需登录到工作节点操作</span></span><br><span class="line">ssh cka-node01</span><br><span class="line"></span><br><span class="line"><span class="comment">### 查看 sysdig 帮助</span></span><br><span class="line">sysdig -h</span><br><span class="line"></span><br><span class="line"><span class="comment">### 查看 sysdig 支持的元数据</span></span><br><span class="line">sysdig -l</span><br><span class="line"></span><br><span class="line"><span class="comment">### 查看指定容器ID</span></span><br><span class="line">crictl ps | grep redis</span><br><span class="line"></span><br><span class="line"><span class="comment">### -M 分析容器30秒，-p 指定事件保存格式，--cri 指定容器运行时，并且保存到指定文件路径中</span></span><br><span class="line">sysdig -M 30 -p <span class="string">"*%evt.time,%user.uid,%proc.name"</span> --cri /run/containerd/containerd.sock container.id=xxxxx &gt; /opt/KSR00101/incidents/summary</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 方法二 falco</span></span><br><span class="line"><span class="comment">### 需登录到工作节点操作</span></span><br><span class="line">ssh cka-node01</span><br><span class="line"></span><br><span class="line"><span class="comment">### </span></span><br><span class="line"><span class="built_in">cd</span> /etc/falco</span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line"><span class="comment">### </span></span><br><span class="line">vim /etc/falco/falco_rules.yaml</span><br><span class="line"><span class="comment"># Container is supposed to be immutable. Package management should be done in building the image.</span></span><br><span class="line">- rule: Launch Package Management Process <span class="keyword">in</span> Container</span><br><span class="line">  desc: Package management process ran inside container</span><br><span class="line">  condition: &gt;</span><br><span class="line">    spawned_process</span><br><span class="line">    and container</span><br><span class="line">    and user.name != <span class="string">"_apt"</span></span><br><span class="line">    and package_mgmt_procs</span><br><span class="line">    and not package_mgmt_ancestor_procs</span><br><span class="line">    and not user_known_package_manager_in_container</span><br><span class="line">  output: &gt;</span><br><span class="line">    Package management process launched <span class="keyword">in</span> container %evt.time,%user.uid,%proc.name</span><br><span class="line"></span><br><span class="line"><span class="comment">### 查看指定容器ID</span></span><br><span class="line">cat /var/<span class="built_in">log</span>/sysdig | grep falco | grep <span class="string">"Package management"</span> -i</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">vim /opt/KSR00101/incidents/summary</span><br></pre></td></tr></table></figure>
<h3 id="考题5-serviceaccount">考题5 - ServiceAccount</h3>
<p>Context<br>
A Pod fails to run because of an incorrectly specified ServiceAcccount.</p>
<h4 id="task-v5">Task</h4>
<p>create a new ServiceAccount named <code>backend-sa</code> in the existing namespace <code>qa</code>, which must <strong>not have access to any secrets</strong>.</p>
<ul>
<li>Inspect the Pods in the namespace <code>qa</code>.
<ul>
<li>Edit the Pod to use the newly created serviceAccount <code>backend-sa</code>.</li>
<li>Ensure that the modified specification is applied and the Pod is running.</li>
</ul>
</li>
<li>Finally, clean-up and delete the now unused serviceAccount in the namespace <code>qa</code>.<br>
在现有 namespace <code>qa</code> 中创建一个名为 <code>backend-sa</code> 的新 ServiceAccount， 确保此 ServiceAccount 不自动挂载secrets。<br>
使用 <code>/cks/9/pod9.yaml</code> 中的清单文件来创建一个 Pod。<br>
最后，清理 namespace <code>qa</code> 中任何未使用的 ServiceAccount。</li>
</ul>
<h4 id="solution-v4">Solution</h4>
<p>搜索 serviceaccount（为Pod配置服务账号），接着再搜索字符串 “automount”<br>
<a href="https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/configure-service-account/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/configure-service-account/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 创建 ServiceAccount</span></span><br><span class="line">kubectl apply -f - &lt;&lt;EOF</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: backend-sa</span><br><span class="line">  namespace: qa</span><br><span class="line">automountServiceAccountToken: <span class="literal">false</span></span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="comment">### </span></span><br><span class="line">k get pods -n qa</span><br><span class="line">  web1-xxx1</span><br><span class="line">  web2-xwx2</span><br><span class="line">  web3-xwx3</span><br><span class="line">k get deployment -n qa</span><br><span class="line">  web1</span><br><span class="line">  web2</span><br><span class="line">  web3</span><br><span class="line"><span class="comment"># 发现这些pod都属于deployment</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 编辑 Pod 使用新创建的 serviceaccount</span></span><br><span class="line">k edit deployment/web1 -n qa</span><br><span class="line">k edit deployment/web2 -n qa</span><br><span class="line">k edit deployment/web3 -n qa</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">template:</span><br><span class="line">  spec:</span><br><span class="line">    serviceAccountName: backend-sa <span class="comment"># add</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">### 应用清单文件</span></span><br><span class="line">kubectl apply -f /cks/9/pod9.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment">### 把除了 backend-sa, 并且没有被使用的 serviceaccount 都删除</span></span><br><span class="line">kubectl get serviceaccount -n qa</span><br><span class="line">    backend-sa</span><br><span class="line">    default</span><br><span class="line">    contentsa</span><br><span class="line"></span><br><span class="line">kubectl get rolebinding -n qa -o wide</span><br><span class="line">kubectl get clustorrolebinding -n qa -o wide</span><br><span class="line"></span><br><span class="line">kubectl delete -n qa serviceaccount contentsa</span><br></pre></td></tr></table></figure>
<h3 id="考题6-2022真题v1-20-pod-安全策略-podsecuritypolicy">考题6 - 2022真题v1.20 Pod 安全策略-PodSecurityPolicy</h3>
<p>2023的最新考试已经没有这道题了，替代的是Pod Security Standard</p>
<h4 id="context6">Context6</h4>
<p>A PodsecurityPolicy shall prevent the creation on of privileged Pods in a specific namespace.<br>
PodSecurityPolicy 应防止在特定 namespace 中特权 Pod 的创建。</p>
<h4 id="task6">Task6</h4>
<p>Create a new <code>PodSecurityPolicy</code> named <code>restrict-policy</code>, which prevents the creation of privileged Pods.</p>
<p>Create a new <code>ClusterRole</code> named <code>restrict-access-role</code>, which uses the newly created PodSecurityPolicy <code>restrict-policy</code>.<br>
Create a new <code>serviceAccount</code> named <code>psp-denial-sa</code> in the existing namespace <code>staging</code>.</p>
<p>Finally, create a new <code>clusterRoleBinding</code> named <code>dany-access-bind</code>, which binds the newly created ClusterRole <code>restrict-access-role</code> to the newly created serviceAccount <code>psp-denial-sa</code>.</p>
<p>创建一个名为 <code>restrict-policy</code> 的新的 PodSecurityPolicy，以防止特权 Pod 的创建。<br>
创建一个名为 <code>restrict-access-role</code> 并使用新创建的 PodSecurityPolicy <code>restrict-policy</code> 的 ClusterRole。<br>
在现有的 namespace <code>staging</code> 中创建一个名为 <code>psp-denial-sa</code> 的新 ServiceAccount 。<br>
最后，创建一个名为 <code>dany-access-bind</code> 的 ClusterRoleBinding，将新创建的 ClusterRole <code>restrict-access-role</code> 绑定到新创建的 ServiceAccount <code>psp-denial-sa</code>。<br>
你可以在一下位置找到模版清单文件： <code>/cks/psp/psp.yaml</code></p>
<h4 id="solution6">Solution6</h4>
<p>搜索 runasany（Pod Security Policy）<br>
<a href="https://kubernetes.io/id/docs/concepts/policy/pod-security-policy/" target="_blank" rel="noopener">https://kubernetes.io/id/docs/concepts/policy/pod-security-policy/</a><br>
搜索 clusterrole（使用RBAC鉴权）<br>
<a href="https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/rbac/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/rbac/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### (1)创建 psp</span></span><br><span class="line">vim /cks/psp/psp.yaml</span><br><span class="line">apiVersion: policy/v1beta1</span><br><span class="line">kind: PodSecurityPolicy</span><br><span class="line">metadata:</span><br><span class="line">  name: restrict-policy</span><br><span class="line">spec:</span><br><span class="line">  privileged: <span class="literal">false</span></span><br><span class="line">  seLinux:</span><br><span class="line">    rule: RunAsAny</span><br><span class="line">  supplementalGroups:</span><br><span class="line">    rule: RunAsAny</span><br><span class="line">  runAsUser:</span><br><span class="line">    rule: RunAsAny</span><br><span class="line">  fsGroup:</span><br><span class="line">    rule: RunAsAny</span><br><span class="line">  volumes:</span><br><span class="line">  - <span class="string">'*'</span></span><br><span class="line"></span><br><span class="line">kubectl apply -f /cks/psp/psp.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment">### (2)创建 clusterrole，使用 psp</span></span><br><span class="line">kubectl create clusterrole restrict-access-role --verb=use --resource=psp --resource-name=restrict-policy</span><br><span class="line"></span><br><span class="line"><span class="comment">### (3)创建 serviceaccount</span></span><br><span class="line">kubectl create serviceaccount psp-denial-sa -n staging </span><br><span class="line"></span><br><span class="line"><span class="comment">### (4)创建 clusterrolebinding</span></span><br><span class="line">kubectl create clusterrolebinding dany-access-bind --clusterrole=restrict-access-role --serviceaccount=staging:psp-denial-sa</span><br><span class="line"></span><br><span class="line"><span class="comment">### (5)启用 PodSecurityPolicy（在控制节点上修改 apiserver 配置）</span></span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line">    - --<span class="built_in">enable</span>-admission-plugins=NodeRestriction,PodSecurityPolicy</span><br><span class="line"></span><br><span class="line">systemctl restart kubelet</span><br></pre></td></tr></table></figure>
<h3 id="考题6-2023真题v1-26-pod-security-standard">考题6 - 2023真题V1.26 Pod Security Standard</h3>
<p>Task weight: 8%<br>
Use context: <code>kubectl config use-context workload-prod</code></p>
<p>There is Deployment <code>container-host-hacker</code> in Namespace <code>team-red</code> which mounts <code>/run/containerd</code> as a hostPath volume on the Node where it’s running. This means that the Pod can access various data about other containers running on the same Node.</p>
<p>To prevent this configure Namespace <code>team-red</code> to <code>enforce</code> the <code>baseline</code> Pod Security Standard. Once completed, delete the Pod of the Deployment mentioned above.</p>
<p>Check the <code>ReplicaSet</code> events and write the event/log lines containing the reason why the Pod isn’t recreated into <code>/opt/course/4/logs</code>.</p>
<h4 id="answer">Answer</h4>
<p>Making Namespaces use Pod Security Standards works via labels. We can simply edit it:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k edit ns team-red</span><br></pre></td></tr></table></figure>
<p>Now we configure the requested label:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># kubectl edit namespace team-red</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Namespace</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">kubernetes.io/metadata.name:</span> <span class="string">team-red</span></span><br><span class="line">    <span class="attr">pod-security.kubernetes.io/enforce:</span> <span class="string">baseline</span> <span class="comment"># add</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">team-red</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure>
<p>This should already be enough for the default Pod Security Admission Controller to pick up on that change. Let’s test it and delete the Pod to see if it’ll be recreated or fails, it should fail!</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">➜ k -n team-red get pod</span><br><span class="line">NAME                                    READY   STATUS    RESTARTS   AGE</span><br><span class="line">container-host-hacker-dbf989777-wm8fc   1/1     Running   0          115s</span><br><span class="line"></span><br><span class="line">➜ k -n team-red delete pod container-host-hacker-dbf989777-wm8fc </span><br><span class="line">pod <span class="string">"container-host-hacker-dbf989777-wm8fc"</span> deleted</span><br><span class="line"></span><br><span class="line">➜ k -n team-red get pod</span><br><span class="line">No resources found <span class="keyword">in</span> team-red namespace.</span><br></pre></td></tr></table></figure>
<p>Usually the ReplicaSet of a Deployment would recreate the Pod if deleted, here we see this doesn’t happen. Let’s check why:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">➜ k -n team-red get rs</span><br><span class="line">NAME                              DESIRED   CURRENT   READY   AGE</span><br><span class="line">container-host-hacker-dbf989777   1         0         0       5m25s</span><br><span class="line"></span><br><span class="line">➜ k -n team-red describe rs container-host-hacker-dbf989777</span><br><span class="line">Name:           container-host-hacker-dbf989777</span><br><span class="line">Namespace:      team-red</span><br><span class="line">...</span><br><span class="line">Events:</span><br><span class="line">  Type     Reason            Age                   From                   Message</span><br><span class="line">  ----     ------            ----                  ----                   -------</span><br><span class="line">...</span><br><span class="line">  Warning  FailedCreate      2m41s                 replicaset-controller  Error creating: pods <span class="string">"container-host-hacker-dbf989777-bjwgv"</span> is forbidden: violates PodSecurity <span class="string">"baseline:latest"</span>: hostPath volumes (volume <span class="string">"containerdata"</span>)</span><br><span class="line">  Warning  FailedCreate      2m2s (x9 over 2m40s)  replicaset-controller  (combined from similar events): Error creating: pods <span class="string">"container-host-hacker-dbf989777-kjfpn"</span> is forbidden: violates PodSecurity <span class="string">"baseline:latest"</span>: hostPath volumes (volume <span class="string">"containerdata"</span>)</span><br></pre></td></tr></table></figure>
<p>There we go! Finally we write the reason into the requested file so that Mr Scoring will be happy too!</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /opt/course/4/logs</span></span><br><span class="line">Warning  FailedCreate      2m2s (x9 over 2m40s)  replicaset-controller  (combined from similar events): Error creating: pods <span class="string">"container-host-hacker-dbf989777-kjfpn"</span> is forbidden: violates PodSecurity <span class="string">"baseline:latest"</span>: hostPath volumes (volume <span class="string">"containerdata"</span>)</span><br></pre></td></tr></table></figure>
<p>Pod Security Standards can give a great base level of security! But when one finds themselves wanting to deeper adjust the levels like <code>baseline</code> or <code>restricted</code>… this isn’t possible and 3rd party solutions like OPA could be looked at.</p>
<h3 id="考题7-networkpolicy-default-deny">考题7 - NetworkPolicy - default-deny</h3>
<h4 id="context-v3">Context</h4>
<p>A default-deny NetworkPolicy avoids to accidentally expose a Pod in a namespace that doesn’t have any other NetworkPolicy defined.<br>
一个默认拒绝（default-deny）的 NetworkPolicy 可避免在未定义任何其他 NetworkPolicy 的 namespace 中意外公开 Pod。</p>
<h4 id="task-v6">Task</h4>
<p>Create a new default-deny NetworkPolicy named <code>denynetwork</code> in the namespace <code>development</code> for all traffic of type <code>Ingress</code>.<br>
The new NetworkPolicy must deny all ingress traffic in the namespace <code>development</code>.</p>
<p>Apply the newly created <code>default-deny</code> NetworkPolicy to all Pods running in namespace <code>development</code>.<br>
You can find a skeleton manifest file at <code>/cks/15/p1.yaml</code></p>
<p>为所有类型为 Ingress+Egress 的流量在 namespace testing 中创建一个名为 <code>denynetwork</code> 的新默认拒绝 NetworkPolicy。 此新的 NetworkPolicy 必须拒绝 namespace testng 中的所有的 Ingress + Egress 流量。<br>
将新创建的默认拒绝 NetworkPolicy 应用与在 namespace testing 中运行的所有 Pod。<br>
你可以在 <code>/cks/15/p1.yaml</code> 找到一个模板清单文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 修改模板清单文件</span></span><br><span class="line">vim /cks/15/p1.yaml</span><br><span class="line">apiVersion: networking.k8s.io/v1</span><br><span class="line">kind: NetworkPolicy</span><br><span class="line">metadata:</span><br><span class="line">  name: denynetwork</span><br><span class="line">  namespace: testing</span><br><span class="line">spec:</span><br><span class="line">  podSelector: &#123;&#125;</span><br><span class="line">  policyTypes:</span><br><span class="line">  - Ingress</span><br><span class="line"></span><br><span class="line"><span class="comment">### 应用清单文件</span></span><br><span class="line">kubectl apply -f /cks/15/p1.yaml</span><br></pre></td></tr></table></figure>
<h3 id="考题8-networkpolicy">考题8 - NetworkPolicy</h3>
<h4 id="task-v7">Task</h4>
<p>create a NetworkPolicy named <code>pod-restriction</code> to restrict access to Pod <code>products-service</code> running in namespace <code>dev-team</code>.<br>
Only allow the following Pods to connect to Pod <code>products-service</code>:</p>
<ul>
<li>Pods in the namespace <code>qa</code></li>
<li>Pods with label <code>environment: testing</code>, in any namespace</li>
</ul>
<p>Make sure to apply the NetworkPolicy.<br>
You can find a skelet on manifest file at <code>/cks/6/p1.yaml</code></p>
<p>创建一个名为 <code>pod-restriction</code> 的 NetworkPolicy 来限制对在 namespace <code>dev-team</code> 中运行的 Pod <code>products-service</code> 的访问。只允许以下 Pod 连接到 Pod <code>products-service</code>：</p>
<ul>
<li>namespace <code>qa</code> 中的 Pod</li>
<li>位于任何 namespace，带有标签 <code>environment: testing</code> 的 Pod</li>
</ul>
<p>注意：确保应用 NetworkPolicy。<br>
你可以在<code>/cks/net/po.yaml</code> 找到一个模板清单文件。</p>
<h4 id="solution-v5">Solution</h4>
<p>搜索 networkpolicy（网络策略）<br>
<a href="https://kubernetes.io/zh-cn/docs/concepts/services-networking/network-policies/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/concepts/services-networking/network-policies/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### (1)查看命名空间 qa 具有的标签</span></span><br><span class="line">kubectl get namespace qa --show-labels</span><br><span class="line"></span><br><span class="line"><span class="comment">### (2)查看 pod 具有的标签</span></span><br><span class="line">kubectl get pod products-service -n dev-team --show-labels</span><br><span class="line"></span><br><span class="line"><span class="comment">### 修改模板清单文件</span></span><br><span class="line">vim /cks/net/po.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">NetworkPolicy</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-restriction</span>  <span class="comment"># name</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev-team</span>  <span class="comment"># namespace</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">podSelector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">products-service</span>  <span class="comment"># (2)</span></span><br><span class="line">  <span class="attr">policyTypes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Ingress</span></span><br><span class="line">  <span class="attr">ingress:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">from:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">namespaceSelector:</span></span><br><span class="line">        <span class="attr">matchLabels:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">qa</span>  <span class="comment"># (1)</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">podSelector:</span>  <span class="comment"># 注意带 - ，表示或的关系</span></span><br><span class="line">        <span class="attr">matchLabels:</span></span><br><span class="line">          <span class="attr">environment:</span> <span class="string">testing</span></span><br><span class="line">      <span class="attr">namespaceSelector:</span> <span class="string">&#123;&#125;</span>    <span class="comment">## 任何命名空间, 不带 - ，且的关系</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 应用清单文件</span></span><br><span class="line">kubectl apply -f /cks/net/po.yaml</span><br></pre></td></tr></table></figure>
<h3 id="考题9-rbac">考题9 - RBAC</h3>
<h4 id="context-v4">Context</h4>
<p>绑定到 Pod 的 ServiceAccount 的 Role 授予过度宽松的权限。完成以下项目以减少权限集。<br>
A Role bound to a Pod’s serviceAccount grants overly permissive permissions.<br>
Complete the following tasks to reduce the set of permissions.</p>
<h4 id="task-v8">Task</h4>
<p>一个名为 <code>web-pod</code> 的现有 Pod 已在 namespace <code>db</code> 中运行。编辑绑定到 Pod 的 ServiceAccount <code>service-account-web</code> 的现有 Role， 仅允许只对 services 类型的资源执行 <code>get</code> 操作。</p>
<ul>
<li>在 namespace <code>db</code> 中创建一个名为 <code>role-2</code> ，并仅允许只对 <code>namespaces</code> 类型的资源执行 <code>delete</code> 操作的新 Role。</li>
<li>创建一个名为 <code>role-2-binding</code> 的新 RoleBinding，将新创建的 Role 绑定到 Pod 的 ServiceAccount。<br>
注意：请勿删除现有的 RoleBinding。</li>
</ul>
<p>Given an existing Pod named <code>web-pod</code> running in the namespace <code>db</code>. Edit the existing Role bound to the Pod’s serviceAccount <code>sa-dev-1</code> to only allow performing <code>list</code> operations, only on resources of type <code>Endpoints</code>.</p>
<ul>
<li>create a new Role named <code>role-2</code> in the namespace <code>db</code>, which only allows performing <code>update</code> operations, only on resources of type <code>persistentvolumeclaims</code></li>
<li>create a new RoleBinding named <code>role-2-binding</code> binding the newly created Role to the Pod’s serviceAccount.</li>
</ul>
<p>Don’t delete the existing RoleBinding</p>
<h4 id="solution-v6">solution</h4>
<p>搜索 clusterrole（使用RBAC鉴权）<br>
<a href="https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/rbac/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/rbac/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 查询 sa 对应的 role 名称（假设是 role-1）</span></span><br><span class="line">kubectl get rolebinding -n db -oyaml | grep <span class="string">'service-account-web'</span> -B 10</span><br><span class="line"></span><br><span class="line"><span class="comment">### 修改 role 清单文件（仅允许对 services 类型的资源执行 get 操作）</span></span><br><span class="line">kubectl edit role -n db role-1</span><br><span class="line"></span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: Role</span><br><span class="line">metadata:</span><br><span class="line">  name: role-1</span><br><span class="line">  namespace: db</span><br><span class="line">  resourceVersion: <span class="string">"9528"</span></span><br><span class="line">rules:</span><br><span class="line">- apiGroups:</span><br><span class="line">    - <span class="string">""</span></span><br><span class="line">  resources:</span><br><span class="line">    - services</span><br><span class="line">  verbs:</span><br><span class="line">    - get</span><br><span class="line"></span><br><span class="line"><span class="comment">### 创建新角色 role-2（仅允许只对 namespaces 类型的资源执行 delete 操作）</span></span><br><span class="line">kubectl create role role-2 -n db --verb=delete --resource=namespaces</span><br><span class="line"></span><br><span class="line"><span class="comment">### 创建 rolebinding，并绑定到 sa 上</span></span><br><span class="line">kubectl create rolebinding role-2-binding --role=role-2 --serviceaccount=db:service-account-web</span><br></pre></td></tr></table></figure>
<h3 id="考题10-kube-apiserver-审计日志记录和采集">考题10 - kube-apiserver 审计日志记录和采集</h3>
<h4 id="task-v9">Task</h4>
<p>Enable audit logs in the cluster.<br>
To do so, enable the log backend, and ensure that:</p>
<ul>
<li>logs are stored at <code>/var/log/kubernetes/audit-logs.txt</code></li>
<li>log files are retained for <code>10</code> days</li>
<li>at maximum, a number of <code>2</code> auditlog files are retained<br>
A basic policy is provided at <code>/etc/kubernetes/logpolicy/sample-policy.yaml</code>. it only specifies what not to log. The base policy is located on the cluster’s <code>master</code> node.</li>
</ul>
<p>Edit and extend the basic policy to log:</p>
<ul>
<li><code>namespaces</code> changes at <code>RequestResponse</code> level</li>
<li>the request body of pods changes in the namespace <code>front-apps</code></li>
<li><code>configMap</code> and <code>secret</code> changes in all namespaces at the <code>Metadata</code> level</li>
<li>Also, add a <code>catch-all</code> ruie to log all other requests at the <code>Metadata</code> level.</li>
</ul>
<p>Don’t forget to apply the modifiedpolicy.<br>
<code>/etc/kubernetes/logpolicy/sample-policy.yaml</code></p>
<p>在 cluster 中启用审计日志。为此，请启用日志后端，并确保：</p>
<ul>
<li>日志存储在 <code>/var/log/kubernetes/audit-logs.txt</code></li>
<li>日志文件能保留 <code>10</code> 天</li>
<li>最多保留 <code>2</code> 个旧审计日志文件<br>
/etc/kubernetes/logpolicy/sample-policy.yaml 提供了基本策略。它仅指定不记录的内容。<br>
注意：基本策略位于 cluster 的 master 节点上。</li>
</ul>
<p>编辑和扩展基本策略以记录：</p>
<ul>
<li>RequestResponse 级别的 cronjobs 更改</li>
<li>namespace front-apps 中 deployment 更改的请求体</li>
<li>Metadata 级别的所有 namespace 中的 ConfigMap 和 Secret 的更改</li>
<li>此外，添加一个全方位的规则以在 Metadata 级别记录所有其他请求。<br>
注意：不要忘记应用修改后的策略</li>
</ul>
<h4 id="solution-v7">Solution</h4>
<p>搜索 audit（审计）<br>
<a href="https://kubernetes.io/zh-cn/docs/tasks/debug/debug-cluster/audit/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/tasks/debug/debug-cluster/audit/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 如果没有 /var/log/kubernetes/，则创建目录</span></span><br><span class="line">mkdir /var/<span class="built_in">log</span>/kubernetes/</span><br><span class="line"></span><br><span class="line"><span class="comment">### 修改 audit 模板文件</span></span><br><span class="line">vim /etc/kubernetes/logpolicy/sample-policy.yaml</span><br><span class="line"></span><br><span class="line">apiVersion: audit.k8s.io/v1</span><br><span class="line">kind: Policy</span><br><span class="line">omitStages:</span><br><span class="line">  - <span class="string">"RequestReceived"</span></span><br><span class="line">rules:</span><br><span class="line">  - level: RequestResponse</span><br><span class="line">    resources:</span><br><span class="line">    - group: <span class="string">""</span></span><br><span class="line">      resources: [<span class="string">"cronjobs"</span>]</span><br><span class="line">  - level: Request</span><br><span class="line">    resources:</span><br><span class="line">    - group: <span class="string">""</span></span><br><span class="line">      resources: [<span class="string">"deployments"</span>]</span><br><span class="line">    namespaces: [<span class="string">"front-apps"</span>]</span><br><span class="line">  - level: Metadata</span><br><span class="line">    resources:</span><br><span class="line">    - group: <span class="string">""</span></span><br><span class="line">      resources: [<span class="string">"secrets"</span>, <span class="string">"configmaps"</span>]</span><br><span class="line">  - level: Metadata</span><br><span class="line">    omitStages:</span><br><span class="line">      - <span class="string">"RequestReceived"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 修改 apiserver 配置文件，启用审计日志</span></span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line">--audit-policy-file=/etc/kubernetes/logpolicy/sample-policy.yaml</span><br><span class="line">--audit-log-path=/var/<span class="built_in">log</span>/kubernetes/audit-logs.txt</span><br><span class="line">--audit-log-maxage=10</span><br><span class="line">--audit-log-maxbackup=2</span><br><span class="line"></span><br><span class="line"><span class="comment">### 在 apiserver 的 Pod 上挂载策略文件和日志文件所在的目录（考试时可能已经挂载好）</span></span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line">volumeMounts:</span><br><span class="line">  - mountPath: /var/<span class="built_in">log</span>/kubernetes</span><br><span class="line">    name: kubernetes-logs</span><br><span class="line">  - mountPath: /etc/kubernetes/logpolicy</span><br><span class="line">    name: kubernetes-policy</span><br><span class="line">volumes:</span><br><span class="line">- name: kubernetes-logs</span><br><span class="line">  hostPath:</span><br><span class="line">    path: /var/<span class="built_in">log</span>/kubernetes</span><br><span class="line">- name: kubernetes-policy</span><br><span class="line">  hostPath:</span><br><span class="line">    path: /etc/kubernetes/logpolicy</span><br><span class="line"></span><br><span class="line"><span class="comment">### 重载生效配置</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart kubelet</span><br></pre></td></tr></table></figure>
<h3 id="考题11-secret">考题11 - Secret</h3>
<h4 id="task-v10">Task</h4>
<p>Retrieve the content of the existing secret named <code>db1-test</code> in the <code>istio-system</code> namespace.<br>
store the username field in a file named <code>/home/candidate/user.txt</code>, and the password field in a file named <code>/home/candidate/pass</code>.txt.</p>
<p>You must create both files; they don’t exist yet.<br>
Do not use/modify the created files in the following steps, create new temporary files if needed.</p>
<p>Create a new secret named <code>db2-test</code> in the <code>istio-system</code> namespace, with the following</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">username :</span> <span class="string">production-instance</span></span><br><span class="line"><span class="attr">password :</span> <span class="string">KvLftKgs4aVH</span></span><br></pre></td></tr></table></figure>
<p>Finally, create a new Pod that has access to the secret db2-test via a volume:</p>
<ul>
<li>Pod name <code>secret-pod</code></li>
<li>Namespace <code>istio-system</code></li>
<li>container name <code>dev-container</code></li>
<li>image <code>nginx</code></li>
<li>volume name <code>secret-volume</code></li>
<li>mount path <code>/etc/secret</code></li>
</ul>
<p>在 namespace <code>istio-system</code> 中获取名为 <code>db1-test</code> 的现有 secret 的内容.<br>
将 username 字段存储在名为 <code>/cks/sec/user.txt</code> 的文件中，并将 password 字段存储在名为 <code>/cks/sec/pass.txt</code> 的文件中。</p>
<p>注意：你必须创建以上两个文件，他们还不存在。<br>
注意：不要在以下步骤中使用/修改先前创建的文件，如果需要，可以创建新的临时文件。</p>
<p>在 <code>istio-system</code> namespace 中创建一个名为 <code>db2-test</code> 的新 secret，内容如下：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">username :</span> <span class="string">production-instance</span></span><br><span class="line"><span class="attr">password :</span> <span class="string">KvLftKgs4aVH</span></span><br></pre></td></tr></table></figure>
<p>最后，创建一个新的 Pod，它可以通过卷访问 secret <code>db2-test</code> ：</p>
<ul>
<li>Pod 名称 <code>secret-pod</code></li>
<li>Namespace <code>istio-system</code></li>
<li>容器名 <code>dev-container</code></li>
<li>镜像 <code>nginx</code></li>
<li>卷名 <code>secret-volume</code></li>
<li>挂载路径 <code>/etc/secret</code></li>
</ul>
<h4 id="solution-v8">Solution</h4>
<p>搜索 secret（使用 kubectl 管理 Secret）<br>
<a href="https://kubernetes.io/zh-cn/docs/tasks/configmap-secret/managing-secret-using-kubectl/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/tasks/configmap-secret/managing-secret-using-kubectl/</a><br>
搜索 secret（Secret）<br>
<a href="https://kubernetes.io/zh-cn/docs/concepts/configuration/secret/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/concepts/configuration/secret/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 检索已存在的 secret，将获取到的用户名和密码字段存储到指定文件</span></span><br><span class="line">kubectl get secrets db2-test -o jsonpath=<span class="string">'&#123;.data.username&#125;'</span> | base64 -d &gt; /home/candidate/user.txt</span><br><span class="line">kubectl get secrets db2-test -o jsonpath=<span class="string">'&#123;.data.password&#125;'</span> | base64 -d &gt; /home/candidate/pass.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">### 创建 secret</span></span><br><span class="line">kubectl -n istio-system create secret generic db2-test --from-literal=username=production-instance --from-literal=password=KvLftKgs4aVH </span><br><span class="line"><span class="comment"># kubectl create secret generic db2-test -n istio-system --from-literal username=production-instance --from-literal password=KvLftKgs4aVH</span></span><br><span class="line"><span class="comment"># error: exactly one NAME is required, got 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 在 Pod 中以文件形式使用 Secret</span></span><br><span class="line">vim k8s-secret.yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: secret-pod</span><br><span class="line">  namespace: istio-system</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - name: dev-container</span><br><span class="line">    image: nginx</span><br><span class="line">    volumeMounts:</span><br><span class="line">    - name: secret-volume</span><br><span class="line">      mountPath: <span class="string">"/etc/secret"</span></span><br><span class="line">      readOnly: <span class="literal">true</span></span><br><span class="line">  volumes:</span><br><span class="line">  - name: secret-volume</span><br><span class="line">    secret:</span><br><span class="line">      secretName: db2-test</span><br><span class="line">      optional: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 应用清单文件</span></span><br><span class="line">kubectl apply -f k8s-secret.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment">### 验证 pod</span></span><br><span class="line">kubectl get pods -n istio-system dev-pod</span><br></pre></td></tr></table></figure>
<h3 id="考题12-dockerfile-和-deployment-安全优化">考题12 - dockerfile 和 deployment 安全优化</h3>
<h4 id="task-v11">Task</h4>
<ul>
<li>Analyze and edit the given Dockerfile (based on the ubuntu:16.04 image) <code>/cks/docker/Dockerfile</code> fixing two instructions present in the file being prominent security/best-practice issues.</li>
<li>Analyze and edit the given manifest file <code>/cks/docker/deployment.yaml</code> fixing two fields present in the file being prominent security/best-practice issues.</li>
</ul>
<p>Don’t add or remove configuration settings; only modify the existing configuration settings, so that two configuration settings each are no longer security/best-practice concerns.</p>
<p>Should you need an unprivileged user for any of the tasks, use user <code>nobody</code> with user id <code>65535</code>.</p>
<blockquote>
<ul>
<li>分析和编辑给定的 Dockerfile <code>/cks/docker/Dockerfile</code>（基于 ubuntu:16.04 镜像），并修复在文件中拥有的突出的安全/最佳实践问题的两个指令。</li>
<li>分析和编辑给定的清单文件 <code>/cks/docker/deployment.yaml</code>，并修复在文件中拥有突出的安全/最佳实践问题的两个字段。</li>
</ul>
<p>注意：请勿添加或删除配置设置；只需修改现有的配置设置让以上两个配置设置都不再有安全/最佳实践问题。<br>
注意：如果您需要非特权用户来执行任何项目，请使用用户 ID 65535 的用户 nobody 。<br>
答题： 注意，本次的 Dockerfile 和 deployment.yaml 仅修改即可，无需部署。</p>
</blockquote>
<h4 id="solution-12">Solution 12</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 修复 dockerfile 文件中存在的两个安全/最佳实践指令</span></span><br><span class="line"><span class="comment">### (1)把ubuntu:latest改为ubuntu:16.04 (2)将 root 注释掉；增加 nobody</span></span><br><span class="line">vim /cks/docker/Dockerfile</span><br><span class="line"><span class="comment"># FROM ubuntu:latest  1 修改</span></span><br><span class="line">FROM ubuntu:16.04</span><br><span class="line"><span class="comment">#USER root </span></span><br><span class="line">USER nobody <span class="comment"># 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 修复 deployment 文件中存在的两个安全/最佳实践问题字段</span></span><br><span class="line"><span class="comment">### (1)将 privileged 变为 False；(2)将 readOnlyRootFilesystem 变为 True 3 check runAsUser 65535</span></span><br><span class="line">vim /cks/docker/deployment.yaml</span><br><span class="line"></span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    app: dev</span><br><span class="line">  name: dev</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: dev</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: dev</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - image: mysql</span><br><span class="line">        name: mysql</span><br><span class="line">        securityContext: &#123;<span class="string">'capabilities'</span>:&#123;<span class="string">'add'</span>:[<span class="string">'NET_ADMIN'</span>],<span class="string">'drop'</span>:[<span class="string">'all'</span>]&#125;,<span class="string">'privileged'</span>: False,<span class="string">'readOnlyRootFilesystem'</span>: True, <span class="string">'runAsUser'</span>: 65535&#125;</span><br></pre></td></tr></table></figure>
<h3 id="考题13-admission-controllers-imagepolicywebhook">考题13 - admission-controllers - ImagePolicyWebhook</h3>
<h4 id="context-v5">Context</h4>
<p>A container image scanner is set up on the cluster, but it’s not yet fully integrated into the cluster’s configuration. When complete, the container image scanner shall scan for and reject the use of vulnerable images.</p>
<p>cluster 上设置了容器镜像扫描器，但尚未完全集成到 cluster 的配置中。完成后，容器镜像扫描器应扫描并拒绝易受攻击的镜像的使用。</p>
<h4 id="task-v12">Task</h4>
<p>You have to complete the entire task on the cluster’s <code>master</code> node, where all services and files have been prepared and placed.<br>
Given an incomplete configuration in directory <code>/etc/kubernetes/epconfig</code> and a functional container image scanner with HTTPS endpoint <code>https://acme.local:8082/image_policy</code>:</p>
<ol>
<li>Enable the necessary plugins to create an image policy</li>
<li>validate the control configuration and change it to an implicit deny</li>
<li>Edit the configuration to point to the provided HTTPS endpoint correctly.</li>
<li>Finally , test if the configuration is working by trying to deploy the vulnerable resource  <code>/cks/1/web1.yaml</code></li>
</ol>
<p>You can find the container image scanner’s log file at <code>/var/loglimagepolicyiacme.log</code></p>
<p>注意：你必须在 cluster 的 master 节点上完成整个考题，所有服务和文件都已被准备好并放置在该节点上。 给定一个目录 <code>/etc/kubernetes/epconfig</code> 中不完整的配置以及具有 HTTPS 端点 <code>https://acme.local:8082/image_policy</code> 的功能性容器镜像扫描器：</p>
<ol>
<li>启用必要的插件来创建镜像策略</li>
<li>校验控制配置并将其更改为隐式拒绝（implicit deny）</li>
<li>编辑配置以正确指向提供的 HTTPS 端点</li>
<li>最后，通过尝试部署易受攻击的资源 <code>/cks/img/web1.yaml</code> 来测试配置是否有效。</li>
</ol>
<p>你可以在 <code>/var/log/imagepolicy/roadrunner.log</code> 找到容器镜像扫描仪的日志文件。</p>
<h4 id="solution-v9">Solution</h4>
<p>搜索 imagepolicywebhook（使用准入控制器），接着再搜索字符串&quot;imagepolicywebhook&quot;<br>
<a href="https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/admission-controllers/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/admission-controllers/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 0 master node</span></span><br><span class="line">ssh masterNode</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /etc/kubernetes/epconfig</span><br><span class="line">ls</span><br><span class="line">  admission_configuration.json kubeconfig.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment">###  查看config-file路径</span></span><br><span class="line">cat /etc/kubernetes/manifests/kube-apiserver.yaml | grep --admission-control-config-file</span><br><span class="line">    - --admission-control-config-file=/etc/kubernetes/epconfig/admission_configuration.json </span><br><span class="line"></span><br><span class="line"><span class="comment">### 1 验证控制平面的配置并将其更改为拒绝</span></span><br><span class="line">vim /etc/kubernetes/epconfig/admission_configuration.json</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">"apiVersion"</span>: <span class="string">"apiserver.config.k8s.io/v1"</span>,</span><br><span class="line">   <span class="attr">"kind"</span>: <span class="string">"AdmissionConfiguration"</span>,</span><br><span class="line">   <span class="attr">"plugins"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="attr">"name"</span>: <span class="string">"ImagePolicyWebhook"</span>,</span><br><span class="line">         <span class="attr">"configuration"</span>: &#123;</span><br><span class="line">            <span class="attr">"imagePolicy"</span>: &#123;</span><br><span class="line">               <span class="attr">"kubeConfigFile"</span>: <span class="string">"/etc/kubernetes/epconfig/kubeconfig.yaml"</span>, <span class="comment">// 1.1 kubeconfig</span></span><br><span class="line">               <span class="attr">"allowTTL"</span>: <span class="number">100</span>,</span><br><span class="line">               <span class="attr">"denyTTL"</span>: <span class="number">50</span>,</span><br><span class="line">               <span class="attr">"retryBackoff"</span>: <span class="number">500</span>,</span><br><span class="line">               <span class="attr">"defaultAllow"</span>: <span class="literal">false</span>   <span class="comment">// 1.2 modify from true to false</span></span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">### 2 编辑配置以正确指向提供的 HTTPS 端点</span></span><br><span class="line">vim kubeconfig.yaml</span><br><span class="line">    apiVersion: v1</span><br><span class="line">    kind: Config</span><br><span class="line">    clusters:</span><br><span class="line">    - cluster:</span><br><span class="line">        certificate-authority: /etc/kubernetes/epconfig/webhook.pem</span><br><span class="line">        server: https://acme.local:8082/image_policy   <span class="comment"># 2 配置此步</span></span><br><span class="line">    name: bouncer_webhook</span><br><span class="line"></span><br><span class="line"><span class="comment">### 3 启用必要的插件以创建镜像策略</span></span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line"></span><br><span class="line">    - --<span class="built_in">enable</span>-admission-plugins=NodeRestriction,ImagePolicyWebhook  <span class="comment"># 3.1 Add ImagePolicyWebhook</span></span><br><span class="line">    - --admission-control-config-file=/etc/kubernetes/epconfig/admission_configuration.json  <span class="comment"># 3.2 Check config-file path</span></span><br><span class="line">    ......</span><br><span class="line">    volumeMounts:                         <span class="comment"># 3.3 Check Mount, can search audit log in kubernetes.io</span></span><br><span class="line">    - mountPath: /etc/kubernetes/epconfig</span><br><span class="line">      name: config</span><br><span class="line">      readyOnly: <span class="literal">false</span></span><br><span class="line">  volumes:</span><br><span class="line">  - hostPath:</span><br><span class="line">      path: /etc/kubernetes/epconfig</span><br><span class="line">      <span class="built_in">type</span>: DirectoryOrCreate</span><br><span class="line">    name: config</span><br><span class="line"></span><br><span class="line"><span class="comment">### 4 加载生效配置</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart kubelet</span><br><span class="line"></span><br><span class="line"><span class="comment">### 5 通过部署易受攻击的资源来测试配置是否有效</span></span><br><span class="line">kubectl apply -f /cks/img/web1.yaml</span><br></pre></td></tr></table></figure>
<h3 id="考题14-删除非无状态或非不可变的-pod">考题14 - 删除非无状态或非不可变的 pod</h3>
<p>Context: it is best-practice to design containers to be stateless and immutable</p>
<h4 id="task-v13">Task</h4>
<p>Inspect Pods runnings in namespace <code>production</code> and delete any Pod that is either not stateless or not immutable.</p>
<p>Use the following strict interpretation of stateless and immutable:</p>
<ul>
<li>Pod being able to store data inside containers must be treated as not stateless. You don’t have to worry whether data is actually stored inside containers or not already.</li>
<li>Pod being configured to be <code>privileged</code> in any way must be treated as potentially not stateless and not immutable.</li>
</ul>
<p>检查在 namespace production 中运行的 Pod，并删除任何非无状态或非不可变的 Pod。<br>
使用以下对无状态和不可变的严格解释：</p>
<ul>
<li>能够在容器内存储数据的 Pod 的容器必须被视为非无状态的。</li>
<li>被配置为任何形式的特权 Pod 必须被视为可能是非无状态和非不可变的。<br>
注意：你不必担心数据是否实际上已经存储在容器中。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 在命名空间 dev 中检查 running 状态的 pod</span></span><br><span class="line">kubectl get pods -n production | grep running -i</span><br><span class="line"></span><br><span class="line"><span class="comment">### 查看具有特权的 pod</span></span><br><span class="line">kubectl get pods -n production -oyaml | grep -i <span class="string">"privileged: true"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 查看具有 volume 的 pod</span></span><br><span class="line"><span class="comment"># jq 用于处理JSON输入，将给定过滤器应用于其JSON文本输入并在标准输出上将过滤器的结果生成为JSON。</span></span><br><span class="line">kubectl get pods -n production -o jsonpath=&#123;.spec.volumes&#125; | jq</span><br><span class="line"></span><br><span class="line"><span class="comment">### 将查询到的具有特权和 volume 的 pod 都删除</span></span><br><span class="line">kubectl delete pods -n production pod名称</span><br></pre></td></tr></table></figure>
<h3 id="考题15-gvisor-runtimeclass">考题15 - gVisor/runtimeclass</h3>
<h4 id="context-v6">Context</h4>
<p>This cluster uses containerd as CRI runtime.<br>
Containerd’s default runtime handler is <code>runc</code> . Containerd has been prepared to support an additional runtime handler , <code>runsc</code> (gVisor).</p>
<blockquote>
<p>该 cluster 使用 containerd 作为 CRI 运行时。<br>
containerd 的默认运行时处理程序是 <code>runc</code>。 containerd 已准备好支持额外的运行时处理程序 <code>runsc</code> (gVisor)。</p>
</blockquote>
<h4 id="task-v14">Task</h4>
<p>Create a RuntimeClass named <code>untrusted</code> using the prepared runtime handler named <code>runsc</code>.<br>
Update all Pods in the namespace <code>server</code> to run on gvisor, unless they are already running on <code>anon-default</code> runtime handler.<br>
You can find a skeleton manifest file at <code>/cks/13/rc.yaml</code></p>
<blockquote>
<p>使用名为 <code>runsc</code> 的现有运行时处理程序，创建一个名为 <code>untrusted</code> 的 RuntimeClass。<br>
更新 namespace <code>server</code> 中的所有 Pod 以在 gVisor 上运行。<br>
您可以在 <code>/cks/gVisor/rc.yaml</code> 中找到一个模版清单</p>
</blockquote>
<h4 id="solution-v10">Solution</h4>
<p>搜索 runtimeclass（容器运行时类）<br>
<a href="https://kubernetes.io/zh-cn/docs/concepts/containers/runtime-class/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/concepts/containers/runtime-class/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 修改模板清单文件</span></span><br><span class="line">vim /cks/gVisor/rc.yaml</span><br><span class="line">    apiVersion: node.k8s.io/v1</span><br><span class="line">    kind: RuntimeClass</span><br><span class="line">    metadata:</span><br><span class="line">      name: untrusted</span><br><span class="line">    handler: runsc</span><br><span class="line"></span><br><span class="line"><span class="comment">### 应用清单文件</span></span><br><span class="line">kubectl apply -f /cks/gVisor/rc.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment">### 修改 server 命名空间下的所有 pod（还需要修改deployment）</span></span><br><span class="line">kubectl get pods -n server</span><br><span class="line">kubectl get deployments -n server</span><br><span class="line"></span><br><span class="line">kubectl get pods -n server -oyaml &gt; myrc.yaml</span><br><span class="line">vim myrc.yaml</span><br><span class="line">spec:</span><br><span class="line">  ......</span><br><span class="line">  runtimeClassName: untrusted</span><br><span class="line"></span><br><span class="line"><span class="comment">### 更新清单文件</span></span><br><span class="line">kubectl delete -f myrc.yaml</span><br><span class="line">kubectl apply -f myrc.yaml</span><br></pre></td></tr></table></figure>
<h3 id="考题16-启用-api-server-认证">考题16 - 启用 API Server 认证</h3>
<h4 id="context-v7">Context</h4>
<p>由 kubeadm 创建的 cluster 的 Kubernetes API 服务器，出于测试目的，临时配置允许未经身份验证和未经授权的访问，授予匿名用户 <code>cluster-admin</code> 的访问权限。</p>
<h4 id="task-v15">Task</h4>
<p>重新配置 cluster 的 Kubernetes API 服务器，以确保<strong>只允许经过身份验证和授权</strong>的 REST 请求。<br>
使用授权模式 <code>Node</code>,<code>RBAC</code> 和准入控制器 <code>NodeRestriction。</code><br>
删除用户 <code>system:anonymous</code> 的 ClusterRoleBinding 来进行清理。<br>
注意：所有 kubectl 配置环境/文件也被配置使用未经身份验证和未经授权的访问。 你不必更改它，但请注意，一旦完成 cluster 的安全加固， kubectl 的配置将无法工作。 您可以使用位于 cluster 的 master 节点上，cluster 原本的 kubectl 配置文件 /etc/kubernetes/admin.conf ，以确保经过身份验证的授权的请求仍然被允许。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k get nodes</span><br><span class="line"></span><br><span class="line"><span class="comment">### 注意：修改 master 节点！</span></span><br><span class="line">ssh masterNode</span><br><span class="line"></span><br><span class="line"><span class="comment">### (1)使用授权模式 Node,RBAC 和准入控制器 NodeRestriction</span></span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line">    - --authorization-mode=Node,RBAC              <span class="comment"># modify  Node,RBAC </span></span><br><span class="line">    - --<span class="built_in">enable</span>-admission-plugins=NodeRestriction  <span class="comment"># modify  NodeRestriction</span></span><br><span class="line">    - --client-ca-file=/etc/kubernetes/pki/ca.crt</span><br><span class="line">    - --<span class="built_in">enable</span>-bootstrap-token-auth=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### (2)删除 system:anonymous 的 ClusterRolebinding 角色绑定（取消匿名用户的集群管理员权限）</span></span><br><span class="line">k get clusterrolebinding -A | grep system:anonymous</span><br><span class="line">kubectl delete clusterrolebinding system:anonymous</span><br></pre></td></tr></table></figure>
<h2 id="参考文章">参考文章</h2>
<ul>
<li>CKS 真题
<ul>
<li><a href="https://huaweicloud.csdn.net/638db1b2dacf622b8df8c678.html" target="_blank" rel="noopener">2022年11月最新CKS认证题库</a></li>
<li><a href="https://huaweicloud.csdn.net/638db1a8dacf622b8df8c643.html?spm=1001.2101.3001.6650.5&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Eactivity-5-126962402-blog-123994683.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Eactivity-5-126962402-blog-123994683.pc_relevant_default&amp;utm_relevant_index=6" target="_blank" rel="noopener">2022.10 CKS考试题库v1.24</a></li>
<li><a href="https://huaweicloud.csdn.net/638db200dacf622b8df8c7f0.html?spm=1001.2101.3001.6650.3&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EYuanLiJiHua%7Eactivity-3-127131284-blog-123994683.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EYuanLiJiHua%7Eactivity-3-127131284-blog-123994683.pc_relevant_default&amp;utm_relevant_index=4" target="_blank" rel="noopener">2022.10 CKS 1.24真题解析</a></li>
<li><a href="https://blog.csdn.net/cloud_engineer/article/details/125709403?spm=1001.2101.3001.6650.7&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-7-125709403-blog-123994683.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-7-125709403-blog-123994683.pc_relevant_default&amp;utm_relevant_index=8" target="_blank" rel="noopener">2022.8 kubernets CKS内容及题库</a></li>
<li><a href="https://blog.csdn.net/zfw_666666/article/details/125185751" target="_blank" rel="noopener">2022.6 CKS认证考题+解析</a></li>
<li><a href="https://blog.csdn.net/april_4?type=blog" target="_blank" rel="noopener">2022.3 CKS 1.23 真题</a></li>
<li><a href="https://huaweicloud.csdn.net/63311d5fd3efff3090b52a1e.html?spm=1001.2101.3001.6650.9&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Eactivity-9-122525427-blog-123994683.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Eactivity-9-122525427-blog-123994683.pc_relevant_default&amp;utm_relevant_index=10" target="_blank" rel="noopener">2022.1 cks 试题</a></li>
<li><a href="https://huaweicloud.csdn.net/638db4efdacf622b8df8cc95.html" target="_blank" rel="noopener">2021.12 Kubernetes CKS 1.20 - 真题 15道题</a></li>
<li><a href="https://blog.csdn.net/itsaka/category_11111851.html" target="_blank" rel="noopener">2021 Kubernetes CKS 1.20 - 真题 15道题</a></li>
</ul>
</li>
<li>CKS其他
<ul>
<li><a href="https://blog.csdn.net/u011127242/article/details/125822057" target="_blank" rel="noopener">CKS考试知识点链接</a></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes CKS 知识点&amp;练习题</title>
    <url>/Kubernetes-CKS-%E7%9F%A5%E8%AF%86%E7%82%B9-%E7%BB%83%E4%B9%A0%E9%A2%98.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="pod-security-policies-psp">Pod Security Policies(PSP)</h2>
<p>Reference:</p>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/security/pod-security-policy/" target="_blank" rel="noopener">k8s Pod Security Policy官方文档</a>
<ul>
<li><a href="https://kubernetes.io/zh-cn/blog/2021/04/06/podsecuritypolicy-deprecation-past-present-and-future/" target="_blank" rel="noopener">PodSecurityPolicy Deprecation: Past, Present, and Future</a></li>
</ul>
</li>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/pod-security-policy.html" target="_blank" rel="noopener">aws eks 官方文档</a></li>
<li><a href="https://www.appvia.io/blog/podsecuritypolicy-is-dead-long-live/" target="_blank" rel="noopener">PodSecurityPolicy is Dead, Long Live…?</a></li>
<li><a href="https://docs.bitnami.com/kubernetes/faq/configuration/understand-pod-security-policies/" target="_blank" rel="noopener">https://docs.bitnami.com/kubernetes/faq/configuration/understand-pod-security-policies/</a></li>
</ul>
<blockquote>
<p>Removed feature<br>
PodSecurityPolicy was deprecated in Kubernetes <code>v1.21</code>, and removed from Kubernetes in <code>v1.25</code>.<br>
Use <a href="https://kubernetes.io/docs/concepts/security/pod-security-admission/" target="_blank" rel="noopener"><code>Pod Security Admission</code></a>instead.</p>
</blockquote>
<p>A Pod Security Policy is a <strong>cluster-level</strong> resource that controls security sensitive aspects of the <strong>pod</strong> specification.</p>
<h2 id="apparmor"><a href="https://kubernetes.io/docs/tutorials/security/apparmor/" target="_blank" rel="noopener">AppArmor</a></h2>
<p><a href="https://blog.csdn.net/cloud_engineer/article/details/125659959" target="_blank" rel="noopener">kubernetes CKS 3.2 AppArmor限制容器对资源访问</a></p>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/apparmor" target="_blank" rel="noopener">Manage AppArmor profiles and Pods using these</a></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKS/AppArmor1-Check%20existing%20AppArmor%20profiles.png" alt="apparmor1"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKS/AppArmor2-deployment.png" alt="apparmor1"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKS/AppArmor2-deployment2.png" alt="AppArmor2-deployment2.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKS/AppArmor2-deployment3beforeChange.png" alt="AppArmor2-deployment3beforeChange.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKS/AppArmor2-deployment4.png" alt="AppArmor2-deployment4.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKS/AppArmor2-deployment5.png" alt="AppArmor2-deployment5.png"></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/CKS/AppArmor3-install%20profile.png" alt="AppArmor3-install profile.png"></p>
<h2 id="apiserver-crash">Apiserver Crash</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/apiserver-crash" target="_blank" rel="noopener">Crash that Apiserver and check them logs</a></p>
<p>kube-apiserver.yaml Location: <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code></p>
<p>Log locations to check:</p>
<ul>
<li><code>/var/log/pods</code></li>
<li><code>/var/log/containers</code></li>
<li><code>crictl ps</code> + <code>crictl logs</code></li>
<li><code>docker ps</code> + <code>docker logs</code> (in case when Docker is used)</li>
<li>kubelet logs: <code>/var/log/syslog</code> or <code>journalctl</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># smart people use a backup</span></span><br><span class="line">cp ~/kube-apiserver.yaml.ori /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># wait till container restarts</span></span><br><span class="line">watch crictl ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># check for apiserver pod</span></span><br><span class="line">k -n kube-system get pod</span><br></pre></td></tr></table></figure>
<p>Give the Apiserver some time to restart itself, like 1-2 minutes. If it doesn’t restart by itself you can also force it with:</p>
<ul>
<li>1: <code>mv /etc/kubernetes/manifests/kube-apiserver.yaml /tmp/kube-apiserver.yaml</code></li>
<li>2: wait till container is removed with <code>watch crictl ps</code></li>
<li>3: <code>mv /tmp/kube-apiserver.yaml /etc/kubernetes/manifests/kube-apiserver.yaml</code></li>
</ul>
<h3 id="configure-a-wrong-argument">Configure a wrong argument</h3>
<p>The idea here is to misconfigure the Apiserver in different ways, then check possible log locations for errors.</p>
<p>You should be very comfortable with situations where the Apiserver is not coming back up.</p>
<p>Configure the Apiserver manifest with a new argument <code>--this-is-very-wrong</code> .</p>
<p>Check if the Pod comes back up and what logs this causes.</p>
<p>Fix the Apiserver again.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># always make a backup !</span></span><br><span class="line">cp /etc/kubernetes/manifests/kube-apiserver.yaml ~/kube-apiserver.yaml.ori</span><br><span class="line"></span><br><span class="line"><span class="comment"># make the change</span></span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># wait till container restarts</span></span><br><span class="line">watch crictl ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># check for apiserver pod</span></span><br><span class="line">k -n kube-system get pod</span><br></pre></td></tr></table></figure>
<p>Apiserver is not coming back, we messed up!</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># check pod logs</span></span><br><span class="line">cat /var/<span class="built_in">log</span>/pods/kube-system_kube-apiserver-controlplane_a3a455d471f833137588e71658e739da/kube-apiserver/X.log</span><br><span class="line">&gt; 2022-01-26T10:41:12.401641185Z stderr F Error: unknown flag: --this-is-very-wrong</span><br></pre></td></tr></table></figure>
<p>Now undo the change and continue</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># smart people use a backup</span></span><br><span class="line">cp ~/kube-apiserver.yaml.ori /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># wait till container restarts</span></span><br><span class="line">watch crictl ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># check for apiserver pod</span></span><br><span class="line">k -n kube-system get pod</span><br></pre></td></tr></table></figure>
<h3 id="misconfigure-etcd-connection">Misconfigure ETCD connection</h3>
<p>Change the existing Apiserver manifest argument to: <code>--etcd-servers=this-is-very-wrong</code> .</p>
<p>Check what the logs say, without using anything in <code>/var</code> .</p>
<p>Fix the Apiserver again.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># always make a backup !</span></span><br><span class="line">cp /etc/kubernetes/manifests/kube-apiserver.yaml ~/kube-apiserver.yaml.ori</span><br><span class="line"></span><br><span class="line"><span class="comment"># make the change</span></span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># wait till container restarts</span></span><br><span class="line">watch crictl ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># check for apiserver pod</span></span><br><span class="line">k -n kube-system get pod</span><br></pre></td></tr></table></figure>
<p>Apiserver is not coming back, we messed up!</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1) if we would check the /var directory</span></span><br><span class="line">cat /var/<span class="built_in">log</span>/pods/kube-system_kube-apiserver-controlplane_e24b3821e9bdc47a91209bfb04056993/kube-apiserver/X.log</span><br><span class="line">&gt; Err: connection error: desc = <span class="string">"transport: Error while dialing dial tcp: address this-is-very-wrong: missing port in address"</span>. Reconnecting...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) but here we want to find other ways, so we check the container logs</span></span><br><span class="line">crictl ps <span class="comment"># maybe run a few times, because the apiserver container get's restarted</span></span><br><span class="line">CONTAINER           IMAGE               CREATED             STATE               NAME                      ATTEMPT             POD ID              POD</span><br><span class="line">062e4db76ac48       a31e1d84401e6       10 minutes ago      Running             kube-apiserver            0                   2641ca9ecc8ee       kube-apiserver-controlplane</span><br><span class="line"></span><br><span class="line">crictl logs 2641ca9ecc8ee <span class="comment"># pod ID</span></span><br><span class="line">&gt; Error <span class="keyword">while</span> dialing dial tcp: address this-is-very-wrong: missing port <span class="keyword">in</span> address. Reconnecting...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3) what about syslogs</span></span><br><span class="line">journalctl | grep apiserver <span class="comment"># nothing specific</span></span><br><span class="line">cat /var/<span class="built_in">log</span>/syslog | grep apiserver <span class="comment"># nothing specific</span></span><br></pre></td></tr></table></figure>
<p>Now undo the change and continue</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># smart people use a backup</span></span><br><span class="line">cp ~/kube-apiserver.yaml.ori /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># wait till container restarts</span></span><br><span class="line">watch crictl ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># check for apiserver pod</span></span><br><span class="line">k -n kube-system get pod</span><br></pre></td></tr></table></figure>
<h3 id="invalid-apiserver-manifest-yaml">Invalid Apiserver Manifest YAML</h3>
<p>Change the Apiserver manifest and add invalid YAML, something like this:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersionTHIS IS VERY :::::</span> <span class="string">WRONG</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br></pre></td></tr></table></figure>
<p>Check what the logs say, and fix again.</p>
<p>Fix the Apiserver again.</p>
<p>Apiserver is not coming back, we messed up!</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># seems like the kubelet can't even create the apiserver pod/container</span></span><br><span class="line">/var/<span class="built_in">log</span>/pods <span class="comment"># nothing</span></span><br><span class="line">crictl logs <span class="comment"># nothing</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># syslogs:</span></span><br><span class="line">tail -f /var/<span class="built_in">log</span>/syslog | grep apiserver</span><br><span class="line">&gt; Could not process manifest file err=<span class="string">"/etc/kubernetes/manifests/kube-apiserver.yaml: couldn't parse as pod(yaml: mapping values are not allowed in this context), please check config file"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># or:</span></span><br><span class="line">journalctl | grep apiserver</span><br><span class="line">&gt; Could not process manifest file<span class="string">" err="</span>/etc/kubernetes/manifests/kube-apiserver.yaml: couldn<span class="string">'t parse as pod(yaml: mapping values are not allowed in this context), please check config file</span></span><br></pre></td></tr></table></figure>
<h2 id="apiserver-misconfigured">Apiserver Misconfigured</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/apiserver-misconfigured" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/apiserver-misconfigured</a></p>
<p>Make sure to have solved the previous Scenario Apiserver Crash.<br>
The Apiserver is not coming up, the manifest is misconfigured in <code>3</code> places. Fix it.</p>
<h3 id="issues">Issues</h3>
<p>For your changes to apply you might have to:</p>
<p>move the kube-apiserver.yaml out of the manifests directory<br>
wait for apiserver container to be gone (watch crictl ps )<br>
move the manifest back in and wait for apiserver coming back up<br>
Some users report that they need to restart the kubelet (service kubelet restart ) but in theory this shouldn’t be necessary.</p>
<h3 id="solution-1">Solution 1</h3>
<p>The kubelet cannot even create the Pod/Container. Check the kubelet logs in syslog for issues.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /var/<span class="built_in">log</span>/syslog | grep kube-apiserver</span><br></pre></td></tr></table></figure>
<p>There is wrong YAML in the manifest at <code>metadata;</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:  <span class="comment"># `metadata;` 改为 "metadata:"</span></span><br></pre></td></tr></table></figure>
<h3 id="solution-2">Solution 2</h3>
<p>After fixing the wrong YAML there still seems to be an issue with a wrong parameter.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Check logs in `/var/log/pods`.</span></span><br><span class="line"><span class="built_in">cd</span> /var/<span class="built_in">log</span>/pods</span><br><span class="line"><span class="built_in">cd</span> /kube-system_kube-apiserver-controlplane_24f6c7045a5830f4ff3dd5c63e8bd9cb/kube-apiserver/</span><br><span class="line">ls</span><br><span class="line">    5.log</span><br><span class="line">cat 5.log</span><br><span class="line">    Error: Error: unknown flag: --authorization-modus.</span><br><span class="line"><span class="comment"># The correct parameter is --authorization-mode.</span></span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line">    - --authorization-mode=Node,RBAC <span class="comment"># 修改--authorization-modus</span></span><br></pre></td></tr></table></figure>
<h3 id="solution-3">Solution 3</h3>
<p>After fixing the wrong parameter, the pod/container might be up, but gets restarted.</p>
<p>Check container logs or /var/log/pods, where we should find:</p>
<p>Error while dialing dial tcp 127.0.0.1:23000: connect:connection refused</p>
<p>Check the container logs: the ETCD connection seems to be wrong. Set the correct port on which ETCD is running (check the ETCD manifest)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line">  - --etcd-servers=https://127.0.0.1:2379 <span class="comment"># 修改--etcd-servers=https://127.0.0.1:23000 为--etcd-servers=https://127.0.0.1:2379</span></span><br></pre></td></tr></table></figure>
<h2 id="apiserver-noderestriction"><a href="https://killercoda.com/killer-shell-cks/scenario/apiserver-node-restriction" target="_blank" rel="noopener">Apiserver NodeRestriction</a></h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/apiserver-node-restriction" target="_blank" rel="noopener">admission controller - Use the NodeRestriction Admission Controller to restrict Kubelet’s permissions</a></p>
<h3 id="verify-the-issue">Verify the issue</h3>
<p>The Kubelet on <code>node01</code> shouldn’t be able to set Node labels</p>
<ul>
<li>starting with <code>node-restriction.kubernetes.io/*</code></li>
<li>on other Nodes than itself （不能label其他node，只能label本node：<code>node01</code>）</li>
</ul>
<p>Verify this is not restricted atm by performing the following actions as the Kubelet from node01 :</p>
<ul>
<li>add label <code>killercoda/one=123</code> to Node <code>controlplane</code></li>
<li>add label <code>node-restriction.kubernetes.io/one=123</code> to Node <code>node01</code></li>
</ul>
<h4 id="tip">Tip</h4>
<p>We can contact the Apiserver as the Kubelet by using the Kubelet kubeconfig</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> KUBECONFIG=/etc/kubernetes/kubelet.conf</span><br><span class="line">k get node</span><br></pre></td></tr></table></figure>
<h4 id="solution">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh node01</span><br><span class="line">    <span class="built_in">export</span> KUBECONFIG=/etc/kubernetes/kubelet.conf</span><br><span class="line">    k label node controlplane killercoda/one=123 <span class="comment"># works but should be restricted 现在可以成功加label，但是我们应该更改配置使得它满足题目要求：be restricted</span></span><br><span class="line">    node/controlplane labeled</span><br><span class="line">    k label node node01 node-restriction.kubernetes.io/one=123 <span class="comment"># works but should be restricted</span></span><br><span class="line">    node/node01 labeled</span><br><span class="line"></span><br><span class="line">    k get node --show-labels </span><br><span class="line">NAME           STATUS   ROLES           AGE   VERSION   LABELS</span><br><span class="line">controlplane   Ready    control-plane   20d   v1.25.3   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,killercoda/one=123,kubernetes.io/arch=amd64,kubernetes.io/hostname=controlplane,kubernetes.io/os=linux,node-role.kubernetes.io/control-plane=,node.kubernetes.io/exclude-from-external-load-balancers=</span><br><span class="line">node01         Ready    &lt;none&gt;          20d   v1.25.3   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=node01,kubernetes.io/os=linux,node-restriction.kubernetes.io/one=123</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以看到两个label都成功加上了</span></span><br></pre></td></tr></table></figure>
<h3 id="enable-the-noderestriction-admission-controller">Enable the NodeRestriction Admission Controller</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">node01 $ <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">logout</span></span><br><span class="line">Connection to node01 closed.</span><br><span class="line">controlplane $ vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - <span class="built_in">command</span>:</span><br><span class="line">    - kube-apiserver</span><br><span class="line">    - --advertise-address=172.30.1.2</span><br><span class="line">    - --allow-privileged=<span class="literal">true</span></span><br><span class="line">    - --authorization-mode=Node,RBAC</span><br><span class="line">    - --client-ca-file=/etc/kubernetes/pki/ca.crt</span><br><span class="line">    - --<span class="built_in">enable</span>-admission-plugins=NodeRestriction    <span class="comment"># Add this line</span></span><br><span class="line">    - --<span class="built_in">enable</span>-bootstrap-token-auth=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh node01</span><br><span class="line">    <span class="built_in">export</span> KUBECONFIG=/etc/kubernetes/kubelet.conf</span><br><span class="line">    k label node controlplane killercoda/two=123 <span class="comment"># restricted</span></span><br><span class="line">      Error from server (Forbidden): nodes <span class="string">"controlplane"</span> is forbidden: node <span class="string">"node01"</span> is not allowed to modify node <span class="string">"controlplane"</span></span><br><span class="line"></span><br><span class="line">    k label node node01 node-restriction.kubernetes.io/two=123 <span class="comment"># restricted</span></span><br><span class="line">      Error from server (Forbidden): nodes <span class="string">"node01"</span> is forbidden: is not allowed to modify labels: node-restriction.kubernetes.io/two</span><br><span class="line"></span><br><span class="line">    k label node node01 <span class="built_in">test</span>/two=123 <span class="comment"># works</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># other test</span></span><br><span class="line">    k label node controlplane <span class="built_in">test</span>/two=123</span><br><span class="line">      Error from server (Forbidden): nodes <span class="string">"controlplane"</span> is forbidden: node <span class="string">"node01"</span> is not allowed to modify node <span class="string">"controlplane"</span></span><br></pre></td></tr></table></figure>
<p>Notice that existing restricted labels won’t be removed once the NodeRestriction is enabled.</p>
<h2 id="imagepolicywebhook"><a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#imagepolicywebhook" target="_blank" rel="noopener">ImagePolicyWebhook</a></h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/image-policy-webhook-setup" target="_blank" rel="noopener">Complete the ImagePolicyWebhook setup</a></p>
<h3 id="complete-the-imagepolicywebhook-setup">Complete the ImagePolicyWebhook setup</h3>
<p>An ImagePolicyWebhook setup has been half finished, complete it:</p>
<ol>
<li>Make sure <code>admission_config.json</code> points to correct kubeconfig</li>
<li>Set the <code>allowTTL</code> to <code>100</code></li>
<li>All Pod creation should be prevented if the external service is not reachable</li>
<li>The external service will be reachable under <code>https://localhost:1234</code> in the future. It doesn’t exist yet so it - shouldn’t be able to create any Pods till then</li>
<li>Register the correct admission plugin in the apiserver</li>
</ol>
<details>
  <summary>Solution</summary>
  <p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># find admission_config.json path in kube-apiserver.yaml</span></span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml <span class="comment"># Find value of --admission-control-config-file</span></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">cat /etc/kubernetes/manifests/kube-apiserver.yaml | grep admission-control-config-file</span><br><span class="line">    - --admission-control-config-file=/etc/kubernetes/policywebhook/admission_config.json</span><br><span class="line"></span><br><span class="line">vim /etc/kubernetes/policywebhook/admission_config.json</span><br></pre></td></tr></table></figure>
</p><p>The <code>/etc/kubernetes/policywebhook/admission_config.json</code> should look like this:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">"apiVersion"</span>: <span class="string">"apiserver.config.k8s.io/v1"</span>,</span><br><span class="line">   <span class="attr">"kind"</span>: <span class="string">"AdmissionConfiguration"</span>,</span><br><span class="line">   <span class="attr">"plugins"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="attr">"name"</span>: <span class="string">"ImagePolicyWebhook"</span>,</span><br><span class="line">         <span class="attr">"configuration"</span>: &#123;</span><br><span class="line">            <span class="attr">"imagePolicy"</span>: &#123;</span><br><span class="line">               <span class="attr">"kubeConfigFile"</span>: <span class="string">"/etc/kubernetes/policywebhook/kubeconf"</span>, <span class="comment">// 1.modify "kubeConfigFile": "/todo/kubeconf" to current</span></span><br><span class="line">               <span class="attr">"allowTTL"</span>: <span class="number">100</span>,  <span class="comment">// 2.modify 50 to 100</span></span><br><span class="line">               <span class="attr">"denyTTL"</span>: <span class="number">50</span>,</span><br><span class="line">               <span class="attr">"retryBackoff"</span>: <span class="number">500</span>,</span><br><span class="line">               <span class="attr">"defaultAllow"</span>: <span class="literal">false</span>   <span class="comment">// 3.modify from true to false</span></span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/kubernetes/policywebhook/kubeconf</span><br></pre></td></tr></table></figure>
<p>The <code>/etc/kubernetes/policywebhook/kubeconf</code> should contain the correct server:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Config</span></span><br><span class="line"><span class="comment"># clusters refers to the remote service.</span></span><br><span class="line"><span class="attr">clusters:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">cluster:</span></span><br><span class="line">    <span class="attr">certificate-authority:</span> <span class="string">/etc/kubernetes/policywebhook/external-cert.pem</span> <span class="comment"># CA for verifying the remote service.</span></span><br><span class="line">    <span class="attr">server:</span> <span class="string">https://localhost:1234</span> <span class="comment"># 4.external service  # URL of remote service to query. Must use 'https'.</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">image-checker</span></span><br><span class="line"></span><br><span class="line"><span class="attr">contexts:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">context:</span></span><br><span class="line">    <span class="attr">cluster:</span> <span class="string">image-checker</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">api-server</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">image-checker</span></span><br><span class="line"><span class="attr">current-context:</span> <span class="string">image-checker</span></span><br><span class="line"><span class="attr">preferences:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># users refers to the API server's webhook configuration.</span></span><br><span class="line"><span class="attr">users:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">api-server</span></span><br><span class="line">  <span class="attr">user:</span></span><br><span class="line">    <span class="attr">client-certificate:</span> <span class="string">/etc/kubernetes/policywebhook/apiserver-client-cert.pem</span>     <span class="comment"># cert for the webhook admission controller to use</span></span><br><span class="line">    <span class="attr">client-key:</span>  <span class="string">/etc/kubernetes/policywebhook/apiserver-client-key.pem</span>             <span class="comment"># key matching the cert</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure>
<p>5 The apiserver needs to be configured with the ImagePolicyWebhook admission plugin:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">command:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">kube-apiserver</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--enable-admission-plugins=NodeRestriction,ImagePolicyWebhook</span> <span class="comment"># 5. Add ImagePolicyWebhook</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--admission-control-config-file=/etc/kubernetes/policywebhook/admission_config.json</span></span><br></pre></td></tr></table></figure>
<p>Luckily the <code>--admission-control-config-file</code> argument seems already to be configured.</p>
  <p></p>
</details>
<details>
  <summary>Test your Solution</summary>
  <p>
Wait till apiserver container restarted: 
</p><p><code>watch crictl ps</code></p>
<p>To test your solution you can simply try to create a Pod:</p>
<p><code>k run pod --image=nginx</code></p>
<p>It should throw you an error like:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Error from server (Forbidden): pods <span class="string">"pod"</span> is forbidden: Post <span class="string">"https://localhost:1234/?timeout=30s"</span>: dial tcp 127.0.0.1:1234: connect: connection refused</span><br></pre></td></tr></table></figure>
<p>Once that service would be implemented and if it would allow the Pod, the Pod could be created.</p>
  <p></p>
</details>
<h2 id="kube-bench"><a href="https://github.com/aquasecurity/kube-bench" target="_blank" rel="noopener">kube-bench</a></h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/cis-benchmarks-kube-bench-fix-controlplane" target="_blank" rel="noopener">cis-benchmarks-kube-bench-fix-controlplane</a></p>
<ul>
<li>Api Server: <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code></li>
<li>Controller Manager pod specification file <code>/etc/kubernetes/manifests/kube-controller-manager.yaml</code></li>
<li>Kubelet: <code>/var/lib/kubelet/config.yaml</code></li>
<li>etcd: <code>/etc/kubernetes/manifests/etcd.yaml</code></li>
</ul>
<h3 id="apiserver-should-be-more-conform-to-cis">Apiserver should be more conform to CIS</h3>
<p>Use <code>kube-bench</code> to ensure <code>1.2.20</code> has status <code>PASS</code>.</p>
<p>Solution</p>
<p>Check for results</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># see all</span></span><br><span class="line">kube-bench run --targets master</span><br><span class="line"></span><br><span class="line"><span class="comment"># or just see the one 推荐这种方法，输出比较少，好看关键信息</span></span><br><span class="line">kube-bench run --targets master --check 1.2.20</span><br><span class="line"></span><br><span class="line">[INFO] 1 Master Node Security Configuration</span><br><span class="line">[INFO] 1.2 API Server</span><br><span class="line">[FAIL] 1.2.20 Ensure that the --profiling argument is <span class="built_in">set</span> to <span class="literal">false</span> (Automated)</span><br><span class="line"></span><br><span class="line">== Remediations master ==</span><br><span class="line">1.2.20 Edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line">on the master node and <span class="built_in">set</span> the below parameter.</span><br><span class="line">--profiling=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>Fix the <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">command:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">kube-apiserver</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--profiling=false</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">k8s.gcr.io/kube-apiserver:v1.22.2</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure>
<p>Now wait for container to be restarted: <code>watch crictl ps</code></p>
<h3 id="controllermanager-should-be-more-conform-to-cis">ControllerManager should be more conform to CIS</h3>
<p>Use <code>kube-bench</code> to ensure <code>1.3.2</code> has status <code>PASS</code>.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 推荐这种方法，输出比较少，好看关键信息</span></span><br><span class="line">kube-bench run --targets=master --check=1.3.2</span><br><span class="line"></span><br><span class="line">[INFO] 1 Master Node Security Configuration</span><br><span class="line">[INFO] 1.3 Controller Manager</span><br><span class="line">[FAIL] 1.3.2 Ensure that the --profiling argument is <span class="built_in">set</span> to <span class="literal">false</span> (Automated)</span><br><span class="line"></span><br><span class="line">== Remediations master ==</span><br><span class="line">1.3.2 Edit the Controller Manager pod specification file /etc/kubernetes/manifests/kube-controller-manager.yaml</span><br><span class="line">on the master node and <span class="built_in">set</span> the below parameter.</span><br><span class="line">--profiling=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>Fix the /etc/kubernetes/manifests/kube-controller-manager.yaml</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">...</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">command:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">kube-controller-manager</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--profiling=false</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">k8s.gcr.io/kube-controller-manager:v1.22.2</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure>
<p>Now wait for container to be restarted: <code>watch crictl ps</code></p>
<h3 id="pki-directory-should-be-more-conform-to-cis">PKI directory should be more conform to CIS</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 推荐这种方法，输出比较少，好看关键信息</span></span><br><span class="line">kube-bench run --check 1.1.19 --targets=master</span><br><span class="line">[INFO] 1 Master Node Security Configuration</span><br><span class="line">[INFO] 1.1 Master Node Configuration Files</span><br><span class="line">[FAIL] 1.1.19 Ensure that the Kubernetes PKI directory and file ownership is <span class="built_in">set</span> to root:root (Automated)</span><br><span class="line"></span><br><span class="line">== Remediations master ==</span><br><span class="line">1.1.19 Run the below <span class="built_in">command</span> (based on the file location on your system) on the master node.</span><br><span class="line">For example,</span><br><span class="line">chown -R root:root /etc/kubernetes/pki/</span><br></pre></td></tr></table></figure>
<p>Fix the /etc/kubernetes/pki/</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chgrp root /etc/kubernetes/pki/</span><br><span class="line"></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">chown -R root:root /etc/kubernetes/pki/</span><br></pre></td></tr></table></figure>
<h2 id="trivy"><a href="https://github.com/aquasecurity/trivy" target="_blank" rel="noopener">Trivy</a></h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/image-vulnerability-scanning-trivy" target="_blank" rel="noopener">Image Vulnerability Scanning Trivy</a></p>
<h3 id="use-trivy-to-scan-images-for-known-vulnerabilities">Use trivy to scan images for known vulnerabilities</h3>
<p>Using <code>trivy</code> :<br>
Scan images in Namespaces <code>applications</code> and <code>infra</code> for the vulnerabilities <code>CVE-2021-28831</code> and <code>CVE-2016-9841</code> .</p>
<p>Scale those Deployments containing any of these down to <code>0</code> .</p>
<p>Solution:</p>
<p>First we check the applications Namespace.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># find images</span></span><br><span class="line">k -n applications get pod -oyaml | grep image:</span><br><span class="line"></span><br><span class="line"><span class="comment"># scan first deployment</span></span><br><span class="line">trivy image nginx:1.19.1-alpine-perl | grep CVE-2021-28831</span><br><span class="line">31.00 MiB / 31.00 MiB [---------------------------------------------------------------------------------------------------] 100.00% 8.41 MiB p/s 4s</span><br><span class="line">| busybox      | CVE-2021-28831   |          | 1.31.1-r9         | 1.31.1-r10    | busybox: invalid free or segmentation |</span><br><span class="line">| ssl_client   | CVE-2021-28831   | HIGH     | 1.31.1-r9         | 1.31.1-r10    | busybox: invalid free or segmentation |</span><br><span class="line"></span><br><span class="line">trivy image nginx:1.19.1-alpine-perl | grep CVE-2016-9841</span><br><span class="line"></span><br><span class="line"><span class="comment"># scan second deployment</span></span><br><span class="line">trivy image nginx:1.20.2-alpine | grep CVE-2021-28831</span><br><span class="line">trivy image nginx:1.20.2-alpine | grep CVE-2016-9841</span><br><span class="line"></span><br><span class="line"><span class="comment"># hit on the first one, so we scale down</span></span><br><span class="line">$ k -n applications get deploy</span><br><span class="line">NAME   READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">web1   2/2     2            2           6m53s</span><br><span class="line">web2   1/1     1            1           6m53s</span><br><span class="line"></span><br><span class="line">$ k -n applications get deploy web1 -oyaml | grep nginx:1.19.1-alpine-perl</span><br><span class="line">      - image: nginx:1.19.1-alpine-perl</span><br><span class="line">$ k -n applications get deploy web2 -oyaml | grep nginx:1.19.1-alpine-perl</span><br><span class="line"></span><br><span class="line">k -n applications get deploy web1 </span><br><span class="line">NAME   READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">web1   2/2     2            2           13m</span><br><span class="line"></span><br><span class="line">k -n applications scale deploy web1 --replicas 0</span><br><span class="line"></span><br><span class="line">$ k -n applications get deploy web1</span><br><span class="line">NAME   READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">web1   0/0     0            0           13m</span><br></pre></td></tr></table></figure>
<p>Next we check the infra Namespace.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># find images</span></span><br><span class="line">k -n infra get pod -oyaml | grep image:</span><br><span class="line"></span><br><span class="line"><span class="comment"># scan deployment</span></span><br><span class="line">trivy image httpd:2.4.39-alpine | grep CVE-2021-28831</span><br><span class="line">trivy image httpd:2.4.39-alpine | grep CVE-2016-9841</span><br><span class="line"></span><br><span class="line"><span class="comment"># hit, so we scale down</span></span><br><span class="line">$ k -n infra get deployments.apps </span><br><span class="line">NAME      READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">inf-hjk   3/3     3            3           16m</span><br><span class="line"></span><br><span class="line">k -n infra scale deploy inf-hjk --replicas 0</span><br><span class="line"></span><br><span class="line">$ k -n infra get deployments.apps </span><br><span class="line">NAME      READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="line">inf-hjk   0/0     0            0           18m</span><br></pre></td></tr></table></figure>
<h2 id="falco">Falco</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/falco-change-rule" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/falco-change-rule</a></p>
<h3 id="investigate-a-falco-rule">Investigate a Falco Rule</h3>
<p>Falco has been installed on Node <code>controlplane</code> and it runs as a service.</p>
<p>It’s configured to log to <code>syslog</code>, and this is where the verification for this scenario also looks.</p>
<p>Cause the rule “shell in a container” to log by:</p>
<ol>
<li>creating a new Pod image <code>nginx:alpine</code></li>
<li><code>kubectl exec pod -- sh</code> into it</li>
<li>check the Falco logs contain a related output</li>
</ol>
<h4 id="tip-v2">Tip</h4>
<p><code>service falco status</code></p>
<p><code>cat /var/log/syslog | grep falco</code></p>
<h4 id="solution-v2">Solution</h4>
<p><code>k run pod --image=nginx:alpine</code></p>
<p><code>k exec -it pod -- sh</code></p>
<p><code>exit</code></p>
<p><code>cat /var/log/syslog | grep falco | grep shell</code></p>
<h3 id="change-a-falco-rule">Change a Falco Rule</h3>
<p>Change the Falco <code>output</code> of rule “Terminal shell in container” to:</p>
<ul>
<li>include <code>NEW SHELL!!!</code> at the very beginning</li>
<li>include <code>user_id=%user.uid</code> at any position</li>
<li>include <code>repo=%container.image.repository</code> at any position</li>
</ul>
<p>Cause syslog output again by creating a shell in that Pod.<br>
Verify the syslogs contain the new data.</p>
<h4 id="tip-v3">Tip</h4>
<p><a href="https://falco.org/docs/rules/supported-fields" target="_blank" rel="noopener">https://falco.org/docs/rules/supported-fields</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/falco/</span><br><span class="line">grep -ri <span class="string">"shell in"</span></span><br></pre></td></tr></table></figure>
<h4 id="solution-v3">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/falco/</span><br><span class="line">cp falco_rules.yaml falco_rules.local.yaml</span><br><span class="line">vim falco_rules.local.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">rule:</span> <span class="string">Terminal</span> <span class="string">shell</span> <span class="string">in</span> <span class="string">container</span></span><br><span class="line">  <span class="attr">desc:</span> <span class="string">A</span> <span class="string">shell</span> <span class="string">was</span> <span class="string">used</span> <span class="string">as</span> <span class="string">the</span> <span class="string">entrypoint/exec</span> <span class="string">point</span> <span class="string">into</span> <span class="string">a</span> <span class="string">container</span> <span class="string">with</span> <span class="string">an</span> <span class="string">attached</span> <span class="string">terminal.</span></span><br><span class="line">  <span class="attr">condition:</span> <span class="string">&gt;</span></span><br><span class="line">    <span class="string">spawned_process</span> <span class="string">and</span> <span class="string">container</span></span><br><span class="line">    <span class="string">and</span> <span class="string">shell_procs</span> <span class="string">and</span> <span class="string">proc.tty</span> <span class="string">!=</span> <span class="number">0</span></span><br><span class="line">    <span class="string">and</span> <span class="string">container_entrypoint</span></span><br><span class="line">    <span class="string">and</span> <span class="string">not</span> <span class="string">user_expected_terminal_shell_in_container_conditions</span></span><br><span class="line">  <span class="attr">output:</span> <span class="string">&gt;</span></span><br><span class="line">    <span class="string">NEW</span> <span class="string">SHELL!!!</span> <span class="string">(user_id=%user.uid</span> <span class="string">repo=%container.image.repository</span> <span class="string">%user.uiduser=%user.name</span> <span class="string">user_loginuid=%user.loginuid</span> <span class="string">%container.info</span></span><br><span class="line">    <span class="string">shell=%proc.name</span> <span class="string">parent=%proc.pname</span> <span class="string">cmdline=%proc.cmdline</span> <span class="string">terminal=%proc.tty</span> <span class="string">container_id=%container.id</span> <span class="string">image=%container.image.repository)</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="string">NOTICE</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">[container,</span> <span class="string">shell,</span> <span class="string">mitre_execution]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service falco restart</span><br><span class="line">k <span class="built_in">exec</span> -it pod -- sh</span><br><span class="line">cat /var/<span class="built_in">log</span>/syslog | grep falco | grep shell</span><br></pre></td></tr></table></figure>
<h2 id="networkpolicy-namespace-selector">NetworkPolicy - namespace selector</h2>
<p>There are existing Pods in Namespace <code>space1</code> and <code>space2</code> .</p>
<p>We need a new NetworkPolicy named <code>np</code> that restricts all Pods in Namespace <code>space1</code> to only have outgoing traffic to Pods in Namespace <code>space2</code> . Incoming traffic not affected.</p>
<p>We also need a new NetworkPolicy named <code>np</code> that restricts all Pods in Namespace <code>space2</code> to only have incoming traffic from Pods in Namespace <code>space1</code> . Outgoing traffic not affected.</p>
<p>The NetworkPolicies should still allow outgoing DNS traffic on port <code>53</code> TCP and UDP.</p>
<h3 id="tip-v4">Tip</h3>
<p>For learning you can check the NetworkPolicy Editor<br>
The namespaceSelector from NPs works with Namespace labels, so first we check existing labels for Namespaces</p>
<h3 id="solution-v4">Solution</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 获取 namespace的label</span></span><br><span class="line">k get ns --show-labels</span><br><span class="line">  NAME              STATUS   AGE     LABELS</span><br><span class="line">  space1            Active   3m9s    kubernetes.io/metadata.name=space1</span><br><span class="line">  space2            Active   3m9s    kubernetes.io/metadata.name=space2</span><br><span class="line"></span><br><span class="line">vim 1.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">NetworkPolicy</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">np</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">space1</span>  <span class="comment"># namespace 已经来表示应用到all Pods in Namespace `space1`</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">podSelector:</span> <span class="string">&#123;&#125;</span> <span class="comment"># 所有pod</span></span><br><span class="line">  <span class="attr">policyTypes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Egress</span></span><br><span class="line">  <span class="attr">egress:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">to:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">namespaceSelector:</span></span><br><span class="line">          <span class="attr">matchLabels:</span></span><br><span class="line">            <span class="attr">kubernetes.io/metadata.name:</span> <span class="string">space2</span>  <span class="comment"># space2的namespace</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">ports:</span> <span class="comment"># 注意加 - 表示或的关系</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">53</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">UDP</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">53</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 2.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">NetworkPolicy</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">np</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">space2</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">podSelector:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">policyTypes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Ingress</span></span><br><span class="line">  <span class="attr">ingress:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">from:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">namespaceSelector:</span></span><br><span class="line">          <span class="attr">matchLabels:</span></span><br><span class="line">            <span class="attr">kubernetes.io/metadata.name:</span> <span class="string">space1</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">53</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">UDP</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">53</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k apply -f 1.yaml</span><br><span class="line">k apply -f 2.yaml</span><br></pre></td></tr></table></figure>
<h2 id="networkpolicy-metadata-protection">NetworkPolicy - Metadata Protection</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/networkpolicy-metadata-protection" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/networkpolicy-metadata-protection</a></p>
<p>Cloud providers can have Metadata Servers which expose critical information, for example GCP or AWS.</p>
<p>For this task we assume that there is a Metadata Server at <code>1.1.1.1</code> .</p>
<p>You can test connection to that IP using <code>nc -v 1.1.1.1 53</code> .</p>
<p>Create a NetworkPolicy named <code>metadata-server</code>In Namespace <code>default</code> which restricts all egress traffic to that IP.</p>
<p>The NetworkPolicy should only affect Pods with label <code>trust=nope</code>.</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">NetworkPolicy</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">metadata-server</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">podSelector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">trust:</span> <span class="string">nope</span></span><br><span class="line">  <span class="attr">policyTypes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Egress</span></span><br><span class="line">  <span class="attr">egress:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">to:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">ipBlock:</span></span><br><span class="line">          <span class="attr">cidr:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">/0</span>  <span class="comment"># all addresses 掩码为0，且0.0.0.0，代表所有地址</span></span><br><span class="line">          <span class="attr">except:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span><span class="string">/32</span> <span class="comment">#</span></span><br></pre></td></tr></table></figure>
<h2 id="rbac-user">RBAC - user</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/rbac-user-permissions" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/rbac-user-permissions</a></p>
<p>There is existing Namespace applications.</p>
<ul>
<li>User <code>smoke</code> should be allowed to <code>create</code> and <code>delete</code> Pods, Deployments and StatefulSets in Namespace <code>applications</code>.</li>
<li>User <code>smoke</code> should have <code>view</code> permissions (like the permissions of the default ClusterRole named <code>view</code> ) in all Namespaces but not in <code>kube-system</code> .</li>
<li>User <code>smoke</code> should be allowed to retrieve available Secret names in Namespace <code>applications</code>. Just the Secret names, no data.</li>
<li>Verify everything using <code>kubectl auth can-i</code> .</li>
</ul>
<h3 id="solution-v5">Solution</h3>
<p>⁣1) RBAC for Namespace applications</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k -n applications create role smoke --verb create,delete --resource pods,deployments,sts</span><br><span class="line">k -n applications create rolebinding smoke --role smoke --user smoke</span><br></pre></td></tr></table></figure>
<p>⁣2) view permission in all Namespaces but not kube-system</p>
<p>As of now it’s not possible to create deny-RBAC in K8s</p>
<p>So we allow for all other Namespaces</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k get ns <span class="comment"># get all namespaces</span></span><br><span class="line">k -n applications create rolebinding smoke-view --clusterrole view --user smoke</span><br><span class="line">k -n default create rolebinding smoke-view --clusterrole view --user smoke</span><br><span class="line">k -n kube-node-lease create rolebinding smoke-view --clusterrole view --user smoke</span><br><span class="line">k -n kube-public create rolebinding smoke-view --clusterrole view --user smoke</span><br></pre></td></tr></table></figure>
<p>⁣3) just list Secret names, no content</p>
<p>This is NOT POSSIBLE using plain K8s RBAC. You might think of doing this:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># NOT POSSIBLE: assigning "list" also allows user to read secret values</span></span><br><span class="line">k -n applications create role list-secrets --verb list --resource secrets</span><br><span class="line"></span><br><span class="line">k -n applications create rolebinding ...</span><br></pre></td></tr></table></figure>
<p>Having the list verb you can simply run kubectl get secrets -oyaml and see all content. Dangerous misconfiguration!</p>
<h3 id="verify">Verify</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># applications</span></span><br><span class="line">k auth can-i create deployments --as smoke -n applications <span class="comment"># YES</span></span><br><span class="line">k auth can-i delete deployments --as smoke -n applications <span class="comment"># YES</span></span><br><span class="line">k auth can-i delete pods --as smoke -n applications <span class="comment"># YES</span></span><br><span class="line">k auth can-i delete sts --as smoke -n applications <span class="comment"># YES</span></span><br><span class="line">k auth can-i delete secrets --as smoke -n applications <span class="comment"># NO</span></span><br><span class="line">k auth can-i list deployments --as smoke -n applications <span class="comment"># YES</span></span><br><span class="line">k auth can-i list secrets --as smoke -n applications <span class="comment"># NO</span></span><br><span class="line">k auth can-i get secrets --as smoke -n applications <span class="comment"># NO</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># view in all namespaces but not kube-system</span></span><br><span class="line">k auth can-i list pods --as smoke -n default <span class="comment"># YES</span></span><br><span class="line">k auth can-i list pods --as smoke -n applications <span class="comment"># YES</span></span><br><span class="line">k auth can-i list pods --as smoke -n kube-public <span class="comment"># YES</span></span><br><span class="line">k auth can-i list pods --as smoke -n kube-node-lease <span class="comment"># YES</span></span><br><span class="line">k auth can-i list pods --as smoke -n kube-system <span class="comment"># NO</span></span><br></pre></td></tr></table></figure>
<h2 id="rbac-serviceaccount">RBAC - ServiceAccount</h2>
<p>There are existing Namespaces <code>ns1</code> and <code>ns2</code><br>
Create ServiceAccount <code>pipeline</code> in both Namespaces.</p>
<ul>
<li>These SAs should be allowed to <code>view</code> almost everything in the whole cluster. You can use the default ClusterRole <code>view</code> for this</li>
<li>These SAs should be allowed to <code>create</code> and <code>delete</code> <code>Deployments</code> in their Namespace.</li>
</ul>
<p>Verify everything using <code>kubectl auth can-i</code></p>
<h3 id="solution-v6">Solution</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># create Namespaces</span></span><br><span class="line">k -n ns1 create sa pipeline</span><br><span class="line">k -n ns2 create sa pipeline</span><br><span class="line"></span><br><span class="line"><span class="comment"># use ClusterRole view</span></span><br><span class="line">k get clusterrole view <span class="comment"># there is default one</span></span><br><span class="line">k create clusterrolebinding pipeline-view --clusterrole view --serviceaccount ns1:pipeline --serviceaccount ns2:pipeline</span><br><span class="line"></span><br><span class="line"><span class="comment"># manage Deployments in both Namespaces</span></span><br><span class="line">k create clusterrole -h <span class="comment"># examples</span></span><br><span class="line">k create clusterrole pipeline-deployment-manager --verb create,delete --resource deployments</span><br><span class="line"><span class="comment"># instead of one ClusterRole we could also create the same Role in both Namespaces</span></span><br><span class="line"></span><br><span class="line">k -n ns1 create rolebinding pipeline-deployment-manager --clusterrole pipeline-deployment-manager --serviceaccount ns1:pipeline</span><br><span class="line">k -n ns2 create rolebinding pipeline-deployment-manager --clusterrole pipeline-deployment-manager --serviceaccount ns2:pipeline</span><br></pre></td></tr></table></figure>
<h2 id="secret-etcd-encryption">Secret - ETCD Encryption</h2>
<p><a href="https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/encrypt-data/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/encrypt-data/</a><br>
<a href="https://killercoda.com/killer-shell-cks/scenario/secret-etcd-encryption" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/secret-etcd-encryption</a></p>
<h3 id="enable-etcd-encryption">Enable ETCD Encryption</h3>
<p>Create an <code>EncryptionConfiguration</code> file at <code>/etc/kubernetes/etcd/ec.yaml</code> and make ETCD use it.</p>
<ul>
<li>One provider should be of type <code>aesgcm</code> with password <code>this-is-very-sec</code> . All new secrets should be encrypted using this one.</li>
<li>One provider should be the <code>identity</code> one to still be able to read existing unencrypted secrets.</li>
</ul>
<h4 id="solution-v7">Solution</h4>
<p>Generate EncryptionConfiguration:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir -p /etc/kubernetes/etcd</span><br><span class="line"><span class="built_in">echo</span> -n this-is-very-sec | base64</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apiserver.config.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">EncryptionConfiguration</span></span><br><span class="line"><span class="attr">resources:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">resources:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">secrets</span></span><br><span class="line">    <span class="attr">providers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">aesgcm:</span></span><br><span class="line">        <span class="attr">keys:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">key1</span></span><br><span class="line">          <span class="attr">secret:</span> <span class="string">dGhpcy1pcy12ZXJ5LXNlYw==</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">identity:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>
<p>Add a new volume and volumeMount in <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>, so that the container can access the file.</p>
</li>
<li>
<p>Pass the new file as argument: <code>--encryption-provider-config=/etc/kubernetes/etcd/ec.yaml</code></p>
</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">command:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">kube-apiserver</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--encryption-provider-config=/etc/kubernetes/etcd/ec.yaml</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/etc/kubernetes/etcd</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">etcd</span></span><br><span class="line">      <span class="attr">readOnly:</span> <span class="literal">true</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line">  <span class="attr">hostNetwork:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">priorityClassName:</span> <span class="string">system-cluster-critical</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/etc/kubernetes/etcd</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">etcd</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure>
<p>Wait till apiserver was restarted: <code>watch crictl ps</code></p>
<h3 id="encrypt-existing-secrets">Encrypt existing Secrets</h3>
<p>Encrypt all existing Secrets in Namespace <code>one</code> using the new provider<br>
Encrypt all existing Secrets in Namespace <code>two</code> using the new provider<br>
Encrypt all existing Secrets in Namespace <code>three</code> using the new provider</p>
<h4 id="tip-v5">Tip</h4>
<p>Recreate Secrets so they are encrypted through the new encryption settings.</p>
<h4 id="solution-v8">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl -n one get secrets -o json | kubectl replace -f -</span><br><span class="line">kubectl -n two get secrets -o json | kubectl replace -f -</span><br><span class="line">kubectl -n three get secrets -o json | kubectl replace -f -</span><br></pre></td></tr></table></figure>
<p>To check you can do for example:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ETCDCTL_API=3 etcdctl --cert /etc/kubernetes/pki/apiserver-etcd-client.crt --key /etc/kubernetes/pki/apiserver-etcd-client.key --cacert /etc/kubernetes/pki/etcd/ca.crt get /registry/secrets/one/s1</span><br></pre></td></tr></table></figure>
<p>The output should be encrypted and prefixed with <code>k8s:enc:aesgcm:v1:key1</code>.</p>
<h2 id="secret-read-and-decode">Secret - Read and Decode</h2>
<h3 id="read-and-decode-the-secrets-in-namespace-one">Read and decode the Secrets in Namespace one</h3>
<ol>
<li>Get the Secrets of type Opaque that have been created in Namespace one .</li>
<li>Create a new file called /opt/ks/one and store the base64-decoded values in that file. Each value needs to be stored on a new line.</li>
</ol>
<h4 id="solution-v9">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k get secrets -n one</span><br><span class="line">NAME   TYPE     DATA   AGE</span><br><span class="line">s1     Opaque   1      39s</span><br><span class="line">s2     Opaque   1      39s</span><br><span class="line"></span><br><span class="line">k get secrets s1 -n one -o yaml | grep data: -A 3</span><br><span class="line">data:</span><br><span class="line">  data: c2VjcmV0</span><br><span class="line">kind: Secret</span><br><span class="line"></span><br><span class="line">k get secrets s2 -n one -o yaml | grep data: -A 3</span><br><span class="line">data:</span><br><span class="line">  data: YWRtaW4=</span><br><span class="line">kind: Secret</span><br><span class="line"></span><br><span class="line">kubectl -n one get secret s1 -ojsonpath=<span class="string">"&#123;.data.data&#125;"</span> | base64 -d</span><br><span class="line"></span><br><span class="line">kubectl -n one get secret s2 -ojsonpath=<span class="string">"&#123;.data.data&#125;"</span> | base64 -d</span><br><span class="line"></span><br><span class="line">vim /opt/ks/one</span><br></pre></td></tr></table></figure>
<p>Your file <code>/opt/ks/one</code> should look like this:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">secret</span></span><br><span class="line"><span class="string">admin</span></span><br></pre></td></tr></table></figure>
<h2 id="privilege-escalation-containers">Privilege Escalation Containers</h2>
<p>Set Privilege Escalation for Deployment</p>
<p>There is a Deployment named <code>logger</code> which constantly outputs the <code>NoNewPrivs</code> flag.</p>
<p>Let the Pods of that Deployment run with <code>Privilege Escalation</code> disabled.</p>
<p>The logs should show the field change.</p>
<h3 id="solution-v10">Solution</h3>
<p>Check them logs <code>k logs -f deploy/logger</code></p>
<p>Edit the Deployment and set the <code>allowPrivilegeEscalation</code> field:</p>
<p><code>k edit deployments.apps logger</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">logger</span></span><br><span class="line">  <span class="attr">strategy:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">logger</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">httpd:2.4.52-alpine</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">httpd</span></span><br><span class="line">        <span class="attr">securityContext:</span></span><br><span class="line">            <span class="attr">allowPrivilegeEscalation:</span> <span class="literal">false</span>  <span class="comment"># 注意加在containers下面，而非spec下</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure>
<h2 id="privileged-containers">Privileged Containers</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/privileged-containers" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/privileged-containers</a></p>
<h3 id="create-a-privileged-pod">Create a privileged Pod</h3>
<ul>
<li>Create a Pod named <code>prime</code> image <code>nginx:alpine</code> .</li>
<li>The container should run as <code>privileged</code> .</li>
</ul>
<p>Install iptables (<code>apk add iptables</code> ) inside the Pod.</p>
<p>Test the capabilities using <code>iptables -L</code> .</p>
<h4 id="solution-v11">Solution</h4>
<p>Generate Pod yaml<br>
<code>k run prime --image=nginx:alpine -oyaml --dry-run=client --command -- sh -c 'sleep 1d' &gt; pod.yaml</code></p>
<p>Set the privileged :</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">prime</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">prime</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">command:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">sh</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">sleep</span> <span class="string">1d</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:alpine</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">prime</span></span><br><span class="line">    <span class="attr">securityContext:</span></span><br><span class="line">      <span class="attr">privileged:</span> <span class="literal">true</span>      <span class="comment"># Add, 注意加在containers下面，而非spec下</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br></pre></td></tr></table></figure>
<p>Now exec into the Pod and run apk add iptables .</p>
<p><code>k exec prime -- apk add iptables</code></p>
<p>You’ll see that iptables -L needs capabilities to run which it here gets through privileged.</p>
<p><code>k exec prime -- iptables -L</code></p>
<h3 id="create-a-privileged-statefulset">Create a privileged StatefulSet</h3>
<p>There is an existing StatefulSet yaml at <code>/application/sts.yaml</code> .</p>
<p>It should run as <code>privileged</code> but it seems like it cannot be applied.</p>
<p>Fix it and create the StatefulSet.</p>
<h4 id="solution-v12">Solution</h4>
<p>Edit the yaml to set privileged in the container section:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">habanero</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">habanero</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">habanero</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">habanero</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="comment">#securityContext:                   # remove</span></span><br><span class="line">        <span class="comment">#privileged: true                 # remove</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">habanero</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">nginx:alpine</span></span><br><span class="line">          <span class="attr">command:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">sh</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">apk</span> <span class="string">add</span> <span class="string">iptables</span> <span class="string">&amp;&amp;</span> <span class="string">sleep</span> <span class="string">1d</span></span><br><span class="line">          <span class="attr">securityContext:</span>                <span class="comment"># add</span></span><br><span class="line">            <span class="attr">privileged:</span> <span class="literal">true</span>              <span class="comment"># add</span></span><br></pre></td></tr></table></figure>
<h2 id="container-hardening">Container Hardening</h2>
<p>Harden a given Docker Container<br>
There is a Dockerfile at <code>/root/image/Dockerfile</code> .</p>
<p>It’s a simple container which tries to make a curl call to an imaginary api with a secret token, the call will 404 , but that’s okay.</p>
<ol>
<li>Use specific version <code>20.04</code> for the base image</li>
<li>Remove layer caching issues with <code>apt-get</code></li>
<li>Remove the hardcoded secret value <code>2e064aad-3a90–4cde-ad86–16fad1f8943e</code>. The secret value should be passed into the container during runtime as env variable <code>TOKEN</code></li>
<li>Make it impossible to <code>docker exec</code> , <code>podman exec</code> or <code>kubectl exec</code> into the container using <code>bash</code><br>
You can build the image using</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root/image</span><br><span class="line">docker build .</span><br></pre></td></tr></table></figure>
<h3 id="solution-v13">Solution</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># vim /root/image/Dockerfile</span></span><br><span class="line">FROM ubuntu</span><br><span class="line">RUN apt-get update </span><br><span class="line">RUN apt-get -y install curl</span><br><span class="line">ENV URL https://google.com/this-will-fail?secret-token=</span><br><span class="line">CMD [<span class="string">"sh"</span>, <span class="string">"-c"</span>, <span class="string">"curl --head <span class="variable">$URL</span>=2e064aad-3a90-4cde-ad86-16fad1f8943e"</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 修改为</span></span><br><span class="line">FROM ubuntu:20.04  <span class="comment"># 1 Specific version</span></span><br><span class="line">RUN apt-get update &amp;&amp; apt-get -y install curl <span class="comment"># 2 Remove Layer Caching</span></span><br><span class="line">ENV URL https://google.com/this-will-fail?secret-token=</span><br><span class="line">RUN rm /usr/bin/bash <span class="comment"># 4 remove bash</span></span><br><span class="line">CMD [<span class="string">"sh"</span>, <span class="string">"-c"</span>, <span class="string">"curl --head <span class="variable">$URL</span><span class="variable">$TOKEN</span>"</span>] <span class="comment"># 3 Secret as runtime Env variable</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root/image</span><br><span class="line">docker build .</span><br><span class="line">docker image ls</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">podman build -t app .</span><br><span class="line">podman image ls</span><br><span class="line">    REPOSITORY                TAG         IMAGE ID      CREATED         SIZE</span><br><span class="line">    localhost/app             latest      2bb9ee2ae5bc  57 seconds ago  132 MB</span><br><span class="line"></span><br><span class="line">podman run -d -e TOKEN=2e064aad-3a90-4cde-ad86-16fad1f8943e app sleep 1d <span class="comment"># run in background</span></span><br><span class="line">podman ps | grep app</span><br><span class="line">    CONTAINER ID  IMAGE                 COMMAND     CREATED        STATUS            PORTS       NAMES</span><br><span class="line">    4a848daec2e2  localhost/app:latest  sleep 1d    9 seconds ago  Up 9 seconds ago              heuristic_golick</span><br><span class="line"></span><br><span class="line">podman <span class="built_in">exec</span> -it 4a848daec2e2 bash <span class="comment"># fails</span></span><br><span class="line">podman <span class="built_in">exec</span> -it 4a848daec2e2 sh <span class="comment"># works</span></span><br></pre></td></tr></table></figure>
<h2 id="container-image-footprint-user">Container Image Footprint User</h2>
<h3 id="run-the-default-dockerfile">Run the default Dockerfile</h3>
<p>There is a given Dockerfile under /opt/ks/Dockerfile .</p>
<p>Using Docker:</p>
<ul>
<li>Build an image named <code>base-image</code> from the Dockerfile.</li>
<li>Run a container named <code>c1</code> from that image.</li>
<li>Check under which user the sleep process is running inside the container</li>
</ul>
<h4 id="solution-v14">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Build and run</span></span><br><span class="line"><span class="built_in">cd</span> /opt/ks/</span><br><span class="line">docker build -t base-image .</span><br><span class="line">docker run --name c1 -d base-image</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show the user of processes</span></span><br><span class="line">docker <span class="built_in">exec</span> c1 ps</span><br><span class="line">    PID   USER     TIME  COMMAND</span><br><span class="line">        1 root      0:00 sleep 1d</span><br><span class="line">        2 root      0:00 ps</span><br><span class="line"><span class="comment"># (to start again) Delete container</span></span><br><span class="line">docker rm c1 --force</span><br></pre></td></tr></table></figure>
<h3 id="run-container-as-user">Run container as user</h3>
<p>Modify the Dockerfile <code>/opt/ks/Dockerfile</code> to run processes as user <code>appuser</code><br>
Update the image <code>base-image</code> with your change<br>
Build a new container <code>c2</code> from that image</p>
<h4 id="solution-v15">Solution</h4>
<p>Add the USER docker command:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">FROM alpine:3.12.3</span><br><span class="line">RUN adduser -D -g <span class="string">''</span> appuser</span><br><span class="line">USER appuser <span class="comment"># Add this line</span></span><br><span class="line">CMD sh -c <span class="string">'sleep 1d'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Build and run:</span></span><br><span class="line"><span class="built_in">cd</span> /opt/ks/</span><br><span class="line">docker build -t base-image .</span><br><span class="line">docker run --name c2 -d base-image</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show the user of processes</span></span><br><span class="line">docker <span class="built_in">exec</span> c2 ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># (to start again) Delete container</span></span><br><span class="line">docker rm c2 --force</span><br></pre></td></tr></table></figure>
<h2 id="runtimeclass-gvisor">RuntimeClass - gVisor</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/sandbox-gvisor" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/sandbox-gvisor</a></p>
<h3 id="install-and-configure-gvisor">Install and configure gVisor</h3>
<p>You should install gVisor on the node <code>node01</code> and make containerd use it.<br>
There is install script <code>/root/gvisor-install.sh</code> which should setup everything, execute it on node <code>node01</code> .</p>
<h4 id="solution-v16"><strong>Solution</strong></h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scp gvisor-install.sh node01:/root</span><br><span class="line">ssh node01</span><br><span class="line">    sh gvisor-install.sh</span><br><span class="line">    service kubelet status</span><br></pre></td></tr></table></figure>
<h3 id="create-runtimeclass-and-pod-to-use-gvisor">Create RuntimeClass and Pod to use gVisor</h3>
<p>Now that gVisor should be configured, create a new <code>RuntimeClass</code> for it.<br>
Then create a new Pod named <code>sec</code> using image <code>nginx:1.21.5-alpine</code> .<br>
Verify your setup by running <code>dmesg</code> in the Pod.</p>
<h4 id="tip-v6">Tip</h4>
<p>The handler for the gVisor RuntimeClass is <code>runsc</code>.</p>
<h4 id="solution-v17">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Back to cantroplane</span></span><br><span class="line">node01 $ <span class="built_in">exit</span></span><br><span class="line">    <span class="built_in">logout</span></span><br><span class="line">    Connection to node01 closed.</span><br><span class="line">controlplane $</span><br></pre></td></tr></table></figure>
<p>First we create the RuntimeClass</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">node.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">RuntimeClass</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">gvisor</span></span><br><span class="line"><span class="attr">handler:</span> <span class="string">runsc</span></span><br></pre></td></tr></table></figure>
<p>And the Pod that uses it</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">sec</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">runtimeClassName:</span> <span class="string">gvisor</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx:1.21.5-alpine</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">sec</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k apply -f rc.yaml</span><br><span class="line">k apply -f pod.yaml</span><br></pre></td></tr></table></figure>
<h4 id="verify-v2">Verify</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k <span class="built_in">exec</span> sec -- dmesg | grep -i gvisor</span><br></pre></td></tr></table></figure>
<h2 id="certificatesigningrequests-sign-manually">CertificateSigningRequests sign manually</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/certificate-signing-requests-sign-manually" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/certificate-signing-requests-sign-manually</a></p>
<p><a href="https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/certificate-signing-requests/#create-private-key" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/certificate-signing-requests/#create-private-key</a></p>
<h3 id="create-key-and-csr">Create KEY and CSR</h3>
<p>The idea here is to create a new “user” that can communicate with K8s.</p>
<p>For this now:</p>
<ol>
<li>Create a new KEY at /root/60099.key for user named 60099@internal.users</li>
<li>Create a CSR at /root/60099.csr for the KEY</li>
</ol>
<h4 id="explanation">Explanation</h4>
<p>Users in K8s are managed via CRTs and the CN/CommonName field in them. The cluster CA needs to sign these CRTs.</p>
<p>This can be achieved with the following procedure:</p>
<ul>
<li>Create a KEY (Private Key) file</li>
<li>Create a CSR (CertificateSigningRequest) file for that KEY</li>
<li>Create a CRT (Certificate) by signing the CSR. Done using the CA (Certificate Authority) of the cluster</li>
</ul>
<h4 id="tip-v7">Tip</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">openssl genrsa -out XXX 2048</span><br><span class="line">openssl req -new -key XXX -out XXX</span><br></pre></td></tr></table></figure>
<h4 id="solution-v18">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">openssl genrsa -out 60099.key 2048</span><br><span class="line">openssl req -new -key 60099.key -out 60099.csr</span><br><span class="line"><span class="comment"># set Common Name = 60099@internal.users</span></span><br></pre></td></tr></table></figure>
<h3 id="manual-signing">Manual signing</h3>
<p>Manually sign the CSR with the K8s CA file to generate the CRT at /root/60099.crt .</p>
<p>Create a new context for kubectl named 60099@internal.users which uses this CRT to connect to K8s.</p>
<h4 id="tip-1">Tip 1</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">openssl x509 -req -<span class="keyword">in</span> XXX -CA XXX -CAkey XXX -CAcreateserial -out XXX -days 500</span><br></pre></td></tr></table></figure>
<h4 id="tip-2">Tip 2</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find /etc/kubernetes/pki | grep ca</span><br></pre></td></tr></table></figure>
<h4 id="solution-1-v2">Solution 1</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">openssl x509 -req -<span class="keyword">in</span> 60099.csr -CA /etc/kubernetes/pki/ca.crt -CAkey /etc/kubernetes/pki/ca.key -CAcreateserial -out 60099.crt -days 500</span><br></pre></td></tr></table></figure>
<h4 id="solution-2-v2">Solution 2</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k config <span class="built_in">set</span>-credentials 60099@internal.users --client-key=60099.key --client-certificate=60099.crt</span><br><span class="line">k config <span class="built_in">set</span>-context 60099@internal.users --cluster=kubernetes --user=60099@internal.users</span><br><span class="line">k config get-contexts</span><br><span class="line">k config use-context 60099@internal.users</span><br><span class="line">k get ns <span class="comment"># fails because no permissions, but shows the correct username returne</span></span><br></pre></td></tr></table></figure>
<h2 id="certificatesigningrequests-sign-via-api">CertificateSigningRequests sign via API</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/certificate-signing-requests-sign-k8s" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/certificate-signing-requests-sign-k8s</a></p>
<p><a href="https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/certificate-signing-requests/#create-private-key" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/certificate-signing-requests/#create-private-key</a></p>
<h3 id="create-key-and-csr-v2">Create KEY and CSR</h3>
<p>The idea here is to create a new “user” that can communicate with K8s.<br>
For this now:</p>
<ol>
<li>Create a new KEY at /root/60099.key for user named 60099@internal.users</li>
<li>Create a CSR at /root/60099.csr for the KEY</li>
</ol>
<h4 id="tip-v8">Tip</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">openssl genrsa -out XXX 2048</span><br><span class="line"></span><br><span class="line">openssl req -new -key XXX -out XXX</span><br></pre></td></tr></table></figure>
<h4 id="solution-v19">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">openssl genrsa -out 60099.key 2048</span><br><span class="line"></span><br><span class="line">openssl req -new -key 60099.key -out 60099.csr</span><br><span class="line"><span class="comment"># set Common Name = 60099@internal.users</span></span><br></pre></td></tr></table></figure>
<h3 id="signing-via-api">Signing via API</h3>
<p>Create a K8s CertificateSigningRequest resource named <code>60099@internal.users</code> and which sends the <code>/root/60099.csr</code> to the API.<br>
Let the K8s API sign the CertificateSigningRequest.<br>
Download the CRT file to <code>/root/60099.crt</code> .</p>
<p>Create a new context for kubectl named <code>60099@internal.users</code> which uses this CRT to connect to K8s.</p>
<h4 id="certificatesigningrequest-template">CertificateSigningRequest template</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apiVersion: certificates.k8s.io/v1</span><br><span class="line">kind: CertificateSigningRequest</span><br><span class="line">metadata:</span><br><span class="line">  name: 60099@internal.users <span class="comment"># ADD</span></span><br><span class="line">spec:</span><br><span class="line">  groups:</span><br><span class="line">  - system:authenticated</span><br><span class="line">  request: &#123;&#123;BASE_64_ENCODED_CSR&#125;&#125; <span class="comment"># ADD</span></span><br><span class="line">  signerName: kubernetes.io/kube-apiserver-client</span><br><span class="line">  usages:</span><br><span class="line">  - client auth</span><br></pre></td></tr></table></figure>
<h4 id="solution-v20">Solution</h4>
<p>Convert the CSR file into base64</p>
<p><code>cat 60099.csr | base64 -w 0</code></p>
<p>Copy it into the YAML</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">certificates.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">CertificateSigningRequest</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="number">60099</span><span class="string">@internal.users</span> <span class="comment"># ADD</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">groups:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">system:authenticated</span></span><br><span class="line">  <span class="attr">request:</span> <span class="string">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFV...</span> <span class="comment"># ADD</span></span><br><span class="line">  <span class="attr">signerName:</span> <span class="string">kubernetes.io/kube-apiserver-client</span></span><br><span class="line">  <span class="attr">usages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">client</span> <span class="string">auth</span></span><br></pre></td></tr></table></figure>
<p>Create and approve</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k -f csr.yaml create</span><br><span class="line">k get csr <span class="comment"># pending</span></span><br><span class="line">k certificate approve 60099@internal.users</span><br><span class="line">k get csr <span class="comment"># approved</span></span><br><span class="line">k get csr 60099@internal.users -ojsonpath=<span class="string">"&#123;.status.certificate&#125;"</span> | base64 -d &gt; 60099.crt</span><br></pre></td></tr></table></figure>
<h4 id="use-the-crt">Use the CRT</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k config <span class="built_in">set</span>-credentials 60099@internal.users --client-key=60099.key --client-certificate=60099.crt</span><br><span class="line">k config <span class="built_in">set</span>-context 60099@internal.users --cluster=kubernetes --user=60099@internal.users</span><br><span class="line">k config get-contexts</span><br><span class="line">k config use-context 60099@internal.users</span><br><span class="line">k get ns <span class="comment"># fails because no permissions, but shows the correct username returned</span></span><br></pre></td></tr></table></figure>
<h2 id="image-use-digest">Image Use Digest</h2>
<h3 id="use-an-image-digest-instead-of-tag">Use an image digest instead of tag</h3>
<p>Image tags can be overwritten, digests not.</p>
<p>Create a Pod named <code>crazy-pod</code> which uses the image digest <code>nginx@sha256:eb05700fe7baa6890b74278e39b66b2ed1326831f9ec3ed4bdc6361a4ac2f333</code> .</p>
<h4 id="solution-v21">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Simply use the image@sha256:digest as image:</span></span><br><span class="line">k run crazy-pod --image=nginx@sha256:eb05700fe7baa6890b74278e39b66b2ed1326831f9ec3ed4bdc6361a4ac2f333</span><br></pre></td></tr></table></figure>
<h3 id="switch-deployment-from-using-tag-to-digest">Switch deployment from using tag to digest</h3>
<p>Convert the existing Deployment <code>crazy-deployment</code> to use the image digest of the current tag instead of the tag.</p>
<h4 id="solution-v22">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># get digest</span></span><br><span class="line">k get deploy --show-labels</span><br><span class="line">k get pod -l app=crazy-deployment -oyaml | grep imageID</span><br><span class="line"></span><br><span class="line"><span class="comment"># use digest</span></span><br><span class="line">k edit deploy crazy-deployment <span class="comment"># image: httpd@sha256:c7b8040505e2e63eafc82d37148b687ff488bf6d25fc24c8bf01d71f5b457531</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># control</span></span><br><span class="line">k get pod -l app=crazy-deployment -oyaml | grep image:</span><br></pre></td></tr></table></figure>
<h2 id="securitycontext-immutability-readonly-filesystem">securityContext - Immutability Readonly Filesystem</h2>
<p><a href="https://killercoda.com/killer-shell-cks/scenario/immutability-readonly-fs" target="_blank" rel="noopener">https://killercoda.com/killer-shell-cks/scenario/immutability-readonly-fs</a></p>
<h3 id="create-a-pod-with-read-only-filesystem">Create a Pod with read-only filesystem</h3>
<p>Create a Pod named <code>pod-ro</code> in Namespace <code>sun</code> of image <code>busybox:1.32.0</code> .<br>
Make sure the container keeps running, like using <code>sleep 1d</code> .</p>
<p>The container root filesystem should be read-only.</p>
<h4 id="solution-v23">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Generate Pod yaml</span></span><br><span class="line">k -n sun run pod-ro --image=busybox:1.32.0 -oyaml --dry-run=client --<span class="built_in">command</span> -- sh -c <span class="string">'sleep 1d'</span> &gt; pod.yaml</span><br></pre></td></tr></table></figure>
<p>Set the readOnlyRootFilesystem :</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">pod-ro</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-ro</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">sun</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">command:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">sh</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">sleep</span> <span class="string">1d</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox:1.32.0</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">pod-ro</span></span><br><span class="line">    <span class="attr">securityContext:</span></span><br><span class="line">      <span class="attr">readOnlyRootFilesystem:</span> <span class="literal">true</span>  <span class="comment"># Add</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">k apply -f pod.yaml</span><br></pre></td></tr></table></figure>
<h3 id="fix-existing-nginx-deployment-to-work-with-read-only-filesystem">Fix existing Nginx Deployment to work with read-only filesystem</h3>
<p>The Deployment <code>web4.0</code> in Namespace <code>moon</code> doesn’t seem to work with <code>readOnlyRootFilesystem</code> .</p>
<p>Add an emptyDir volume to fix this.</p>
<h4 id="solution-v24">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Check the logs to find the location that needs to be writable</span><br><span class="line"></span><br><span class="line">k -n moon logs -f deploy/web4.0</span><br><span class="line">    Found 2 pods, using pod/web4.0-8554496f95-trtz9</span><br><span class="line">    sh: can<span class="string">'t create /etc/date.log: Read-only file system</span></span><br></pre></td></tr></table></figure>
<p>Edit the Deployment, add a new emptyDir volume</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">...</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">command:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">sh</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">date</span> <span class="string">&gt;</span> <span class="string">/etc/date.log</span> <span class="string">&amp;&amp;</span> <span class="string">sleep</span> <span class="string">1d</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">busybox:1.32.0</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">container</span></span><br><span class="line">        <span class="attr">securityContext:</span></span><br><span class="line">          <span class="attr">readOnlyRootFilesystem:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/etc</span>  <span class="comment"># Get from log, the location that needs to be writable</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">temp</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">temp</span></span><br><span class="line">        <span class="attr">emptyDir:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="static-manual-analysis-k8s">Static Manual Analysis K8s</h2>
<h3 id="analyse-k8s-pod-yaml">Analyse K8s Pod YAML</h3>
<p>Perform a manual static analysis on files <code>/root/apps/app1-*</code> considering security.<br>
Move the less secure file to <code>/root/insecure</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># app1-30b5eba5.yaml </span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">main</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">alpine</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">["/bin/sleep",</span> <span class="string">"999999"</span><span class="string">]</span></span><br><span class="line">    <span class="attr">securityContext:</span></span><br><span class="line">      <span class="attr">readOnlyRootFilesystem:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">dnsPolicy:</span> <span class="string">ClusterFirst</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># app1-510d6362.yaml </span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">main</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">alpine</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">["/bin/sleep",</span> <span class="string">"999999"</span><span class="string">]</span></span><br><span class="line">    <span class="attr">livenessProbe:</span></span><br><span class="line">      <span class="attr">exec:</span></span><br><span class="line">        <span class="attr">command:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">cat</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">/tmp/healthy</span></span><br><span class="line">      <span class="attr">initialDelaySeconds:</span> <span class="number">5</span></span><br><span class="line">      <span class="attr">periodSeconds:</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h4 id="tip-v9">Tip</h4>
<p>Enforcing a read-only root filesystem can make containers more secure.</p>
<h4 id="solution-v25">Solution</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root/apps   </span><br><span class="line">ls</span><br><span class="line">    app1-30b5eba5.yaml  app1-510d6362.yaml  app2-b917e60e.yaml  app2-f720cbb4.yaml  app3-819f4686.yaml  app3-905fe637.yaml</span><br><span class="line"></span><br><span class="line">mv /root/apps/app1-510d6362.yaml /root/insecure</span><br></pre></td></tr></table></figure>
<h3 id="analyse-k8s-deployment-yaml">Analyse K8s Deployment YAML</h3>
<p>Perform a manual static analysis on files <code>/root/apps/app2-*</code> considering security.<br>
Move the less secure file to <code>/root/insecure</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># app2-b917e60e.yaml </span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">web</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">web</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">web</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">web</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">web</span></span><br><span class="line">        <span class="attr">securityContext:</span></span><br><span class="line">          <span class="attr">capabilities:</span></span><br><span class="line">            <span class="attr">drop:</span> <span class="string">[]</span></span><br><span class="line">          <span class="attr">allowPrivilegeEscalation:</span> <span class="literal">true</span>  <span class="comment"># not secure</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">httpd</span></span><br><span class="line">        <span class="attr">readinessProbe:</span></span><br><span class="line">          <span class="attr">exec:</span></span><br><span class="line">            <span class="attr">command:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">cat</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">/tmp/healthy</span></span><br><span class="line">          <span class="attr">initialDelaySeconds:</span> <span class="number">5</span></span><br><span class="line">          <span class="attr">periodSeconds:</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># app2-f720cbb4.yaml </span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx-deployment</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">securityContext:</span></span><br><span class="line">        <span class="attr">runAsNonRoot:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">runAsUser:</span> <span class="number">10001</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">nginx:1.21.6</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>
<h4 id="tip-v10">Tip</h4>
<p>Check the <code>securityContext</code> settings, just because there are some doesn’t mean they do something good or at all.</p>
<h4 id="solution-v26">Solution</h4>
<p>File a<code>pp2-b917e60e.yaml</code> has some <code>securityContext</code> settings, but they don’t drop any capabilities and even allow <code>allowPrivilegeEscalation</code>.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mv /root/apps/app2-b917e60e.yaml /root/insecure</span><br></pre></td></tr></table></figure>
<h3 id="analyse-k8s-statefulset-yaml">Analyse K8s StatefulSet YAML</h3>
<p>Perform a manual static analysis on files <code>/root/apps/app3-*</code> considering security.<br>
Move the less secure file to <code>/root/insecure</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># app3-819f4686.yaml </span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">web</span></span><br><span class="line">  <span class="attr">clusterIP:</span> <span class="string">None</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">web</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">"nginx"</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">minReadySeconds:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">k8s.gcr.io/nginx-slim:0.8</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">web</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">www</span></span><br><span class="line">          <span class="attr">mountPath:</span> <span class="string">/usr/share/nginx/html</span></span><br><span class="line">        <span class="attr">readinessProbe:</span></span><br><span class="line">          <span class="attr">httpGet:</span></span><br><span class="line">            <span class="attr">scheme:</span> <span class="string">HTTPS</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/index.html</span></span><br><span class="line">            <span class="attr">port:</span> <span class="number">8443</span></span><br><span class="line">          <span class="attr">initialDelaySeconds:</span> <span class="number">10</span></span><br><span class="line">          <span class="attr">periodSeconds:</span> <span class="number">5</span></span><br><span class="line">        <span class="attr">startupProbe:</span></span><br><span class="line">          <span class="attr">httpGet:</span></span><br><span class="line">            <span class="attr">scheme:</span> <span class="string">HTTPS</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/index.html</span></span><br><span class="line">            <span class="attr">port:</span> <span class="number">8443</span></span><br><span class="line">          <span class="attr">initialDelaySeconds:</span> <span class="number">10</span></span><br><span class="line">          <span class="attr">periodSeconds:</span> <span class="number">5</span></span><br><span class="line">        <span class="attr">securityContext:</span></span><br><span class="line">          <span class="attr">privileged:</span> <span class="literal">true</span>  <span class="comment"># not secure</span></span><br><span class="line">        <span class="string">...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># app3-905fe637.yaml </span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mysql-set</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">"mysql"</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mysql</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">3306</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mysql-store</span></span><br><span class="line">          <span class="attr">mountPath:</span> <span class="string">/var/lib/mysql</span></span><br><span class="line">        <span class="attr">securityContext:</span></span><br><span class="line">          <span class="attr">privileged:</span> <span class="literal">false</span>    <span class="comment"># secure</span></span><br><span class="line">        <span class="string">...</span></span><br></pre></td></tr></table></figure>
<h4 id="tip-v11">Tip</h4>
<p>If you face large files, search for settings like <code>securityContext</code> .</p>
<h4 id="solution-v27">Solution</h4>
<p>We see usage of privileged: true .</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /root/apps/app3-819f4686.yaml | grep securityContext -A 3</span><br><span class="line">mv /root/apps/app3-819f4686.yaml /root/insecure</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>TECH</category>
        <category>container</category>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Cloud</tag>
        <tag>container</tag>
      </tags>
  </entry>
  <entry>
    <title>Git Pages + Jekyll/Hexo Build your own blog</title>
    <url>/Git-Pages-Jekyll-Hexo-Build-your-own-blog.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="hexo-博客主题">Hexo 博客主题</h1>
<p><a href="../hexo-theme-zilan.html">Hexo博客自建主题hexo-theme-zilan</a></p>
<h1 id="1-github-pages">1 Github Pages</h1>
<p>比较懒，默认都是用过gitbhub的啦</p>
<p>安装 Git</p>
<blockquote>
<p>Windows：下载并安装 git.<br>
Mac：使用 Homebrew, MacPorts ：brew install git;或下载 安装程序 安装。<br>
Linux (Ubuntu, Debian)：sudo apt-get install git-core<br>
Linux (Fedora, Red Hat, CentOS)：sudo yum install git-core<br>
Windows 用户<br>
由于众所周知的原因，从上面的链接下载git for windows最好挂上一个代理，否则下载速度十分缓慢。也可以参考这个页面，收录了存储于百度云的下载地址。</p>
</blockquote>
<blockquote>
<p>Mac 用户<br>
您在编译时可能会遇到问题，请先到 App Store 安装 Xcode，Xcode 完成后，启动并进入 Preferences -&gt; Download -&gt; Command Line Tools -&gt; Install 安装命令行工具。</p>
</blockquote>
<hr>
<blockquote>
<p>Windows 用户<br>
由于众所周知的原因，从上面的链接下载git for windows最好挂上一个代理，否则下载速度十分缓慢。也可以参考<a href="https://github.com/waylau/git-for-win" target="_blank" rel="noopener">这个页面</a>，收录了存储于百度云的下载地址。</p>
</blockquote>
<h2 id="step1-创建一个库-create-a-repository">step1 创建一个库 Create a repository</h2>
<p>在<a href="https://github.com/" target="_blank" rel="noopener">GitHub</a> 页面<a href="https://github.com/new" target="_blank" rel="noopener">创建一个库</a> 命名规则是：<a href="http://username.github.io" target="_blank" rel="noopener">username.github.io</a>（username是Github用户名）。</p>
<p><a href="http://xn--CatherineLiyuankun-z372az17lh1lmp5ax1t6s3g.github.io" target="_blank" rel="noopener">例如我的就是CatherineLiyuankun.github.io</a>，我已经建过这个库了，所以报错说库已经存在。<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/setp1-1.png" alt="setp1-1"></p>
<h2 id="step2-clone-库">step2 clone 库</h2>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/setp2.png" alt="setp2.png"></p>
<h2 id="step3-创建index-html">step3 创建index.html</h2>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/setp3-1.png" alt="setp3-1.png"></p>
<h2 id="step4-git-push">step4 git push</h2>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/setp4-1.png" alt="setp4-1.png"></p>
<h2 id="step5-访问页面">step5 访问页面</h2>
<p>我的对应页面就是： <a href="https://catherineliyuankun.github.io/" target="_blank" rel="noopener">https://catherineliyuankun.github.io/</a></p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/setp5-1..png" alt="setp5-1"><br>
上面照着pages页面的步骤做就行，重点在下面</p>
<hr>
<h1 id="2-jekyll-or-hexo">2 Jekyll or Hexo ?</h1>
<p>弄到这里，我就犹疑了，查了查有用Jekyll 也有用 Hexo。这两个静态页面生成器（Static Website Generation）到底有什么区别，各自优缺有是什么呢？</p>
<table>
<thead>
<tr>
<th>Tables</th>
<th style="text-align:center">Jekyll</th>
<th style="text-align:right">Hexo</th>
</tr>
</thead>
<tbody>
<tr>
<td>依赖</td>
<td style="text-align:center">ruby  gem （gem依赖也许会带来不兼容问题 <strong>弱点</strong>）</td>
<td style="text-align:right">nodejs</td>
</tr>
<tr>
<td></td>
<td style="text-align:center"><em>brew install ruby</em></td>
<td style="text-align:right"><em>brew install node</em></td>
</tr>
<tr>
<td>安装</td>
<td style="text-align:center"><em>gem install jekyll</em></td>
<td style="text-align:right"><strong><em>npm install hexo-cli -g</em></strong></td>
</tr>
<tr>
<td>生成静态站点的速度</td>
<td style="text-align:center">随着网站内容增加越来越慢  <strong>最大弱点</strong></td>
<td style="text-align:right">相当快 <strong>优点</strong></td>
</tr>
<tr>
<td>与git Pages关系</td>
<td style="text-align:center">背后运行引擎，支持html/md格式（把原文上传github， 可以直接生成博客，也可以用在线编辑器处理，但只能用<a href="https://help.github.com/articles/adding-jekyll-plugins-to-a-github-pages-site/" target="_blank" rel="noopener">Github-safe plugins</a>）<strong>优点</strong></td>
<td style="text-align:right">无直接关系（本地生成 html 再上传），部署简单：deploy to Github pages or any other host with one deploy command</td>
</tr>
<tr>
<td>格式</td>
<td style="text-align:center">html/md</td>
<td style="text-align:right">md</td>
</tr>
<tr>
<td>是否需本地环境</td>
<td style="text-align:center">不需</td>
<td style="text-align:right">需要</td>
</tr>
<tr>
<td>编辑</td>
<td style="text-align:center">不支持在titles或者YAML使用变量，许多插件过时了 <strong>弱点</strong> ；不buid-in支持livereload；不buid-in支持post pagination as of Jekyll 3</td>
<td style="text-align:right">大量可用的<a href="https://hexo.io/plugins/" target="_blank" rel="noopener">免费插件</a>  <strong>优点</strong></td>
</tr>
<tr>
<td>模板</td>
<td style="text-align:center">copy Jekyll创始人的<a href="https://github.com/mojombo/tpw" target="_blank" rel="noopener">示例库</a>，以及其他用Jekyll搭建的<a href="https://github.com/jekyll/jekyll/wiki/Sites" target="_blank" rel="noopener">blog</a></td>
<td style="text-align:right">大量可用的<a href="https://hexo.io/themes/" target="_blank" rel="noopener">免费开源主题</a> 中国社区很活跃 <strong>优点</strong></td>
</tr>
<tr>
<td>迁移</td>
<td style="text-align:center">依靠<a href="https://import.jekyllrb.com/docs/home/" target="_blank" rel="noopener">Jekyll importers</a>可从其他平台迁移博客（例如WordPress）<strong>优点</strong></td>
<td style="text-align:right"><a href="https://hexo.io/zh-cn/docs/migration" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/migration</a></td>
</tr>
<tr>
<td>开源</td>
<td style="text-align:center">免费开源</td>
<td style="text-align:right">免费开源</td>
</tr>
<tr>
<td>category 分类</td>
<td style="text-align:center">需要自己写标签语言遍历然后在创建各个分类的主页，再设置页面css，或者用ruby写插件</td>
<td style="text-align:right">文章前使用“category: 分类名”，自动右边生成，包括分类主页，默认样式</td>
</tr>
<tr>
<td>教程难度</td>
<td style="text-align:center">相对更难</td>
<td style="text-align:right">更简洁</td>
</tr>
<tr>
<td>上手难度</td>
<td style="text-align:center">相对更难</td>
<td style="text-align:right">更简单</td>
</tr>
</tbody>
</table>
<hr>
<h1 id="3-jekyll">3 Jekyll</h1>
<p>官网： <a href="https://jekyllrb.com/docs/quickstart/" target="_blank" rel="noopener">https://jekyllrb.com/docs/quickstart/</a><br>
中文版官网：<a href="https://www.jekyll.com.cn/docs/quickstart/" target="_blank" rel="noopener">https://www.jekyll.com.cn/docs/quickstart/</a></p>
<h2 id="step-0-前提安装有ruby">step 0 前提安装有ruby</h2>
<ul>
<li>
<p>如果你是Mac用户，你就需要安装 Xcode 和 Command-Line Tools了。下载方式 Preferences →<br>
Downloads → Components。如果安装过Xcode和 Command-Line Tools，那就已经有ruby了。</p>
</li>
<li>
<p>在 Windows 下使用 Jekyll 你可以使用 Jekyll running on Windows, 但是官方文档并不建议你在 Windows 平台上安装 Jekyll。</p>
</li>
</ul>
<p>安装 ruby</p>
<p>Mac</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">brew </span><span class="keyword">install </span>ruby</span><br></pre></td></tr></table></figure>
<p>Linux</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> intall ruby</span><br></pre></td></tr></table></figure>
<p>我已经安装有了。<br>
检查下版本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ruby -v</span><br></pre></td></tr></table></figure>
<h2 id="step1-安装jekyll">step1 安装Jekyll</h2>
<p>开始正题</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~ gem install jekyll</span><br></pre></td></tr></table></figure>
<h2 id="step2-建my-awesome-site">step2 建my-awesome-site</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~ jekyll new my-awesome-site</span><br></pre></td></tr></table></figure>
<p>手动把my-awesome-site目录下的所有内容复制到自己的git库中，我的是~/MyOwnGit/CatherineLiyuankun.github.io 或者是命令行复制</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> my-awesome-site</span><br><span class="line">cp -R * /Users/liyuankun/MyOwnGit/CatherineLiyuankun.github.io/</span><br></pre></td></tr></table></figure>
<h2 id="step3-启动jekyll环境">step3 启动Jekyll环境</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">➜  CatherineLiyuankun.github.io git:(master) ✗ jekyll serve</span><br></pre></td></tr></table></figure>
<h2 id="step4-访问页面">step4 访问页面</h2>
<p>通过<a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a> ，访问页面。</p>
<h2 id="step5-jekyll博客模板">step5 Jekyll博客模板</h2>
<p>Jekyll创始人的<a href="https://github.com/mojombo/tpw" target="_blank" rel="noopener">示例库</a>，以及其他用Jekyll搭建的<a href="https://github.com/jekyll/jekyll/wiki/Sites" target="_blank" rel="noopener">blog</a>。</p>
<hr>
<h1 id="4-hexo">4 Hexo</h1>
<p>官网主题(模板)： <a href="https://hexo.io/themes/" target="_blank" rel="noopener">https://hexo.io/themes/</a><br>
中文版官网：<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/</a></p>
<h2 id="step-0-前提安装有node-js">step 0 前提安装有Node.js</h2>
<p>如果您的电脑中尚未安装Node.js，安装 Node.js 的最佳方式是使用 nvm。<br>
可参考这篇来安装Node.js ：<a href="../Install-node-js-and-nvm.html">Install node.js and nvm</a></p>
<blockquote>
<p>Windows 用户<br>
对于windows用户来说，建议使用安装程序进行安装。安装时，请勾选Add to PATH选项。<br>
另外，您也可以使用Git Bash，这是git for windows自带的一组程序，提供了Linux风格的shell，在该环境下，您可以直接用上面提到的命令来安装Node.js。打开它的方法很简单，在任意位置单击右键，选择“Git Bash Here”即可。由于Hexo的很多操作都涉及到命令行，您可以考虑始终使用Git Bash来进行操作。</p>
</blockquote>
<h2 id="step1-安装-hexo">step1 安装 Hexo</h2>
<p>开始正题,所有必备的应用程序安装完成后，即可使用 npm 安装 Hexo。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
<h2 id="step2-init-hexo">step2 init Hexo</h2>
<p>安装 Hexo 完成后，请执行下列命令，Hexo 将会在指定文件夹中(我新建了文件夹hexofolder)新建所需要的文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo init hexofolder</span><br><span class="line"><span class="built_in">cd</span> hexofolder</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>
<p>新建完成后，指定文件夹的目录如下：</p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── <span class="variable">_config</span>.yml</span><br><span class="line">├── package.json</span><br><span class="line">├── scaffolds</span><br><span class="line">├── source</span><br><span class="line">|   ├── <span class="variable">_drafts</span></span><br><span class="line">|   └── <span class="variable">_posts</span></span><br><span class="line">└── themes</span><br></pre></td></tr></table></figure>
<p>_config.yml<br>
网站的 配置 信息，您可以在此<a href="https://hexo.io/zh-cn/docs/configuration" target="_blank" rel="noopener">配置大部分的参数</a>。</p>
<p>package.json<br>
应用程序的信息。EJS, Stylus 和 Markdown renderer 已默认安装，您可以自由移除。(具体看官方文档，这里就不赘述了)</p>
<p>scaffolds<br>
模版 文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。</p>
<p>Hexo的模板是指在新建的markdown文件中默认填充的内容。例如，如果您修改scaffold/post.md中的Front-matter内容，那么每次新建一篇文章时都会包含这个修改。</p>
<p>source<br>
资源文件夹是存放用户资源的地方。除 <em>posts 文件夹之外，开头命名为</em> (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。</p>
<p>themes<br>
主题 文件夹。Hexo 会根据主题来生成静态页面。</p>
<h2 id="step3-hexo-命令">step3 Hexo 命令</h2>
<p>在<folder>文件夹下就可以执行</folder></p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line">hexo g #hexo <span class="keyword">generate</span> 生成</span><br><span class="line">hexo s #启动本地web服务器</span><br></pre></td></tr></table></figure>
<p>这时，通过<a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a> ，访问页面。就可以看到，hexo默认带的主题landscap的效果。</p>
<blockquote>
<p>Hexo<a href="https://hexo.io/zh-cn/docs/commands" target="_blank" rel="noopener">常用的几个命令</a>：<br>
hexo generate (hexo g) 生成静态文件，会在当前目录下生成一个新的叫做public的文件夹<br>
hexo server (hexo s) 启动本地web服务，用于博客的预览<br>
hexo deploy (hexo d) 部署播客到远端（比如github, heroku等平台）<br>
另外还有其他几个常用命令：</p>
</blockquote>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">hexo new <span class="string">"postName"</span> #新建文章</span><br><span class="line">hexo new<span class="built_in"> page </span><span class="string">"pageName"</span> #新建页面</span><br></pre></td></tr></table></figure>
<p>常用简写</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">hexo n == hexo new</span><br><span class="line">hexo g == hexo generate</span><br><span class="line">hexo s == hexo server</span><br><span class="line">hexo d == hexo deploy</span><br></pre></td></tr></table></figure>
<p>常用组合</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hexo</span> d -g <span class="comment">#生成部署</span></span><br><span class="line">hexo s -g <span class="comment">#生成预览</span></span><br></pre></td></tr></table></figure>
<h2 id="step4-添加其他主题">step4 添加其他主题</h2>
<p>官网主题(模板)： <a href="https://hexo.io/themes/%EF%BC%8C%E5%9C%A8%E4%B8%8A%E9%9D%A2%E9%80%89%E6%8B%A9%E8%87%AA%E5%B7%B1%E5%96%9C%E6%AC%A2%E7%9A%84%E6%A8%A1%E6%9D%BF%EF%BC%8C%E8%BF%9B%E5%85%A5%E5%AE%83%E5%AF%B9%E5%BA%94%E7%9A%84git%E9%A1%B5%E9%9D%A2%EF%BC%8C%E8%8E%B7%E5%BE%97clone" target="_blank" rel="noopener">https://hexo.io/themes/，在上面选择自己喜欢的模板，进入它对应的git页面，获得clone</a>的链接。</p>
<p>这里以我改的主题Hexo-theme-zilan为例进行说明， 我这个主题增加了。</p>
<h3 id="安装主题">安装主题</h3>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">cd hexofolder/themes</span><br><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/CatherineLiyuankun/Hexo-theme-zilan.git</span><br></pre></td></tr></table></figure>
<p>可以看到themes文件夹下多了一个文件夹Hexo-theme-zilan。</p>
<h3 id="启用主题">启用主题</h3>
<p>修改Hexo目录下的_config.yml配置文件中的theme属性，将其设置为Hexo-theme-zilan。</p>
<h3 id="更新主题">更新主题</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes/Hexo-theme-zilan</span><br><span class="line">git pull</span><br><span class="line">hexo g <span class="comment"># 生成</span></span><br><span class="line">hexo s <span class="comment"># 启动本地web服务器</span></span><br></pre></td></tr></table></figure>
<p>现在打开<a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> ，会看到我们已经应用了一个新的主题。</p>
<h2 id="step5-部署到git-pages">step5 部署到git pages</h2>
<p>这一步恐怕是最关键的一步了，让我们把在本地web环境下预览到的博客部署到github上，然后就可以直接通过<a href="http://CatherineLiyuankun.github.io/" target="_blank" rel="noopener">http://CatherineLiyuankun.github.io/</a>访问了。</p>
<p>首先需要明白所谓部署到github的原理。</p>
<p>之前步骤中在Github上创建的那个特别的repo（<a href="http://CatherineLiyuankun.github.io" target="_blank" rel="noopener">CatherineLiyuankun.github.io</a>）一个最大的特点就是其master中的html静态文件，可以通过链接<a href="http://CatherineLiyuankun.github.io" target="_blank" rel="noopener">http://CatherineLiyuankun.github.io</a>来直接访问。<br>
Hexo -g 会生成一个静态网站（第一次会生成一个public目录），这个静态文件可以直接访问。<br>
需要将hexo生成的静态网站，提交(git commit)到github上。<br>
明白了原理，怎么做自然就清晰了。</p>
<p>使用hexo deploy部署<br>
hexo deploy可以部署到很多平台，具体可以参考这个链接. 如果部署到github，需要在配置文件_config.xml中作如下修改：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: git@github.com/CatherineLiyuankun.github.io</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>
<p>注意部署到git需要提前安装一个扩展：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install</span> hexo-deployer-git <span class="comment">--save</span></span><br></pre></td></tr></table></figure>
<p>然后在命令行中执行</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hexo d</span></span><br></pre></td></tr></table></figure>
<p>即可完成部署。</p>
<p>去自己的git pages看下部署的成果吧！<a href="https://catherineliyuankun.github.io/" target="_blank" rel="noopener">https://catherineliyuankun.github.io/</a></p>
<h2 id="step5-添加分类">step5 添加分类</h2>
<h3 id="添加分类页">添加分类页</h3>
<p>新建一个页面，命名为 categories 。命令如下：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">hexo new<span class="built_in"> page </span>categories</span><br></pre></td></tr></table></figure>
<p>编辑刚新建的页面/source/categories/index.md，将页面的类型设置为 categories ，主题将自动为这个页面显示所有分类。</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">title: 分类</span><br><span class="line">date: 2018-8-22 12:39:04</span><br><span class="line">type: "categories"</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>注意：如果有启用多说 或者 Disqus 评论，默认页面也会带有评论。需要关闭的话，请添加字段 comments 并将值设置为 false，如：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">分类</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2018</span><span class="number">-8</span><span class="number">-22</span> <span class="number">12</span><span class="string">:39:04</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">"categories"</span></span><br><span class="line"><span class="attr">comments:</span> <span class="literal">false</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>
<p>在菜单中添加链接。编辑主题的 _config.yml ，将 menu 中的 categories: /categories 注释去掉，如下:</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">menu</span>:</span><br><span class="line">  home: /</span><br><span class="line">  categorie<span class="variable">s:</span> /categories</span><br><span class="line">  archive<span class="variable">s:</span> /archives</span><br><span class="line">  <span class="keyword">tag</span><span class="variable">s:</span> /<span class="keyword">tags</span></span><br></pre></td></tr></table></figure>
<p>但是这样部署之后，在分类页面还是看不到任何分类的，同时官方的next教程中并没有写。<br>
其实为文章添加分类关联的教程已经在hexo教程给出了。。<br>
下面仅仅做个简单的介绍，全面的教程参照<a href="https://hexo.io/zh-cn/docs/front-matter.html#%E5%88%86%E7%B1%BB%E5%92%8C%E6%A0%87%E7%AD%BE" target="_blank" rel="noopener">hexo官方教程</a></p>
<p>文章内添加分类：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Installing</span> <span class="string">MySQL</span> <span class="string">on</span> <span class="string">Mac</span></span><br><span class="line"><span class="attr">catalog:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2018</span><span class="number">-09</span><span class="number">-29</span> <span class="number">14</span><span class="string">:23:53</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">"zsh: command not found"</span></span><br><span class="line"><span class="attr">header-img:</span> <span class="string">"https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Installing-MySQL-on-Mac/mysql-header.png"</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">MySQL</span></span><br><span class="line"><span class="attr">categories:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">TECH</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">Database</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>
<h3 id="添加文章分类关联">添加文章分类关联</h3>
<p>hexo中有Front-matter这个概念，是文件最上方以 — 分隔的区域，用于指定个别文件的变量。举个栗子，在hexo new post article时会生成article.md文件，文件生成好的文章属性。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: hexo next 为文章添加分类</span><br><span class="line">date: 2018-8-22 18:12:43</span><br><span class="line">tags:</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>在其中添加categories属性，再部署之后就可以在分类页看到分类了</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: hexo next 为文章添加分类</span><br><span class="line">date: 2018-8-22 18:12:43</span><br><span class="line">tags:</span><br><span class="line">categories: </span><br><span class="line"><span class="bullet">- </span>Frontend</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<h2 id="step5-分类显示页面">step5+ 分类显示页面</h2>
<p>参考<a href="https://github.com/hughshen/blog/blob/c3390a5a99cfcf398a012a9cf742b7f41b49d345/app/posts/1437904915000-hexo-modify-theme.md" target="_blank" rel="noopener">hughshen的文章</a></p>
<p>我的Commit代码1：<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/5005553605b5b2c1a2077d5b025b2e387d93a030" target="_blank" rel="noopener">[categories] page and category page work</a></p>
<p>Commit 代码2：<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/2183339d41a39eb4c88847f953d08f6a8df72909" target="_blank" rel="noopener">重构archive，category, tags</a><br>
Commit 代码3：<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/84b8445e9e682c1ef284dc4a17938a16da977f89" target="_blank" rel="noopener">重构archive，category, tags2</a></p>
<p>├── archive.ejs //文章归档，包括单个分类与单个标签，调用 _partial/archive.ejs<br>
├── categories.ejs  //显示所有分类的布局，<br>
├── category.ejs  //单个分类显示的布局，调用_partial/archive.ejs<br>
├── tags.ejs  //显示所有显示的布局，调用 _partial/archive.ejs, 调用_partial/tags.ejs</p>
<h2 id="step6-多级分类显示">step6 多级分类显示</h2>
<p>利用系统的<a href="https://hexo.io/zh-cn/docs/helpers.html#list-categories" target="_blank" rel="noopener">list_categories([categories], [options])</a>辅助函数生成分类列表;</p>
<p>&lt;%- list_categories([options]) %&gt;</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>orderby</td>
<td>分类排列方式</td>
<td>name</td>
</tr>
<tr>
<td>order</td>
<td>分类排列顺序。1, asc 升序；-1, desc 降序。</td>
<td>1</td>
</tr>
<tr>
<td>show_count</td>
<td>显示每个分类的文章总数</td>
<td>true</td>
</tr>
<tr>
<td>style</td>
<td>分类列表的显示方式。使用 list 以无序列表（unordered list）方式显示。</td>
<td>list</td>
</tr>
<tr>
<td>separator</td>
<td>分类间的分隔符号。只有在 style 不是 list 时有用。</td>
<td>,</td>
</tr>
<tr>
<td>depth</td>
<td>要显示的分类层级。0 显示所有层级的分类；-1 和 0 很类似，但是显示不分层级；1 只显示第一层的分类。</td>
<td>0</td>
</tr>
<tr>
<td>class</td>
<td>分类列表的 class 名称。</td>
<td>category</td>
</tr>
<tr>
<td>transform</td>
<td>改变分类名称显示方法的函数</td>
<td></td>
</tr>
</tbody>
</table>
<p>具体代码见Commit: <a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/e7a7cd1843986f6cc4ac124184d3d0021d93aafe" target="_blank" rel="noopener">[categories][sidebar]Make categories display as hierarchical structure in sidebar</a></p>
<h2 id="step6-分类页面显示不同背景图片">step6+ 分类页面显示不同背景图片</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- /Hexo-theme-zilan/themes/zilan/layout/_partial/header.ejs --&gt;</span><br><span class="line">&lt;!-- Post Header --&gt;</span><br><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">    header.intro-header&#123;</span><br><span class="line">        &lt;% if (is_home()) &#123; %&gt;</span><br><span class="line">            background-image: url(&apos;&lt;%= config.root + config[&quot;header-img&quot;] %&gt;&apos;); </span><br><span class="line">            /*config*/</span><br><span class="line">        &lt;%&#125; else if (is_post())&#123;%&gt;</span><br><span class="line">            background-image: url(&apos;&lt;%= page[&quot;header-img&quot;] %&gt;&apos;);</span><br><span class="line">            /*post*/</span><br><span class="line">        &lt;%&#125; else if (is_category())&#123;%&gt;</span><br><span class="line">            background-image: url(&apos;&lt;%= config.root + &quot;img/header_img/category-bg.jpg&quot; %&gt;&apos;);</span><br><span class="line">            /*category*/</span><br><span class="line">        &lt;%&#125; else &#123;%&gt;</span><br><span class="line">            background-image: url(&apos;&lt;%= config.root + page[&quot;header-img&quot;] %&gt;&apos;);</span><br><span class="line">            /*page*/</span><br><span class="line">        &lt;%&#125; %&gt;</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;% if (config.signature) &#123;%&gt;</span><br><span class="line">    #signature&#123;</span><br><span class="line">        background-image: url(&apos;&lt;%= config.root + config[&quot;signature-img&quot;] %&gt;&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;%&#125;%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;% if (config[&quot;header-cover-color&quot;]) &#123;%&gt;</span><br><span class="line">    #header-cover&#123;</span><br><span class="line">        background-color: &lt;%= config[&quot;header-cover-color&quot;] %&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;%&#125;%&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>具体代码见Commit: <a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/25b40c9d72c1eb0d62f97c376b6366d942eda12f" target="_blank" rel="noopener">[category][header]background img for url http://liyuankun.top/categories/xxxxx/</a></p>
<p>参考文章： <a href="https://blog.chonghan.me/Hexo/Hexo-change-header-background-image/" target="_blank" rel="noopener">Hexo 魔改： 为 Next 主题 Header 栏设置可变化的背景图片</a></p>
<h2 id="step7-添加widget">step7 添加widget</h2>
<p>看我的commit：<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/f799a1a0457d6c88bcd47a2502aecdbd2f4efd40" target="_blank" rel="noopener">侧边栏 添加微信二维码widget</a></p>
<h2 id="step8-模板">step8 模板</h2>
<p>在layout布局文件夹中, 可以看到有的主题布局文件是.ejs 结尾，有的是.swig结尾，其实是使用的模板不同。<br>
用于存放主题的模板文件，决定了网站内容的呈现方式，Hexo 内建 Swig 模板引擎，您可以另外安装插件来获得 EJS、Haml 或 Jade 支持，Hexo 根据模板文件的扩展名来决定所使用的模板引擎。<br>
对于下载的<a href="https://github.com/hexojs/hexo-renderer-jade" target="_blank" rel="noopener">jade的模板</a>，需要在安装插件。终端下输入</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install </span>hexo-renderer-<span class="keyword">jade </span>--save</span><br></pre></td></tr></table></figure>
<p>对于下载的<a href="https://github.com/hexojs/hexo-renderer-ejs" target="_blank" rel="noopener">Ejs的模板</a>，需要在安装插件。终端下输入：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install</span> hexo-renderer-ejs <span class="comment">--save</span></span><br></pre></td></tr></table></figure>
<p>对于下载的<a href="https://github.com/hexojs/hexo-renderer-haml" target="_blank" rel="noopener">Haml的模板</a>，需要在安装插件。终端下输入：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install</span> hexo-renderer-haml <span class="comment">--save</span></span><br></pre></td></tr></table></figure>
<h2 id="step9-支持markdown数学公式">step9 支持markdown数学公式</h2>
<blockquote>
<p>原生hexo并不支持数学公式，需要安装插件 mathJax。mathJax 是一款运行于浏览器中的开源数学符号渲染引擎，使用 mathJax 可以方便的在浏览器中嵌入数学公式。mathJax 使用网络字体产生高质量的排版，因此可适应各种分辨率，它的显示是基于文本的而非图片，因此显示效果更好。这些公式可以被搜索引擎使用，因此公式里的符号一样可以被搜索引擎检索到。</p>
</blockquote>
<h3 id="step9-1-在hexo目录-我的是hexo-theme-zilan-下安装">step9.1 在hexo目录(我的是Hexo-theme-zilan)下安装</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-math --save</span><br></pre></td></tr></table></figure>
<h3 id="step9-2-方法一配置hexo-math">step9.2 方法一配置hexo-math</h3>
<p>代码可以参考我的commit：<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/71e6f7a23dbbb4056303c6374214077491f0f183" target="_blank" rel="noopener">支持markdown数学公式</a>。</p>
<h4 id="step9-2-1-在站点配置文件-config-yml-中添加">step9.2.1 在站点配置文件_config.yml 中添加</h4>
<p>(我的是Hexo-theme-zilan/_config.yml)</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">math:</span></span><br><span class="line">  <span class="attr">engine:</span> <span class="string">'mathjax'</span> <span class="comment"># or 'katex'</span></span><br><span class="line">  <span class="attr">mathjax:</span></span><br><span class="line">    <span class="comment"># src: custom_mathjax_source</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="comment"># MathJax config</span></span><br></pre></td></tr></table></figure>
<h4 id="step9-2-2-在-zilan-主题配置文件-config-yml-中添加">step9.2.2 在 zilan 主题配置文件_config.yml 中添加</h4>
<p>并将 mathJax.enable 设为 true.<br>
(我的是Hexo-theme-zilan/themes/zilan/_config.yml)</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># MathJax Support</span></span><br><span class="line"><span class="attr">mathjax:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">cdn:</span> <span class="string">//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML</span></span><br></pre></td></tr></table></figure>
<h4 id="step9-2-3-mathjax-ejs">step9.2.3 mathjax.ejs</h4>
<p>在Hexo-theme-zilan/themes/zilan/layout/_third-party/添加 mathjax.ejs<br>
mathjax.ejs</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;% if(theme.mathjax.enable) &#123; %&gt; </span><br><span class="line">  &lt;% if (!theme.mathjax.per_page || (page.total || page.mathjax)) &#123; %&gt; </span><br><span class="line">    &lt;script type=&quot;text/x-mathjax-config&quot;&gt;</span><br><span class="line">      MathJax.Hub.Config(&#123;</span><br><span class="line">        tex2jax: &#123;</span><br><span class="line">          inlineMath: [ [&apos;$&apos;,&apos;$&apos;], [&quot;\\(&quot;,&quot;\\)&quot;]  ],</span><br><span class="line">          processEscapes: true,</span><br><span class="line">          skipTags: [&apos;script&apos;, &apos;noscript&apos;, &apos;style&apos;, &apos;textarea&apos;, &apos;pre&apos;, &apos;code&apos;]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script type=&quot;text/x-mathjax-config&quot;&gt;</span><br><span class="line">      MathJax.Hub.Queue(function() &#123;</span><br><span class="line">        var all = MathJax.Hub.getAllJax(), i;</span><br><span class="line">        for (i=0; i &lt; all.length; i += 1) &#123;</span><br><span class="line">          all[i].SourceElement().parentNode.className += &apos; has-jax&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;&lt;%= theme.mathjax.cdn%&gt;&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;% &#125; %&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>
<h4 id="step9-2-4-mathjax-ejs配置">step9.2.4 mathjax.ejs配置</h4>
<p>添加到Hexo-theme-zilan/themes/zilan/layout/layout.ejs中：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- Markdown math --&gt;</span><br><span class="line">&lt;% include ./_third-party/mathjax.ejs %&gt;</span><br></pre></td></tr></table></figure>
<h3 id="step9-2-方法二-直接添加hexo-math-不推荐">step9.2 方法二 直接添加hexo-math(不推荐)</h3>
<p>建议用方法一，方便灵活配置。<br>
添加到Hexo-theme-zilan/themes/zilan/layout/layout.ejs中：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">src</span>=<span class="string">"http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="step10-hexo博客中插入音乐和视频">step10 Hexo博客中插入音乐和视频</h2>
<p><a href="../Hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%8F%92%E5%85%A5%E9%9F%B3%E4%B9%90%E5%92%8C%E8%A7%86%E9%A2%91.html">Hexo博客中插入音乐和视频</a></p>
<h2 id="step11-hexo插入相对路径">step11 Hexo插入相对路径</h2>
<p><a href="../hexo-reference%20path%20for%20link%20to%20another%20blog%20post.html">Hexo博客中插入相对路径</a></p>
<h1 id="5-博客配置">5 博客配置</h1>
<h2 id="5-1-绑定域名">5.1 绑定域名</h2>
<h3 id="step1-买域名">step1 买域名</h3>
<p>可以在<a href="https://wanwang.aliyun.com/domain/?spm=5176.8006371.1007.dnetcndomain.q1ys4x" target="_blank" rel="noopener">阿里云</a>购买的域名。我这个 liyuankun.top 的域名第一年才只要1元(<a href="https://wanwang.aliyun.com/domain/1yuan?spm=5176.8112568.483655.12.3c8f9ed5abPlyL" target="_blank" rel="noopener">新用户特惠</a>)~ 我又续了9年，共10年才145元。</p>
<p>域名尽量选择短一点比较好记住，中文域名比如 博客.top ,GitHub Pages 无法处理中文域名，会导致你的域名在你的主页上不能使用。</p>
<p>常见国际域名后缀：.com，.net，.top，tech，.ink，.info，.win等<br>
常见国内域名后缀：.cn,   .com.cn,  .cx,  .cc,  .xin等</p>
<h3 id="step2-域名解析">step2 域名解析</h3>
<p>在你的域名注册提供商那里配置DNS解析，获取<a href="https://help.github.com/articles/setting-up-an-apex-domain/" target="_blank" rel="noopener">GitHub的IP地址</a>, 或者直接ping <a href="http://CatherineLiyuankun.github.io" target="_blank" rel="noopener">CatherineLiyuankun.github.io</a>, 得到IP。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ping CatherineLiyuankun.github.io</span><br><span class="line">PING catherineliyuankun.github.io (185.1xx.xxx.153): 56 data bytes</span><br><span class="line">64 bytes from 185.1xx.xxx.153: icmp_seq=0 ttl=47 time=459.228 ms</span><br></pre></td></tr></table></figure>
<h4 id="🌐-根域名-如-example-com-：添加-a记录">​​🌐 根域名（如 <a href="http://example.com" target="_blank" rel="noopener">example.com</a>）​​：添加 ​​A记录​</h4>
<p>指向GitHub Pages的IP地址（需4条记录）：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">主机记录：@</span>  </span><br><span class="line"><span class="string">记录类型：A</span>  </span><br><span class="line"><span class="string">记录值：</span>  </span><br><span class="line">  <span class="number">185.199</span><span class="number">.108</span><span class="number">.153</span>  </span><br><span class="line">  <span class="number">185.199</span><span class="number">.109</span><span class="number">.153</span>  </span><br><span class="line">  <span class="number">185.199</span><span class="number">.110</span><span class="number">.153</span>  </span><br><span class="line">  <span class="number">185.199</span><span class="number">.111</span><span class="number">.153</span>  </span><br><span class="line"><span class="string">TTL：自动（默认）</span></span><br></pre></td></tr></table></figure>
<p>如果绑定的是顶级域名，则DNS要新建一条A记录，指向185.1xx.xxx.153等4个IP。<br>
@, 代表 liyuankun.top，记录值就是我们博客的IP地址，刚才ping出的地址 185.1xx.xxx.153</p>
<p>在配置 GitHub Pages 的自定义域名时，为根域名（如 <a href="http://example.com" target="_blank" rel="noopener">example.com</a>）添加 ​​4 个 A 记录​​，分别指向 185.199.108.153、185.199.109.153、185.199.110.153和 185.199.111.153，主要是出于以下核心原因：</p>
<ol>
<li>
<p>​​负载均衡与高可用性​​<br>
GitHub Pages 使用​​全球分布式服务器​​部署，这四个 IP 地址对应不同地理位置的服务器节点（如北美、欧洲、亚洲等）。<br>
当用户访问网站时，DNS 系统会根据用户地理位置自动选择​​最近的服务器 IP​​，显著提升访问速度并降低延迟。<br>
若某一服务器故障或维护，其他 IP 可无缝接管流量，避免服务中断。</p>
</li>
<li>
<p>​​冗余设计提升可靠性​​</p>
</li>
</ol>
<ul>
<li>单一 IP 存在​​单点故障风险​​（如服务器宕机、网络波动）。通过配置多个 IP，DNS 系统可自动切换至可用节点，确保网站持续可访问。</li>
<li>GitHub 官方明确要求为根域名配置 ​​4 个 A 记录​​，这是其服务架构的强制设计。</li>
</ul>
<ol start="3">
<li>
<p>​​支持 HTTPS 证书签发​​<br>
GitHub Pages 为自定义域名​​自动签发 TLS 证书​​（通过 Let’s Encrypt），而证书验证过程需确保域名解析到 GitHub 的服务器集群。多个 IP 地址能提高证书验证的成功率。<br>
若仅配置单一 IP，可能因区域解析不稳定导致证书签发失败或 HTTPS 无法启用。</p>
</li>
<li>
<p>​​与 CNAME 记录的限制互补​​</p>
</li>
</ol>
<ul>
<li>根域名（如 <a href="http://example.com" target="_blank" rel="noopener">example.com</a>）​​不能直接使用 CNAME 记录​​（违反 DNS 协议规范），必须通过 A 记录解析到 IP 地址。</li>
<li>子域名（如 &lt;<a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a>）可灵活使用&gt; CNAME 指向 <a href="http://username.github.io" target="_blank" rel="noopener">username.github.io</a>，但根域名需依赖多 IP 的 A 记录实现类似效果。</li>
</ul>
<h4 id="🔗-子域名-如-www-example-com-：添加-cname记录">​​🔗 子域名（如 &lt;<a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a>）​​：添加&gt; ​​CNAME记录</h4>
<p>指向GitHub Pages默认域名：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">主机记录：www</span>  </span><br><span class="line"><span class="string">记录类型：CNAME</span>  </span><br><span class="line"><span class="string">记录值：`你的GitHub用户名.github.io`（例如</span> <span class="string">`catherineliyuankun.github.io`）</span>  </span><br><span class="line"><span class="string">TTL：自动</span></span><br></pre></td></tr></table></figure>
<p>如果绑定的是二级域名，则DNS要新建一条CNAME记录，<a href="http://xn--CatherineLiyuankun-m254at60r.github.com" target="_blank" rel="noopener">指向CatherineLiyuankun.github.com</a><br>
主机记录为 www,代表可以解析 &lt;www.liyuankun.top的域名。&gt;</p>
<p>此外，别忘了将_config.yml文件中的baseurl改成根目录&quot;/&quot;。</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5_1-step3.png" alt="5_1-step3.png"></p>
<h3 id="step3-修改cname">step3 修改CNAME</h3>
<p>如果你不想用<a href="http://username.github.io" target="_blank" rel="noopener">http://username.github.io</a>这个域名，可以换成自己的域名。</p>
<p>具体方法是在repo的根目录下面，新建一个名为CNAME的文本文件（注意一定是大写的！！！），里面写入你要绑定的域名，<a href="http://xn--liyuankun-k99pf62n.xn--topxxx-r06lr19q.example.com" target="_blank" rel="noopener">比如liyuankun.top或者xxx.example.com</a>。<br>
或者是在github 你的pages库：<a href="http://CatherineLiyuankun.github.io" target="_blank" rel="noopener">CatherineLiyuankun.github.io</a> 的Setting 选项里，设置Custom domain：liyuankun.top。就会自动新建一个名为CNAME的文本文件，里面写入你填写的域名：liyuankun.top。<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5_1-1.png" alt="5_1-1.png"><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5_1-2.png" alt="5_1-2"></p>
<p>启用HTTPS（可选但推荐）​​<br>
完成DNS修改后，耐心等待传播（最长48小时），再启用HTTPS。DNS生效后，在GitHub仓库设置中勾选 ​​Enforce HTTPS​​，强制使用加密访问。</p>
<h3 id="step4-域名备案">step4 域名备案</h3>
<blockquote>
<p>购买好域名后我就可以直接使用它吗？<br>
如果只是用作pages博客的域名，前面三步骤就可以使用了。<br>
如果需要绑定七牛云或者其他用途，则需要域名备案。域名只有经过备案审核后才能使用，审核必须有相应的主机，光有域名不行。</p>
</blockquote>
<blockquote>
<p>那我该如何备案呢？</p>
</blockquote>
<h4 id="1通过全国公安机关互联网安全管理服务平台-备案">1通过全国公安机关互联网安全管理服务平台 备案</h4>
<p><a href="https://developer.qiniu.com/af/kb/3987/how-to-make-website-and-inquires-the-police-put-on-record-information" target="_blank" rel="noopener">如何进行公安网备案？</a></p>
<h4 id="2通过阿里云-备案">2通过阿里云 备案</h4>
<blockquote>
<ol>
<li>在阿里云登录后进入<a href="https://beian.aliyun.com/" target="_blank" rel="noopener">备案系统</a>，申请备案。</li>
</ol>
</blockquote>
<ol start="2">
<li>按表单要求填写真实的备案信息，然后点击提交。此操作需要证件照（身份证或其他有效证件）的正反面照片。按表单要求填写真实的备案信息，然后点击提交。此操作需要证件照（身份证或其他有效证件）的正反面照片。</li>
</ol>
<blockquote>
<ol start="3">
<li>提交申请后过一天或两天，阿里云工作人员会给你打电话，验证你的姓名和身份证后四位等信息就算是初审通过了。</li>
<li>接下来你需要再次登录备案系统，申请幕布拍照，然后点击指定链接，网购价值15元的幕布，以此为背景拍照再上传到备案系统。</li>
</ol>
</blockquote>
<ol start="5">
<li>工作人员会对照片进行审核，照片审核通过后他们会把你的备案信息提交给省通信管理局审核，通信管理局一般会审核11—20天，审核通过后会发短信和邮件通知你。</li>
</ol>
<h2 id="5-1-域名被劫持-gitpages重新绑定域名">5.1+ 域名被劫持+GitPages重新绑定域名</h2>
<h3 id="git-pages-verifying-your-custom-domain">Git Pages Verifying your custom domain</h3>
<p>在<a href="https://github.com/CatherineLiyuankun/CatherineLiyuankun.github.io/settings/pages" target="_blank" rel="noopener">https://github.com/CatherineLiyuankun/CatherineLiyuankun.github.io/settings/pages</a> 里发现 Custom domain 不知怎么变为空的了。重新填写liyuankun.top, save后弹出error: “The custom domain <code>liyuankun.top</code> is already taken. If you are the owner of this domain, check out <a href="https://docs.github.com/pages/configuring-a-custom-domain-for-your-github-pages-site/verifying-your-custom-domain-for-github-pages" target="_blank" rel="noopener">https://docs.github.com/pages/configuring-a-custom-domain-for-your-github-pages-site/verifying-your-custom-domain-for-github-pages</a> for information about how to verify and release this domain.”</p>
<p>按照<a href="https://docs.github.com/pages/configuring-a-custom-domain-for-your-github-pages-site/verifying-your-custom-domain-for-github-pages" target="_blank" rel="noopener">文档</a>的步骤，进入到git profile下的setting: <a href="https://github.com/settings/" target="_blank" rel="noopener">https://github.com/settings/</a> --&gt; In the “Code, planning, and automation” section of the sidebar, click  <code>Pages</code></p>
<ol>
<li>Create a TXT record in your DNS configuration for the following hostname: <code>_github-pages-challenge-CatherineLiyuankun.liyuankun.top</code></li>
<li>Use this code for the value of the TXT record: cxxxxxxxxxxxxxxxxx0</li>
<li>Wait until your DNS configuration changes. This could take up to 24 hours to propagate.</li>
</ol>
<p>前两步的核心目的​​</p>
<ol>
<li>​域名所有权验证​​GitHub 要求您在 DNS 中创建一条​​专属的 TXT 记录​​（主机名 _github-pages-challenge-CatherineLiyuankun.liyuankun.top，值 c58…6f0），以此证明您对该域名拥有控制权。
<ul>
<li>只有真正的域名所有者才能修改 DNS 记录，因此这是最直接的验证方式。</li>
<li>​​TXT 记录的作用​​TXT 记录用于存储域名相关的文本信息（如验证码）。GitHub 通过向 DNS 系统查询该记录是否存在且匹配，确认您是否按指示完成了操作。</li>
<li>​​主机名的唯一性​​主机名 _github-pages-challenge-CatherineLiyuankun.liyuankun.top包含您的 GitHub 用户名（CatherineLiyuankun），确保验证码与您的账户绑定，他人无法复用。</li>
</ul>
</li>
<li>​​防止域名劫持（Domain Takeover）​​未经验证的域名可能被他人恶意绑定到其他 GitHub Pages 仓库（例如当您删除仓库或降级服务时）。
<ul>
<li>验证后，GitHub 会锁定该域名，仅允许您的账户或组织使用它发布页面。</li>
</ul>
</li>
<li>​​安全保护范围扩展​​验证顶级域名（如 liyuankun.top）后，其所有​​直接子域名​​（如 docs.liyuankun.top、blog.liyuankun.top）也会自动受到保护，避免被滥用。</li>
</ol>
<h3 id="修改-dns-的具体操作步骤">​​修改 DNS 的具体操作步骤​​</h3>
<p>⚙️ 1. ​​登录域名注册商控制台​​<br>
访问你的域名注册商网站（如阿里云、腾讯云、Cloudflare 等），登录账户。<br>
进入 ​​DNS 管理面板​​（通常位于“域名管理”→“DNS 设置”或“域名解析”）。</p>
<p>📝 2. ​​添加 TXT 记录​​<br>
点击 ​​“添加记录”​​ 按钮（部分服务商需选择“添加解析记录”）。<br>
按以下参数填写：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">​​记录类型​​：选择</span> <span class="string">​​TXT​​</span></span><br><span class="line"><span class="string">​​主机名/主机记录​​：_github-pages-challenge-CatherineLiyuankun.liyuankun.top（​​⚠️</span> <span class="string">注意：需完整复制</span> <span class="string">GitHub</span> <span class="string">提供的主机名，包含开头的下划线</span> <span class="string">_​​）</span></span><br><span class="line"><span class="string">​​记录值/内容​​：c5xxxxxxxxxxxxxxxxxf0（​​粘贴</span> <span class="string">GitHub</span> <span class="string">提供的完整验证码，包括引号（若有）​​）</span></span><br><span class="line"><span class="string">​​TTL（生存时间）​​：保持默认值（通常为</span> <span class="string">自动或</span> <span class="number">600</span><span class="string">）。</span></span><br></pre></td></tr></table></figure>
<p>💾 3. ​​保存并生效​​<br>
点击 ​​“保存”​​ 或 ​​“确认”​​，完成记录添加。<br>
等待 ​​DNS 全球传播​​（通常需 ​​5 分钟~24 小时​​）。</p>
<p>✔️ ​​验证是否生效​​<br>
🔍 方法 1：使用命令行工具</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dig _github-pages-challenge-CatherineLiyuankun.liyuankun.to +nostats +nocomments +nocmd TXT</span><br></pre></td></tr></table></figure>
<p>若返回结果包含 “c58xxxxxxxxxxxxxxx6f0”，说明记录已生效。</p>
<p>🌐 方法 2：在线 DNS 检测工具<br>
访问 DNS Checker 或者点击“生效检测”，输入完整主机名，选择 TXT类型查询。<br>
若全球多个节点均返回正确验证码，表示记录已生效。</p>
<p>⚠️ ​​关键注意事项​​</p>
<ol>
<li>​​严格匹配格式​​：<br>
主机名需包含开头的下划线 _和完整的域名（如_github-pages-challenge-用户名.域名）。<br>
验证码需完全复制（包括字母大小写和数字），部分服务商要求值用引号包裹（如 “c58…6f0”）。</li>
<li>​​长期保留记录​​：<br>
​​不可删除 TXT 记录​​！即使验证成功，删除后 GitHub 会判定验证失效。</li>
<li>​​与后续步骤的关系​​：<br>
此操作仅用于所有权验证，仍需按需配置 ​​A 记录（根域名）​​ 或 ​​CNAME 记录（子域名）​​ 指向 GitHub Pages IP。</li>
</ol>
<h3 id="dns生效后-verify">DNS生效后，Verify</h3>
<h2 id="5-2-网站统计">5.2 网站统计</h2>
<h3 id="5-2-1-sitemap">5.2.1 <a href="https://github.com/hexojs/hexo-generator-sitemap" target="_blank" rel="noopener">sitemap</a></h3>
<p>hexo所在文件夹下，命令行安装sitemap:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line">npm install hexo-generator-baidu-sitemap --save</span><br></pre></td></tr></table></figure>
<p>在_config.yml里添加：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sitemap</span></span><br><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">sitemap.xml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">baidusitemap:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">baidusitemap.xml</span></span><br></pre></td></tr></table></figure>
<p>如果你已经配置了自己的域名，在_config.yml里修改url为自己的域名，例如我的<a href="http://liyuankun.top/">http://liyuankun.top/</a>。</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">url:</span> <span class="string">http://liyuankun.top</span></span><br></pre></td></tr></table></figure>
<p>生成sitemap.xml 和 baidusitemap.xml 文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>
<p>配完之后，就可以访问<a href="http://liyuankun.top/sitemap.xml%E5%92%8Chttp://liyuankun.top/baidusitemap.xml">http://liyuankun.top/sitemap.xml和http://liyuankun.top/baidusitemap.xml</a>，发现文件已经成功生成了.</p>
<p>老版本的Google Search Console 在抓取–》 robots.txt测试工具 可以 测试robots.txt。 新版本中好像找不到了。。。后来找到了，robots.txt <a href="https://support.google.com/webmasters/answer/6062598" target="_blank" rel="noopener">测试工具链接</a>在此。<br>
百度也有<a href="https://ziyuan.baidu.com/robots/index?site=http://liyuankun.top/" target="_blank" rel="noopener">robots.txt工具</a>。</p>
<p>借助 robots.txt 测试工具，您可以检查 robots.txt 文件是否可以阻止 Google 网页抓取工具访问您网站上的特定网址。例如，您可以使用此工具来测试 Googlebot-Image 抓取工具能否抓取您想阻止 Google 图片搜索访问的图片网址。</p>
<p>在your-hexo-site\source中新建文件robots.txt,内容可以参照:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># hexo robots.txt</span><br><span class="line">User-agent: *</span><br><span class="line">Allow: /</span><br><span class="line">Allow: /archives/</span><br><span class="line">Allow: /categories/</span><br><span class="line">Allow: /tags/</span><br><span class="line">Allow: /about-me/</span><br><span class="line">Disallow: /vendors/</span><br><span class="line">Disallow: /js/</span><br><span class="line">Disallow: /css/</span><br><span class="line">Disallow: /fonts/</span><br><span class="line">Disallow: /vendors/</span><br><span class="line">Disallow: /fancybox/</span><br><span class="line">Sitemap: http://liyuankun.top/sitemap.xml</span><br><span class="line">Sitemap: http://liyuankun.top/baidusitemap.xml</span><br></pre></td></tr></table></figure>
<h3 id="5-2-2-google-search-console">5.2.2 <a href="https://search.google.com/search-console/about" target="_blank" rel="noopener">Google Search Console</a></h3>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5_2-2GoogleSearchConsole-1welcom.png" alt="5_2-2GoogleSearchConsole-1welcom"></p>
<p>然后选择验证方式：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5_2-2GoogleSearchConsole-2verify.png" alt="5_2-2GoogleSearchConsole-2verify"></p>
<p>我选择的验证方式是HTML标记（HTML Tag）,<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5_2-2GoogleSearchConsole-2verifyHtmlTag.png" alt="5_2-2GoogleSearchConsole-2verifyHtmlTag"></p>
<p>把复制的&quot;&lt;meta …&gt;&quot;部分粘贴到 your hexo folder/themes/zilan/layout/_partial/head.ejs</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- other tag --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"google-site-verification"</span> <span class="attr">content</span>=<span class="string">"4aJ9pFEKjOcI9zlltw5NYLKMsnk_Ygy49okv3PcTknw"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- other tag --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>提交sitemap<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5_2-2GoogleSearchConsole-3sitemap.png" alt="5_2-2GoogleSearchConsole-3sitemap"></p>
<h3 id="5-2-3-baidu-sitemap">5.2.3 Baidu sitemap</h3>
<p><a href="https://ziyuan.baidu.com/site/#/" target="_blank" rel="noopener">百度搜索引擎提交入口</a><br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5.2.3Baidu1.png" alt="5.2.3Baidu1"><br>
百度搜索有三种验证方式，我选择Html标签验证，把复制的&quot;&lt;meta …&gt;&quot;部分粘贴到 your hexo folder/themes/zilan/layout/_partial/head.ejs：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- other tag --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"baidu-site-verification"</span> <span class="attr">content</span>=<span class="string">"JFD0vIDsbS"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- other tag --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>验证成功后，查看<a href="https://ziyuan.baidu.com/dashboard/index?site=http://liyuankun.top/" target="_blank" rel="noopener">站点信息</a></p>
<p>百度的sitemap提交需要邀请才可以，并没有对所有网站开放，网站高一点等级才会在你后台开放提交sitemap的入口。</p>
<p><a href="https://ziyuan.baidu.com/robots/index?site=http://liyuankun.top/" target="_blank" rel="noopener">robots.txt工具</a>可以告诉百度您网站的哪些页面可以被抓取，哪些页面不可以被抓取。<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5.2.3Baidu2Robots.png" alt="5.2.3Baidu2Robots"></p>
<h3 id="5-2-4-analytics">5.2.4 Analytics</h3>
<p>集成了 <a href="https://marketingplatform.google.com/about/" target="_blank" rel="noopener">Baidu Analytics</a> 和 <a href="https://marketingplatform.google.com/about/" target="_blank" rel="noopener">Google Analytics</a>，到各个网站注册拿到track_id替换下面的就可以了</p>
<p>配置方法： <a href="https://www.jianshu.com/p/7e1166eb412a" target="_blank" rel="noopener">https://www.jianshu.com/p/7e1166eb412a</a></p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line"><span class="section"># Analytics settings</span></span><br><span class="line"><span class="section"># Baidu Analytics</span></span><br><span class="line"><span class="section"># ba_track_id: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></span><br><span class="line"><span class="section"># Google Analytics</span></span><br><span class="line">ga<span class="emphasis">_track_</span>id: 'UA-XXXXXXXX-X'          # Format: UA-xxxxxx-xx</span><br><span class="line">ga_domain: yoursite</span><br></pre></td></tr></table></figure>
<h3 id="5-2-5-添加baidu站内搜索">5.2.5 添加baidu站内搜索</h3>
<p>添加<a href="https://ziyuan.baidu.com/cse/wiki/introduce" target="_blank" rel="noopener">百度站内搜索</a>，点击现在使用-&gt;新建搜索引擎-&gt;查看代码，将代码里的id值复制，打开_config.xml，添加配置。</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">baidu_search:</span>     <span class="comment">## http://zn.baidu.com/</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">id:</span> <span class="string">"567867xxxxx1171234"</span> <span class="comment">## for your baidu search id</span></span><br><span class="line">  <span class="attr">site:</span> <span class="string">http://zhannei.baidu.com/cse/search</span> <span class="comment">## your can change to your site instead of the default site</span></span><br></pre></td></tr></table></figure>
<h2 id="5-3-评论">5.3 评论</h2>
<h3 id="disqus"><a href="https://disqus.com/" target="_blank" rel="noopener">Disqus</a></h3>
<p>博客中使用的是 <a href="https://disqus.com/" target="_blank" rel="noopener">Disqus</a> 评论系统，注册帐号后，按下面的步骤简单的配置即可：</p>
<blockquote>
<p>一定一定要注意不是username!!! 是shortname！！！！</p>
</blockquote>
<p>刚开始被有些文章误导了，disqus_username: 填成username。造成评论一直无法显示!</p>
<blockquote>
<p>We were unable to load Disqus. If you are a moderator please see our troubleshooting guide.</p>
</blockquote>
<p>什么是shortname?  <a href="https://help.disqus.com/installation/whats-a-shortname" target="_blank" rel="noopener">https://help.disqus.com/installation/whats-a-shortname</a><br>
去哪找shortname呢？<br>
在<a href="https://disqus.com/admin/create/" target="_blank" rel="noopener">https://disqus.com/admin/create/</a>  点击setting。<br>
没创建页面的先创建页面，输入网站名（就是根据这个生成Shortname的）lyk,<br>
下一步选免费的，然后选应用，填网址<a href="https://catherineliyuankun.github.io/" target="_blank" rel="noopener">https://catherineliyuankun.github.io/</a>。成功！</p>
<blockquote>
<p>Shortname    Your website shortname is lyk-1</p>
</blockquote>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5_3-1.png" alt="5_3-1.png"></p>
<p>这个 Shortname 就是我们 _config.yml 中 disqus_username</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Disqus settings</span></span><br><span class="line"><span class="attr">disqus_username:</span> <span class="string">lyk-1</span></span><br></pre></td></tr></table></figure>
<h3 id="gitment">Gitment</h3>
<h4 id="step-1-注册-oauth-application"><strong>step 1 注册 OAuth Application</strong></h4>
<ol>
<li>登录 Github。 注册 <a href="https://github.com/settings/profile" target="_blank" rel="noopener">https://github.com/settings/profile</a> (左侧下方的 Developer<br>
settings-&gt;点击绿色 Register a new application)</li>
<li>填写：</li>
</ol>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">Application name：Gitment</span><br><span class="line">Homepage <span class="built_in">URL</span>：<span class="keyword">https</span>://catherineliyuankun.github.io/</span><br><span class="line">Application description：Blog comment <span class="keyword">system</span></span><br><span class="line">Authorization callback <span class="built_in">URL</span>：<span class="keyword">https</span>://catherineliyuankun.github.io/</span><br></pre></td></tr></table></figure>
<p>点击 Register application后获取：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Client ID: xxxx</span><br><span class="line">Client Secret: xxxxxxxxxx</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>新建一个git 库存放 gitment-comments, Repository name 为 gitment-comments<br>
地址：<a href="https://github.com/catherineliyuankun/gitment-comments" target="_blank" rel="noopener">https://github.com/catherineliyuankun/gitment-comments</a><br>
但是稍后填的是库名：gitment-comments，不是地址。</li>
</ol>
<h4 id="step-2-添加-gitment-到博客">step 2 添加 Gitment 到博客</h4>
<p>打开 __config.yml, 添加设置：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">gitment:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mint:</span> <span class="literal">true</span>   <span class="comment"># RECOMMEND, A mint on Gitment, to support count, language and proxy_gateway</span></span><br><span class="line">  <span class="attr">count:</span> <span class="literal">true</span>   <span class="comment"># Show comments count in post meta area</span></span><br><span class="line">  <span class="attr">lazy:</span> <span class="literal">false</span>   <span class="comment"># Comments lazy loading with a button</span></span><br><span class="line">  <span class="attr">cleanly:</span> <span class="literal">false</span>  <span class="comment"># Hide 'Powered by ...' on footer, and more</span></span><br><span class="line">  <span class="attr">language:</span>   <span class="comment"># Force language, or auto switch by theme</span></span><br><span class="line">  <span class="attr">github_user:</span> <span class="string">catherineliyuankun</span>  <span class="comment"># 此处 - Your Github ID</span></span><br><span class="line">  <span class="attr">github_repo:</span> <span class="string">gitment-comments</span> <span class="comment"># 此处注意 - The repo you use to store Gitment comments</span></span><br><span class="line">  <span class="attr">client_id:</span> <span class="string">xxxxxxxxxxxxxxxxxx</span> <span class="comment"># 此处 - Github client id for the Gitment</span></span><br><span class="line">  <span class="attr">client_secret:</span> <span class="string">xxxxxxxxxxxxx</span> <span class="comment"># 此处 - Github access secret token for the Gitment</span></span><br><span class="line">  <span class="attr">proxy_gateway:</span> <span class="comment"># Address of api proxy, See: https://github.com/aimingoo/intersect</span></span><br><span class="line">  <span class="attr">redirect_protocol:</span> <span class="comment"># Protocol of redirect_uri with force_redirect_protocol when mint enabled</span></span><br></pre></td></tr></table></figure>
<p>添加gitment代码（页面，样式，script等）到主题：我的主题的<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/28458cf69588837448ab769f645eea3948a704fc" target="_blank" rel="noopener">commit gitment代码</a></p>
<p>部署:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo g -d</span><br></pre></td></tr></table></figure>
<p>之后文章底部会出现 初始化本文的评论页，点击初始化。</p>
<h2 id="5-4-二维码">5.4 二维码</h2>
<p>添加微信二维码 commit 代码 ：<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/f799a1a0457d6c88bcd47a2502aecdbd2f4efd40" target="_blank" rel="noopener">Add wechat QR code widget</a></p>
<h2 id="5-5-git-fork-me">5.5 git fork me</h2>
<p>获取<a href="https://blog.github.com/2008-12-19-github-ribbons/" target="_blank" rel="noopener">forlk me代码</a>，选择你喜欢的代码添加到hexo/themes/zilan/layout/layout.ejs的末尾即可，注意要将代码里的you改成你的Github账号名。</p>
<p>我的博客模板的<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/15cced30f3d95e466cd5d10f8f3a462707c9d336" target="_blank" rel="noopener">commit</a>。</p>
<h2 id="5-6-使用图床">5.6 使用图床</h2>
<h3 id="七牛云">七牛云</h3>
<p>有很多推荐<a href="https://portal.qiniu.com/signup?code=3lbl5aqwrovv6" target="_blank" rel="noopener">七牛云</a>, 具体方法可以看<a href="https://www.jianshu.com/p/44d818f781a7" target="_blank" rel="noopener">这篇文章</a>.</p>
<p>用插件上传图片时报错：</p>
<blockquote>
<p>请求报文格式错误。(400：incorrect region, please use <a href="http://up-z2.qiniup.com" target="_blank" rel="noopener">up-z2.qiniup.com</a>)<br>
我之前选的“华南”地区。伤心，查了查官网上传没有问题，可以自动切换上传区域。插件可能还没更新最新的sdk造成的。算了先用官网上传吧。</p>
</blockquote>
<p><a href="https://developer.qiniu.com/kodo/manual/1671/region-endpoint" target="_blank" rel="noopener">存储区域和上传域名的对应关系</a>：<br>
<a href="https://developer.qiniu.com/kodo/kb/3882/upload-problem-faq" target="_blank" rel="noopener">上传慢、上传失败等上传常见问题的处理方法</a></p>
<p>除了上传图片的基本功能，还可以<a href="https://developer.qiniu.com/dora/manual/1316/image-watermarking-processing-watermark" target="_blank" rel="noopener">添加水印</a>。<a href="https://blog.csdn.net/yongf2014/article/details/50016761" target="_blank" rel="noopener">制作图片水印以及缩略图</a></p>
<p>但是现在七牛云的测试域名30天就会回收不能使用了，需要<a href="https://portal.qiniu.com/cdn/domain/create?ref=developer.qiniu.com" target="_blank" rel="noopener">绑定自己的域名</a>，但是自己的域名必须<a href="https://developer.qiniu.com/af/kb/3987/how-to-make-website-and-inquires-the-police-put-on-record-information" target="_blank" rel="noopener">公安网备案</a>才可以使用。备案审核必须有相应的主机，光有域名不行。也就是说你只买有域名，同时没有买过（或租）服务器是无法审核的。所以不想买主机的童鞋可以用下面👇的方法，或者换其他的图床。</p>
<h3 id="github-做图床">github 做图床</h3>
<p>用github新建个库，<a href="https://github.com/CatherineLiyuankun/PicturexxBed" target="_blank" rel="noopener">PictureBed</a>专门放我的博客图好了。</p>
<blockquote>
<p>注意! 一定要设置成Public的，不要设置成private私有的。<br>
注意! 一定要设置成Public的，不要设置成private私有的。<br>
注意! 一定要设置成Public的，不要设置成private私有的。<br>
设置成私有后，图片链接会带有?token=AB6MExxxxxxxxI5K6XVVI4<br>
<a href="https://raw.githubusercontent.com/CatherineLiyuankun/PictureBed/master/blog/post/xxx.png?token=AB6MExxxxxxxxI5K6XVVI4" target="_blank" rel="noopener">https://raw.githubusercontent.com/CatherineLiyuankun/PictureBed/master/blog/post/xxx.png?token=AB6MExxxxxxxxI5K6XVVI4</a><br>
过一段时间token会失效，获取图片就会返回404<br>
设置成public,就可以继续用了</p>
</blockquote>
<p>克隆到本地：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/CatherineLiyuankun/PicturexxBed.git</span><br></pre></td></tr></table></figure>
<p>然后添加图片。<br>
需要注意的是：到GitHub提取图片地址时，注意把blob改成 raw。<br>
例如github中一张图片的地址是：<a href="https://github.com/CatherineLiyuankun/PictureBed/blob/master/blog/base/alipay.png" target="_blank" rel="noopener">https://github.com/CatherineLiyuankun/PictureBed/blob/master/blog/base/alipay.png</a></p>
<p>在博客中图片使用时的地址是：<br>
<a href="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/alipay.png" target="_blank" rel="noopener">https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/base/alipay.png</a></p>
<h2 id="5-7-rss订阅">5.7 RSS订阅</h2>
<p>我的<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/28f6a36b995656795f1a1ffc844d74964875f872" target="_blank" rel="noopener">commit</a></p>
<h3 id="安装插件">安装插件</h3>
<p>hexo博客有一个专门生成RSS xml文件的插件hexo-generator-feed。<br>
安装：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure>
<h3 id="配置">配置</h3>
<p>_config.yml文件中添加如下内容</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="attr">plugins:</span></span><br><span class="line">    <span class="string">hexo-generator-feed</span></span><br><span class="line"><span class="comment">#Feed Atom</span></span><br><span class="line"><span class="attr">feed:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">atom</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">atom.xml</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">20</span></span><br></pre></td></tr></table></figure>
<h3 id="生成rss">生成RSS</h3>
<figure class="highlight zsh"><table><tr><td class="code"><pre><span class="line">➜  Hexo-theme-zilan git:(master) ✗ hexo g</span><br><span class="line">(node:88561) [DEP0061] DeprecationWarning: fs.SyncWriteStream is deprecated.</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Files loaded <span class="keyword">in</span> 437 ms</span><br><span class="line">INFO  Generated: category-sitemap.xml</span><br><span class="line">INFO  Generated: sitemap.xsl</span><br><span class="line">INFO  Generated: sitemap.xml</span><br><span class="line">INFO  Generated: tags/index.html</span><br><span class="line">INFO  Generated: about/index.html</span><br><span class="line">INFO  Generated: archive/index.html</span><br><span class="line">INFO  Generated: atom.xml     就是生成这个！</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p>可以订阅了，把<a href="https://catherineliyuankun.github.io/atom.xml" target="_blank" rel="noopener">https://catherineliyuankun.github.io/atom.xml</a>输入到邮箱的订阅地址就行了！</p>
<h2 id="5-8-font-awesome-图标">5.8 font awesome 图标</h2>
<p><a href="http://www.bootcss.com/p/font-awesome/" target="_blank" rel="noopener">http://www.bootcss.com/p/font-awesome/</a></p>
<h2 id="5-9-添加email-to">5.9 添加email to</h2>
<p><a href="https://hexo.io/zh-cn/docs/helpers#mail-to" target="_blank" rel="noopener">官网教程</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;%- mail_to(&apos;a@abc.com&apos;) %&gt;</span><br><span class="line">// &lt;a href=&quot;mailto:a@abc.com&quot; title=&quot;a@abc.com&quot;&gt;a@abc.com&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- mail_to(&apos;a@abc.com&apos;, &apos;Email&apos;) %&gt;</span><br><span class="line">// &lt;a href=&quot;mailto:a@abc.com&quot; title=&quot;Email&quot;&gt;Email&lt;/a&gt;</span><br></pre></td></tr></table></figure>
<p>我的<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/246e4e2c3b93426bbbeef1e347067da4e01b947e" target="_blank" rel="noopener">commit代码</a>，还用到了font awesome 图标。</p>
<h2 id="5-10-捐赠-赏">5.10 捐赠/赏</h2>
<p>我的<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/b080910aeea650d72ab4932fd2673f885c05b21c" target="_blank" rel="noopener">commit代码</a><br>
在_config.yml里添加属性来控制是否显示捐赠按钮：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># donate</span></span><br><span class="line"><span class="attr">donate:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">donate-alipay:</span> <span class="string">img/alipay.png</span></span><br><span class="line"><span class="attr">donate-wechat:</span> <span class="string">img/wechatpay.png</span></span><br></pre></td></tr></table></figure>
<p>在zilan/layout/_partial下添加donate.ejs文件，用来放相应页面代码</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Donate --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span>(<span class="attr">config</span>['<span class="attr">donate</span>']) &#123; %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"donate-container"</span> <span class="attr">style</span>=<span class="string">"padding: 10px 0; margin: auto auto; width: 90%; text-align: center;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"rewardButton"</span> <span class="attr">disable</span>=<span class="string">"enable"</span> <span class="attr">onclick</span>=<span class="string">"var qr = document.getElementById('QR'); if (qr.style.display === 'none') &#123;qr.style.display='block';&#125; else &#123;qr.style.display='none'&#125;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>Donate<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"QR"</span> <span class="attr">style</span>=<span class="string">"display: none;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wechat"</span> <span class="attr">style</span>=<span class="string">"display: inline-block"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"wechat_qr"</span> <span class="attr">src</span>=<span class="string">"&lt;%= config['donate-wechat']%&gt;"</span> <span class="attr">alt</span>=<span class="string">"WeChat Pay"</span> <span class="attr">style</span>=<span class="string">"width: 200px; height: 200px; text-align: center;"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- &lt;p&gt;Wechat&lt;/p&gt; --&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"alipay"</span> <span class="attr">style</span>=<span class="string">"display: inline-block"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"alipay_qr"</span> <span class="attr">src</span>=<span class="string">"&lt;%= config['donate-alipay']%&gt;"</span> <span class="attr">alt</span>=<span class="string">"Alipay"</span> <span class="attr">style</span>=<span class="string">"width: 200px; height: 200px; text-align: center;"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- &lt;p&gt;Alipay&lt;/p&gt; --&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br></pre></td></tr></table></figure>
<p>在博客文章页面 themes/zilan/layout/post.ejs 里添加进捐献页面donate.ejs</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;%- partial(&apos;_partial/donate&apos;) %&gt;</span><br></pre></td></tr></table></figure>
<h2 id="5-11-利用-fancybox-添加图片放大预览查看功能">5.11 利用 Fancybox 添加图片放大预览查看功能</h2>
<p>基于donate功能，为二维码图片提供点击放大的功能。<br>
我的<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/40e5b397a9d9cf5eb657c55867cd8999da3874c2" target="_blank" rel="noopener">commit代码</a></p>
<h3 id="在-config-yml里添加属性来控制是否使用fancybox按钮">在_config.yml里添加属性来控制是否使用fancybox按钮</h3>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">fancybox:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="下载fancybox库">下载fancybox库</h3>
<p>点击下载最新的 <a href="https://github.com/fancyapps/fancybox/releases/tag/v3.4.0" target="_blank" rel="noopener">fancybox 库</a>， 解压缩至 /theme/material/source/fancybox/ 目录下，这里贴出目录结构：</p>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/5_11-1.png" alt="5_11-1.png"></p>
<h3 id="在themes-zilan-source-js-下添加wrapimage-js-用于在指定的-img-外裹一层-fancybox-所需要的属性">在themes/zilan/source/js/下添加wrapImage.js, 用于在指定的 <img> 外裹一层 fancybox 所需要的属性</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Caption</span></span><br><span class="line">$(<span class="string">'.donate-container'</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line">  $(<span class="keyword">this</span>).find(<span class="string">'img'</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($(<span class="keyword">this</span>).parent().hasClass(<span class="string">'fancybox'</span>)) <span class="keyword">return</span>;</span><br><span class="line">     <span class="keyword">var</span> alt = <span class="keyword">this</span>.alt;</span><br><span class="line">     <span class="keyword">if</span> (alt) $(<span class="keyword">this</span>).after(<span class="string">'&lt;span class="caption"&gt;'</span> + alt + <span class="string">'&lt;/span&gt;'</span>);</span><br><span class="line">     $(<span class="keyword">this</span>).wrap(<span class="string">'&lt;a href="'</span> + <span class="keyword">this</span>.src + <span class="string">'" title="'</span> + alt + <span class="string">'" class="fancybox"&gt;&lt;/a&gt;'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">   $(<span class="keyword">this</span>).find(<span class="string">'.fancybox'</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $(<span class="keyword">this</span>).attr(<span class="string">'rel'</span>, <span class="string">'article'</span> + i);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> <span class="keyword">if</span> ($.fancybox)&#123;</span><br><span class="line">  $(<span class="string">'.fancybox'</span>).fancybox();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="在themes-zilan-layout-layout-ejs下添加fancybox-script-css">在themes/zilan/layout/layout.ejs下添加fancybox script, css</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;% if (theme.fancybox)&#123; %&gt;</span><br><span class="line">    &lt;%- css(&apos;/fancybox/jquery.fancybox&apos;) %&gt;</span><br><span class="line">    &lt;%- js(&apos;/fancybox/jquery.fancybox.pack&apos;) %&gt;</span><br><span class="line">    &lt;%- js(&apos;/js/wrapImage.js&apos;) %&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>
<p>成功！</p>
<h2 id="5-12-share-分享">5.12 Share 分享</h2>
<p>用的第三方组件<a href="https://github.com/revir/need-more-share2" target="_blank" rel="noopener">need-more-share2</a><br>
另外可以参考主题next添加need-more-share2的<a href="https://github.com/iissnan/hexo-theme-next/pull/1913/files" target="_blank" rel="noopener">pull request</a></p>
<p>fix bug: <a href="https://github.com/iissnan/hexo-theme-next/pull/1976" target="_blank" rel="noopener">微信分享图片无法loading出来</a><br>
source\lib\needsharebutton\needsharebutton.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> imgSrc = <span class="string">"https://api.qinco.me/api/qr?size=400&amp;content="</span> + <span class="built_in">encodeURIComponent</span>(myoptions.url);</span><br></pre></td></tr></table></figure>
<p>改为</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> imgSrc = <span class="string">"http://tool.oschina.net/action/qrcode/generate?output=image/png&amp;error=L&amp;type=0&amp;margin=2&amp;size=4&amp;data="</span> + <span class="built_in">encodeURIComponent</span>(myoptions.url);</span><br></pre></td></tr></table></figure>
<p>我的<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/3c6ca2bdef522acbc1d57bb252868481f99620b3" target="_blank" rel="noopener">commit</a></p>
<h2 id="5-13-版权声明">5.13 版权声明</h2>
<p>以zilan 主题来举例，”your_theme“ is ”zilan“。<br>
对应commit 代码： <a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/21b7d216e43e494c3757b6764198d214b021943f" target="_blank" rel="noopener">[copyright][post] add copyright</a></p>
<h3 id="5-13-1-html-内容">5.13.1 Html 内容</h3>
<p>在your_theme\layout_partial\post下面，创建一个名为copyright.ejs的文件，在里面填写</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!</span> <span class="attr">--</span> 添加版权信息 <span class="attr">--</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"article-footer-copyright"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>本文标题: <span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;%- config.root %&gt;&lt;%- page.path %&gt;"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">title</span>=<span class="string">"&lt;%= page.title %&gt;"</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">page.title</span> %&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>本文链接: <span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;%- config.root %&gt;&lt;%- page.path %&gt;"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">title</span>=<span class="string">"&lt;%= page.title %&gt;"</span>&gt;</span><span class="tag">&lt;<span class="name">%-</span> <span class="attr">config.url</span> %&gt;</span>/<span class="tag">&lt;<span class="name">%-</span> <span class="attr">page.path</span> %&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>.<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>本文由<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;%= config.root %&gt;index.html"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">title</span>=<span class="string">"&lt;%= config.author %&gt;"</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">config.author</span> %&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>创作和发表,采用<span class="tag">&lt;<span class="name">b</span>&gt;</span>BY<span class="tag">&lt;/<span class="name">b</span>&gt;</span>-<span class="tag">&lt;<span class="name">b</span>&gt;</span>NC<span class="tag">&lt;/<span class="name">b</span>&gt;</span>-<span class="tag">&lt;<span class="name">b</span>&gt;</span>SA<span class="tag">&lt;/<span class="name">b</span>&gt;</span>国际许可协议进行许可,转载请注明作者及出处。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="5-13-2-html-内容添加到post文尾">5.13.2 Html 内容添加到post文尾</h3>
<p>在your_theme/layout/post.ejs 的&lt;%- page.content %&gt;后面添加</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">&lt;<span class="meta">%</span>- partial<span class="comment">('_partial/post/copyright')</span> <span class="meta">%</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="5-13-3-修改样式css">5.13.3 修改样式css</h3>
<p>在/zilan/source/css/下创建 copyright.styl，并在head.ejs里引用   &lt;%- css(‘css/copyright’)%&gt;</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-class">.article-footer-copyright</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">2em</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: .<span class="number">5em</span> <span class="number">1em</span>;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">3px</span> solid <span class="number">#0085a1</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f9f9f9</span>;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-14-代码块复制功能">5.14 代码块复制功能</h2>
<p>参考文章： <a href="https://qiming.info/Hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E5%8A%A0%E5%85%A5%E4%BB%A3%E7%A0%81%E5%9D%97%E5%A4%8D%E5%88%B6%E5%8A%9F%E8%83%BD/" target="_blank" rel="noopener">Hexo博客中加入代码块复制功能</a></p>
<h2 id="5-15-搜索功能">5.15 搜索功能</h2>
<p>借鉴了hexo-theme-next的<a href="http://theme-next.iissnan.com/third-party-services.html#local-search" target="_blank" rel="noopener">local-search</a>，使用的<a href="https://github.com/theme-next/hexo-generator-searchdb" target="_blank" rel="noopener">hexo-generator-searchdb</a>。<br>
GitHub commit： <a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/6b672a20aa23101bf0b17f7d790c1f5ad8422843" target="_blank" rel="noopener">Add local search function</a>。</p>
<h3 id="5-15-1-install-hexo-generator-searchdb">5.15.1 install hexo-generator-searchdb</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>
<p>或者在Hexo-theme-zilan/package.json文件中增加：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"dependencies": &#123;</span><br><span class="line">  "hexo-generator-searchdb": "^1.1.0",</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>
<h3 id="5-15-2-修改-config-yml">5.15.2 修改_config.yml</h3>
<p>/Hexo-theme-zilan/_config.yml中增加设置：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Search hexo-generator-searchdb  https://github.com/theme-next/hexo-generator-search</span></span><br><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">10000</span></span><br><span class="line">  <span class="attr">content:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="5-15-3-write-a-search-view">5.15.3 write a search view</h3>
<p>This is the place for displaying a search form and search results ;</p>
<h4 id="search-icon-界面">search icon 界面</h4>
<p>nav bar上添加search icon，在“岚”后面。<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/sarch%20icon%20view.png" alt="search icon 界面"><br>
点击触发search popup显示。themes/zilan/layout/_partial/nav.ejs 添加：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!-- Search --&gt;</span><br><span class="line">&lt;% <span class="keyword">var</span> hasSearch = theme.swiftype_key || theme.algolia_search.enable || theme.tinysou_Key || theme.local_search.enable; %&gt;</span><br><span class="line">&lt;% <span class="keyword">if</span> (hasSearch) &#123;%&gt;</span><br><span class="line">    &lt;li <span class="class"><span class="keyword">class</span></span>=<span class="string">"menu-item menu-item-search"</span>&gt;</span><br><span class="line">    &lt;% <span class="keyword">if</span> (theme.swiftype_key) &#123; %&gt;</span><br><span class="line">        &lt;a href=<span class="string">"javascript:;"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"st-search-show-outputs"</span>&gt;</span><br><span class="line">    &lt;% &#125; <span class="keyword">else</span> <span class="keyword">if</span> (theme.local_search.enable || theme.algolia_search.enable) &#123; %&gt;</span><br><span class="line">        &lt;a href=<span class="string">"javascript:;"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"popup-trigger"</span>&gt;</span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line">        &lt;% <span class="keyword">if</span> (theme.menu_icons.enable) &#123; %&gt;</span><br><span class="line">            &lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"menu-item-icon fa fa-search fa-fw"</span>&gt;&lt;<span class="regexp">/i&gt; &lt;br /</span>&gt;</span><br><span class="line">        &lt;% &#125; %&gt;</span><br><span class="line">    &lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>li&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>
<h4 id="search-popup-界面">search popup 界面</h4>
<p>themes/zilan/layout/layout.ejs 文件中增加search popup 界面，用来输入search string和search 结果。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!-- Search popup--&gt;</span><br><span class="line">&lt;% <span class="keyword">var</span> hasSearch = theme.swiftype_key || theme.algolia_search.enable || theme.tinysou_Key || theme.local_search.enable; %&gt;</span><br><span class="line">&lt;% <span class="keyword">if</span> (hasSearch) &#123;%&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"site-search"</span>&gt;</span><br><span class="line">  &lt;% include ./_partial/search.ejs %&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;% &#125; %&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/search%20popup%20view.png" alt="search popup 界面"></p>
<h3 id="5-15-4-write-a-search-script">5.15.4 write a search script</h3>
<p>This script tells the browser how to grab search data and filter out contents what we’re searching;<br>
添加文件：<br>
<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/blob/master/themes/zilan/layout/_third-party/search/localsearch.ejs" target="_blank" rel="noopener">themes/zilan/layout/_third-party/search/localsearch.ejs</a></p>
<h3 id="5-15-5-tell-hexo-to-connect-the-above-two-part">5.15.5 tell hexo to connect the above two part</h3>
<p>themes/zilan/layout/layout.ejs</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!-- Search --&gt;</span><br><span class="line">&lt;% include ./_third-party/search/index.ejs %&gt;</span><br></pre></td></tr></table></figure>
<p>另外修了3个bug：</p>
<ol>
<li>Fix Bug: <a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/6b672a20aa23101bf0b17f7d790c1f5ad8422843#diff-6f479bf13d3e26f8efd29d7b534db439L53" target="_blank" rel="noopener">ajax xml parser error</a></li>
<li>Fix Bug: <a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/6b672a20aa23101bf0b17f7d790c1f5ad8422843#diff-6f479bf13d3e26f8efd29d7b534db439R307" target="_blank" rel="noopener">input is null, so add /zilan/layout/_partial/search/localsearch.ejs inside “site-search”</a></li>
<li>Fix Bug: <a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/6b672a20aa23101bf0b17f7d790c1f5ad8422843#diff-6f479bf13d3e26f8efd29d7b534db439R302" target="_blank" rel="noopener">click close icon not work</a></li>
</ol>
<hr>
<h1 id="6-优化">6 优化</h1>
<h2 id="6-1-优化文章链接">6.1 优化文章链接</h2>
<p>Hexo默认的文章链接形式为 your domain/year/month/day/postTitle.<br>
这就是四级url，造成url过长，对搜索引擎是十分不友好的，我们可以改成 domain/postTitle 的形式。<br>
编辑站点_config.yml文件，修改其中的permalink字段改为 ”permalink: :title.html“:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># permalink: :year/:month/:day/:title/  原来permalink的值</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:title.html</span>  <span class="comment"># 现在permalink的值</span></span><br></pre></td></tr></table></figure>
<h2 id="6-2-设置站点地图-sitemap">6.2 设置站点地图 sitemap</h2>
<p>可以看本文的<a href="http://liyuankun.top/Git-Pages-Jekyll-Hexo-Build-your-own-blog.html#sitemap">sitemap部分</a>。</p>
<h2 id="6-3-设置关键字keywords">6.3 设置关键字keywords</h2>
<ol>
<li>添加博客网站关键字<br>
_config.yml中找到设置Site的部分添加keyword：</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Site settings</span></span><br><span class="line"><span class="attr">SEOTitle:</span> <span class="string">Yuankun</span> <span class="string">|</span> <span class="string">Zilan</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">keyword:</span> <span class="string">Tech</span> <span class="string">blog,</span> <span class="string">travel</span> <span class="string">notes,</span> <span class="string">游记,</span> <span class="string">React,</span> <span class="string">Redux,</span> <span class="string">javascript,</span> <span class="string">Frontend,</span> <span class="string">Machine</span> <span class="string">Learning</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>添加博客文章关键字</li>
</ol>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="comment">###</span></span><br><span class="line"><span class="attr">date:</span> <span class="comment">###</span></span><br><span class="line"><span class="attr">categories:</span> <span class="comment">###</span></span><br><span class="line"><span class="attr">tags:</span> <span class="comment">###</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="comment">###</span></span><br><span class="line"><span class="attr">description:</span> <span class="comment">###</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>
<h2 id="6-4-添加-nofollow-标签-优化seo权重">6.4 添加 “nofollow” 标签，优化SEO权重</h2>
<p><a href="https://ahrefs.com/blog/zh/nofollow-links/" target="_blank" rel="noopener">“nofollow” 标签的前世今生</a>。</p>
<blockquote>
<p>简单理解，<a href="https://www.batmanit.com/p/439.html" target="_blank" rel="noopener">Nofollow标签</a>，它常用于A标签的一个属性值，主要表达不要向某个特定链接传递权重，有的时候写在Meta标签中，则表示不要爬行网页上所有的链接，主要的表现形式为:<br>
① <code>&lt;a rel=&quot;nofollow&quot; href=&quot;&quot;&gt;不要跟随链接&lt;/a&gt;</code><br>
② <code>&lt;meta name=&quot;robots&quot; content=&quot;nofollow&quot;/&gt;</code><br>
所以页面中包含的不想影响SEO权重的链接中，加上rel=&quot;nofollow&quot;属性。例如评论，广告、新闻链接，站内联系页面，CMS程序多余入口中的链接都适合添加这个属性。</p>
</blockquote>
<p>例如我把换页的链接中加上rel=&quot;nofollow&quot;属性：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"previous"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;%- config.root %&gt;&lt;%- page.prev_link %&gt;"</span> <span class="attr">rel</span>=<span class="string">"external nofollow"</span>&gt;</span><span class="symbol">&amp;larr;</span>  <span class="tag">&lt;<span class="name">%-</span> <span class="attr">__</span>('<span class="attr">next</span>')%&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="7-遇到的坑">7 遇到的坑</h1>
<h2 id="目录-无法跳转">目录 无法跳转</h2>
<p>href=&quot;#undefined&quot;<br>
可以看我这个commit是怎么修改的 : <a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/3d1a7c1dbdf332ed9922e8d65f130e4c80237671" target="_blank" rel="noopener">fix bug:  the content href=&quot;#undefined&quot;</a></p>
<p>参考这两个链接：<br>
1 <a href="https://github.com/Haojen/hexo-theme-Anisina/issues/34" target="_blank" rel="noopener">_config.yml的markdown-it设置里面加上</a>，</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">markdown:</span></span><br><span class="line">  <span class="attr">anchors:</span></span><br><span class="line">    <span class="attr">level:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">permalinkSymbol:</span> <span class="string">''</span></span><br></pre></td></tr></table></figure>
<p>2 <a href="https://github.com/ppoffice/hexo-theme-icarus/issues/286" target="_blank" rel="noopener">package.json文件中删除&quot;hexo-toc&quot;</a></p>
<h2 id="disqus用username无法显示">Disqus用username无法显示</h2>
<p>这个在<a href="../#disqus">“评论”</a>里已经说了.</p>
<h2 id="category-分类页面分页只显示10个文章">Category 分类页面分页只显示10个文章</h2>
<p>虽然页面空间很大，但只显示10个文章列表就分页了：<br>
<img src="https://github.com/CatherineLiyuankun/PictureBed/raw/master/blog/post/Git-Pages-Jekyll-Hexo-Build-your-own-blog/category%E5%88%86%E9%A1%B5%E6%AF%8F%E9%A1%B5%E6%95%B0%E9%87%8F.png" alt="10个文章列表就分页"></p>
<p>参考了别人的文章： <a href="http://www.yuzhewo.com/2015/11/21/Hexo%E7%A8%8B%E5%BA%8Farchive%E9%A1%B5%E9%9D%A2%E6%95%B0%E9%87%8F%E8%AE%BE%E7%BD%AE/" target="_blank" rel="noopener">Hexo程序archive页面数量设置</a><br>
但试了试不起作用。。。<br>
这三个插件我之前就装有，可以在package.json里查看：<br>
“hexo-generator-archive”: “^0.1.4”,<br>
“hexo-generator-category”: “^0.1.3”,<br>
“hexo-generator-feed”: “^1.2.2”,<br>
“hexo-generator-index”: “^0.2.0”,</p>
<p>_config.yml文件中添加配置也加了：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Pagination</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">11</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">archives</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 主页每页显示文章数</span></span><br><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">    <span class="attr">per_page:</span> <span class="number">12</span></span><br><span class="line"><span class="comment">## archive分页每页显示文章数</span></span><br><span class="line"><span class="attr">archive_generator:</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">15</span></span><br><span class="line">  <span class="attr">yearly:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">monthly:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">daily:</span> <span class="literal">false</span></span><br><span class="line"><span class="comment">## tag分页每页显示文章数</span></span><br><span class="line"><span class="attr">tag_generator:</span></span><br><span class="line">    <span class="attr">per_page:</span> <span class="number">16</span></span><br><span class="line"><span class="comment">## category分页每页显示文章数</span></span><br><span class="line"><span class="attr">category_generator:</span> </span><br><span class="line">    <span class="attr">per_page:</span> <span class="number">30</span></span><br></pre></td></tr></table></figure>
<p>要说唯一不同的是，我之前的pagination_dir: archives，而查阅的其他文章中都是pagination_dir: page。<br>
但我改成page也还是不起作用。。。。</p>
<p>等我发布（hexo deploy）出来后发现，其实除了tag_generator 和 archive_generator 没有成功以外，其他的设置都成功了，可能是本地模式（hexo server）下没有更新。</p>
<p>整个修改过程参考commit： <a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/4607f6174e0615bf5bcc4bdada7715c6934b0d29" target="_blank" rel="noopener">category 分页样式修改+分页每页数量</a></p>
<h2 id="error-eisdir-illegal-operation-on-a-directory">ERROR EISDIR: illegal operation on a directory</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">➜  Hexo-theme-zilan git:(master) ✗ hexo g</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Files loaded <span class="keyword">in</span> 564 ms</span><br><span class="line">ERROR EISDIR: illegal operation on a directory, <span class="built_in">read</span></span><br><span class="line">Error: EISDIR: illegal operation on a directory, <span class="built_in">read</span></span><br></pre></td></tr></table></figure>
<p>查了下貌似和npm有关，但我试了试网上的方法并不起作用，但是这个错也不影响我的博客功能。暂且放下，找到方法了再更新。</p>
<h2 id="dep0061-deprecationwarning-fs-syncwritestream-is-deprecated">[DEP0061] DeprecationWarning: fs.SyncWriteStream is deprecated</h2>
<p><a href="../Hexo-node-28561-DEP0061-DeprecationWarning-fs-SyncWriteStream-is-deprecated.html">fs.SyncWriteStream is deprecated</a></p>
<h2 id="其他小的修改">其他小的修改</h2>
<p>页面内容width修改，在大屏幕（&gt;1800px 和&gt; 2400px）下，页面内容更宽。<br>
commit：t<a href="https://github.com/CatherineLiyuankun/Hexo-theme-zilan/commit/64a23dad122b7cf59039d754125fc59307c6a9f1" target="_blank" rel="noopener">he .container with responsive when screen width is larger than 1800px</a></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> (<span class="attribute">min-width:</span> <span class="number">2400px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">2070px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">min-width:</span> <span class="number">1800px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1770px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="参考文章">参考文章</h1>
<ul>
<li>
<p>阮一峰的文章 <a href="http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html" target="_blank" rel="noopener">搭建一个免费的，无限流量的Blog----github Pages和Jekyll入门</a></p>
</li>
<li>
<p>这篇适合懒得学git的小白，完全把作者的模板拷贝过来改改参数： <a href="https://www.jianshu.com/p/e68fba58f75c" target="_blank" rel="noopener">利用 GitHub Pages 快速搭建个人博客</a></p>
</li>
<li>
<p><a href="https://linghucong.js.org/2016/04/15/2016-04-15-hexo-github-pages-blog/" target="_blank" rel="noopener">手把手教你使用Hexo + Github Pages搭建个人独立博客</a></p>
</li>
<li>
<p><a href="https://www.jianshu.com/p/ec7953b9e5ab" target="_blank" rel="noopener">Github Pages 搭建笔记</a></p>
</li>
<li>
<p><a href="https://www.techiediaries.com/jekyll-hugo-hexo/" target="_blank" rel="noopener">How to Choose the Right Static Generator: Jekyll vs. Hugo vs. Hexo</a></p>
</li>
<li>
<p><a href="https://ryanluoxu.github.io/2017/11/27/Hexo-Next-%E6%B7%BB%E5%8A%A0-Gitment-%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/" target="_blank" rel="noopener">Hexo-Next 添加 Gitment 评论系统</a></p>
</li>
<li>
<p><a href="https://io-oi.me/tech/hexo-next-optimization/" target="_blank" rel="noopener">打造个性超赞博客 Hexo + NexT + GitHub Pages 的超深度优化</a></p>
</li>
<li>
<p><a href="http://theme-next.iissnan.com/getting-started.html" target="_blank" rel="noopener">NexT 主题使用</a></p>
</li>
<li>
<p><a href="http://www.ehcoo.com/seo.html" target="_blank" rel="noopener">【搜索优化】Hexo-next百度和谷歌搜索优化</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>TECH</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Blog</tag>
      </tags>
  </entry>
  <entry>
    <title>日期格式DateTimeFormat-yyyy-MM-dd HH:mm:ss 坑&amp;大小写区别</title>
    <url>/%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8FDateTimeFormat-yyyy-MM-dd-HH-mm-ss-%E5%9D%91-%E5%A4%A7%E5%B0%8F%E5%86%99%E5%8C%BA%E5%88%AB.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="编程中的时间概念">编程中的时间概念</h1>
<h2 id="unix-时间戳-unix-timestamp"><a href="https://zh.m.wikipedia.org/wiki/UNIX%E6%97%B6%E9%97%B4" target="_blank" rel="noopener">Unix 时间戳（Unix Timestamp）</a></h2>
<p>参考文章：</p>
<ul>
<li><a href="https://www.51cto.com/article/526190.html" target="_blank" rel="noopener">为什么编程语言中日期能够实现加减法</a></li>
</ul>
<p><code>Unix timestamp = Unix 时间戳 = Unix time = Unix epoch = POSIX time</code></p>
<blockquote>
<p>时间戳是自 1970 年 1 月 1 日（00:00:00 ）至当前时间的总秒数, 不考虑闰秒。它也被称为 Unix 时间戳（Unix Timestamp）。<br>
Unix时间戳(Unix timestamp)，或称Unix时间(Unix time)、POSIX时间(POSIX time)，是一种时间表示方式，定义为从1970年01月01日00时00分00秒（UTC/GMT）起至现在的总秒数。Unix时间戳不仅被使用在Unix系统、类Unix系统中(比如 Linux系统)，也在许多其他操作系统中被广泛采用。</p>
<p>UNIX时间戳的 0 按照 ISO 8601 规范为 ：1970-01-01T00:00:00Z.</p>
<p>时间戳其实就是一个整数。<br>
一个小时表示为UNIX时间戳格式为：3600秒；一天表示为UNIX时间戳为86400秒，闰秒不计算。<br>
在大多数的 Unix 系统中 Unix 时间戳存储为 32 位，这样会引发 2038 年问题或 Y2038。</p>
</blockquote>
<p>多数编程语言起源于UNIX，UNIX系统的时间纪元是1970-01-01 00:00:00,即所为的UNIX时间戳。</p>
<p>最初计算机都是32位操作系统，时间需要通过number存储，32位能表示数字为2147483647。一年365天的总秒数位31536000 ，两者相除得68.1 (68.0962597349).而选用1970年的，可以支持到2038年。</p>
<!-- 所以如果从0000-00-00 00:00:00 算起的话，计算机到1901年12月13日就溢出了。???? -->
<p>最早版本的Unix时间是32位整型，以60 Hz增加。1971年11月3日发行的第一版《Unix Programmer’s Manual》定义了Unix时间为“the time since 00:00:00, 1 January 1971, measured in sixtieths of a second”，即从1971年1月1日00:00:00开始，以60赫兹增加。[2]这意味着以32位无符号整型存储Unix时间，829天（约2.5年）后就将用尽重置。由于该限制，Unix时间原点被重定义多次。Unix V3规定采用60hz的滴答数，从1972年元旦开始计时。直至1973年的Unix V4开始采用1970年1月1日00:00:00UTC为时间原点，以1赫兹计时。由于Unix和C语言采用32位有符号整型表示时间，这可容纳约136年的时间跨度，在1970年之前和之后各占一半。即到2038年1月19日和1901月12月13日用尽重置。</p>
<p>此后，这个Unix 时间定义考虑到时区，闰秒等问题被修订。</p>
<p>当年的电脑需要一个可靠的外部时钟同步源，因此早期的 Unix 系统用一个32位字长表示时间，以1/60秒，即1Hz为时间间隔和外部时间源同步（这道不完全是由于老美的电网频率是60Hz的缘故，当时的系统主板的晶振就是1Hz）。 结果这个时间所表示的跨度只有大约829天（约2.5年），显然不够用，因此需要一个原始的起始（〔纪〕··〔元〕）时间，由于 Unix 系统源自上时间69年代，第一个正式版本于1970年首次运行在 PDP-11 上，1971年11月 UNIX Programmer’s Manual（Unix程序员手册）首次公布，这个手册里面提及了起始时间，将它定义为【1971】年1月1日。－－ 手册也承认，该起始时间大约每 2.5年就要重新修正一次。</p>
<p>之后系统时间同步间隔被修订为 1 秒，这样32位就可表述约136年的跨度，也正是这个期间（具体年份不祥），起始时间被修订为1970.1.1 （Unix开发者认为把之前的 1971.1.1 取整进位到最临近的年代起始（以每10年一个断代算），要比 1971 这个有点不伦不类的时间好），因此从这以后，Unix一直沿用了 1970.1.1 这个起始时间，而相关的程序也相应的沿用了这个时间，而深受 Unix 影响的后续操作系统们，如：OS/2, Windows, Mactonish, Linux。。。。都沿用了这个｛事实标准｝。</p>
<p>现时大部分使用UNIX的系统都是32位的，即它们会以32位有符号整数表示时间类型time_t。因此它可以表示136年的秒数。表示协调世界时间1901年12月13日星期五20时45分52秒 至 2038年1月19日3时14分07秒（二进制：01111111 11111111 11111111 11111111，0x7FFF:FFFF），在下一秒二进制数字会是10000000 00000000 00000000 00000000（0x8000:0000），这是负数，因此各系统会把时间误解作1901年12月13日20时45分52秒（亦有可能回归到1970年）。这时可能会令软件发生问题，导致系统瘫痪。</p>
<p>目前的解决方案是把系统由32位转为64位系统。在64位系统下，此时间最多可以表示到2922亿7702万6596年12月4日15时30分08秒。</p>
<table>
<thead>
<tr>
<th>Human Readable Time</th>
<th>Seconds</th>
</tr>
</thead>
<tbody>
<tr>
<td>1 Hour</td>
<td>3600 Seconds</td>
</tr>
<tr>
<td>1 Day</td>
<td>86400 Seconds</td>
</tr>
<tr>
<td>1 Week</td>
<td>604800 Seconds</td>
</tr>
<tr>
<td>1 Month (30.44 days)</td>
<td>2629743 Seconds</td>
</tr>
<tr>
<td>1 Year (365.24 days)</td>
<td>31556926 Seconds</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>编程语言</th>
<th>编程中获取Unix时间戳</th>
<th>0对应的默认时间</th>
</tr>
</thead>
<tbody>
<tr>
<td>Java</td>
<td><code>System.currentTimeMillis() / 1000</code>  对于中国开发者，通过 <code>System.out.println(new Date(0));</code> ,控制台打印的时间是1970-01-01 08:00:00 ，这个是因为中国处于东8区的缘由。对于程序内部存储值无影响。</td>
<td>Unix timestamp, <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Date.html#Date" target="_blank" rel="noopener">文档地址</a></td>
</tr>
<tr>
<td>JavaScript</td>
<td><code>Math.round(new Date().getTime()/1000)</code> <code>getTime()</code>返回数值的单位是毫秒</td>
<td>Unix timestamp, <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" rel="noopener">文档地址</a></td>
</tr>
<tr>
<td>Python</td>
<td>先 <code>import time</code> 然后 <code>time.time()</code> 返回1476929706.5320001 可以 <code>int(time.time())</code></td>
<td>Unix timestamp, <a href="https://docs.python.org/3/library/datetime.html#date-objects" target="_blank" rel="noopener">文档地址</a></td>
</tr>
<tr>
<td>PHP</td>
<td><code>time()</code></td>
<td>Unix timestamp, <a href="http://php.net/manual/en/function.time.php" target="_blank" rel="noopener">文档地址</a></td>
</tr>
<tr>
<td>Microsoft .NET / C#</td>
<td><code>epoch = (DateTime.Now.ToUniversalTime().Ticks - 621355968000000000) / 10000000</code></td>
<td>Not Unix timestamp 默认采用int64位来表示时间戳，并且精确到100ns，开始日期点为0001-01-01 00:00:00.000。<a href="https://msdn.microsoft.com/zh-cn/library/z2xf7zzk(v=vs.110).aspx?cs-save-lang=1&amp;cs-lang=csharp#code-snippet-1" target="_blank" rel="noopener">文档地址</a></td>
</tr>
<tr>
<td>Perl</td>
<td><code>time</code></td>
<td></td>
</tr>
<tr>
<td>Golang</td>
<td><code>time.now().Unix()</code></td>
<td></td>
</tr>
<tr>
<td>Ruby</td>
<td>获取Unix时间戳：<code>Time.now</code> 或 <code>Time.new</code>; 显示Unix时间戳：<code>Time.now.to_i</code></td>
<td></td>
</tr>
<tr>
<td>ORACLE</td>
<td></td>
<td>Unix timestamp, <a href="https://docs.oracle.com/cd/E11882_01/appdev.112/e13995/oracle/sql/TIMESTAMP.html" target="_blank" rel="noopener">文档TIMESTAMP object initialized to 1/1/1970</a></td>
</tr>
<tr>
<td>PostgreSQL</td>
<td><code>SELECT extract(epoch FROM now())</code></td>
<td></td>
</tr>
<tr>
<td>MySQL</td>
<td><code>SELECT unix_timestamp(now())</code></td>
<td></td>
</tr>
<tr>
<td>SQL Server</td>
<td><code>SELECT DATEDIFF(s, '1970-01-01 00:00:00', GETUTCDATE())</code></td>
<td></td>
</tr>
<tr>
<td>VBScript / ASP</td>
<td><code>DateDiff(&quot;s&quot;, &quot;01/01/1970 08:00:00&quot;, Now())</code></td>
<td>Not Unix timestamp <a href="https://www.microsoft.com/china/vbscript/vbstutor/vbsdatatype.htm" target="_blank" rel="noopener">文档地址</a>. 这个开始时间很奇怪，从API来看，开始时间是从0100-01-01 00:00:00, 不过从代码测试来看，开始时间是从1899-12-30 0 :00:00 开始</td>
</tr>
<tr>
<td>lua</td>
<td><code>os.time()</code> 返回时间戳</td>
<td></td>
</tr>
<tr>
<td>Unix /Linux/<a href="https://baike.baidu.com/item/%E7%B1%BBUNIX?fromModule=lemma_inlink" target="_blank" rel="noopener">类UNIX</a>/OS X</td>
<td>命令行：<code>date +%s</code></td>
<td></td>
</tr>
<tr>
<td><a href="https://baike.baidu.com/item/FreeSWITCH?fromModule=lemma_inlink" target="_blank" rel="noopener">FreeSWITCH</a></td>
<td><code>fs_cli &gt; strepoch</code>或者：<code>fs_cli &gt; eval ${strepoch()}</code>或者：（在 freeswitch里面，获取linux系统的时间戳）<code>fs_cli &gt; system date +%s</code></td>
<td></td>
</tr>
<tr>
<td>其他操作系统(如果Perl被安装在系统中)</td>
<td>命令行状态：<code>perl -e &quot;print time&quot;</code></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="oracle-数据库">Oracle 数据库</h3>
<p><a href="https://www.cnblogs.com/java-class/p/4742740.html" target="_blank" rel="noopener">Oracle date 和 timestamp 区别</a></p>
<p>oracle中，一般使用类型INTEGER，获取方式：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> (<span class="keyword">SYSDATE</span> - <span class="keyword">TO_DATE</span>(<span class="string">'1970-1-1 8'</span>, <span class="string">'YYYY-MM-DD HH24'</span>)) * <span class="number">86400</span> <span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>
<h3 id="java-中的时间戳">Java 中的时间戳</h3>
<p><a href="https://blog.csdn.net/L1585931143/article/details/53471197" target="_blank" rel="noopener">Java日期类的时间从为什么是从1970年1月1日</a></p>
<p>java中，一般使用类型long，获取方式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 0. Get default date</span></span><br><span class="line">        System.out.println(<span class="keyword">new</span> Date(<span class="number">0</span>)); <span class="comment">// Thu Jan 01 00:00:00 GMT 1970</span></span><br><span class="line">        <span class="comment">// 1.</span></span><br><span class="line">        Long t1 = System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// 2.</span></span><br><span class="line">        Long t2 = Calendar.getInstance().getTimeInMillis();</span><br><span class="line">        <span class="comment">// 3.</span></span><br><span class="line">        Long t3 = <span class="keyword">new</span> Date().getTime();</span><br><span class="line">        System.out.println(t1); <span class="comment">// 1668657023995</span></span><br><span class="line">        System.out.println(t2); <span class="comment">// 1668657024730</span></span><br><span class="line">        System.out.println(t3); <span class="comment">// 1668657025323</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="javascript-中的时间戳">JavaScript 中的时间戳</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 0.Get default date </span></span><br><span class="line"><span class="keyword">const</span> date1 = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">console</span>.log(date1); <span class="comment">// Thu Jan 01 1970 08:00:00 GMT+0800 (China Standard Time) 因为中国处于东8区的缘由。对于程序内部存储值无影响。</span></span><br><span class="line"><span class="comment">// 1.获取的时间戳, 把毫秒改成000显示</span></span><br><span class="line"><span class="keyword">const</span> timestamp1 = <span class="built_in">Date</span>.parse(<span class="keyword">new</span> <span class="built_in">Date</span>()); <span class="comment">// 1668656204000</span></span><br><span class="line"><span class="comment">// 2.获取当前毫秒的时间戳</span></span><br><span class="line"><span class="keyword">const</span> timestamp2 = (<span class="keyword">new</span> <span class="built_in">Date</span>()).valueOf(); <span class="comment">// 1668656204519</span></span><br><span class="line"><span class="comment">// 3.获取当前毫秒的时间戳</span></span><br><span class="line"><span class="keyword">const</span> timestamp3=<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()；<span class="comment">// 1668656204519</span></span><br></pre></td></tr></table></figure>
<h2 id="iso-8601"><a href="https://zh.m.wikipedia.org/wiki/ISO_8601" target="_blank" rel="noopener">ISO 8601</a></h2>
<h2 id="润秒">润秒</h2>
<h2 id="1988-12-30-12-00-00-am">1988/12/30 12:00:00 am</h2>
<p>参考文章：</p>
<ul>
<li><a href="https://www.explainxkcd.com/wiki/index.php/2676:_Historical_Dates" target="_blank" rel="noopener">2676: Historical Dates 1970.1.1 &amp; 1899.12.30</a></li>
<li><a href="https://social.msdn.microsoft.com/Forums/office/en-US/f1eef5fe-ef5e-4ab6-9d92-0998d3fa6e14/what-is-story-behind-december-30-1899-as-base-date?forum=accessdev" target="_blank" rel="noopener">What is story behind December 30, 1899 as base date?</a></li>
<li><a href="https://stackoverflow.com/questions/3963617/why-is-1899-12-30-the-zero-date-in-access-sql-server-instead-of-12-31" target="_blank" rel="noopener">Why is 1899-12-30 the zero date in Access / SQL Server instead of 12/31?</a></li>
<li><a href="http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/delphivclwin32/System_TDateTime.html#4465736372697074696F6E" target="_blank" rel="noopener">System.TDateTime in Delphi</a></li>
</ul>
<h3 id="in-excel-lotus-1-2-3">In Excel &amp; Lotus 1-2-3</h3>
<blockquote>
<p>Dec 30th, 1899 comes from a spreadsheet date compatibility issue between Excel and Lotus 1-2-3 (referenced in the title text.) Spreadsheets store dates as sequential numbers so that they can be used in calculations. In Excel, by default, January 1, 1900 is number 1. Based on that, Excel’s integer date representation would be the number of days that have passed since December 31, 1899.</p>
<p>However, because of a bug intentionally carried over from Lotus 1-2-3 where it counts February 29, 1900 as a day even though it actually was not, for any day since then, Excel’s integer date representation is actually the number of days that have passed since December 30, 1899. Most other spreadsheet applications copied the behavior of Excel to maintain compatibility with it. This leads to the value of 0 in some applications (notably Open- and LibreOffice Calc and Google Spreadsheets) being interpreted as Dec 30th, 1899. Similarly, Microsoft Visual Basic and Visual Basic for Applications (VBA) interpret 0.0 as Dec 30th, 1899.</p>
<p>1899 年 12 月 30 日来自 Excel 和 <a href="https://zh.wikipedia.org/wiki/Lotus_1-2-3" target="_blank" rel="noopener">Lotus 1-2-3</a>之间的电子表格日期兼容性问题（在标题文本中引用。）电子表格将日期存储为连续数字，以便可以在计算中使用它们。 在 Excel 中，默认情况下，1900 年 1 月 1 日是数字 1。 基于此，Excel 的整数日期表示将是自 1899 年 12 月 31 日以来经过的天数。但是，由于有意从 Lotus 1-2-3 遗留的错误，它将 1900 年 2 月 29 日算作一天 虽然它实际上不是，但从那以后的任何一天，Excel 的整数日期表示实际上是自 1899 年 12 月 30 日以来经过的天数。大多数其他电子表格应用程序复制 Excel 的行为以保持与它的兼容性。 这导致某些应用程序（特别是 Open- 和 LibreOffice Calc 以及 Google Spreadsheets）中的值 0 被解释为 1899 年 12 月 30 日。类似地，Microsoft Visual Basic 和 Visual Basic for Applications (VBA) 将 0.0 解释为 1899 年 12 月 30 日。</p>
</blockquote>
<p>在office excel中存在两种日期格式1900 和 1904，即日期的开始点为 1900-01-01 00：00:00 和 1904-01-01 00:00:00 。一般Excel 默认是按照1900的日期系统，且认为1900年为润年，1900年2月分 按照29天计算。Excel中存储值得起始日期是从1开始的，即，1900-01-01 00:00:00 在excel中对应的存储值为1 （天）。</p>
<h3 id="in-delphi-c">In Delphi, C++</h3>
<blockquote>
<p>In Delphi, TDateTime is a type that maps to a Double. In C++, the TDateTime class corresponds to the Delphi TDateTime type.</p>
<p>The integral part of a Delphi TDateTime value is the number of days that have passed since 12/30/1899. The fractional part of the TDateTime value is fraction of a 24 hour day that has elapsed.</p>
</blockquote>
<table>
<thead>
<tr>
<th>TDateTime</th>
<th>UTC</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>12/30/1899 12:00 am</td>
</tr>
<tr>
<td>2.75</td>
<td>1/1/1900 6:00 pm</td>
</tr>
<tr>
<td>-1.25</td>
<td>12/29/1899 6:00 am</td>
</tr>
<tr>
<td>35065</td>
<td>1/1/1996 12:00 am</td>
</tr>
</tbody>
</table>
<blockquote>
<p>To find the fractional number of days between two dates, simply subtract the two values, unless one of the TDateTime values is negative. Similarly, to increment a date and time value by a certain fractional number of days, add the fractional number to the date and time value if the TDateTime value is positive.</p>
<p>When working with negative TDateTime values, computations must handle time portion separately. The fractional part reflects the fraction of a 24-hour day without regard to the sign of the TDateTime value. For example, 6:00 am on 12/29/1899 is –1.25, not –1 + 0.25, which would be –0.75. There are no TDateTime values between –1 and 0.</p>
</blockquote>
<h2 id="yyyy-mm-dd-hh-mm-ss-sss-含义">yyyy-MM-dd HH:mm:ss SSS 含义</h2>
<table>
<thead>
<tr>
<th>Letter</th>
<th>含义</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>y</td>
<td>不包含纪元的年份</td>
<td>y------&gt;9     例如2009用不包含纪元的年份表示就是9。如果年份小于 10，则显示不具有前导零的年份。</td>
</tr>
<tr>
<td>yy</td>
<td>不包含纪元的年份</td>
<td>yy-----&gt;09   例如2009用不包含纪元的年份表示就是09。如果年份小于 10，则显示具有前导零的年份。</td>
</tr>
<tr>
<td>yyyy</td>
<td>包括纪元的四位数的年份</td>
<td>yyyy—&gt;2009</td>
</tr>
<tr>
<td>M</td>
<td>月份数字</td>
<td>M-------&gt;2 大写的M    一位数的月份没有前导零。</td>
</tr>
<tr>
<td>MM</td>
<td>月份数字</td>
<td>MM------&gt;02 大写的M  一位数的月份有一个前导零。</td>
</tr>
<tr>
<td>MMM</td>
<td>月份的缩写名称</td>
<td>MMM-----&gt;Feb 大写的M   例如英文中是&quot;Jan&quot;, “Apr”, “Sep”, “Oct”, “May”, “Jun”, “Jul”, “Feb”, “Mar”, “Aug”,  “Nov”, “Dec”。中文是&quot;1月&quot;, “2月”, “3月”。C#中在 AbbreviatedMonthNames 中定义。</td>
</tr>
<tr>
<td>MMMM</td>
<td>月份的完整名称。</td>
<td>MMMM----&gt;February 大写的M  例如英文中是’January’, ‘February’，中文是&quot;一月&quot;，“二月” C#中在 MonthNames 中定义。</td>
</tr>
<tr>
<td>d</td>
<td>一月中的天数</td>
<td>d---------&gt;3    一位数的日期没有前导零</td>
</tr>
<tr>
<td>dd</td>
<td>一月中的天数</td>
<td>dd--------&gt;03   有前导零</td>
</tr>
<tr>
<td>ddd</td>
<td>周中某天的缩写名称</td>
<td>ddd-------&gt;Sun   例如英文是：“Sun”, “Mon”, “Tue”, “Wed”，“Thu”, “Fri”, “Sat”; 中文是：“周日”， &quot;周一&quot;等。 C#中在 AbbreviatedDayNames 中定义。</td>
</tr>
<tr>
<td>dddd</td>
<td>周中某天的完整名称</td>
<td>dddd------&gt;Sunday  例如英文是： [“Sunday”, “Monday”, “Tuesday”, ‘Wednesday’, &quot;Thursday’, ‘Friday’,“Saturday”; 中文是：“星期日”， &quot;星期一&quot;等。 C#中在在 DayNames 中定义。</td>
</tr>
<tr>
<td>H</td>
<td>小时（0-23）</td>
<td>H---------&gt;9   24 小时制的是大写的H</td>
</tr>
<tr>
<td>HH</td>
<td>小时（0-23）</td>
<td>HH---------&gt;09   24 小时制的是大写的H</td>
</tr>
<tr>
<td>h</td>
<td>小时（1-12）</td>
<td>h----------&gt;6  12小时制的是小写的h，没有前导零， 24小时制 18 = 12小时制 6</td>
</tr>
<tr>
<td>hh</td>
<td>小时（1-12）</td>
<td>hh----------&gt;06  12小时制的是小写的h</td>
</tr>
<tr>
<td>m</td>
<td>分</td>
<td>m--------&gt;7 小写的m 没有前导零</td>
</tr>
<tr>
<td>mm</td>
<td>分</td>
<td>mm--------&gt;07 小写的m</td>
</tr>
<tr>
<td>s</td>
<td>秒</td>
<td>s--------&gt;9  没有前导零</td>
</tr>
<tr>
<td>ss</td>
<td>秒</td>
<td>ss--------&gt;09</td>
</tr>
<tr>
<td>a</td>
<td>displays time with AM/ PM marker</td>
<td>hh:mm:ss a--------&gt;12：59：59 AM</td>
</tr>
<tr>
<td>SSS</td>
<td>毫秒</td>
<td>SSS---------&gt;666</td>
</tr>
<tr>
<td>Y</td>
<td>Week Year</td>
<td>YYYY----&gt;2020</td>
</tr>
<tr>
<td>D</td>
<td>一年中天数</td>
<td>DD--------&gt;365</td>
</tr>
</tbody>
</table>
<h3 id="其他含义">其他含义</h3>
<p>gg 时期或纪元。如果要设置格式的日期不具有关联的时期或纪元字符串，则忽略该模式。<br>
f 秒的小数精度为一位。其余数字被截断。<br>
　ff 秒的小数精度为两位。其余数字被截断。<br>
　fff 秒的小数精度为三位。其余数字被截断。<br>
　ffff 秒的小数精度为四位。其余数字被截断。<br>
　fffff 秒的小数精度为五位。其余数字被截断。<br>
　ffffff 秒的小数精度为六位。其余数字被截断。<br>
　fffffff 秒的小数精度为七位。其余数字被截断。<br>
　t 在 AMDesignator 或 PMDesignator 中定义的 AM/PM 指示项的第一个字符（如果存在）。<br>
　tt 在 AMDesignator 或 PMDesignator 中定义的 AM/PM 指示项（如果存在）。<br>
　z 时区偏移量（“+”或“-”后面仅跟小时）。一位数的小时数没有前导零。例如，太平洋标准时间是“-8”。<br>
　zz 时区偏移量（“+”或“-”后面仅跟小时）。一位数的小时数有前导零。例如，太平洋标准时间是“-08”。<br>
　zzz 完整时区偏移量（“+”或“-”后面跟有小时和分钟）。一位数的小时数和分钟数有前导零。例如，太平洋标准时间是“-08:00”。<br>
　: 在 TimeSeparator 中定义的默认时间分隔符。<br>
　/ 在 DateSeparator 中定义的默认日期分隔符。<br>
　% c 其中 c 是格式模式（如果单独使用）。如果格式模式与原义字符或其他格式模式合并，则可以省略“%”字符。<br>
　\ c 其中 c 是任意字符。照原义显示字符。若要显示反斜杠字符，请使用“\”。</p>
<h3 id="hh-mm-ss">hh:mm:ss</h3>
<p>按照12小时制的格式进行字符串格式化</p>
<ul>
<li>如果时间处于00：00：00——12：59：59，则返回的字符串正常</li>
<li>如果时间处于13：00：00——23：59：59，则返回的字符串是实际时间-12小时后的值，也就是说比真实的时间少了12个小时。<br>
例如：14:00:00进行格式化后的字符串为“2:00:00”</li>
</ul>
<h3 id="hh-mm-ss-v2">HH:mm:ss</h3>
<p>按照24小时制的格式进行字符串格式化<br>
当时间为任意一个区间，则返回的字符串都是正常的。</p>
<h1 id="时间基本概念">时间基本概念</h1>
<blockquote>
<p>简单地讲， GMT 是以前的世界时间标准；UTC 是现在在使用的世界时间标准；时区是基于格林威治子午线来偏移的，往东为正，往西为负；夏令时是地方时间制度，施行夏令时的地方，每年有2天很特殊（一天只有23个小时，另一天有25个小时）。</p>
</blockquote>
<h2 id="utc"><code>UTC</code></h2>
<p><code>UTC</code>是协调世界时（<code>Coordinated Universal Time</code>）的缩写， 协调世界时，又称世界统一时间、世界标准时间、国际协调时间。它以前也被称为<code>格林威治标准时间</code>或者“格林尼治标准时间”（<code>GMT</code>）。使用UTC而不是CUT作为缩写是英语与法语（Temps Universel Coordonné）之间妥协的结果，不是什么低级错误。由于英文（CUT）和法文（TUC）的缩写不同，作为妥协，简称UTC。<br>
UTC 是现在全球通用的时间标准，全球各地都同意将各自的时间进行同步协调。UTC 时间是经过平均太阳时（以格林威治时间GMT为准）、地轴运动修正后的新时标以及以秒为单位的国际原子时所综合精算而成。<br>
在军事中，协调世界时会使用“Z”来表示。又由于Z在无线电联络中使用“Zulu”作代称，协调世界时也会被称为&quot;Zulu time&quot;。</p>
<h2 id="gmt"><code>GMT</code></h2>
<p><code>GMT</code>（Greenwich Mean Time）<code>格林威治标准时间</code>或者“格林尼治标准时间”， 它规定太阳每天经过位于英国伦敦郊区的皇家格林威治天文台的时间为中午12点。<br>
1884年10月在美国华盛顿召开了一个国际子午线会议，该会议将格林威治子午线设定为本初子午线，并将格林威治平时 (GMT, Greenwich Mean Time) 作为世界时间标准（UT, Universal Time）。由此也确定了全球24小时自然时区的划分，所有时区都以和 GMT 之间的偏移量做为参考。<br>
后来，格林尼治天文台所在地的地方平太阳时被定义为全世界的时间标准，被称为格林尼治平时（Greenwich Mean Time），“平时（mean time）”就是“平太阳时（mean solar time）”的意思。</p>
<p>后来，由于1925年以前人们在天文观测中，常常把每天的起始（0时）定为正午，而不是通常民用的午夜，给格林尼治平时的意义造成含糊，人们使用世界时（Universal Time, UT）一词来明确表示每天从午夜开始的格林尼治平时。</p>
<p>目前使用的世界时测算标准又称<code>UT1</code>。在UT1之前人们曾使用过UT0，但由于UT0没有考虑极移导致的天文台地理坐标变动的问题，因此测出的世界时不准确，现在已经不再被使用。在UT1之后，由于人们发现，因为地球自转本身不均匀的问题，UT1定义的时间的流逝仍然不均匀，于是人们又发展了一些对UT1进行平滑处理后的时间标准，包括<code>UT1R</code>和<code>UT2</code>，但它们都未能彻底解决定义的时间的流逝不均匀的问题，这些时间标准现在都不再被使用。</p>
<p>后来，人们为了彻底解决定义的时间的流逝不均匀的问题，开始使用原子钟定义时间。人们首先用全世界的原子钟共同为地球确立了一个均匀流动的时间，称为国<code>际原子时</code>（<code>International Atomic Time</code>, <code>TAI</code>）。然后，为了使定义的时间与地球自转相配合，人们通过在TAI的基础上不定期增减闰秒的方式，使定义的时间与世界时（UT1）保持差异在0.9秒以内，这样定义的时间就是协调世界时（Coordinated Universal Time, UTC）。UTC是目前全世界使用的时间标准。UTC与UT1之间的差异被称为DUT1。<br>
1972年之前，格林威治时间（GMT）一直是世界时间的标准。1972年之后，GMT 不再是一个时间标准了。</p>
<h3 id="gmt-vs-utc">GMT vs UTC</h3>
<p>GMT是前世界标准时，UTC是现世界标准时。<br>
UTC 比 GMT更精准，以原子时计时，适应现代社会的精确计时。<br>
但在不需要精确到秒的情况下，二者可以视为等同。<br>
每年格林尼治天文台会发调时信息，基于UTC。</p>
<h2 id="时区">时区</h2>
<blockquote>
<p>从格林威治本初子午线起，经度每向东或者向西间隔15°，就划分一个时区，在这个区域内，大家使用同样的标准时间。</p>
<p>但实际上，为了照顾到行政上的方便，常将1个国家或1个省份划在一起。所以时区并不严格按南北直线来划分，而是按自然条件来划分。另外：由于目前，国际上并没有一个批准各国更改时区的机构。一些国家会由于特定原因改变自己的时区。</p>
<p>全球共分为24个标准时区，相邻时区的时间相差一个小时。</p>
<p>在不同地区，同一个时区往往会有很多个不同的时区名称，因为名称中通常会包含该国该地区的地理信息。在夏令时期间，当地的时区名称及字母缩写会有所变化（通常会包含“daylight”或“summer”字样）。</p>
<p>例如美国东部标准时间叫：<code>EST</code>，<code>Estern Standard Time</code>；而东部夏令时间叫：<code>EDT</code>，<code>Estern Daylight Time</code>。</p>
<p>查看世界所有时区的名字可以访问这个网站：<a href="https://www.timeanddate.com/time/zones/" target="_blank" rel="noopener">https://www.timeanddate.com/time/zones/</a></p>
</blockquote>
<p>例如同样都是东八区，有很多个不同的时区名称，因为名称中通常会包含该国、该地区的地理信息。</p>
<table>
<thead>
<tr>
<th>Abbreviation</th>
<th>Time zone name</th>
<th>Location</th>
<th>Offset</th>
</tr>
</thead>
<tbody>
<tr>
<td>CST</td>
<td>China Standard Time</td>
<td>Asia</td>
<td>UTC +8</td>
</tr>
<tr>
<td>HKT</td>
<td>Hong Kong Time</td>
<td>Asia</td>
<td>UTC +8</td>
</tr>
<tr>
<td>SGT</td>
<td>Singapore Time SST – Singapore Standard Time</td>
<td>Asia</td>
<td>UTC +8</td>
</tr>
</tbody>
</table>
<h2 id="夏令时">夏令时</h2>
<p><code>DST</code>（Daylight Saving Time），夏令时又称夏季时间，或者夏时制。</p>
<blockquote>
<p>它是为节约能源而人为规定地方时间的制度。一般在天亮早的夏季人为将时间提前一小时，可以使人早起早睡，减少照明量，以充分利用光照资源，从而节约照明用电。</p>
<p>全球约40%的国家在夏季使用夏令时，其他国家则全年只使用标准时间。标准时间在有的国家也因此被相应地称为冬季时间。</p>
<p>在施行夏令时的国家，一年里面有一天只有23小时（夏令时开始那一天），有一天有25小时（夏令时结束那一天），其他时间每天都是24小时。</p>
<p><code>DST</code>是夏令时（<code>Daylight Saving Time</code>）的缩写，在一年的某一段时间中将当地时间调整（通常）一小时。 DST的规则非常神奇（由当地法律确定），并且每年的起止时间都不同。C语言库中有一个表格，记录了各地的夏令时规则（实际上，为了灵活性，C语言库通常是从某个系统文件中读取这张表）。从这个角度而言，这张表是夏令时规则的唯一权威真理。</p>
</blockquote>
<h2 id="本地时间local-time">本地时间Local time</h2>
<blockquote>
<p>在日常生活中所使用的时间我们通常称之为本地时间。这个时间等于我们所在（或者所使用）时区内的当地时间，它由与世界标准时间（UTC）之间的偏移量来定义。这个偏移量可以表示为 UTC- 或 UTC+，后面接上偏移的小时和分钟数。<br>
本地时间就是用当地时区的时间表示。通常代码会自动获取操作系统的Time zone设置来转换成本地时间， 例如 <code>new Date()</code>.</p>
</blockquote>
<p>‘2024-08-19T17:00:00.380Z’ UTC时间<br>
例如在中国的本地时间就是Tue Aug 20 2024 16:33:09 GMT+0800 (China Standard Time)<br>
和其他时区的本地时间不同</p>
<h1 id="internationalization其他基本概念">internationalization其他基本概念</h1>
<p><code>i18n</code> ( internationalization ) 简称国际化 ，在现代前端开发中，有国际化需求的网站 / app，都需要进行 i18n 进行多语言的处理。</p>
<p><code>ISO</code>(International Organization for Standardization) 国际标准化组织.</p>
<p><a href="http://cuihuan.net/2019/05/12/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/" target="_blank" rel="noopener">字符编码那些事儿</a></p>
<h2 id="cldr"><a href="https://cldr.unicode.org/" target="_blank" rel="noopener"><code>CLDR</code></a></h2>
<blockquote>
<p><a href="https://cldr.unicode.org/" target="_blank" rel="noopener"><code>CLDR</code></a><br>
The Unicode <code>Common Locale Data Repository</code> (CLDR) provides key building blocks for software to support the world’s languages, with the largest and most extensive standard repository of locale data available. This data is used by a wide spectrum of companies for their software internationalization and localization, adapting software to the conventions of different languages for such common software tasks.</p>
</blockquote>
<p>通用语言环境数据仓库<a href="https://cldr.unicode.org/" target="_blank" rel="noopener"><code>CLDR</code></a><br>
通用语言环境数据仓库 (Common Locale Data Repository, CLDR) 项目是 Unicode Consortium 的一个项目，用于提供扩展的语言环境数据。CLDR 包含特定于语言环境的信息，操作系统通常会将该信息提供给应用程序。该信息包含数字格式、日期、时间和货币字符串、字符分类（小写、大写、可打印等）、字符串整理规则以及其他内容。<br>
CLDR 是以 Unicode 的编码标准作为前提，将多国的语言文字进行编码的。<br>
CLDR 不仅阐述了每个国家语言的文字应当如何被解析，并且，为了解析结果的可靠，还规定了结果集排序方式。<br>
该项目每年提供两次版本更新，一次是4月份，一次是10月份。github最新开发版本：<a href="https://github.com/unicode-org/cldr/tree/latest" target="_blank" rel="noopener">github-unicode-org/cldr</a>，可以下载<a href="https://github.com/unicode-org/cldr/releases" target="_blank" rel="noopener">最新数据</a>。<br>
国家下属子区域名称也有各种语言的翻译：<a href="https://github.com/unicode-org/cldr/tree/latest/common/subdivisions" target="_blank" rel="noopener">subdivisions</a>，可用的区域英文名称和代码：<a href="https://unicode.org/cldr/charts/latest/supplemental/territory_subdivisions.html" target="_blank" rel="noopener">Territory Subdivisions</a>，例如代码cnhb的中文简体（目前在yue_Hans.xml文件中）是“湖北”，可以考虑以后用到需要翻译国家下面一级或者两级子区域的网站，例如<a href="https://youbianku.com/" target="_blank" rel="noopener">邮编库系列网站</a>。</p>
<p>CLDR 是 Unicode Consortium（Unicode 联盟）下属的一个项目，并不从属于 Unicode Standard（Unicode 标准，即我们一般说的 Unicode），它们是两个平行的项目。</p>
<h3 id="java-中的cldr">Java 中的CLDR</h3>
<p>从JDK 9开始，Unicode Consortium的公共区域设置数据存储库（CLDR）数据作为默认区域设置数据启用，因此您可以使用标准区域设置数据而无需任何进一步操作。</p>
<p>在JDK 8中，虽然CLDR区域设置数据与JRE捆绑在一起，但默认情况下不启用它。</p>
<p>使用区域设置敏感服务（如日期，时间和数字格式）的代码可能会使用CLDR区域设置数据生成不同的结果。请记住，即使<code>System.out.printf（）</code>也是区域设置感知的。</p>
<p>要启用与JDK 8兼容的行为，请将系统属性设置为例如前面的<code>java.locale.providers</code>值。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java.locale.providers=COMPAT,CLDR</span><br></pre></td></tr></table></figure>
<p>见<a href="https://docs.oracle.com/en/java/javase/11/intl/internationalization-enhancements1.html#GUID-9DCDB41C-A989-4220-8140-DBFB844A0FCA" target="_blank" rel="noopener">CLDR语言环境数据通过默认启用的Java平台</a>，标准版国际指南和<a href="https://openjdk.org/jeps/252?spm=a2c6h.12873639.article-detail.98.1f10173fd2EXCx" target="_blank" rel="noopener">JEP 252：使用CLDR语言环境数据的默认</a>。</p>
<p>Java 9的国际化增强功能包括默认情况下启用CLDR语言环境数据。</p>
<p>使用以下关键字标识的语言环境数据有四个不同的来源：</p>
<ul>
<li>
<p>CLDR：Unicode通用语言环境数据存储库(CLDR)项目提供的语言环境数据。</p>
</li>
<li>
<p>HOST：当前用户对基础操作系统设置的自定义。根据操作系统的不同，可以支持日期，时间，数字和货币等格式。</p>
</li>
<li>
<p>SPI：在已安装的SPI提供程序中实现的对语言环境敏感的服务。</p>
</li>
<li>
<p>COMPAT(JRE)：与Java 9之前的发行版兼容的语言环境数据。JRE仍可以用作值，但已弃用，以后会删除。</p>
</li>
</ul>
<p>在Java 8和早期版本中，JRE是默认语言环境数据。Java 9默认将CLDR设置为最高优先级。我们使用java.locale.providers系统属性按首选顺序选择语言环境数据源。如果提供程序未能请求区域设置数据，则可以处理下一个提供程序。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java.locale.providers=COMPAT,CLDR,HOST,SPI</span><br></pre></td></tr></table></figure>
<p>如果我们不设置该属性，则默认行为是：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java.locale.providers=CLDR,COMPAT,SPI</span><br></pre></td></tr></table></figure>
<p>为了与Java 8兼容，请将COMPAT置于CLDR之前。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java.locale.providers=COMPAT,CLDR</span><br></pre></td></tr></table></figure>
<p>Ant 配置 （build.xml）</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">java</span> <span class="attr">classname</span>=<span class="string">"com.lyk.web.app.PropertySetJsHelper"</span> <span class="attr">failonerror</span>=<span class="string">"yes"</span> <span class="attr">fork</span>=<span class="string">"yes"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sysproperty</span> <span class="attr">key</span>=<span class="string">"java.locale.providers"</span> <span class="attr">value</span>=<span class="string">"COMPAT,CLDR,SPI"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">java</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Gradle 配置 （build.gradle）</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">systemProperty <span class="string">'java.locale.providers'</span>, <span class="string">'COMPAT,CLDR,SPI'</span></span><br></pre></td></tr></table></figure>
<p>参考文章： <a href="https://developer.aliyun.com/article/659407" target="_blank" rel="noopener">JDK11变化详解，JDK8升级JDK11详细指南</a></p>
<h2 id="icu"><a href="https://icu.unicode.org/" target="_blank" rel="noopener">ICU</a></h2>
<p>ICU (<code>International Components for Unicode</code>)是为软件应用提供Unicode和全球化支持的一套成熟、广泛使用的C/C++、<a href="http://xn--Java-321g.NET" target="_blank" rel="noopener">Java和.NET</a> 类库集，可在所有平台的C/C++、Java和C# 软件上获得一致的结果，用于支持软件国际化的开源项目, 软件开发者几乎可以使用ICU 解决任何国际化的问题，根据各地的风俗和语言习惯，实现对数字、货币、时间、日期、和消息的格式化、解析，对字符串进行大小写转换、整理、搜索和排序等功能。ICU的主页是<a href="http://www.icu-project.org/" target="_blank" rel="noopener">http://www.icu-project.org/</a></p>
<blockquote>
<p>在unicode的统治下，世界各国的基本编码不会出现乱码等异常。但当中华民族逐步强大，准备冲出中国统一世界的时候，发现各国的货币，时间，数字等表示灰常不统一，例如数字1234.5，英文表示1,234.5，葡语表示确是1.234,5，很是苦恼。</p>
<p>此时IBM站了出来，叫上google,apple等小伙伴，遵循”IBM公共许可证”，开源了一套基于unicode的国际化组件ICU(International Component for Unicode<br>
)。根据各地的风俗和语言习惯，实现对数字、货币、时间、日期、和消息的格式化、解析，对字符串进行大小写转换、整理、搜索和排序等功能，ICU4C提供了强大的BIDI算法，对阿拉伯语等BIDI语言提供了完善的支持。</p>
<p>ICU成为了目前国际化组件的实事标准，底层依赖UNICODE和CLDR，官方提供了C/C++和JAVA的SDK，ICU4C和ICU4J，同时，各个语言在此基础上开发了各个语言的版本，例如php的intl组件。</p>
</blockquote>
<p>ICU首先是由Taligent(泰利根)公司开发的，Taligent公司被合并为IBM公司全球化认证中心的Unicode研究组后，ICU由IBM和开源组织合作继续开发。</p>
<ul>
<li>
<p>开始ICU只有Java平台的版本，后来这个平台下的ICU类被吸纳入SUN公司开发的JDK1.1，并在JDK以后的版本中不断改进。</p>
</li>
<li>
<p>C++和C平台下的ICU是由JAVA平台下的ICU移植过来的，移植过的版本被称为ICU4C，来支持这C/C++两个平台下的国际化应用。</p>
</li>
<li>
<p>ICU4J和ICU4C区别不大，但由于ICU4C是开源的，并且紧密跟进Unicode标准，ICU4C支持的Unicode标准总是最新的；同时，因为JAVA平台的ICU4J的发布需要和JDK绑定，ICU4C支持Unicode标准改变的速度要比ICU4J快的多。</p>
</li>
<li>
<p>在Linux 操作系统上，.NET Core 使用ICU的全球化API， 从 .NET 5.0 开始，如果应用在 Windows 10 2019 年 5 月更新或更高版本上运行，.NET 库将使用 ICU 全球化 API。.NET 5 统一使用ICU, 引入此更改的原因有两个：</p>
<ul>
<li>应用跨平台（包括 Linux、macOS 和 Windows）具有相同的全球化行为。</li>
<li>应用可以通过使用自定义 ICU 库来控制全球化行为。</li>
</ul>
</li>
</ul>
<p>ICU的功能主要有:</p>
<ul>
<li>代码页转换: 对文本数据进行Unicode、几乎任何其他字符集或编码的相互转换。ICU的转化表基于IBM过去几十年收集的字符集数据，在世界各地都是最完整的。</li>
<li>排序规则（Collation）: 根据特定语言、区域或国家的管理和标准比较字数串。ICU的排序规则基于Unicode排序规则算法加上来自公共区域性数据仓库（Common locale data repository）的区域特定比较规则。</li>
<li>格式化: 根据所选区域设置的惯例，实现对数字、货币、时间、日期、和利率的格式化。包括将月和日名称转换成所选语言、选择适当缩写、正确对字段进行排序等。这些数据也取自公共区域性数据仓库。</li>
<li>时间计算: 在传统格里历基础上提供多种历法。提供一整套时区计算API。</li>
<li>Unicode支持: ICU紧密跟进Unicode标准，通过它可以很容易地访问Unicode标准制定的很多Unicode字符属性、Unicode规范化、大小写转换和其他基础操作。</li>
<li>正则表达式: ICU的正则表达式全面支持Unicode并且性能极具竞争力。</li>
<li>Bidi: 支持不同文字书写顺序混合文字（例如从左到右书写的英语，或者从右到左书写的阿拉伯文和希伯来文）的处理。</li>
<li>文本边界: 在一段文本内定位词、句或段落位置、或标识最适合显示文本的自动换行位置。</li>
</ul>
<h1 id="编程语言中的datetime-format">编程语言中的DateTime format</h1>
<h2 id="javascript中的datetime">JavaScript中的DateTime</h2>
<h3 id="原生javascript">原生JavaScript</h3>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/Date" target="_blank" rel="noopener">MDN Date()</a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> date1 = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'December 17, 1995 03:24:00'</span>);</span><br><span class="line"><span class="comment">// Sun Dec 17 1995 03:24:00 GMT...</span></span><br><span class="line"><span class="keyword">const</span> date2 = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'1995-12-17T03:24:00'</span>);</span><br><span class="line"><span class="comment">// Sun Dec 17 1995 03:24:00 GMT...</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(date1 === date2);</span><br><span class="line"><span class="comment">// Expected output: false</span></span><br><span class="line"><span class="built_in">console</span>.log(date1 - date2);</span><br><span class="line"><span class="comment">// Expected output: 0</span></span><br></pre></td></tr></table></figure>
<h4 id="语法">语法</h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>()   <span class="comment">// now</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(value)  <span class="comment">// timestamp (the number of milliseconds since midnight at the beginning of January 1, 1970, UTC</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(dateString)</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(dateObject)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(year, monthIndex)</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(year, monthIndex, day)</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(year, monthIndex, day, hours)</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(year, monthIndex, day, hours, minutes)</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(year, monthIndex, day, hours, minutes, seconds)</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(year, monthIndex, day, hours, minutes, seconds, milliseconds)</span><br><span class="line"></span><br><span class="line"><span class="built_in">Date</span>()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> today = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"><span class="keyword">const</span> birthday = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"December 17, 1995 03:24:00"</span>); <span class="comment">// DISCOURAGED: may not work in all runtimes</span></span><br><span class="line"><span class="keyword">const</span> birthday = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"1995-12-17T03:24:00"</span>); <span class="comment">// This is standardized and will work reliably</span></span><br><span class="line"><span class="keyword">const</span> birthday = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">1995</span>, <span class="number">11</span>, <span class="number">17</span>); <span class="comment">// the month is 0-indexed</span></span><br><span class="line"><span class="keyword">const</span> birthday = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">1995</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">3</span>, <span class="number">24</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> birthday = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">628021800000</span>); <span class="comment">// passing epoch timestamp</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="literal">undefined</span>)); <span class="comment">// Invalid Date</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="literal">null</span>)); <span class="comment">// 1970-01-01T00:00:00.000Z</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Date</span>([<span class="string">"2020-06-19"</span>, <span class="string">"17:13"</span>]));</span><br><span class="line"><span class="comment">// 2020-06-19T17:13:00.000Z in Chrome, since it recognizes "2020-06-19,17:13"</span></span><br><span class="line"><span class="comment">// "Invalid Date" in Firefox</span></span><br></pre></td></tr></table></figure>
<h4 id="原生js时区">原生JS时区</h4>
<blockquote>
<p>注意 <code>new Date()</code> 会默认生成本地时间, 也就是带时区的时间</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"2024-08-19T17:28:38.380Z"</span>)</span><br><span class="line"><span class="comment">// Tue Aug 20 2024 01:28:38 GMT+0800 (China Standard Time)</span></span><br><span class="line"><span class="comment">// new Date会默认生成本地时间，time zone从 OS 操作系统的time zone设置读取</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> utcYear = date.getUTCFullYear(); <span class="comment">// 2024</span></span><br><span class="line"><span class="keyword">const</span> utcMonth = date.getUTCMonth() + <span class="number">1</span>; <span class="comment">// 8, Adding 1 because getUTCMonth() returns zero-based index 7</span></span><br><span class="line"><span class="keyword">const</span> utcDay = date.getUTCDate(); <span class="comment">// 19</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> year = date.getFullYear().toString()   <span class="comment">// 2024</span></span><br><span class="line"><span class="keyword">const</span> month = (date.getMonth() + <span class="number">1</span>).toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>) <span class="comment">// 8</span></span><br><span class="line"><span class="keyword">const</span> day = date.getDate().toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>) </span><br><span class="line"><span class="comment">// if time zone is GMT+0800, day is 20</span></span><br><span class="line"><span class="comment">// if time zone is GMT+0000, day is 19</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改timezone</span></span><br><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"2024-08-19T17:28:38.380Z"</span>);</span><br><span class="line"><span class="keyword">const</span> options = &#123; <span class="attr">timeZone</span>: <span class="string">'Asia/Shanghai'</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> dateString = date.toLocaleString(<span class="string">'en-US'</span>, options);</span><br><span class="line"><span class="built_in">console</span>.log(dateString); <span class="comment">// '8/20/2024, 1:28:38 AM'</span></span><br></pre></td></tr></table></figure>
<h4 id="local-date-time">Local date time</h4>
<ul>
<li><code>toString()</code>, <code>toDateString()</code>, <code>toTimeString()</code></li>
<li><code>toLocaleString()</code>,<code>toLocaleDateString()</code>, <code>toLocaleTimeString()</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> event = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'05 October 2011 21:48 UTC'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ------------------Local------------------ */</span></span><br><span class="line"><span class="built_in">console</span>.log(event.toString());</span><br><span class="line"><span class="comment">// Expected output: "Thu Oct 06 2011 05:48:00 GMT+0800 (China Standard Time)"</span></span><br><span class="line"><span class="comment">// Note: your timezone may vary</span></span><br><span class="line"><span class="built_in">console</span>.log(event.toDateString());</span><br><span class="line"><span class="comment">// this date interpreted in the local timezone</span></span><br><span class="line"><span class="comment">// Expected output: 'Thu Oct 06 2011'</span></span><br><span class="line">event.toTimeString()</span><br><span class="line"><span class="comment">// '05:48:00 GMT+0800 (China Standard Time)'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// returns a string with a language-sensitive representation of the date portion of this date in the local timezone</span></span><br><span class="line"><span class="comment">// toLocaleDateString()</span></span><br><span class="line"><span class="comment">// toLocaleDateString(locales)</span></span><br><span class="line"><span class="comment">// toLocaleDateString(locales, options)</span></span><br><span class="line"><span class="built_in">console</span>.log(event.toLocaleDateString());</span><br><span class="line"><span class="comment">// '10/6/2011'</span></span><br><span class="line">event.toLocaleDateString(<span class="string">"nl-Latn-BE"</span>)</span><br><span class="line"><span class="comment">// '6-10-2011'</span></span><br><span class="line">event.toLocaleDateString(<span class="string">"fi"</span>)</span><br><span class="line"><span class="comment">// '6.10.2011'</span></span><br><span class="line">event.toLocaleDateString(<span class="string">"sr-CS"</span>)</span><br><span class="line"><span class="comment">// '6. 10. 2011.'</span></span><br><span class="line">event.toLocaleDateString(<span class="string">"fr-CA"</span>)</span><br><span class="line"><span class="comment">// '2011-10-06'</span></span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">  weekday: <span class="string">'long'</span>,</span><br><span class="line">  year: <span class="string">'numeric'</span>,</span><br><span class="line">  month: <span class="string">'long'</span>,</span><br><span class="line">  day: <span class="string">'numeric'</span>,</span><br><span class="line">&#125;;</span><br><span class="line">event.toLocaleDateString(<span class="string">'de-DE'</span>, options)</span><br><span class="line"><span class="comment">// 'Donnerstag, 6. Oktober 2011'</span></span><br><span class="line">event.toLocaleDateString(<span class="string">'ar-EG'</span>, options)</span><br><span class="line"><span class="comment">// 'الخميس، ٦ أكتوبر ٢٠١١'</span></span><br><span class="line">event.toLocaleDateString(<span class="literal">undefined</span>, options)</span><br><span class="line"><span class="comment">// 'Thursday, October 6, 2011'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// toLocaleString()</span></span><br><span class="line"><span class="comment">// toLocaleString(locales)</span></span><br><span class="line"><span class="comment">// toLocaleString(locales, options)</span></span><br><span class="line"><span class="comment">// British English uses day-month-year order and 24-hour time without AM/PM</span></span><br><span class="line">event.toLocaleString(<span class="string">'en-GB'</span>, &#123; <span class="attr">timeZone</span>: <span class="string">'UTC'</span> &#125;)</span><br><span class="line"><span class="comment">// '05/10/2011, 21:48:00'</span></span><br><span class="line"><span class="comment">// Korean uses year-month-day order and 12-hour time with AM/PM</span></span><br><span class="line">event.toLocaleString(<span class="string">'ko-KR'</span>, &#123; <span class="attr">timeZone</span>: <span class="string">'UTC'</span> &#125;)</span><br><span class="line"><span class="comment">// '2011. 10. 5. 오후 9:48:00'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// toLocaleTimeString()</span></span><br><span class="line"><span class="comment">// toLocaleTimeString(locales)</span></span><br><span class="line"><span class="comment">// toLocaleTimeString(locales, options)</span></span><br><span class="line">event.toLocaleTimeString(<span class="string">'en-US'</span>)</span><br><span class="line"><span class="comment">// '5:48:00 AM'</span></span><br><span class="line">event.toLocaleTimeString(<span class="string">'it-IT'</span>)</span><br><span class="line"><span class="comment">// '05:48:00'</span></span><br><span class="line">event.toLocaleTimeString(<span class="string">'ar-EG'</span>)</span><br><span class="line"><span class="comment">// '٥:٤٨:٠٠ ص'</span></span><br></pre></td></tr></table></figure>
<h4 id="utc-datetime">UTC datetime</h4>
<ul>
<li><code>toISOString()</code>，<code>toJSON()</code></li>
<li><code>toUTCString()</code>, <code>toGMTString()</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> event = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'05 October 2011 21:48 UTC'</span>);</span><br><span class="line"><span class="comment">/* ------------------UTC------------------ */</span></span><br><span class="line"><span class="built_in">console</span>.log(event.toISOString()); </span><br><span class="line"><span class="comment">// a simplified format based on ISO 8601, which is always 24 or 27 characters long (YYYY-MM-DDTHH:mm:ss.sssZ or ±YYYYYY-MM-DDTHH:mm:ss.sssZ, respectively). The timezone is always UTC, as denoted by the suffix Z.</span></span><br><span class="line"><span class="comment">// Expected output: "2011-10-05T21:48:00.000Z"</span></span><br><span class="line"><span class="built_in">console</span>.log(event.toJSON());</span><br><span class="line"><span class="comment">// in the same ISO format as toISOString()</span></span><br><span class="line"><span class="comment">// '2011-10-05T21:48:00.000Z'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(event.toGMTString());</span><br><span class="line"><span class="comment">// Expected output: 'Wed, 05 Oct 2011 21:48:00 GMT'</span></span><br><span class="line">event.toUTCString()</span><br><span class="line"><span class="comment">// 'Wed, 05 Oct 2011 21:48:00 GMT'</span></span><br><span class="line"><span class="comment">// The timezone is always UTC. toGMTString() is an alias of this method.</span></span><br></pre></td></tr></table></figure>
<h4 id="生成current-time的utc-string">生成current time的UTC String</h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getNowUTCFormatted</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">    <span class="keyword">const</span> year = date.getUTCFullYear()</span><br><span class="line">    <span class="keyword">const</span> month = <span class="built_in">String</span>(date.getUTCMonth() + <span class="number">1</span>).padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">const</span> day = <span class="built_in">String</span>(date.getUTCDate()).padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">const</span> hours = <span class="built_in">String</span>(date.getUTCHours()).padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">const</span> minutes = <span class="built_in">String</span>(date.getUTCMinutes()).padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">const</span> seconds = <span class="built_in">String</span>(date.getUTCSeconds()).padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">const</span> milliseconds = <span class="built_in">String</span>(date.getUTCMilliseconds()).padStart(<span class="number">3</span>, <span class="string">'0'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 'YYYY-MM-DDTHH:mm:ss.SSSZZ'</span></span><br><span class="line">    <span class="keyword">const</span> utcString = <span class="string">`<span class="subst">$&#123;year&#125;</span>-<span class="subst">$&#123;month&#125;</span>-<span class="subst">$&#123;day&#125;</span>T<span class="subst">$&#123;hours&#125;</span>:<span class="subst">$&#123;minutes&#125;</span>:<span class="subst">$&#123;seconds&#125;</span>.<span class="subst">$&#123;milliseconds&#125;</span>+0000`</span></span><br><span class="line">    <span class="keyword">return</span> utcString</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="生成本地时间local-time-mm-dd-yyyy">生成本地时间Local time <code>MM/dd/yyyy</code></h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getLocalDateFromUTCTime</span>(<span class="params">utcTimeStr: string, _displayLocale: string</span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(utcTimeStr)</span><br><span class="line">  <span class="keyword">const</span> year = date.getFullYear().toString()</span><br><span class="line">  <span class="keyword">const</span> month = (date.getMonth() + <span class="number">1</span>).toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span><br><span class="line">  <span class="keyword">const</span> day = date.getDate().toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;month&#125;</span>/<span class="subst">$&#123;day&#125;</span>/<span class="subst">$&#123;year&#125;</span>`</span></span><br><span class="line">  <span class="comment">// MM/dd/yyyy</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// unit test</span></span><br><span class="line">  describe(<span class="string">'getLocalDateFromUTCTime'</span>, () =&gt; &#123;</span><br><span class="line">    it(<span class="string">'should format UTC time correctly'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> utcTimeStr = <span class="string">'2023-10-01T12:00:00Z'</span></span><br><span class="line">      <span class="keyword">const</span> formattedDate = getLocalDateFromUTCTime(utcTimeStr, <span class="string">'en'</span>)</span><br><span class="line">      expect(formattedDate).toBe(<span class="string">'10/01/2023'</span>)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> utcTimeStr2 = <span class="string">'2024-08-19T17:00:00.380Z'</span></span><br><span class="line">      <span class="keyword">const</span> formattedDate2 = getLocalDateFromUTCTime(utcTimeStr2, <span class="string">'en'</span>)</span><br><span class="line">      <span class="comment">// get current timezone</span></span><br><span class="line">      <span class="keyword">const</span> timezoneOffsetInMinutes = <span class="keyword">new</span> <span class="built_in">Date</span>().getTimezoneOffset()  <span class="comment">// -480</span></span><br><span class="line">      <span class="keyword">const</span> hours = <span class="built_in">Math</span>.abs(<span class="built_in">Math</span>.floor(timezoneOffsetInMinutes / <span class="number">60</span>)) <span class="comment">// 8</span></span><br><span class="line">      <span class="keyword">const</span> minutes = <span class="built_in">Math</span>.abs(timezoneOffsetInMinutes % <span class="number">60</span>); <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> sign = timezoneOffsetInMinutes &gt; <span class="number">0</span> ? <span class="string">'-'</span> : <span class="string">'+'</span> <span class="comment">// '+'</span></span><br><span class="line">      <span class="keyword">const</span> utcOffset = <span class="string">`UTC<span class="subst">$&#123;sign&#125;</span><span class="subst">$&#123;hours.toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>)&#125;</span>:<span class="subst">$&#123;minutes.toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>)&#125;</span>`</span>; <span class="comment">// UTC+08:00</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">/* eslint-disable */</span></span><br><span class="line">      <span class="keyword">if</span> (sign === <span class="string">'+'</span> &amp;&amp; hours &gt;= <span class="number">7</span>) &#123;</span><br><span class="line">        <span class="comment">// for Shanghai timezone, the date should be 08/20/2024</span></span><br><span class="line">        expect(formattedDate2).toBe(<span class="string">'08/20/2024'</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        expect(formattedDate2).toBe(<span class="string">'08/19/2024'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/* eslint-enable */</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="生成utc-mm-dd-yyyy">生成UTC <code>MM/dd/yyyy</code></h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getLocalDateFromUTCTime</span>(<span class="params">utcTimeStr: string, _displayLocale: string</span>): <span class="title">string</span> </span>&#123;</span><br><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(utcTimeStr);</span><br><span class="line"><span class="keyword">const</span> year = date.getUTCFullYear();</span><br><span class="line"><span class="keyword">const</span> month = date.getUTCMonth() + <span class="number">1</span>; <span class="comment">// Adding 1 because getUTCMonth() returns zero-based index</span></span><br><span class="line"><span class="keyword">const</span> day = date.getUTCDate();</span><br><span class="line"><span class="built_in">console</span>.log(year, month, day);</span><br><span class="line">  <span class="comment">// MM/dd/yyyy</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="js库-moment-deprecated">JS库 - Moment [Deprecated]</h3>
<h4 id="moment-global-import-issue">Moment global import issue</h4>
<p><a href="https://codesandbox.io/s/moment-import-issue-17oqzz" target="_blank" rel="noopener">https://codesandbox.io/s/moment-import-issue-17oqzz</a></p>
<h3 id="js库-dayjs"><a href="https://www.npmjs.com/package/dayjs" target="_blank" rel="noopener">JS库 - dayjs</a></h3>
<p><a href="https://day.js.org/docs/en/parse/string-format#list-of-all-available-parsing-tokens" target="_blank" rel="noopener">Format token： 'YYYY-MM-DDTHH:mm:ss.SSSZZ’代表什么</a></p>
<h4 id="dayjs生成current-time的utc-string">dayjs生成current time的UTC String</h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> dayjs <span class="keyword">from</span> <span class="string">'dayjs'</span></span><br><span class="line"><span class="keyword">import</span> utc <span class="keyword">from</span> <span class="string">'dayjs/plugin/utc'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getNowUTCFormatted</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// new Date(0) = Unix Epoch Start Time(Midnight, January 1, 1970 UTC)</span></span><br><span class="line">  <span class="comment">// Formart new Date(0) to expected format '1970-01-01T00:00:00.000+0000'</span></span><br><span class="line">  <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">  dayjs.extend(utc)</span><br><span class="line">  <span class="keyword">const</span> formattedDateTime = dayjs(now).utc().format(<span class="string">'YYYY-MM-DDTHH:mm:ss.SSSZZ'</span>)</span><br><span class="line">  <span class="comment">// "SSS" represents the three-digit millisecond. For example, "123" represents 123 milliseconds.</span></span><br><span class="line">  <span class="comment">// "ZZ" represents the time zone offset. In this case, it is "+0000," which means the time is in Coordinated Universal Time (UTC) with no offset.</span></span><br><span class="line">  <span class="keyword">return</span> formattedDateTime</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="生成本地时间local-time-mm-dd-yyyy-v2">生成本地时间<a href="https://day.js.org/docs/en/manipulate/local" target="_blank" rel="noopener">Local time</a> <code>MM/dd/yyyy</code></h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getLocalDateFromUTCTime</span>(<span class="params">utcTimeStr: string, _displayLocale: string</span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="comment">// utc(keepLocalTime?: boolean)</span></span><br><span class="line">  <span class="keyword">const</span> formattedDateTime = dayjs(utcTimeStr).utc(<span class="literal">true</span>).format(<span class="string">'MM/dd/yyyy'</span>)</span><br><span class="line">  <span class="keyword">return</span> formattedDateTime</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="dayjs生成utc-mm-dd-yyyy">dayjs生成<a href="https://day.js.org/docs/en/manipulate/utc" target="_blank" rel="noopener">UTC</a> <code>MM/dd/yyyy</code></h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getLocalDateFromUTCTime</span>(<span class="params">utcTimeStr: string, _displayLocale: string</span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> formattedDateTime = dayjs(utcTimeStr).utc().format(<span class="string">'MM/dd/yyyy'</span>)</span><br><span class="line">  <span class="keyword">return</span> formattedDateTime</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="dayjs-utc-adds-utc-local-isutc-apis-to-parse-or-display-in-utc">dayjs <a href="https://day.js.org/docs/en/plugin/utc" target="_blank" rel="noopener">UTC</a> adds .utc .local .isUTC APIs to parse or display in UTC</h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> utc = <span class="built_in">require</span>(<span class="string">"dayjs/plugin/utc"</span>);</span><br><span class="line"><span class="comment">// import utc from 'dayjs/plugin/utc' // ES 2015</span></span><br><span class="line"></span><br><span class="line">dayjs.extend(utc);</span><br><span class="line"></span><br><span class="line"><span class="comment">// default local time</span></span><br><span class="line">dayjs().format(); <span class="comment">//2019-03-06T17:11:55+08:00</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// UTC mode</span></span><br><span class="line">dayjs.utc().format(); <span class="comment">// 2019-03-06T09:11:55Z</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// convert local time to UTC time</span></span><br><span class="line">dayjs().utc().format(); <span class="comment">// 2019-03-06T09:11:55Z</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// While in UTC mode, all display methods will display in UTC time instead of local time.</span></span><br><span class="line"><span class="comment">// And all getters and setters will internally use the Date#getUTC* and Date#setUTC* methods instead of the Date#get* and Date#set* methods.</span></span><br><span class="line">dayjs.utc().isUTC(); <span class="comment">// true</span></span><br><span class="line">dayjs.utc().local().format(); <span class="comment">//2019-03-06T17:11:55+08:00</span></span><br><span class="line">dayjs.utc(<span class="string">"2018-01-01"</span>, <span class="string">"YYYY-MM-DD"</span>); <span class="comment">// with CustomParseFormat plugin</span></span><br></pre></td></tr></table></figure>
<h4 id="time-zone"><a href="https://day.js.org/docs/en/timezone/timezone" target="_blank" rel="noopener">Time Zone</a></h4>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">dayjs.extend(utc)</span><br><span class="line">dayjs.extend(timezone)</span><br><span class="line"></span><br><span class="line"><span class="comment">// current time zone is 'Europe/Berlin' (offset +01:00)</span></span><br><span class="line"><span class="comment">// Parsing</span></span><br><span class="line">dayjs.tz(<span class="string">"2013-11-18 11:55:20"</span>, <span class="string">"America/Toronto"</span>) <span class="comment">// '2013-11-18T11:55:20-05:00'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Converting (from time zone 'Europe/Berlin'!)</span></span><br><span class="line">dayjs(<span class="string">"2013-11-18 11:55:20"</span>).tz(<span class="string">"America/Toronto"</span>) <span class="comment">// '2013-11-18T05:55:20-05:00'</span></span><br></pre></td></tr></table></figure>
<h2 id="java-中的datetime">Java 中的DateTime</h2>
<h3 id="java-中的时间戳-v2"><a href="./%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8FDateTimeFormat-yyyy-MM-dd-HH-mm-ss-%E5%9D%91-%E5%A4%A7%E5%B0%8F%E5%86%99%E5%8C%BA%E5%88%AB.html#java-%E4%B8%AD%E7%9A%84%E6%97%B6%E9%97%B4%E6%88%B3">Java 中的时间戳</a></h3>
<h3 id="java-中的datetime-format">Java 中的DateTime format</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.Format;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// displaying current date and time</span></span><br><span class="line">        Calendar cal = Calendar.getInstance();</span><br><span class="line">        String formatStr = <span class="string">"dd/MMMM/yyyy hh:mm:ss zzzz"</span>;</span><br><span class="line">        SimpleDateFormat simpleformat = <span class="keyword">new</span> SimpleDateFormat(formatStr);</span><br><span class="line">        System.out.println(<span class="string">"Today's date '"</span> + formatStr + <span class="string">"' = "</span> + simpleformat.format(cal.getTime()));</span><br><span class="line"></span><br><span class="line">        formatStr = <span class="string">"dd/MMM/yyy hh:mm:ss zzz"</span>;</span><br><span class="line">        Format f = <span class="keyword">new</span> SimpleDateFormat(formatStr);</span><br><span class="line">        System.out.println(<span class="string">"Today's date '"</span> + formatStr + <span class="string">"' = "</span> + f.format(<span class="keyword">new</span> Date()));</span><br><span class="line"></span><br><span class="line">        formatStr = <span class="string">"dd/MM/yy hh:mm:ss zz"</span>;</span><br><span class="line">        f = <span class="keyword">new</span> SimpleDateFormat(formatStr);</span><br><span class="line">        System.out.println(<span class="string">"Today's date '"</span> + formatStr + <span class="string">"' = "</span> + f.format(<span class="keyword">new</span> Date()));</span><br><span class="line"></span><br><span class="line">        formatStr = <span class="string">"d/M/y h:mm:s z"</span>;</span><br><span class="line">        f = <span class="keyword">new</span> SimpleDateFormat(formatStr);</span><br><span class="line">        System.out.println(<span class="string">"Today's date '"</span> + formatStr + <span class="string">"' = "</span> + f.format(<span class="keyword">new</span> Date()));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// current time</span></span><br><span class="line">        System.out.println(<span class="string">"------Time----------"</span>);</span><br><span class="line">        formatStr = <span class="string">"hh:mm:ss a"</span>;</span><br><span class="line">        f = <span class="keyword">new</span> SimpleDateFormat(formatStr);</span><br><span class="line">        String strResult = f.format(<span class="keyword">new</span> Date());</span><br><span class="line">        System.out.println(<span class="string">"Time '"</span> + formatStr + <span class="string">"' = "</span>+strResult); <span class="comment">// Time = 02:52:28 AM</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Illegal pattern character 'A'at java.text.SimpleDateFormat.compile(SimpleDateFormat.java:826)</span></span><br><span class="line">        <span class="comment">// formatStr = "hh:mm:ss A";</span></span><br><span class="line">        <span class="comment">// f = new SimpleDateFormat(formatStr);</span></span><br><span class="line">        <span class="comment">// strResult = f.format(new Date());</span></span><br><span class="line">        <span class="comment">// System.out.println("Time '" + formatStr + "' = "+strResult);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// displaying hour</span></span><br><span class="line">        f = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"H"</span>);</span><br><span class="line">        String strHour = f.format(<span class="keyword">new</span> Date());</span><br><span class="line">        System.out.println(<span class="string">"Current Hour = "</span>+strHour); <span class="comment">// Current Hour = 2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// displaying minutes</span></span><br><span class="line">        f = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"mm"</span>);</span><br><span class="line">        String strMinute = f.format(<span class="keyword">new</span> Date());</span><br><span class="line">        System.out.println(<span class="string">"Current Minutes = "</span>+strMinute); <span class="comment">// Current Minutes = 52</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// displaying seconds</span></span><br><span class="line">        f = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"ss"</span>);</span><br><span class="line">        String strSeconds = f.format(<span class="keyword">new</span> Date());</span><br><span class="line">        System.out.println(<span class="string">"Current Seconds = "</span>+strSeconds); <span class="comment">// Current Seconds = 28</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Today&apos;s date &apos;dd/MMMM/yyyy hh:mm:ss zzzz&apos; = 25/November/2022 08:33:21 Coordinated Universal Time</span><br><span class="line">Today&apos;s date &apos;dd/MMM/yyy hh:mm:ss zzz&apos; = 25/Nov/2022 08:33:21 UTC</span><br><span class="line">Today&apos;s date &apos;dd/MM/yy hh:mm:ss zz&apos; = 25/11/22 08:33:21 UTC</span><br><span class="line">Today&apos;s date &apos;d/M/y h:mm:s z&apos; = 25/11/2022 8:33:21 UTC</span><br><span class="line">------Time----------</span><br><span class="line">Time &apos;hh:mm:ss a&apos; = 08:33:21 AM</span><br><span class="line">Current Hour = 8</span><br><span class="line">Current Minutes = 33</span><br><span class="line">Current Seconds = 21</span><br></pre></td></tr></table></figure>
<h2 id="参考文章">参考文章</h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/135951778" target="_blank" rel="noopener">彻底弄懂GMT、UTC、时区和夏令时</a></li>
<li><a href="https://blog.csdn.net/wildpal/article/details/40039977?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166865369616800215039495%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166865369616800215039495&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-6-40039977-null-null.142%5Ev63%5Econtrol,201%5Ev3%5Econtrol,213%5Ev2%5Et3_esquery_v3&amp;utm_term=%E6%97%B6%E9%97%B4%E6%88%B3&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener">什么是时间戳</a></li>
</ul>
<p>其他语言日期格式</p>
<ul>
<li><a href="https://www.51cto.com/article/147694.html" target="_blank" rel="noopener">C#日期型数据简单剖析</a></li>
<li><a href="https://cloud.tencent.com/developer/article/1653924" target="_blank" rel="noopener">在jsp页面中使用EL表达式格式化date日期</a></li>
<li><a href="https://docs.python.org/zh-cn/3/library/time.html" target="_blank" rel="noopener">3.11.0 Documentation » Python 标准库 » 通用操作系统服务 » time — 时间的访问和转换</a></li>
</ul>
]]></content>
  </entry>
</search>
